====================================================================================================
ğŸ“¦ SPOTITFORME - TÃœM ADMIN PANELÄ° VE ALT SAYFALAR
====================================================================================================

ğŸ¯ BaÅŸlangÄ±Ã§: app/page.tsx
ğŸ“… Tarih: 15.02.2026 00:31:38
ğŸ“Š Toplam: 94 dosya
ğŸŒ Bulunan Sayfalar: 0

====================================================================================================
ğŸ—ºï¸  SAYFA HARÄ°TASI
====================================================================================================

â€¢ /admin
â€¢ /admin/ads
â€¢ /admin/ads/create-manual
â€¢ /admin/adsense
â€¢ /admin/test
â€¢ /admin/users
â€¢ /create-spot
â€¢ /discovery
â€¢ /for-business
â€¢ /forgot-password
â€¢ /help/[id]
â€¢ /page.tsx
â€¢ /privacy
â€¢ /product/[id]
â€¢ /products
â€¢ /products/[id]
â€¢ /profile
â€¢ /profile/[id]
â€¢ /reset-password
â€¢ /shop/[id]
â€¢ /shop/[id]/inventory
â€¢ /shop/[id]/inventory/[productId]
â€¢ /shop/[id]/inventory/add
â€¢ /shop/analytics
â€¢ /shop/dashboard
â€¢ /shop/spots
â€¢ /spots
â€¢ /spots/[id]
â€¢ /terms
â€¢ /test
â€¢ /test-email
â€¢ /test-geolocation
â€¢ /test-panel

====================================================================================================
ğŸ“± APP SAYFALARI (page.tsx)
====================================================================================================

ğŸ“„ app/admin/ads/create-manual/page.tsx
ğŸ“Š 137 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/admin/ads/create-manual/page.tsx
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';

export default function CreateManualAdPage() {
  const router = useRouter();
  const [formData, setFormData] = useState({
    name: '',
    ad_type: 'manual',
    position: 'sidebar',
    size: '300x250',
    custom_html: '',
    advertiser_name: '',
    advertiser_url: '',
    advertiser_email: '',
    start_date: '',
    end_date: '',
    daily_budget: '',
    total_budget: '',
    status: 'draft'
  });

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    // Supabase'e kaydet
    router.push('/admin/ads');
  };

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-6">Yeni Manuel Reklam Ekle</h1>
      
      <form onSubmit={handleSubmit} className="space-y-6 max-w-2xl">
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-1">Reklam AdÄ± *</label>
            <input
              type="text"
              required
              className="w-full p-2 border rounded"
              value={formData.name}
              onChange={(e) => setFormData({...formData, name: e.target.value})}
            />
          </div>
          
          <div>
            <label className="block text-sm font-medium mb-1">Pozisyon *</label>
            <select
              className="w-full p-2 border rounded"
              value={formData.position}
              onChange={(e) => setFormData({...formData, position: e.target.value})}
            >
              <option value="header">Ana Sayfa Ãœst (728x90)</option>
              <option value="sidebar">SaÄŸ Sidebar (300x250)</option>
              <option value="inline">Ä°Ã§erik ArasÄ± (728x90)</option>
              <option value="mobile">Mobil Banner (320x50)</option>
              <option value="popup">Popup (400x300)</option>
            </select>
          </div>
        </div>

        <div>
          <label className="block text-sm font-medium mb-1">Reklamveren Bilgileri</label>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
            <input
              type="text"
              placeholder="Åirket AdÄ±"
              className="p-2 border rounded"
              value={formData.advertiser_name}
              onChange={(e) => setFormData({...formData, advertiser_name: e.target.value})}
            />
            <input
              type="url"
              placeholder="Website URL"
              className="p-2 border rounded"
              value={formData.advertiser_url}
              onChange={(e) => setFormData({...formData, advertiser_url: e.target.value})}
            />
          </div>
        </div>

        <div>
          <label className="block text-sm font-medium mb-1">Reklam HTML Kodu</label>
          <textarea
            rows={8}
            className="w-full p-2 border rounded font-mono text-sm"
            placeholder='<a href="https://example.com"><img src="https://example.com/banner.jpg" alt="Reklam" /></a>'
            value={formData.custom_html}
            onChange={(e) => setFormData({...formData, custom_html: e.target.value})}
          />
          <p className="text-sm text-gray-500 mt-1">
            HTML5 banner kodu veya basit HTML. Boyutlara dikkat edin.
          </p>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-1">BaÅŸlangÄ±Ã§ Tarihi</label>
            <input
              type="date"
              className="w-full p-2 border rounded"
              value={formData.start_date}
              onChange={(e) => setFormData({...formData, start_date: e.target.value})}
            />
          </div>
          <div>
            <label className="block text-sm font-medium mb-1">BitiÅŸ Tarihi</label>
            <input
              type="date"
              className="w-full p-2 border rounded"
              value={formData.end_date}
              onChange={(e) => setFormData({...formData, end_date: e.target.value})}
            />
          </div>
        </div>

        <div className="flex justify-end space-x-4">
          <button
            type="button"
            onClick={() => router.back()}
            className="px-4 py-2 border rounded-lg hover:bg-gray-100"
          >
            Ä°ptal
          </button>
          <button
            type="submit"
            className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
          >
            ReklamÄ± Kaydet
          </button>
        </div>
      </form>
    </div>
  );
}

ğŸ“„ app/admin/ads/page.tsx
ğŸ“Š 156 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/admin/ads/page.tsx - Reklam Ana SayfasÄ±
'use client';

import { useState } from 'react';
import Link from 'next/link';

export default function AdminAdsPage() {
  const [activeTab, setActiveTab] = useState('overview');

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-6">Reklam YÃ¶netimi</h1>
      
      <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
        <div className="bg-white p-4 rounded-lg shadow">
          <h3 className="font-semibold">Toplam Gelir</h3>
          <p className="text-2xl font-bold text-green-600">â‚º0.00</p>
        </div>
        <div className="bg-white p-4 rounded-lg shadow">
          <h3 className="font-semibold">Aktif Reklamlar</h3>
          <p className="text-2xl font-bold text-blue-600">0</p>
        </div>
        <div className="bg-white p-4 rounded-lg shadow">
          <h3 className="font-semibold">BugÃ¼nkÃ¼ GÃ¶sterim</h3>
          <p className="text-2xl font-bold text-purple-600">0</p>
        </div>
        <div className="bg-white p-4 rounded-lg shadow">
          <h3 className="font-semibold">BugÃ¼nkÃ¼ TÄ±klama</h3>
          <p className="text-2xl font-bold text-orange-600">0</p>
        </div>
      </div>

      <div className="flex space-x-4 mb-6">
        <button
          className={`px-4 py-2 rounded-lg ${activeTab === 'overview' ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}
          onClick={() => setActiveTab('overview')}
        >
          Genel BakÄ±ÅŸ
        </button>
        <button
          className={`px-4 py-2 rounded-lg ${activeTab === 'adsense' ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}
          onClick={() => setActiveTab('adsense')}
        >
          AdSense YÃ¶netimi
        </button>
        <button
          className={`px-4 py-2 rounded-lg ${activeTab === 'manual' ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}
          onClick={() => setActiveTab('manual')}
        >
          Manuel Reklamlar
        </button>
        <button
          className={`px-4 py-2 rounded-lg ${activeTab === 'advertisers' ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}
          onClick={() => setActiveTab('advertisers')}
        >
          Reklamverenler
        </button>
      </div>

      {activeTab === 'overview' && (
        <div className="bg-white p-6 rounded-lg shadow">
          <h2 className="text-xl font-bold mb-4">HÄ±zlÄ± Eylemler</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <Link href="/admin/ads/adsense-setup" className="bg-blue-50 p-4 rounded-lg border border-blue-200 hover:bg-blue-100 transition">
              <h3 className="font-semibold">AdSense Kurulum</h3>
              <p className="text-sm text-gray-600">Google AdSense entegrasyonu</p>
            </Link>
            <Link href="/admin/ads/create-manual" className="bg-green-50 p-4 rounded-lg border border-green-200 hover:bg-green-100 transition">
              <h3 className="font-semibold">Manuel Reklam Ekle</h3>
              <p className="text-sm text-gray-600">Kendi reklamÄ±nÄ±zÄ± ekleyin</p>
            </Link>
            <Link href="/admin/ads/placements" className="bg-purple-50 p-4 rounded-lg border border-purple-200 hover:bg-purple-100 transition">
              <h3 className="font-semibold">Reklam YerleÅŸimleri</h3>
              <p className="text-sm text-gray-600">Reklam pozisyonlarÄ±nÄ± yÃ¶netin</p>
            </Link>
            <Link href="/admin/ads/reports" className="bg-orange-50 p-4 rounded-lg border border-orange-200 hover:bg-orange-100 transition">
              <h3 className="font-semibold">Raporlar</h3>
              <p className="text-sm text-gray-600">Performans raporlarÄ±</p>
            </Link>
          </div>
        </div>
      )}

      {activeTab === 'adsense' && (
        <div className="bg-white p-6 rounded-lg shadow">
          <h2 className="text-xl font-bold mb-4">AdSense YÃ¶netimi</h2>
          <div className="space-y-4">
            <div className="p-4 border rounded-lg">
              <h3 className="font-semibold">AdSense Durumu</h3>
              <div className="flex items-center space-x-2 mt-2">
                <div className="w-3 h-3 rounded-full bg-red-500"></div>
                <span>AdSense aktif deÄŸil</span>
              </div>
            </div>
            
            <div className="p-4 border rounded-lg">
              <h3 className="font-semibold mb-2">AdSense Kurulumu</h3>
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium mb-1">AdSense Client ID</label>
                  <input
                    type="text"
                    placeholder="ca-pub-xxxxxxxxxxxxxxxx"
                    className="w-full p-2 border rounded"
                  />
                  <p className="text-sm text-gray-500 mt-1">Google AdSense panelinden alÄ±nan client ID</p>
                </div>
                <button className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                  AdSense'i Aktif Et
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {activeTab === 'manual' && (
        <div className="bg-white p-6 rounded-lg shadow">
          <h2 className="text-xl font-bold mb-4">Manuel Reklam YÃ¶netimi</h2>
          <div className="space-y-4">
            <div className="flex justify-between items-center">
              <h3 className="font-semibold">Mevcut Reklamlar</h3>
              <Link href="/admin/ads/create-manual" className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                Yeni Reklam Ekle
              </Link>
            </div>
            
            {/* Reklam listesi buraya gelecek */}
            <div className="text-center py-8 text-gray-500">
              HenÃ¼z manuel reklam eklenmemiÅŸ
            </div>
          </div>
        </div>
      )}

      {activeTab === 'advertisers' && (
        <div className="bg-white p-6 rounded-lg shadow">
          <h2 className="text-xl font-bold mb-4">Reklamveren YÃ¶netimi</h2>
          <div className="space-y-4">
            <div className="flex justify-between items-center">
              <h3 className="font-semibold">Reklamverenler</h3>
              <button className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                Yeni Reklamveren Ekle
              </button>
            </div>
            
            {/* Reklamveren listesi buraya gelecek */}
            <div className="text-center py-8 text-gray-500">
              HenÃ¼z reklamveren eklenmemiÅŸ
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

ğŸ“„ app/admin/adsense/page.tsx
ğŸ“Š 609 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/admin/adsense/page.tsx - DÃœZELTMÄ°Å VERSÄ°YON
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import AdUnitManager from '@/components/admin/AdUnitManager'
import AdPerformance from '@/components/admin/AdPerformance'
import Link from 'next/link'

// AdUnit tipi
interface AdUnit {
  id: string
  name: string
  type: 'display' | 'in-article' | 'in-feed'
  size: string
  position: string
  status: 'active' | 'paused'
  revenue: number
}

// AdSense Config tipi
interface AdSenseConfig {
  clientId: string
  isActive: boolean
  autoAds: boolean
  adUnits: AdUnit[]
  lastSync?: string
}

export default function AdSensePage() {
  const [config, setConfig] = useState<AdSenseConfig>({
    clientId: process.env.NEXT_PUBLIC_ADSENSE_CLIENT_ID || '',
    isActive: false,
    autoAds: true,
    adUnits: [
      {
        id: 'ad-header-001',
        name: 'Header Banner',
        type: 'display',
        size: '728x90',
        position: 'header',
        status: 'active',
        revenue: 45.50
      },
      {
        id: 'ad-sidebar-001',
        name: 'Sidebar Rectangle',
        type: 'display',
        size: '300x250',
        position: 'sidebar',
        status: 'active',
        revenue: 32.75
      },
      {
        id: 'ad-article-001',
        name: 'Article Inline',
        type: 'in-article',
        size: '336x280',
        position: 'content-middle',
        status: 'paused',
        revenue: 18.20
      }
    ]
  })
  
  const [loading, setLoading] = useState(true)
  const [saving, setSaving] = useState(false)
  // DÃœZELTME: 'code' tab'Ä±nÄ± da ekle
  const [activeTab, setActiveTab] = useState<'settings' | 'units' | 'performance' | 'code'>('settings')

  useEffect(() => {
    fetchAdSenseConfig()
  }, [])

  const fetchAdSenseConfig = async () => {
    try {
      setLoading(true)
      
      // Database'den config'i Ã§ek
      const { data } = await supabase
        .from('site_settings')
        .select('*')
        .eq('key', 'adsense_config')
        .single()

      if (data && data.value) {
        const savedConfig = JSON.parse(data.value)
        setConfig(prev => ({
          ...prev,
          ...savedConfig,
          // Database'de yoksa varsayÄ±lan deÄŸerleri koru
          clientId: savedConfig.clientId || prev.clientId,
          isActive: savedConfig.isActive !== undefined ? savedConfig.isActive : prev.isActive,
          autoAds: savedConfig.autoAds !== undefined ? savedConfig.autoAds : prev.autoAds,
          adUnits: savedConfig.adUnits || prev.adUnits,
          lastSync: savedConfig.lastSync
        }))
      }
    } catch (error) {
      console.error('AdSense config yÃ¼klenemedi:', error)
      // Hata durumunda varsayÄ±lan config ile devam et
    } finally {
      setLoading(false)
    }
  }

  const saveConfig = async () => {
    setSaving(true)
    try {
      const configToSave = {
        ...config,
        lastSync: new Date().toISOString()
      }

      const { error } = await supabase
        .from('site_settings')
        .upsert({
          key: 'adsense_config',
          value: JSON.stringify(configToSave),
          updated_at: new Date().toISOString()
        }, {
          onConflict: 'key'
        })

      if (error) throw error

      // Admin log'a kaydet
      await supabase
        .from('admin_logs')
        .insert({
          action: 'adsense_config_updated',
          details: { 
            config: configToSave,
            timestamp: new Date().toISOString()
          }
        })

      alert('âœ… AdSense ayarlarÄ± baÅŸarÄ±yla kaydedildi!')
      
    } catch (error) {
      console.error('AdSense config kaydedilemedi:', error)
      alert('âŒ KayÄ±t sÄ±rasÄ±nda hata oluÅŸtu. LÃ¼tfen tekrar deneyin.')
    } finally {
      setSaving(false)
    }
  }

  const handleAdUnitsUpdate = (updatedUnits: AdUnit[]) => {
    setConfig(prev => ({
      ...prev,
      adUnits: updatedUnits
    }))
  }

  const generateAdCode = (type: 'header' | 'auto' | 'unit') => {
    switch (type) {
      case 'header':
        return `<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${config.clientId}"></script>`
      
      case 'auto':
        return `<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "${config.clientId}",
    enable_page_level_ads: true,
    overlays: {bottom: true}
  });
</script>`
      
      case 'unit':
        return `<ins class="adsbygoogle"
  style="display:block"
  data-ad-client="${config.clientId}"
  data-ad-slot="1234567890"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({});
</script>`
      
      default:
        return ''
    }
  }

  const copyToClipboard = (text: string) => {
    navigator.clipboard.writeText(text)
    alert('KopyalandÄ±!')
  }

  const testAdSense = async () => {
    if (!config.clientId) {
      alert('Ã–nce AdSense Client ID girin')
      return
    }

    try {
      const response = await fetch('/api/adsense/test', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ clientId: config.clientId })
      })

      const data = await response.json()
      
      if (data.success) {
        alert('âœ… AdSense baÄŸlantÄ±sÄ± baÅŸarÄ±lÄ±!')
      } else {
        alert('âŒ AdSense baÄŸlantÄ±sÄ± baÅŸarÄ±sÄ±z: ' + data.message)
      }
    } catch (error) {
      alert('âŒ Test sÄ±rasÄ±nda hata oluÅŸtu')
    }
  }

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">AdSense ayarlarÄ± yÃ¼kleniyor...</p>
        </div>
      </div>
    )
  }

  return (
    <div className="space-y-6">
      {/* BaÅŸlÄ±k ve Navigasyon */}
      <div className="flex flex-col md:flex-row md:items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Google AdSense YÃ¶netimi</h1>
          <p className="text-gray-600">Reklam ayarlarÄ±nÄ±zÄ± buradan yÃ¶netin ve takip edin</p>
        </div>
        
        <div className="flex space-x-3 mt-4 md:mt-0">
          <button
            onClick={testAdSense}
            className="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium"
          >
            ğŸ”— BaÄŸlantÄ±yÄ± Test Et
          </button>
          <Link
            href="https://adsense.google.com"
            target="_blank"
            className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center"
          >
            ğŸŒ AdSense'e Git
          </Link>
        </div>
      </div>

      {/* Durum GÃ¶stergesi */}
      <div className={`p-4 rounded-lg ${config.isActive ? 'bg-green-50 border border-green-200' : 'bg-yellow-50 border border-yellow-200'}`}>
        <div className="flex items-center justify-between">
          <div className="flex items-center space-x-3">
            <div className={`w-3 h-3 rounded-full ${config.isActive ? 'bg-green-500' : 'bg-yellow-500'}`} />
            <div>
              <p className="font-medium">
                AdSense {config.isActive ? 'Aktif' : 'Devre DÄ±ÅŸÄ±'}
              </p>
              <p className="text-sm text-gray-600">
                {config.isActive 
                  ? 'Reklamlar sitenizde gÃ¶steriliyor' 
                  : 'Reklamlar ÅŸu anda gÃ¶sterilmiyor'}
              </p>
            </div>
          </div>
          <button
            onClick={() => setConfig({...config, isActive: !config.isActive})}
            className={`px-4 py-2 rounded-lg font-medium ${
              config.isActive
                ? 'bg-red-100 hover:bg-red-200 text-red-700'
                : 'bg-green-100 hover:bg-green-200 text-green-700'
            }`}
          >
            {config.isActive ? 'ReklamlarÄ± Durdur' : 'ReklamlarÄ± BaÅŸlat'}
          </button>
        </div>
      </div>

      {/* Tab Navigation */}
      <div className="bg-white rounded-xl shadow">
        <div className="border-b">
          <nav className="flex -mb-px">
            {[
              { id: 'settings' as const, name: 'Temel Ayarlar', icon: 'âš™ï¸' },
              { id: 'units' as const, name: 'Reklam Ãœniteleri', icon: 'ğŸ“º' },
              { id: 'performance' as const, name: 'Performans', icon: 'ğŸ“Š' },
              { id: 'code' as const, name: 'Kodlar', icon: 'ğŸ’»' }
            ].map((tab) => (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                className={`flex-1 py-4 text-center font-medium border-b-2 ${
                  activeTab === tab.id
                    ? 'border-blue-600 text-blue-600'
                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }`}
              >
                <span className="mr-2">{tab.icon}</span>
                {tab.name}
              </button>
            ))}
          </nav>
        </div>

        {/* Tab Content */}
        <div className="p-6">
          {/* AYARLAR TAB */}
          {activeTab === 'settings' && (
            <div className="space-y-6">
              <div>
                <h2 className="text-lg font-bold text-gray-900 mb-4">AdSense Kimlik Bilgileri</h2>
                
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      AdSense Client ID *
                    </label>
                    <input
                      type="text"
                      value={config.clientId}
                      onChange={(e) => setConfig({...config, clientId: e.target.value})}
                      placeholder="ca-pub-xxxxxxxxxxxxxxxx"
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    />
                    <p className="text-sm text-gray-500 mt-1">
                      Google AdSense hesabÄ±nÄ±zdaki Publisher ID
                    </p>
                  </div>

                  <div className="grid md:grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <h3 className="font-medium text-gray-900">Reklam AyarlarÄ±</h3>
                      
                      <div className="flex items-center space-x-3">
                        <input
                          type="checkbox"
                          checked={config.autoAds}
                          onChange={(e) => setConfig({...config, autoAds: e.target.checked})}
                          className="w-4 h-4 text-blue-600"
                          id="autoAds"
                        />
                        <label htmlFor="autoAds" className="text-sm font-medium text-gray-700">
                          Otomatik Reklamlar
                        </label>
                        <span className="text-xs text-gray-500">
                          (Google en iyi yerlere reklam yerleÅŸtirir)
                        </span>
                      </div>

                      <div className="flex items-center space-x-3">
                        <input
                          type="checkbox"
                          checked={config.isActive}
                          onChange={(e) => setConfig({...config, isActive: e.target.checked})}
                          className="w-4 h-4 text-blue-600"
                          id="isActive"
                        />
                        <label htmlFor="isActive" className="text-sm font-medium text-gray-700">
                          ReklamlarÄ± Aktif Et
                        </label>
                      </div>
                    </div>

                    <div className="space-y-4">
                      <h3 className="font-medium text-gray-900">GeliÅŸmiÅŸ Ayarlar</h3>
                      
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          GDPR UyumluluÄŸu
                        </label>
                        <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
                          <option>KullanÄ±cÄ± onayÄ± iste</option>
                          <option>Otomatik kabul et</option>
                          <option>Sadece AB dÄ±ÅŸÄ±</option>
                        </select>
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Reklam FrekansÄ±
                        </label>
                        <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
                          <option>Normal</option>
                          <option>DÃ¼ÅŸÃ¼k (daha az reklam)</option>
                          <option>YÃ¼ksek (maksimum gelir)</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              {/* Kaydet Butonu */}
              <div className="flex justify-end pt-6 border-t">
                <button
                  onClick={saveConfig}
                  disabled={saving || !config.clientId}
                  className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  {saving ? 'Kaydediliyor...' : 'AyarlarÄ± Kaydet'}
                </button>
              </div>
            </div>
          )}

          {/* REKLAM ÃœNÄ°TELERÄ° TAB */}
          {activeTab === 'units' && (
            <div>
              <div className="mb-6">
                <h2 className="text-lg font-bold text-gray-900 mb-2">Reklam Ãœnite YÃ¶netimi</h2>
                <p className="text-gray-600">
                  Reklam Ã¼nitelerinizi ekleyin, dÃ¼zenleyin ve yÃ¶netin
                </p>
              </div>
              
              <AdUnitManager 
                adUnits={config.adUnits}
                onUpdate={handleAdUnitsUpdate}
                clientId={config.clientId}
              />
              
              <div className="mt-6 bg-gray-50 p-4 rounded-lg">
                <h3 className="font-medium text-gray-900 mb-2">ğŸ’¡ Ä°puÃ§larÄ±</h3>
                <ul className="text-sm text-gray-600 space-y-1">
                  <li>â€¢ "Display" reklamlar genel amaÃ§lÄ±dÄ±r, her yerde kullanÄ±labilir</li>
                  <li>â€¢ "In-article" reklamlar makale iÃ§eriÄŸine gÃ¶re optimize edilir</li>
                  <li>â€¢ "In-feed" reklamlar haber akÄ±ÅŸÄ±na entegre olur</li>
                  <li>â€¢ 300x250 boyutu (Medium Rectangle) en yÃ¼ksek tÄ±klama oranÄ±na sahiptir</li>
                </ul>
              </div>
            </div>
          )}

          {/* PERFORMANS TAB */}
          {activeTab === 'performance' && (
            <div>
              <div className="mb-6">
                <h2 className="text-lg font-bold text-gray-900 mb-2">Reklam PerformansÄ±</h2>
                <p className="text-gray-600">
                  ReklamlarÄ±nÄ±zÄ±n performansÄ±nÄ± takip edin ve optimize edin
                </p>
              </div>
              
              <AdPerformance />
              
              <div className="mt-6 grid grid-cols-1 md:grid-cols-3 gap-6">
                <div className="bg-white border border-gray-200 rounded-lg p-4">
                  <h3 className="font-medium text-gray-900 mb-2">ğŸ“ˆ Performans Ä°puÃ§larÄ±</h3>
                  <ul className="text-sm text-gray-600 space-y-2">
                    <li>â€¢ CTR %1'in altÄ±ndaysa reklam pozisyonunu deÄŸiÅŸtirin</li>
                    <li>â€¢ RPM â‚º5'in altÄ±ndaysa reklam formatÄ±nÄ± gÃ¶zden geÃ§irin</li>
                    <li>â€¢ Mobile trafik genellikle daha yÃ¼ksek tÄ±klama oranÄ±na sahiptir</li>
                  </ul>
                </div>
                
                <div className="bg-white border border-gray-200 rounded-lg p-4">
                  <h3 className="font-medium text-gray-900 mb-2">ğŸ¯ Optimizasyon</h3>
                  <ul className="text-sm text-gray-600 space-y-2">
                    <li>â€¢ En Ã§ok tÄ±klanan reklam boyutu: 300x250</li>
                    <li>â€¢ En yÃ¼ksek RPM: 970x250 (Leaderboard)</li>
                    <li>â€¢ En iyi pozisyon: Ä°Ã§erik sonu</li>
                  </ul>
                </div>
                
                <div className="bg-white border border-gray-200 rounded-lg p-4">
                  <h3 className="font-medium text-gray-900 mb-2">âš ï¸ Dikkat Edilecekler</h3>
                  <ul className="text-sm text-gray-600 space-y-2">
                    <li>â€¢ Sayfa baÅŸÄ±na 3'ten fazla reklam koymayÄ±n</li>
                    <li>â€¢ Pop-up reklamlar kullanÄ±cÄ± deneyimini bozar</li>
                    <li>â€¢ Reklam ile iÃ§erik oranÄ± %30'u geÃ§memeli</li>
                  </ul>
                </div>
              </div>
            </div>
          )}

          {/* KODLAR TAB - HATA DÃœZELTÄ°LDÄ° */}
          {activeTab === 'code' && (
            <div className="space-y-6">
              <div>
                <h2 className="text-lg font-bold text-gray-900 mb-4">AdSense KodlarÄ±</h2>
                <p className="text-gray-600 mb-6">
                  AÅŸaÄŸÄ±daki kodlarÄ± ilgili yerlere ekleyerek AdSense'i aktif edin
                </p>
              </div>

              {/* Head Script */}
              <div className="bg-gray-900 rounded-lg overflow-hidden">
                <div className="bg-gray-800 px-4 py-3 flex justify-between items-center">
                  <div>
                    <h3 className="font-medium text-white">Head Script</h3>
                    <p className="text-gray-400 text-sm">HTML &lt;head&gt; tag'i iÃ§ine ekleyin</p>
                  </div>
                  <button
                    onClick={() => copyToClipboard(generateAdCode('header'))}
                    className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm"
                  >
                    Kopyala
                  </button>
                </div>
                <pre className="p-4 text-gray-300 text-sm overflow-x-auto">
                  {generateAdCode('header')}
                </pre>
              </div>

              {/* Auto Ads Script */}
              <div className="bg-gray-900 rounded-lg overflow-hidden">
                <div className="bg-gray-800 px-4 py-3 flex justify-between items-center">
                  <div>
                    <h3 className="font-medium text-white">Auto Ads Script</h3>
                    <p className="text-gray-400 text-sm">&lt;body&gt; tag'inin hemen altÄ±na ekleyin</p>
                  </div>
                  <button
                    onClick={() => copyToClipboard(generateAdCode('auto'))}
                    className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm"
                  >
                    Kopyala
                  </button>
                </div>
                <pre className="p-4 text-gray-300 text-sm overflow-x-auto">
                  {generateAdCode('auto')}
                </pre>
              </div>

              {/* Manual Ad Unit */}
              <div className="bg-gray-900 rounded-lg overflow-hidden">
                <div className="bg-gray-800 px-4 py-3 flex justify-between items-center">
                  <div>
                    <h3 className="font-medium text-white">Manual Ad Unit</h3>
                    <p className="text-gray-400 text-sm">Ä°Ã§erik iÃ§inde kullanmak iÃ§in</p>
                  </div>
                  <button
                    onClick={() => copyToClipboard(generateAdCode('unit'))}
                    className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm"
                  >
                    Kopyala
                  </button>
                </div>
                <pre className="p-4 text-gray-300 text-sm overflow-x-auto">
                  {generateAdCode('unit')}
                </pre>
              </div>

              {/* Kurulum TalimatlarÄ± */}
              <div className="bg-blue-50 border border-blue-200 rounded-lg p-6">
                <h3 className="font-bold text-blue-900 mb-3">ğŸ“‹ Kurulum TalimatlarÄ±</h3>
                <ol className="space-y-3 text-blue-800">
                  <li className="flex items-start">
                    <span className="bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 flex-shrink-0">1</span>
                    <span>YukarÄ±daki "Head Script" kodunu <code className="bg-white px-2 py-1 rounded">app/layout.tsx</code> dosyasÄ±ndaki &lt;head&gt; iÃ§ine ekleyin</span>
                  </li>
                  <li className="flex items-start">
                    <span className="bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 flex-shrink-0">2</span>
                    <span>"Auto Ads Script" kodunu &lt;body&gt; tag'inin hemen altÄ±na ekleyin</span>
                  </li>
                  <li className="flex items-start">
                    <span className="bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 flex-shrink-0">3</span>
                    <span>Manual ad unit kodunu istediÄŸiniz sayfalara ekleyin</span>
                  </li>
                  <li className="flex items-start">
                    <span className="bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 flex-shrink-0">4</span>
                    <span>Google AdSense'den siteyi doÄŸrulayÄ±n (24-48 saat sÃ¼rebilir)</span>
                  </li>
                </ol>
              </div>
            </div>
          )}
        </div>
      </div>

      {/* HÄ±zlÄ± Ä°statistikler */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div className="bg-white rounded-lg shadow p-4">
          <p className="text-sm text-gray-600">Aktif Reklam</p>
          <p className="text-2xl font-bold text-gray-900">
            {config.adUnits.filter(u => u.status === 'active').length}
          </p>
        </div>
        <div className="bg-white rounded-lg shadow p-4">
          <p className="text-sm text-gray-600">Toplam Gelir</p>
          <p className="text-2xl font-bold text-gray-900">
            {config.adUnits.reduce((sum, unit) => sum + unit.revenue, 0).toFixed(2)} â‚º
          </p>
        </div>
        <div className="bg-white rounded-lg shadow p-4">
          <p className="text-sm text-gray-600">Ort. RPM</p>
          <p className="text-2xl font-bold text-gray-900">
            {(config.adUnits.reduce((sum, unit) => sum + unit.revenue, 0) / config.adUnits.length || 0).toFixed(2)} â‚º
          </p>
        </div>
        <div className="bg-white rounded-lg shadow p-4">
          <p className="text-sm text-gray-600">Durum</p>
          <p className={`text-2xl font-bold ${config.isActive ? 'text-green-600' : 'text-red-600'}`}>
            {config.isActive ? 'Aktif' : 'Pasif'}
          </p>
        </div>
      </div>

      {/* Son GÃ¼ncelleme */}
      {config.lastSync && (
        <div className="text-center text-sm text-gray-500">
          Son gÃ¼ncelleme: {new Date(config.lastSync).toLocaleString('tr-TR')}
        </div>
      )}
    </div>
  )
}

ğŸ“„ app/admin/page.tsx
ğŸ“Š 96 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/admin/page.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import DashboardStats from '@/components/admin/DashboardStats'
import RecentSpots from '@/components/admin/RecentSpots'
import RevenueChart from '@/components/admin/RevenueChart'
import AdSenseStatus from '@/components/admin/AdSenseStatus'

interface DashboardStats {
  totalUsers: number
  totalSpots: number
  totalShops: number
  revenue: number
  activeAds: number
}

// Payment interface'ini tanÄ±mla
interface Payment {
  amount: number
  status?: string
  [key: string]: any
}

export default function AdminDashboard() {
  const [stats, setStats] = useState<DashboardStats>({
    totalUsers: 0,
    totalSpots: 0,
    totalShops: 0,
    revenue: 0,
    activeAds: 0
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchDashboardData()
  }, [])

  const fetchDashboardData = async () => {
    try {
      // Paralel olarak tÃ¼m verileri Ã§ek
      const [
        usersData,
        spotsData,
        shopsData,
        revenueData
      ] = await Promise.all([
        supabase.from('user_profiles').select('count', { count: 'exact', head: true }),
        supabase.from('spots').select('count', { count: 'exact', head: true }),
        supabase.from('shops').select('count', { count: 'exact', head: true }),
        supabase.from('payments').select('amount').eq('status', 'completed')
      ])

      // DÃœZELTÄ°LMÄ°Å KISIM: reduce fonksiyonuna tipleri ekle
      const totalRevenue = revenueData.data?.reduce(
        (sum: number, payment: Payment) => sum + (payment.amount || 0), 
        0
      ) || 0

      setStats({
        totalUsers: usersData.count || 0,
        totalSpots: spotsData.count || 0,
        totalShops: shopsData.count || 0,
        revenue: totalRevenue,
        activeAds: 3 // Hardcoded ÅŸimdilik
      })
    } catch (error) {
      console.error('Dashboard verileri alÄ±namadÄ±:', error)
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="space-y-6">
      {/* Ãœst Bilgi */}
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Admin Dashboard</h1>
        <p className="text-gray-600">SpotItForMe yÃ¶netim paneline hoÅŸ geldiniz</p>
      </div>

      {/* Ä°statistik KartlarÄ± */}
      <DashboardStats stats={stats} loading={loading} />

      {/* AdSense Durumu */}
      <AdSenseStatus />

      {/* Grafikler ve Tablolar */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <RevenueChart />
        <RecentSpots />
      </div>
    </div>
  )
}

ğŸ“„ app/admin/test/page.tsx
ğŸ“Š 880 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/admin/test/page.tsx (TAM DÃœZELTÄ°LMÄ°Å)
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

interface TestResult {
  name: string
  status: 'success' | 'error' | 'warning' | 'pending'
  message: string
  details?: any
  duration?: number
}

interface EmailTestData {
  to: string
  template: string
  data: {
    name: string
    spotTitle: string
    spotId: string
    spotterName: string
  }
}

export default function SystemTestPage() {
  const [testResults, setTestResults] = useState<TestResult[]>([])
  const [runningTests, setRunningTests] = useState(false)
  const [user, setUser] = useState<any>(null)
  const [emailTestData, setEmailTestData] = useState<EmailTestData>({
    to: '',
    template: 'welcome',
    data: {
      name: 'Test User',
      spotTitle: 'Test Spot BaÅŸlÄ±ÄŸÄ±',
      spotId: 'test-' + Date.now(),
      spotterName: 'Test YardÄ±mcÄ±'
    }
  })

  // KullanÄ±cÄ± oturumunu kontrol et
  useEffect(() => {
    checkUserSession()
  }, [])

  const checkUserSession = async () => {
    const { data: { user } } = await supabase.auth.getUser()
    setUser(user)
    
    if (!user) {
      addTestResult({
        name: 'KullanÄ±cÄ± Oturumu',
        status: 'error',
        message: 'Oturum aÃ§Ä±lmamÄ±ÅŸ. LÃ¼tfen giriÅŸ yapÄ±n.'
      })
    }
  }

  const addTestResult = (result: TestResult) => {
    setTestResults(prev => [...prev, result])
  }

  // TÄ°P GÃœVENLÄ° TEST FONKSÄ°YONU
  const createTestResult = (
    status: TestResult['status'],
    message: string,
    details?: any,
    duration?: number
  ): Omit<TestResult, 'name'> => {
    return { status, message, details, duration }
  }

  // 1. TEMEL SÄ°STEM TESTLERÄ°
  const runBasicTests = async () => {
    const tests = [
      {
        name: 'Supabase BaÄŸlantÄ±sÄ±',
        test: async () => {
          const start = Date.now()
          try {
            const { data, error } = await supabase
              .from('spots')
              .select('count', { count: 'exact', head: true })
            
            const duration = Date.now() - start
            
            if (error) throw error
            
            return createTestResult(
              'success',
              `BaÄŸlantÄ± baÅŸarÄ±lÄ±. ${data} tablo var.`,
              null,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `BaÄŸlantÄ± hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      },
      {
        name: 'Database TablolarÄ±',
        test: async () => {
          const start = Date.now()
          const requiredTables = ['spots', 'sightings', 'user_profiles', 'shops']
          const results: any[] = []
          
          try {
            for (const table of requiredTables) {
              const { error } = await supabase
                .from(table)
                .select('*')
                .limit(1)
              
              results.push({
                table,
                exists: !error,
                error: error?.message
              })
            }
            
            const missingTables = results.filter(r => !r.exists)
            const duration = Date.now() - start
            
            if (missingTables.length > 0) {
              return createTestResult(
                'warning',
                `${missingTables.length} tablo eksik`,
                results,
                duration
              )
            }
            
            return createTestResult(
              'success',
              'TÃ¼m tablolar mevcut',
              results,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `Tablo kontrol hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      },
        {
        name: 'Storage Bucket',
        test: async () => {
            const start = Date.now()
            try {
            // DIRECT TEST: Bucket'a dosya yÃ¼kle
            const testFile = new File(['test-content'], `test-${Date.now()}.txt`, {
                type: 'text/plain'
            })
            
            const { error: uploadError } = await supabase.storage
                .from('spot-images')
                .upload(`system-test/test-${Date.now()}.txt`, testFile)
            
            const duration = Date.now() - start
            
            if (uploadError) {
                // Upload baÅŸarÄ±sÄ±z - bucket yok veya izin yok
                return createTestResult(
                uploadError.message.includes('bucket') ? 'error' : 'warning',
                `Upload hatasÄ±: ${uploadError.message}`,
                uploadError,
                duration
                )
            }
            
            // Upload BAÅARILI - bucket Ã§alÄ±ÅŸÄ±yor!
            return createTestResult(
                'success',
                'Storage bucket Ã§alÄ±ÅŸÄ±yor! Dosya yÃ¼klendi.',
                { uploaded: true, timestamp: new Date().toISOString() },
                duration
            )
            
            } catch (error: any) {
            return createTestResult(
                'error',
                `Storage test hatasÄ±: ${error.message}`,
                error
            )
            }
        }
        },
      {
        name: 'Health Check API',
        test: async () => {
          const start = Date.now()
          try {
            const response = await fetch('/api/health')
            const data = await response.json()
            const duration = Date.now() - start
            
            if (!response.ok) {
              return createTestResult(
                'error',
                `API hatalÄ±: ${response.status}`,
                data,
                duration
              )
            }
            
            return createTestResult(
              'success',
              `API Ã§alÄ±ÅŸÄ±yor (${data.duration})`,
              data,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `API hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      }
    ]

    for (const test of tests) {
      const result = await test.test()
      addTestResult({ 
        name: test.name, 
        ...result 
      })
      await new Promise(resolve => setTimeout(resolve, 500))
    }
  }

  // 2. EMAIL SÄ°STEM TESTLERÄ°
  const runEmailTests = async () => {
    const tests = [
      {
        name: 'Email API BaÄŸlantÄ±sÄ±',
        test: async () => {
          const start = Date.now()
          try {
            const response = await fetch('/api/send-email', { method: 'GET' })
            const data = await response.json()
            const duration = Date.now() - start
            
            if (!response.ok) {
              return createTestResult(
                'error',
                `Email API hatalÄ±: ${data.error || response.status}`,
                data,
                duration
              )
            }
            
            const status: TestResult['status'] = data.gmail_configured ? 'success' : 'warning'
            
            return createTestResult(
              status,
              data.gmail_configured 
                ? 'Email API hazÄ±r' 
                : 'Gmail konfigÃ¼rasyonu eksik',
              data,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `Email API hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      },
      {
        name: 'Test Email GÃ¶nderimi',
        test: async () => {
          if (!emailTestData.to) {
            return createTestResult(
              'warning',
              'Test email adresi gerekli',
              'LÃ¼tfen bir email adresi girin'
            )
          }

          const start = Date.now()
          try {
            const response = await fetch('/api/send-email', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                to: emailTestData.to,
                template: emailTestData.template,
                data: emailTestData.data,
                subject: `âœ… SpotItForMe Test Email - ${new Date().toLocaleString()}`,
                html: `
                  <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px; text-align: center; border-radius: 10px 10px 0 0;">
                      <h1 style="color: white; margin: 0;">âœ… TEST EMAIL</h1>
                      <p style="color: white; opacity: 0.9; margin-top: 10px;">SpotItForMe Email Sistemi Testi</p>
                    </div>
                    <div style="padding: 30px; border: 1px solid #e5e7eb; border-top: none; border-radius: 0 0 10px 10px;">
                      <p>Merhaba <strong>${emailTestData.data.name}</strong>,</p>
                      <p>Bu email SpotItForMe sisteminin dÃ¼zgÃ¼n Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± test etmek iÃ§in gÃ¶nderilmiÅŸtir.</p>
                      
                      <div style="background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <p><strong>Test DetaylarÄ±:</strong></p>
                        <p>ğŸ“§ Template: ${emailTestData.template}</p>
                        <p>â° GÃ¶nderim ZamanÄ±: ${new Date().toLocaleString('tr-TR')}</p>
                        <p>ğŸ†” Spot ID: ${emailTestData.data.spotId}</p>
                        <p>ğŸ‘¤ GÃ¶nderen: ${emailTestData.data.spotterName}</p>
                      </div>

                      <div style="text-align: center; margin: 30px 0;">
                        <div style="display: inline-block; background: #10b981; color: white; padding: 12px 30px; border-radius: 8px;">
                          âœ… EMAIL SÄ°STEMÄ° Ã‡ALIÅIYOR
                        </div>
                      </div>

                      <p>Bu email baÅŸarÄ±yla alÄ±ndÄ±ysa, SpotItForMe email sisteminiz dÃ¼zgÃ¼n Ã§alÄ±ÅŸÄ±yor demektir.</p>
                      
                      <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 30px 0;" />

                      <p style="font-size: 12px; color: #6b7280;">
                        Bu bir test emailidir. LÃ¼tfen cevaplamayÄ±n.
                      </p>
                    </div>
                  </div>
                `,
                text: `SpotItForMe Test Email - ${new Date().toLocaleString()}. Email sisteminiz Ã§alÄ±ÅŸÄ±yor!`
              })
            })

            const data = await response.json()
            const duration = Date.now() - start
            
            if (!response.ok) {
              return createTestResult(
                'error',
                `Email gÃ¶nderilemedi: ${data.error || response.status}`,
                data,
                duration
              )
            }
            
            return createTestResult(
              'success',
              `Email baÅŸarÄ±yla gÃ¶nderildi: ${data.messageId}`,
              data,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `Email gÃ¶nderme hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      },
      {
        name: 'CRON Job Testi',
        test: async () => {
          const start = Date.now()
          try {
            const response = await fetch('/api/cron/process-emails')
            const data = await response.json()
            const duration = Date.now() - start
            
            if (!response.ok) {
              const status: TestResult['status'] = data.error === 'Unauthorized' ? 'warning' : 'error'
              
              return createTestResult(
                status,
                data.error === 'Unauthorized' 
                  ? 'CRON secret gerekli (normal)' 
                  : `CRON hatasÄ±: ${data.error}`,
                data,
                duration
              )
            }
            
            return createTestResult(
              'success',
              `CRON Ã§alÄ±ÅŸÄ±yor: ${data.processed?.length || 0} email iÅŸlendi`,
              data,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `CRON test hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      },
      {
        name: 'Environment Variables',
        test: async () => {
          const start = Date.now()
          try {
            const response = await fetch('/api/env-check')
            const data = await response.json()
            const duration = Date.now() - start
            
            if (!response.ok || !data.success) {
              return createTestResult(
                'error',
                `Environment hatasÄ±: ${data.message}`,
                data,
                duration
              )
            }
            
            return createTestResult(
              'success',
              'Environment variables mevcut',
              data.envVars,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `Environment check hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      }
    ]

    for (const test of tests) {
      const result = await test.test()
      addTestResult({ 
        name: test.name, 
        ...result 
      })
      await new Promise(resolve => setTimeout(resolve, 1000))
    }
  }

  // 3. Ä°ÅLEVSEL TESTLER
  const runFunctionalTests = async () => {
    const tests = [
      {
        name: 'Spot API Testi',
        test: async () => {
          const start = Date.now()
          try {
            const response = await fetch('/api/spots')
            const data = await response.json()
            const duration = Date.now() - start
            
            if (!response.ok || data.status !== 'success') {
              return createTestResult(
                'error',
                `Spot API hatasÄ±: ${data.message}`,
                data,
                duration
              )
            }
            
            return createTestResult(
              'success',
              `Spot API Ã§alÄ±ÅŸÄ±yor: ${data.data?.spots?.length || 0} spot`,
              data.data,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `Spot API hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      },
      {
        name: 'KullanÄ±cÄ± API Testi',
        test: async () => {
          const start = Date.now()
          try {
            const response = await fetch('/api/users')
            const data = await response.json()
            const duration = Date.now() - start
            
            if (!response.ok || data.status !== 'success') {
              return createTestResult(
                'error',
                `User API hatasÄ±: ${data.message}`,
                data,
                duration
              )
            }
            
            return createTestResult(
              'success',
              `User API Ã§alÄ±ÅŸÄ±yor: ${data.data?.users?.length || 0} kullanÄ±cÄ±`,
              data.data,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `User API hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      },
      {
        name: 'Spot OluÅŸturma Testi',
        test: async () => {
          if (!user) {
            return createTestResult(
              'warning',
              'Spot oluÅŸturmak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z',
              'KullanÄ±cÄ± oturumu gerekiyor'
            )
          }

          const start = Date.now()
          try {
            const testSpot = {
              user_id: user.id,
              title: `[TEST] Sistem Test Spotu - ${Date.now()}`,
              description: 'Bu spot sistem testi iÃ§in oluÅŸturulmuÅŸtur.',
              category: 'DiÄŸer',
              location: 'Test Åehri',
              status: 'active',
              image_url: null
            }

            const { data, error } = await supabase
              .from('spots')
              .insert([testSpot])
              .select()
            
            const duration = Date.now() - start
            
            if (error) {
              return createTestResult(
                'error',
                `Spot oluÅŸturma hatasÄ±: ${error.message}`,
                error,
                duration
              )
            }
            
            if (data && data[0]) {
              setTimeout(async () => {
                await supabase.from('spots').delete().eq('id', data[0].id)
              }, 5000)
            }
            
            return createTestResult(
              'success',
              `Test spot'u oluÅŸturuldu: ${data?.[0]?.title}`,
              data,
              duration
            )
          } catch (error: any) {
            return createTestResult(
              'error',
              `Spot oluÅŸturma hatasÄ±: ${error.message}`,
              error
            )
          }
        }
      }
    ]

    for (const test of tests) {
      const result = await test.test()
      addTestResult({ 
        name: test.name, 
        ...result 
      })
      await new Promise(resolve => setTimeout(resolve, 500))
    }
  }

  // TÃœM TESTLERÄ° Ã‡ALIÅTIR
  const runAllTests = async () => {
    setTestResults([])
    setRunningTests(true)
    
    try {
      addTestResult({
        name: 'Test BaÅŸlatÄ±ldÄ±',
        status: 'pending',
        message: 'Sistem testleri baÅŸlatÄ±lÄ±yor...'
      })
      
      await runBasicTests()
      await runEmailTests()
      await runFunctionalTests()
      
      addTestResult({
        name: 'Testler TamamlandÄ±',
        status: 'success',
        message: 'TÃ¼m sistem testleri tamamlandÄ±.'
      })
      
    } catch (error: any) {
      addTestResult({
        name: 'Test HatasÄ±',
        status: 'error',
        message: `Test sÄ±rasÄ±nda hata: ${error.message}`
      })
    } finally {
      setRunningTests(false)
    }
  }

  // TEST SONUÃ‡LARINI ANALÄ°Z ET
  const getTestSummary = () => {
    const total = testResults.length
    const success = testResults.filter(r => r.status === 'success').length
    const error = testResults.filter(r => r.status === 'error').length
    const warning = testResults.filter(r => r.status === 'warning').length
    
    return { total, success, error, warning }
  }

  const summary = getTestSummary()

  // STATUS RENKLERÄ°
  const getStatusColor = (status: TestResult['status']) => {
    switch (status) {
      case 'success': return 'bg-green-100 text-green-800 border-green-200'
      case 'error': return 'bg-red-100 text-red-800 border-red-200'
      case 'warning': return 'bg-yellow-100 text-yellow-800 border-yellow-200'
      case 'pending': return 'bg-blue-100 text-blue-800 border-blue-200'
      default: return 'bg-gray-100 text-gray-800 border-gray-200'
    }
  }

  const getStatusIcon = (status: TestResult['status']) => {
    switch (status) {
      case 'success': return 'âœ…'
      case 'error': return 'âŒ'
      case 'warning': return 'âš ï¸'
      case 'pending': return 'â³'
      default: return 'â„¹ï¸'
    }
  }

  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-50 to-white p-4 md:p-8">
      <div className="max-w-6xl mx-auto">
        {/* BAÅLIK */}
        <div className="mb-8 text-center">
          <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            ğŸ§ª SpotItForMe Sistem Test Merkezi
          </h1>
          <p className="text-gray-600">
            TÃ¼m sistem bileÅŸenlerini test edin, hatalarÄ± tespit edin.
          </p>
        </div>

        {/* DURUM Ã–ZETÄ° */}
        <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
          <div className="bg-white rounded-xl shadow p-6 text-center">
            <div className="text-2xl font-bold text-gray-900">{summary.total}</div>
            <div className="text-gray-600">Toplam Test</div>
          </div>
          <div className="bg-white rounded-xl shadow p-6 text-center">
            <div className="text-2xl font-bold text-green-600">{summary.success}</div>
            <div className="text-gray-600">BaÅŸarÄ±lÄ±</div>
          </div>
          <div className="bg-white rounded-xl shadow p-6 text-center">
            <div className="text-2xl font-bold text-red-600">{summary.error}</div>
            <div className="text-gray-600">HatalÄ±</div>
          </div>
          <div className="bg-white rounded-xl shadow p-6 text-center">
            <div className="text-2xl font-bold text-yellow-600">{summary.warning}</div>
            <div className="text-gray-600">UyarÄ±</div>
          </div>
        </div>

        {/* EMAIL TEST ALANI */}
        <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
          <h2 className="text-xl font-bold text-gray-900 mb-4">ğŸ“§ Email Testi</h2>
          <div className="space-y-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Test Email Adresi
              </label>
              <input
                type="email"
                value={emailTestData.to}
                onChange={(e) => setEmailTestData({...emailTestData, to: e.target.value})}
                placeholder="ornek@gmail.com"
                className="w-full md:w-96 px-4 py-2 border border-gray-300 rounded-lg"
              />
              <p className="text-sm text-gray-500 mt-1">
                Test email'ini bu adrese gÃ¶ndereceÄŸiz.
              </p>
            </div>
            
            <div className="flex flex-wrap gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Template
                </label>
                <select
                  value={emailTestData.template}
                  onChange={(e) => setEmailTestData({...emailTestData, template: e.target.value})}
                  className="px-4 py-2 border border-gray-300 rounded-lg"
                >
                  <option value="welcome">HoÅŸgeldin</option>
                  <option value="spot-created">Spot OluÅŸturuldu</option>
                  <option value="spot-sighting">YardÄ±m Bildirimi</option>
                  <option value="test">Test</option>
                </select>
              </div>
              
              <div className="flex items-end">
                <button
                  onClick={() => {
                    setTestResults([])
                    runEmailTests()
                  }}
                  disabled={runningTests || !emailTestData.to}
                  className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg disabled:opacity-50"
                >
                  Sadece Email Testi Ã‡alÄ±ÅŸtÄ±r
                </button>
              </div>
            </div>
          </div>
        </div>

        {/* TEST KONTROLLERÄ° */}
        <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
          <h2 className="text-xl font-bold text-gray-900 mb-4">ğŸ”„ Test Kontrolleri</h2>
          <div className="flex flex-wrap gap-4">

            
            <button
              onClick={() => setTestResults([])}
              className="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 px-6 rounded-lg"
            >
              SonuÃ§larÄ± Temizle
            </button>
            
            <button
              onClick={() => window.location.reload()}
              className="bg-blue-100 hover:bg-blue-200 text-blue-600 font-medium py-3 px-6 rounded-lg"
            >
              SayfayÄ± Yenile
            </button>
          </div>
          
          {user && (
            <div className="mt-4 p-3 bg-gray-50 rounded-lg">
              <p className="text-sm">
                ğŸ‘¤ Oturum: <span className="font-medium">{user.email}</span>
                <span className="ml-4">ğŸ†” User ID: <code className="text-xs">{user.id.substring(0, 8)}...</code></span>
              </p>
            </div>
          )}
        </div>

        {/* TEST SONUÃ‡LARI */}
        <div className="bg-white rounded-xl shadow-lg p-6">
          <div className="flex justify-between items-center mb-6">
            <h2 className="text-xl font-bold text-gray-900">ğŸ“Š Test SonuÃ§larÄ±</h2>
            <span className="text-sm text-gray-500">
              {testResults.length} test sonucu
            </span>
          </div>
          
          {testResults.length === 0 ? (
            <div className="text-center py-12">
              <div className="text-4xl mb-4">ğŸ§ª</div>
              <h3 className="text-lg font-medium text-gray-900 mb-2">
                HenÃ¼z test Ã§alÄ±ÅŸtÄ±rÄ±lmadÄ±
              </h3>
              <p className="text-gray-600">
                YukarÄ±daki butonlarla testleri baÅŸlatÄ±n.
              </p>
            </div>
          ) : (
            <div className="space-y-4 max-h-[600px] overflow-y-auto pr-2">
              {testResults.map((result, index) => (
                <div
                  key={index}
                  className={`p-4 rounded-lg border ${getStatusColor(result.status)}`}
                >
                  <div className="flex items-start justify-between">
                    <div className="flex items-start space-x-3">
                      <span className="text-xl">{getStatusIcon(result.status)}</span>
                      <div>
                        <h4 className="font-bold">{result.name}</h4>
                        <p className="text-sm mt-1">{result.message}</p>
                        
                        {result.duration && (
                          <p className="text-xs text-gray-600 mt-1">
                            â±ï¸ {result.duration}ms
                          </p>
                        )}
                        
                        {result.details && (
                          <details className="mt-2">
                            <summary className="text-sm cursor-pointer text-gray-700">
                              DetaylarÄ± gÃ¶ster
                            </summary>
                            <pre className="mt-2 p-3 bg-black bg-opacity-5 rounded text-xs overflow-x-auto">
                              {JSON.stringify(result.details, null, 2)}
                            </pre>
                          </details>
                        )}
                      </div>
                    </div>
                    
                    <div className="flex items-center">
                      <span className={`px-2 py-1 rounded text-xs font-medium ${
                        result.status === 'success' ? 'bg-green-200 text-green-800' :
                        result.status === 'error' ? 'bg-red-200 text-red-800' :
                        result.status === 'warning' ? 'bg-yellow-200 text-yellow-800' :
                        'bg-blue-200 text-blue-800'
                      }`}>
                        {result.status.toUpperCase()}
                      </span>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>

        {/* HIZLI Ä°PUÃ‡LARI */}
        <div className="mt-8 grid md:grid-cols-3 gap-6">
          <div className="bg-blue-50 rounded-xl p-6">
            <div className="text-2xl mb-3">ğŸ”§</div>
            <h4 className="font-bold text-gray-900 mb-2">SÄ±k KarÅŸÄ±laÅŸÄ±lan Hatalar</h4>
            <ul className="text-sm text-gray-600 space-y-1">
              <li>â€¢ Gmail App Password eksik</li>
              <li>â€¢ Supabase RLS politikalarÄ±</li>
              <li>â€¢ Environment variables eksik</li>
              <li>â€¢ Storage bucket oluÅŸturulmamÄ±ÅŸ</li>
            </ul>
          </div>
          
          <div className="bg-green-50 rounded-xl p-6">
            <div className="text-2xl mb-3">âœ…</div>
            <h4 className="font-bold text-gray-900 mb-2">Test Edilen Sistemler</h4>
            <ul className="text-sm text-gray-600 space-y-1">
              <li>â€¢ Supabase Database & Auth</li>
              <li>â€¢ Gmail Email API</li>
              <li>â€¢ CRON Job System</li>
              <li>â€¢ Rate Limiting</li>
              <li>â€¢ Health Check Endpoints</li>
            </ul>
          </div>
          
          <div className="bg-purple-50 rounded-xl p-6">
            <div className="text-2xl mb-3">ğŸ“</div>
            <h4 className="font-bold text-gray-900 mb-2">Sonraki AdÄ±mlar</h4>
            <ul className="text-sm text-gray-600 space-y-1">
              <li>1. HatalarÄ± dÃ¼zelt</li>
              <li>2. Email sistemini test et</li>
              <li>3. Spot oluÅŸturmayÄ± test et</li>
              <li>4. TÃ¼m API'leri doÄŸrula</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ app/admin/users/page.tsx
ğŸ“Š 308 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/admin/users/page.tsx - DÃœZELTÄ°LMÄ°Å
'use client';

import { useState, useEffect } from 'react';
import { supabase } from '@/lib/supabase';

interface UserProfile {
  id: string;
  email: string;
  name: string | null;
  created_at: string;
  is_admin: boolean;
  total_spots: number;
  total_helps: number;
}

interface UserWithStats extends UserProfile {
  total_spots: number;
  total_helps: number;
}

interface SupabaseUserProfile {
  id: string;
  email: string;
  name: string | null;
  created_at: string;
  is_admin: boolean;
  avatar_url?: string;
}

export default function AdminUsersPage() {
  const [users, setUsers] = useState<UserWithStats[]>([]);
  const [loading, setLoading] = useState(true);
  const [search, setSearch] = useState('');
  const [page, setPage] = useState(1);
  const [totalCount, setTotalCount] = useState(0);

  useEffect(() => {
    fetchUsers();
  }, [page, search]);

  const fetchUsers = async () => {
    try {
      setLoading(true);
      
      // Arama sorgusu
      let query = supabase
        .from('user_profiles')
        .select('*', { count: 'exact' });

      if (search) {
        query = query.or(`email.ilike.%${search}%,name.ilike.%${search}%`);
      }

      // Pagination
      const { data, count, error } = await query
        .range((page - 1) * 20, page * 20 - 1)
        .order('created_at', { ascending: false });

      if (error) throw error;

      // KullanÄ±cÄ± istatistiklerini getir
      const usersWithStats = await Promise.all(
        (data || []).map(async (user: SupabaseUserProfile) => {
          const [spotsRes, sightingsRes] = await Promise.all([
            supabase.from('spots').select('id', { count: 'exact', head: true }).eq('user_id', user.id),
            supabase.from('sightings').select('id', { count: 'exact', head: true }).eq('spotter_id', user.id)
          ]);

          return {
            ...user,
            total_spots: spotsRes.count || 0,
            total_helps: sightingsRes.count || 0
          } as UserWithStats;
        })
      );

      setUsers(usersWithStats);
      setTotalCount(count || 0);
    } catch (error) {
      console.error('KullanÄ±cÄ±lar yÃ¼klenemedi:', error);
    } finally {
      setLoading(false);
    }
  };

  const toggleAdmin = async (userId: string, currentStatus: boolean) => {
    if (!confirm(`${currentStatus ? 'Admin yetkisini kaldÄ±rmak' : 'Admin yetkisi vermek'} istediÄŸinize emin misiniz?`)) {
      return;
    }

    try {
      const { error } = await supabase
        .from('user_profiles')
        .update({ is_admin: !currentStatus })
        .eq('id', userId);

      if (error) throw error;

      // Listeyi gÃ¼ncelle
      setUsers(users.map(user => 
        user.id === userId 
          ? { ...user, is_admin: !currentStatus }
          : user
      ));

      alert('KullanÄ±cÄ± yetkisi gÃ¼ncellendi!');
    } catch (error) {
      console.error('Yetki gÃ¼ncellenemedi:', error);
      alert('Yetki gÃ¼ncellenirken bir hata oluÅŸtu');
    }
  };

  const deleteUser = async (userId: string, email: string) => {
    if (!confirm(`${email} kullanÄ±cÄ±sÄ±nÄ± silmek istediÄŸinize emin misiniz? Bu iÅŸlem geri alÄ±namaz!`)) {
      return;
    }

    try {
      // Ã–nce iliÅŸkili verileri sil
      await supabase.from('spots').delete().eq('user_id', userId);
      await supabase.from('sightings').delete().eq('spotter_id', userId);
      await supabase.from('user_profiles').delete().eq('id', userId);

      // Auth kullanÄ±cÄ±sÄ±nÄ± sil (admin yetkisi gerektirir)
      const { error } = await supabase.auth.admin.deleteUser(userId);
      
      if (error) throw error;

      // Listeden kaldÄ±r
      setUsers(users.filter(user => user.id !== userId));
      
      alert('KullanÄ±cÄ± baÅŸarÄ±yla silindi!');
    } catch (error) {
      console.error('KullanÄ±cÄ± silinemedi:', error);
      alert('KullanÄ±cÄ± silinirken bir hata oluÅŸtu. Supabase dashboard Ã¼zerinden deneyin.');
    }
  };

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold text-gray-900">KullanÄ±cÄ± YÃ¶netimi</h1>
        <p className="text-gray-600">TÃ¼m kullanÄ±cÄ±larÄ± gÃ¶rÃ¼ntÃ¼leyin ve yÃ¶netin</p>
      </div>

      {/* Arama ve Filtreler */}
      <div className="bg-white rounded-xl shadow p-6">
        <div className="flex flex-col md:flex-row gap-4 mb-6">
          <div className="flex-1">
            <input
              type="text"
              placeholder="Email veya isim ile ara..."
              value={search}
              onChange={(e) => setSearch(e.target.value)}
              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            />
          </div>
          <button
            onClick={fetchUsers}
            className="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium"
          >
            Ara
          </button>
        </div>

        {/* KullanÄ±cÄ± Listesi */}
        {loading ? (
          <div className="text-center py-8">
            <div className="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
            <p className="mt-2 text-gray-600">KullanÄ±cÄ±lar yÃ¼kleniyor...</p>
          </div>
        ) : (
          <>
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead className="bg-gray-50">
                  <tr>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">KullanÄ±cÄ±</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">KayÄ±t Tarihi</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Spot'lar</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">YardÄ±m</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Yetki</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Ä°ÅŸlemler</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-100">
                  {users.map((user: UserWithStats) => (
                    <tr key={user.id} className="hover:bg-gray-50">
                      <td className="py-3 px-4">
                        <div>
                          <p className="font-medium">{user.name || 'Ä°simsiz KullanÄ±cÄ±'}</p>
                          <p className="text-sm text-gray-500">{user.email}</p>
                        </div>
                      </td>
                      <td className="py-3 px-4 text-sm text-gray-600">
                        {new Date(user.created_at).toLocaleDateString('tr-TR')}
                      </td>
                      <td className="py-3 px-4">
                        <span className="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">
                          {user.total_spots}
                        </span>
                      </td>
                      <td className="py-3 px-4">
                        <span className="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">
                          {user.total_helps}
                        </span>
                      </td>
                      <td className="py-3 px-4">
                        <button
                          onClick={() => toggleAdmin(user.id, user.is_admin)}
                          className={`px-3 py-1 rounded-full text-xs font-medium ${
                            user.is_admin
                              ? 'bg-purple-100 text-purple-800 hover:bg-purple-200'
                              : 'bg-gray-100 text-gray-800 hover:bg-gray-200'
                          }`}
                        >
                          {user.is_admin ? 'Admin' : 'KullanÄ±cÄ±'}
                        </button>
                      </td>
                      <td className="py-3 px-4">
                        <div className="flex space-x-2">
                          <button
                            onClick={() => deleteUser(user.id, user.email)}
                            className="px-3 py-1 bg-red-50 hover:bg-red-100 text-red-700 rounded text-xs font-medium border border-red-200"
                          >
                            Sil
                          </button>
                          <button
                            onClick={() => {
                              // KullanÄ±cÄ± detay sayfasÄ±na git
                              window.open(`/profile?user=${user.id}`, '_blank');
                            }}
                            className="px-3 py-1 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded text-xs font-medium border border-blue-200"
                          >
                            GÃ¶rÃ¼ntÃ¼le
                          </button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>

            {/* Pagination */}
            {totalCount > 20 && (
              <div className="mt-6 flex justify-center">
                <div className="flex space-x-2">
                  <button
                    onClick={() => setPage(p => Math.max(1, p - 1))}
                    disabled={page === 1}
                    className="px-3 py-2 border rounded-lg disabled:opacity-50"
                  >
                    â† Ã–nceki
                  </button>
                  <span className="px-4 py-2">
                    Sayfa {page} / {Math.ceil(totalCount / 20)}
                  </span>
                  <button
                    onClick={() => setPage(p => p + 1)}
                    disabled={page >= Math.ceil(totalCount / 20)}
                    className="px-3 py-2 border rounded-lg disabled:opacity-50"
                  >
                    Sonraki â†’
                  </button>
                </div>
              </div>
            )}
          </>
        )}

        {!loading && users.length === 0 && (
          <div className="text-center py-8 text-gray-500">
            {search ? 'Arama kriterlerinize uygun kullanÄ±cÄ± bulunamadÄ±' : 'HenÃ¼z kullanÄ±cÄ± kaydÄ± yok'}
          </div>
        )}
      </div>

      {/* Ä°statistikler */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div className="bg-white rounded-xl shadow p-6">
          <h3 className="font-bold text-gray-900 mb-2">Toplam KullanÄ±cÄ±</h3>
          <p className="text-3xl font-bold text-blue-600">{totalCount}</p>
          <p className="text-sm text-gray-600 mt-1">KayÄ±tlÄ± toplam kullanÄ±cÄ±</p>
        </div>
        <div className="bg-white rounded-xl shadow p-6">
          <h3 className="font-bold text-gray-900 mb-2">Admin SayÄ±sÄ±</h3>
          <p className="text-3xl font-bold text-purple-600">
            {users.filter(u => u.is_admin).length}
          </p>
          <p className="text-sm text-gray-600 mt-1">YÃ¶netici yetkisine sahip</p>
        </div>
        <div className="bg-white rounded-xl shadow p-6">
          <h3 className="font-bold text-gray-900 mb-2">Aktif BugÃ¼n</h3>
          <p className="text-3xl font-bold text-green-600">
            {users.filter(u => {
              const userDate = new Date(u.created_at);
              const today = new Date();
              return userDate.toDateString() === today.toDateString();
            }).length}
          </p>
          <p className="text-sm text-gray-600 mt-1">BugÃ¼n kayÄ±t olanlar</p>
        </div>
      </div>
    </div>
  );
}

ğŸ“„ app/create-spot/page.tsx
ğŸ“Š 412 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/create-spot/page.tsx - DÃœZELTMÄ°Å VERSÄ°YON
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
// Header ve Footer import'larÄ±nÄ± KALDIRIYORUZ - Layout'ta zaten var

export default function CreateSpotPage() {
  const router = useRouter()
  
  const [title, setTitle] = useState('')
  const [description, setDescription] = useState('')
  const [category, setCategory] = useState('')
  const [location, setLocation] = useState('')
  const [imageFile, setImageFile] = useState<File | null>(null)
  const [imagePreview, setImagePreview] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')

  const categories = [
    'Elektronik',
    'Giyim & Aksesuar',
    'Ev & BahÃ§e',
    'Koleksiyon',
    'Kitap & MÃ¼zik',
    'Oyuncak & Oyun',
    'Spor & Outdoor',
    'AraÃ§ & ParÃ§a',
    'DiÄŸer'
  ]

  const locations = [
    'Ä°stanbul',
    'Ankara',
    'Ä°zmir',
    'Bursa',
    'Antalya',
    'Adana',
    'Konya',
    'TÃ¼rkiye Geneli',
    'Yurt DÄ±ÅŸÄ±'
  ]

  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (file) {
      if (file.size > 5 * 1024 * 1024) { // 5MB limit
        setError('Resim boyutu 5MB\'dan kÃ¼Ã§Ã¼k olmalÄ±dÄ±r')
        return
      }
      setImageFile(file)
      const reader = new FileReader()
      reader.onloadend = () => {
        setImagePreview(reader.result as string)
      }
      reader.readAsDataURL(file)
    }
  }

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')

    try {
      // 1. KullanÄ±cÄ± kontrolÃ¼
      const { data: { user }, error: userError } = await supabase.auth.getUser()
      if (userError || !user) {
        throw new Error('LÃ¼tfen Ã¶nce giriÅŸ yapÄ±n')
      }

      console.log('ğŸ‘¤ KullanÄ±cÄ±:', user.id)

      let imageUrl = ''

      // 2. Resim yÃ¼kleme
      if (imageFile) {
        console.log('ğŸ“¸ Resim yÃ¼kleniyor:', imageFile.name)
        
        try {
          const timestamp = Date.now()
          const fileExt = imageFile.name.split('.').pop()
          const fileName = `${user.id}/${timestamp}.${fileExt}`
          
          console.log('ğŸ“ Dosya adÄ±:', fileName)
          
          // Bucket kontrolÃ¼
          const { data: buckets } = await supabase.storage.listBuckets()
          console.log('ğŸ“¦ Bucket\'lar:', buckets)
          
          // Resim yÃ¼kle
          const { data: uploadData, error: uploadError } = await supabase.storage
            .from('spot-images')
            .upload(fileName, imageFile, {
              cacheControl: '3600',
              upsert: false,
              contentType: imageFile.type
            })

          if (uploadError) {
            console.error('âŒ YÃ¼kleme hatasÄ±:', uploadError)
            throw new Error(`Resim yÃ¼klenemedi: ${uploadError.message}`)
          }

          console.log('âœ… Resim yÃ¼klendi!')

          // Public URL al
          const { data: { publicUrl } } = supabase.storage
            .from('spot-images')
            .getPublicUrl(fileName)
          
          console.log('ğŸ”— Public URL:', publicUrl)
          imageUrl = publicUrl
          
          if (!publicUrl) {
            throw new Error('Resim URLsi alÄ±namadÄ±')
          }
          
        } catch (uploadErr: any) {
          console.error('âŒ Resim yÃ¼kleme hatasÄ±:', uploadErr)
          setError(`âŒ Resim yÃ¼klenemedi: ${uploadErr.message}`)
          setLoading(false)
          return
        }
      } else {
        console.log('â„¹ï¸ Resim seÃ§ilmedi')
      }

      // 3. Spot'u database'e kaydet - SADECE VAR OLAN KOLONLARI KULLAN
      console.log('ğŸ’¾ Database\'e kaydediliyor...')
      
      const spotData = {
        user_id: user.id,
        title: title.trim(),
        description: description.trim(),
        category: category || null,
        location: location || null,
        image_url: imageUrl || null,
        status: 'active',
        views: 0,
        helps: 0,
        created_at: new Date().toISOString()
      }

      console.log('ğŸ“ Spot verisi:', spotData)

      const { data: spotDataResult, error: spotError } = await supabase
        .from('spots')
        .insert([spotData])
        .select()

      console.log('ğŸ“Š Database yanÄ±tÄ±:', { spotDataResult, spotError })

      if (spotError) {
        console.error('âŒ Database hatasÄ±:', spotError)
        throw new Error(`Spot kaydedilemedi: ${spotError.message}`)
      }

      // 4. BAÅARILI
      console.log('ğŸ‰ Spot baÅŸarÄ±yla oluÅŸturuldu!')
      
      if (imageUrl) {
        alert('âœ… Spot baÅŸarÄ±yla oluÅŸturuldu! Resim de yÃ¼klendi.')
      } else {
        alert('âœ… Spot baÅŸarÄ±yla oluÅŸturuldu!')
      }
      
      // Yeni oluÅŸturulan spot'a yÃ¶nlendir
      if (spotDataResult && spotDataResult[0]) {
        router.push(`/spots/${spotDataResult[0].id}`)
      } else {
        router.push('/spots')
      }

    } catch (err: any) {
      console.error('âŒ Spot oluÅŸturma hatasÄ±:', err)
      setError(err.message || 'Spot oluÅŸturulurken bir hata oluÅŸtu')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="min-h-screen bg-gray-50">
      {/* HEADER'Ä± KALDIRIYORUZ - Layout'ta zaten var */}
      
      <main className="container-custom py-8 md:py-12">
        <div className="max-w-2xl mx-auto">
          {/* BaÅŸlÄ±k */}
          <div className="text-center mb-8 md:mb-10">
            <h1 className="text-2xl md:text-3xl lg:text-4xl font-bold text-gray-900 mb-3 md:mb-4">
              Yeni Spot OluÅŸtur
            </h1>
            <p className="text-gray-600 text-sm md:text-base">
              AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼ topluluÄŸumuzla paylaÅŸÄ±n, binlerce gÃ¶z sizin iÃ§in arasÄ±n
            </p>
          </div>

          {/* Form */}
          <form onSubmit={handleSubmit} className="bg-white rounded-xl md:rounded-2xl shadow-lg p-4 md:p-6 lg:p-8">
            {/* Resim YÃ¼kleme */}
            <div className="mb-6 md:mb-8">
              <label className="block text-sm font-medium text-gray-700 mb-3">
                ÃœrÃ¼n FotoÄŸrafÄ± (Opsiyonel)
                <span className="text-gray-500 ml-1 text-xs md:text-sm">- Daha hÄ±zlÄ± bulunmasÄ±nÄ± saÄŸlar</span>
              </label>
              
              {imagePreview ? (
                <div className="mb-4">
                  <div className="relative">
                    <img
                      src={imagePreview}
                      alt="Preview"
                      className="w-full max-w-md h-48 md:h-64 object-cover rounded-lg mx-auto border-2 border-green-200"
                    />
                    <div className="absolute top-2 right-2 bg-green-100 text-green-800 text-xs px-2 py-1 rounded">
                      âœ“ HazÄ±r
                    </div>
                  </div>
                  <button
                    type="button"
                    onClick={() => {
                      setImageFile(null)
                      setImagePreview('')
                    }}
                    className="mt-2 text-red-600 hover:text-red-800 text-sm flex items-center"
                  >
                    <span className="mr-1">ğŸ—‘ï¸</span> Resmi KaldÄ±r
                  </button>
                </div>
              ) : (
                <label className="cursor-pointer">
                  <div className="border-2 border-dashed border-gray-300 rounded-xl md:rounded-2xl p-4 md:p-8 text-center hover:border-blue-400 transition duration-200 bg-gray-50 hover:bg-blue-50">
                    <div className="text-3xl md:text-4xl mb-3 md:mb-4 text-gray-400">ğŸ“·</div>
                    <p className="text-gray-600 mb-2 font-medium text-sm md:text-base">
                      Resim yÃ¼klemek iÃ§in tÄ±klayÄ±n veya sÃ¼rÃ¼kleyin
                    </p>
                    <p className="text-xs md:text-sm text-gray-500 mb-3 md:mb-4">
                      PNG, JPG, GIF â€¢ Maksimum 5MB
                    </p>
                    <div className="btn-primary inline-block !py-2 !px-3 md:!py-2 md:!px-4 text-sm md:text-base">
                      Resim SeÃ§
                    </div>
                    <input
                      type="file"
                      accept="image/*"
                      onChange={handleImageChange}
                      className="hidden"
                    />
                  </div>
                </label>
              )}
              
              {/* Resim Bilgisi */}
              {imageFile && (
                <div className="mt-3 p-3 bg-blue-50 rounded-lg">
                  <div className="flex items-center justify-between text-xs md:text-sm">
                    <div className="flex items-center">
                      <span className="text-blue-600 mr-2">ğŸ“¦</span>
                      <span className="font-medium truncate max-w-xs">{imageFile.name}</span>
                    </div>
                    <div className="text-gray-600">
                      {(imageFile.size / 1024 / 1024).toFixed(2)} MB
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* BaÅŸlÄ±k */}
            <div className="mb-6">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Ne arÄ±yorsunuz? *
              </label>
              <input
                type="text"
                value={title}
                onChange={(e) => setTitle(e.target.value)}
                className="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm md:text-base"
                placeholder="Ã–rnek: Vintage Nikon F2 kamera lensi"
                required
                maxLength={100}
              />
              <p className="text-xs md:text-sm text-gray-500 mt-1">
                {title.length}/100 karakter
              </p>
            </div>

            {/* AÃ§Ä±klama */}
            <div className="mb-6">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                DetaylÄ± AÃ§Ä±klama *
              </label>
              <textarea
                value={description}
                onChange={(e) => setDescription(e.target.value)}
                className="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm md:text-base"
                placeholder="Marka, model, renk, boyut, Ã¶zel notlar... Ne kadar detaylÄ± olursa o kadar iyi!"
                rows={4}
                required
                maxLength={1000}
              />
              <p className="text-xs md:text-sm text-gray-500 mt-1">
                {description.length}/1000 karakter
              </p>
            </div>

            {/* Kategori ve Konum */}
            <div className="grid md:grid-cols-2 gap-4 md:gap-6 mb-6 md:mb-8">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Kategori
                </label>
                <select
                  value={category}
                  onChange={(e) => setCategory(e.target.value)}
                  className="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm md:text-base"
                >
                  <option value="">Kategori SeÃ§in</option>
                  {categories.map((cat) => (
                    <option key={cat} value={cat}>{cat}</option>
                  ))}
                </select>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Konum
                </label>
                <select
                  value={location}
                  onChange={(e) => setLocation(e.target.value)}
                  className="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm md:text-base"
                >
                  <option value="">Konum SeÃ§in</option>
                  {locations.map((loc) => (
                    <option key={loc} value={loc}>{loc}</option>
                  ))}
                </select>
              </div>
            </div>

            {/* Hata MesajÄ± */}
            {error && (
              <div className="mb-6 bg-red-50 border border-red-200 text-red-700 p-3 md:p-4 rounded-lg">
                <div className="flex items-center">
                  <span className="mr-2">âŒ</span>
                  <span className="text-sm md:text-base">{error}</span>
                </div>
              </div>
            )}

            {/* Butonlar */}
            <div className="flex flex-col sm:flex-row gap-3 md:gap-4 pt-4 md:pt-6 border-t">
              <button
                type="submit"
                disabled={loading}
                className="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 md:py-3 rounded-lg disabled:opacity-50 flex items-center justify-center text-sm md:text-base"
              >
                {loading ? (
                  <>
                    <span className="animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"></span>
                    OluÅŸturuluyor...
                  </>
                ) : (
                  'Spot\'u OluÅŸtur ve PaylaÅŸ'
                )}
              </button>
              
              <button
                type="button"
                onClick={() => router.push('/')}
                className="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 md:py-3 rounded-lg text-sm md:text-base"
              >
                Ä°ptal
              </button>
            </div>

            {/* Bilgi Notu */}
            <div className="mt-6 md:mt-8 p-3 md:p-4 bg-blue-50 rounded-lg">
              <div className="flex items-start">
                <span className="text-blue-600 mr-2 md:mr-3 text-lg">ğŸ’¡</span>
                <div>
                  <p className="font-medium text-blue-800 mb-1 text-sm md:text-base">Spot OluÅŸturma Ä°puÃ§larÄ±</p>
                  <ul className="text-xs md:text-sm text-blue-700 space-y-1">
                    <li>â€¢ Net fotoÄŸraf eklemek bulunma ÅŸansÄ±nÄ± %70 artÄ±rÄ±r</li>
                    <li>â€¢ Marka ve model bilgisi Ã§ok Ã¶nemli</li>
                    <li>â€¢ BÃ¼tÃ§e aralÄ±ÄŸÄ± belirtirseniz daha hÄ±zlÄ± yardÄ±m alÄ±rsÄ±nÄ±z</li>
                    <li>â€¢ Spot'unuz 30 gÃ¼n aktif kalacak</li>
                  </ul>
                </div>
              </div>
            </div>
          </form>

          {/* Debug Info - Sadece development'da */}
          {process.env.NODE_ENV === 'development' && (
            <div className="mt-6 p-4 bg-gray-100 rounded-lg text-sm">
              <p className="font-medium mb-2">ğŸ› ï¸ Development Bilgileri:</p>
              <p>â€¢ Tablo: <code>spots</code></p>
              <p>â€¢ Kolonlar: id, user_id, title, description, category, location, image_url, status, views, helps</p>
              <p>â€¢ RLS: Aktif</p>
            </div>
          )}
        </div>
      </main>

      {/* FOOTER'Ä± KALDIRIYORUZ - Layout'ta zaten var */}
    </div>
  )
}

ğŸ“„ app/discovery/page.tsx
ğŸ“Š 156 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/discovery/page.tsx - DÃœZELTMÄ°Å (Header/Footer kaldÄ±rÄ±ldÄ±)
'use client'

import { useState } from 'react'
import Feed from '@/components/social/Feed'
import CreatePostModal from '@/components/social/CreatePostModal'

// Basit placeholder component'ler
function TrendingHashtags() {
  return (
    <div className="bg-white rounded-xl shadow p-6">
      <h3 className="font-bold text-gray-900 mb-4">ğŸ”¥ PopÃ¼ler Hashtag'ler</h3>
      <div className="space-y-2">
        {['#vintage', '#kamera', '#antika', '#koleksiyon'].map((tag) => (
          <div key={tag} className="flex justify-between items-center p-2 hover:bg-gray-50 rounded">
            <span className="text-blue-600">{tag}</span>
            <span className="text-sm text-gray-500">42 paylaÅŸÄ±m</span>
          </div>
        ))}
      </div>
    </div>
  )
}

function SuggestedUsers() {
  return (
    <div className="bg-white rounded-xl shadow p-6">
      <h3 className="font-bold text-gray-900 mb-4">ğŸ‘¥ Ã–nerilen KullanÄ±cÄ±lar</h3>
      <div className="space-y-3">
        {['Ahmet Y.', 'Zeynep K.', 'Mehmet T.'].map((user) => (
          <div key={user} className="flex items-center justify-between">
            <div className="flex items-center space-x-3">
              <div className="w-10 h-10 rounded-full bg-blue-100"></div>
              <span>{user}</span>
            </div>
            <button className="text-blue-600 text-sm">Takip Et</button>
          </div>
        ))}
      </div>
    </div>
  )
}

export default function DiscoveryPage() {
  const [showCreateModal, setShowCreateModal] = useState(false)

  return (
    <div className="min-h-screen bg-gray-50">
      {/* HEADER KALDIRILDI - Layout'ta zaten var */}
      
      <CreatePostModal
        isOpen={showCreateModal}
        onClose={() => setShowCreateModal(false)}
        onPostCreated={() => console.log('post created')}
      />

      <div className="container-custom py-8">
        <div className="grid lg:grid-cols-3 gap-8">
          {/* Ana Feed */}
          <div className="lg:col-span-2">
            <div className="mb-6">
              <h1 className="text-3xl font-bold text-gray-900 mb-2">
                ğŸ¯ KeÅŸfet
              </h1>
              <p className="text-gray-600">
                TopluluÄŸumuzun keÅŸiflerini, koleksiyonlarÄ±nÄ± ve nadir buluÅŸlarÄ±nÄ± takip edin
              </p>
            </div>

            {/* CTA Butonu */}
            <div className="bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl p-6 text-white mb-8">
              <div className="flex items-center justify-between">
                <div>
                  <h3 className="text-xl font-bold mb-2">Nadir bir ÅŸey mi gÃ¶rdÃ¼n?</h3>
                  <p>PaylaÅŸ, topluluÄŸa ilham ver, puan kazan!</p>
                </div>
                <button
                  onClick={() => setShowCreateModal(true)}
                  className="bg-white text-blue-600 hover:bg-gray-100 font-bold py-3 px-6 rounded-lg"
                >
                  ğŸ“¸ PaylaÅŸÄ±m Yap
                </button>
              </div>
            </div>

            {/* Feed */}
            <Feed type="for-you" />
          </div>

          {/* SaÄŸ Sidebar */}
          <div className="space-y-6">
            {/* Profil kartÄ± */}
            <div className="bg-white rounded-xl shadow p-6">
              <div className="flex items-center space-x-3">
                <div className="w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full"></div>
                <div>
                  <h3 className="font-bold text-gray-900">Profilin</h3>
                  <p className="text-sm text-gray-600">KeÅŸfet, paylaÅŸ, puan kazan</p>
                </div>
              </div>
              
              <div className="mt-4 grid grid-cols-3 gap-2 text-center">
                <div>
                  <div className="font-bold text-lg">0</div>
                  <div className="text-xs text-gray-600">PaylaÅŸÄ±m</div>
                </div>
                <div>
                  <div className="font-bold text-lg">0</div>
                  <div className="text-xs text-gray-600">TakipÃ§i</div>
                </div>
                <div>
                  <div className="font-bold text-lg">0</div>
                  <div className="text-xs text-gray-600">Takip</div>
                </div>
              </div>

              <button
                onClick={() => setShowCreateModal(true)}
                className="w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 rounded-lg"
              >
                PaylaÅŸÄ±m Yap
              </button>
            </div>

            {/* Trending Hashtags */}
            <TrendingHashtags />

            {/* Ã–nerilen KullanÄ±cÄ±lar */}
            <SuggestedUsers />

            {/* HÄ±zlÄ± Ä°puÃ§larÄ± */}
            <div className="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100">
              <h4 className="font-bold text-gray-900 mb-3">ğŸ’¡ KeÅŸif Ä°puÃ§larÄ±</h4>
              <ul className="space-y-2 text-sm">
                <li className="flex items-start">
                  <span className="mr-2">âœ…</span>
                  <span>Hashtag kullan daha Ã§ok kiÅŸiye ulaÅŸ</span>
                </li>
                <li className="flex items-start">
                  <span className="mr-2">âœ…</span>
                  <span>FotoÄŸraflÄ± paylaÅŸÄ±mlar 2x daha fazla etkileÅŸim alÄ±r</span>
                </li>
                <li className="flex items-start">
                  <span className="mr-2">âœ…</span>
                  <span>GÃ¼nlÃ¼k paylaÅŸÄ±m yaparak puan kazan</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      {/* FOOTER KALDIRILDI - Layout'ta zaten var */}
    </div>
  )
}

ğŸ“„ app/for-business/page.tsx
ğŸ“Š 845 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/for-business/page.tsx - DÃœZELTMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { useRouter, useSearchParams } from 'next/navigation'
import AuthModal from '@/components/AuthModal'
import { supabase } from '@/lib/supabase'
import { sendBusinessRegistrationEmail } from '@/lib/email-server'

interface ShopFormData {
  shopName: string
  ownerName: string
  email: string
  phone: string
  address: string
  city: string
  website: string
  description: string
  businessType: string
  monthlySpots: string
  acceptTerms: boolean
  acceptPrivacy: boolean
  acceptMarketing: boolean
}

export default function ForBusinessPage() {
  const router = useRouter()
  const searchParams = useSearchParams()
  const editMode = searchParams.get('edit') === 'true'
  
  const [formData, setFormData] = useState<ShopFormData>({
    shopName: '',
    ownerName: '',
    email: '',
    phone: '',
    address: '',
    city: '',
    website: '',
    description: '',
    businessType: 'retail',
    monthlySpots: '20-50',
    acceptTerms: false,
    acceptPrivacy: false,
    acceptMarketing: false
  })

  const [loading, setLoading] = useState(false)
  const [submitted, setSubmitted] = useState(false)
  const [showAuthModal, setShowAuthModal] = useState(false)
  const [existingShop, setExistingShop] = useState<any>(null)
  const [user, setUser] = useState<any>(null)
  const [authSuccessCallback, setAuthSuccessCallback] = useState<() => void>(() => {})

  useEffect(() => {
    checkUser()
  }, [])

  const checkUser = async () => {
    const { data: { user } } = await supabase.auth.getUser()
    if (user) {
      setUser(user)
      // KullanÄ±cÄ±nÄ±n maÄŸazasÄ± var mÄ± kontrol et
      checkExistingShop(user.id)
      // Forma email ve isim bilgilerini otomatik doldur
      if (!editMode) {
        setFormData(prev => ({
          ...prev,
          email: user.email || '',
          ownerName: user.user_metadata?.name || ''
        }))
      }
    }
  }

  const checkExistingShop = async (userId: string) => {
    const { data: shop } = await supabase
      .from('shops')
      .select('*')
      .eq('owner_id', userId)
      .single()

    if (shop) {
      setExistingShop(shop)
      if (!editMode) {
        router.push(`/shop/dashboard`)
      } else {
        // Edit modunda formu doldur
        setFormData({
          shopName: shop.shop_name || '',
          ownerName: shop.owner_name || '',
          email: shop.email || '',
          phone: shop.phone || '',
          address: shop.address || '',
          city: shop.city || '',
          website: shop.website || '',
          description: shop.description || '',
          businessType: shop.business_type || 'retail',
          monthlySpots: shop.monthly_capacity || '20-50',
          acceptTerms: true,
          acceptPrivacy: true,
          acceptMarketing: false
        })
      }
    }
  }

  const businessTypes = [
    { id: 'retail', name: 'Perakende MaÄŸaza', icon: 'ğŸª', description: 'Fiziksel veya online maÄŸaza' },
    { id: 'antique', name: 'AntikacÄ±', icon: 'ğŸº', description: 'Antika ve koleksiyon Ã¼rÃ¼nleri' },
    { id: 'collector', name: 'Koleksiyoner', icon: 'ğŸ¨', description: 'Nadir ve koleksiyonluk Ã¼rÃ¼nler' },
    { id: 'repair', name: 'Tamir Servisi', icon: 'ğŸ”§', description: 'OnarÄ±m ve yedek parÃ§a' },
    { id: 'secondhand', name: '2. El MaÄŸaza', icon: 'ğŸ”„', description: 'Ä°kinci el Ã¼rÃ¼n satÄ±ÅŸÄ±' },
    { id: 'specialty', name: 'Uzman MaÄŸaza', icon: 'ğŸ¯', description: 'Ã–zel Ã¼rÃ¼nler (hobi, sanat, vs.)' },
    { id: 'other', name: 'DiÄŸer', icon: 'ğŸ¢', description: 'DiÄŸer iÅŸletme tÃ¼rleri' },
  ]

  const spotRanges = [
    { id: '1-10', name: '1-10 spot/ay', description: 'Yeni baÅŸlayanlar iÃ§in' },
    { id: '10-20', name: '10-20 spot/ay', description: 'Orta Ã¶lÃ§ekli iÅŸletme' },
    { id: '20-50', name: '20-50 spot/ay', description: 'Aktif maÄŸaza' },
    { id: '50-100', name: '50-100 spot/ay', description: 'BÃ¼yÃ¼k Ã¶lÃ§ekli iÅŸletme' },
    { id: '100+', name: '100+ spot/ay', description: 'Ã‡ok aktif maÄŸaza' },
  ]

  const cities = [
    'Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya', 'Adana', 
    'Konya', 'Gaziantep', 'ÅanlÄ±urfa', 'Mersin', 'Kayseri', 'EskiÅŸehir',
    'Trabzon', 'Samsun', 'BalÄ±kesir', 'AydÄ±n', 'MuÄŸla', 'Denizli',
    'TekirdaÄŸ', 'Kocaeli', 'Manisa', 'Hatay', 'Sakarya', 'DiyarbakÄ±r',
    'Van', 'Malatya', 'ElazÄ±ÄŸ', 'Erzurum', 'KahramanmaraÅŸ', 'Sivas'
  ]

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)

    try {
      // KullanÄ±cÄ± kontrolÃ¼
      if (!user) {
        // Auth modal'Ä±nÄ± aÃ§ ve form submit callback'ini kaydet
        setAuthSuccessCallback(() => () => handleFormSubmit())
        setShowAuthModal(true)
        setLoading(false)
        return
      }

      // Form submit iÅŸlemini yap
      await handleFormSubmit()
      
    } catch (error: any) {
      console.error('MaÄŸaza kaydÄ± hatasÄ±:', error)
      
      let errorMessage = 'KayÄ±t sÄ±rasÄ±nda bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.'
      
      if (error.message?.includes('unique constraint')) {
        errorMessage = 'Bu email adresiyle zaten bir maÄŸaza kaydÄ± bulunmaktadÄ±r.'
      } else if (error.message?.includes('foreign key constraint')) {
        errorMessage = 'KullanÄ±cÄ± bulunamadÄ±. LÃ¼tfen tekrar giriÅŸ yapÄ±n.'
      }
      
      alert(errorMessage)
    } finally {
      setLoading(false)
    }
  }

  const handleFormSubmit = async () => {
    if (!formData.acceptTerms || !formData.acceptPrivacy) {
      alert('LÃ¼tfen KullanÄ±m KoÅŸullarÄ± ve Gizlilik PolitikasÄ±nÄ± kabul edin.')
      return
    }

    let result

    if (editMode && existingShop) {
      // GÃ¼ncelleme modu
      result = await supabase
        .from('shops')
        .update({
          shop_name: formData.shopName,
          description: formData.description,
          address: formData.address,
          city: formData.city,
          phone: formData.phone,
          website: formData.website || null,
          email: formData.email,
          business_type: formData.businessType,
          monthly_capacity: formData.monthlySpots,
          updated_at: new Date().toISOString(),
          owner_name: formData.ownerName  // EKLENDÄ°
        })
        .eq('id', existingShop.id)
        .select()
        .single()
    } else {
      // Yeni kayÄ±t
      result = await supabase
        .from('shops')
        .insert({
          owner_id: user.id,
          shop_name: formData.shopName,
          description: formData.description,
          address: formData.address,
          city: formData.city,
          phone: formData.phone,
          website: formData.website || null,
          email: formData.email,
          business_type: formData.businessType,
          monthly_capacity: formData.monthlySpots,
          subscription_type: 'free',
          is_verified: false,
          verification_status: 'pending',
          owner_name: formData.ownerName
        })
        .select()
        .single()
    }

    if (result.error) {
      // MaÄŸaza zaten var mÄ± kontrol et
      if (result.error.code === '23505') {
        const { data: existing } = await supabase
          .from('shops')
          .select('*')
          .eq('owner_id', user.id)
          .single()
        
        if (existing) {
          alert('Zaten bir maÄŸazanÄ±z var. MaÄŸaza panelinize yÃ¶nlendiriliyorsunuz.')
          router.push(`/shop/dashboard`)
          return
        }
      }
      
      // Daha detaylÄ± hata mesajÄ±
      console.error('Supabase error:', result.error)
      throw new Error(`Supabase error: ${result.error.message} (code: ${result.error.code})`)
    }

    // Email gÃ¶nder (yeni kayÄ±t iÃ§in)
    if (!editMode) {
      try {
        await sendBusinessRegistrationEmail(
          formData.email, 
          formData.shopName, 
          user.id
        )
      } catch (emailError) {
        console.warn('Email gÃ¶nderilemedi:', emailError)
        // Email hatasÄ± form submit iÅŸlemini durdurmaz
      }
    }

    // BaÅŸarÄ±lÄ±
    setSubmitted(true)
  }

  const handleAuthSuccess = () => {
    setShowAuthModal(false)
    checkUser() // KullanÄ±cÄ± bilgilerini yenile
    
    // Auth baÅŸarÄ±lÄ± olduktan sonra kaydedilen callback'i Ã§alÄ±ÅŸtÄ±r
    if (authSuccessCallback) {
      setTimeout(() => {
        authSuccessCallback()
      }, 500) // KÄ±sa bir bekleme sÃ¼resi
    }
  }

  const handleSkipForNow = () => {
    router.push('/spots')
  }

  if (submitted) {
    return (
      <div className="min-h-screen bg-gray-50">
        <main className="container-custom py-12">
          <div className="max-w-2xl mx-auto bg-white rounded-2xl shadow-lg p-8 md:p-12 text-center">
            <div className="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-3xl mx-auto mb-6">
              âœ…
            </div>
            
            <h1 className="text-3xl font-bold text-gray-900 mb-4">
              {editMode ? 'MaÄŸaza Bilgileriniz GÃ¼ncellendi!' : 'MaÄŸaza KaydÄ±nÄ±z AlÄ±ndÄ±!'}
            </h1>
            
            <p className="text-gray-600 mb-8">
              <strong>{formData.shopName}</strong> maÄŸazanÄ±z iÃ§in {editMode ? 'bilgileriniz gÃ¼ncellendi' : 'kaydÄ±nÄ±z baÅŸarÄ±yla alÄ±ndÄ±'}! ğŸ‰
              <br />
              {!editMode && `Onay email'i ${formData.email} adresinize gÃ¶nderildi.`}
            </p>
            
            <div className="space-y-4">
              <button
                onClick={() => router.push('/shop/dashboard')}
                className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-xl text-lg"
              >
                MaÄŸaza Paneline Git
              </button>
              
              <button
                onClick={() => router.push('/create-spot')}
                className="w-full bg-white hover:bg-gray-50 text-blue-600 border-2 border-blue-600 font-bold py-4 px-8 rounded-xl text-lg"
              >
                Ä°lk Spot'unu OluÅŸtur
              </button>
              
              <button
                onClick={() => {
                  setSubmitted(false)
                  if (editMode) {
                    router.push('/for-business')
                  }
                }}
                className="w-full text-gray-600 hover:text-gray-800"
              >
                {editMode ? 'BaÅŸka Bir MaÄŸaza DÃ¼zenle' : 'Yeni MaÄŸaza KaydÄ± OluÅŸtur'}
              </button>
            </div>
          </div>
        </main>
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <main className="container-custom py-8 md:py-12">
        {/* Hero Section */}
        <div className="text-center mb-12 md:mb-16">
          <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
            Ä°ÅŸletmeniz Ä°Ã§in <span className="text-blue-600">SpotItForMe</span>
          </h1>
          
          <p className="text-xl text-gray-600 max-w-3xl mx-auto mb-8">
            MÃ¼ÅŸterilerinizin aradÄ±ÄŸÄ± Ã¼rÃ¼nleri sizde olduÄŸunu anÄ±nda bildirin, 
            satÄ±ÅŸlarÄ±nÄ±zÄ± artÄ±rÄ±n ve sadÄ±k mÃ¼ÅŸteriler kazanÄ±n.
          </p>
          
          <div className="inline-flex items-center bg-blue-50 text-blue-700 px-4 py-2 rounded-full text-sm font-medium mb-6">
            ğŸ¯ Tamamen Ãœcretsiz - SÄ±nÄ±rsÄ±z Spot OluÅŸturma
          </div>
          
          <div className="grid md:grid-cols-3 gap-6 max-w-4xl mx-auto">
            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
              <div className="text-3xl mb-4">ğŸ‘ï¸</div>
              <h3 className="font-bold text-gray-900 mb-2">Binlerce Potansiyel MÃ¼ÅŸteri</h3>
              <p className="text-gray-600 text-sm">Arayan mÃ¼ÅŸteriler doÄŸrudan size ulaÅŸsÄ±n</p>
            </div>
            
            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
              <div className="text-3xl mb-4">âš¡</div>
              <h3 className="font-bold text-gray-900 mb-2">AnÄ±nda Bildirim</h3>
              <p className="text-gray-600 text-sm">MÃ¼ÅŸteri aradÄ±ÄŸÄ±nda hemen haberdar olun</p>
            </div>
            
            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
              <div className="text-3xl mb-4">ğŸ“ˆ</div>
              <h3 className="font-bold text-gray-900 mb-2">SatÄ±ÅŸlarÄ± ArtÄ±rÄ±n</h3>
              <p className="text-gray-600 text-sm">Hedefli mÃ¼ÅŸterilerle satÄ±ÅŸ yapÄ±n</p>
            </div>
          </div>
        </div>

        {/* Form Section */}
        <div className="max-w-4xl mx-auto">
          <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
            {/* Form Header */}
            <div className="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-8">
              <h2 className="text-3xl font-bold mb-2">
                {editMode ? 'MaÄŸaza Bilgilerini GÃ¼ncelle' : 'Ãœcretsiz MaÄŸaza KaydÄ±'}
              </h2>
              <p className="opacity-90">
                {editMode 
                  ? 'MaÄŸaza bilgilerinizi gÃ¼ncelleyin' 
                  : 'Formu doldurun, 2 dakikada maÄŸazanÄ±zÄ± aÃ§Ä±n'}
              </p>
            </div>

            {/* User Status */}
            {!user && (
              <div className="mx-8 my-6 p-6 bg-yellow-50 border border-yellow-200 rounded-xl">
                <div className="flex items-center">
                  <div className="text-2xl mr-4">ğŸ”’</div>
                  <div>
                    <h3 className="font-bold text-gray-900 mb-1">GiriÅŸ YapmanÄ±z Gerekiyor</h3>
                    <p className="text-gray-600 text-sm">
                      MaÄŸaza kaydÄ± iÃ§in Ã¶nce giriÅŸ yapmalÄ±sÄ±nÄ±z. HesabÄ±nÄ±z yoksa 30 saniyede oluÅŸturabilirsiniz.
                    </p>
                  </div>
                </div>
                
                <div className="flex flex-col sm:flex-row gap-3 mt-4">
                  <button
                    onClick={() => {
                      setAuthSuccessCallback(() => () => {}) // BoÅŸ callback
                      setShowAuthModal(true)
                    }}
                    className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg"
                  >
                    GiriÅŸ Yap / KayÄ±t Ol
                  </button>
                  
                  <button
                    onClick={handleSkipForNow}
                    className="bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-3 px-6 rounded-lg"
                  >
                    Åimdilik Atla
                  </button>
                </div>
              </div>
            )}

            {user && (
              <div className="mx-8 my-6 p-6 bg-green-50 border border-green-200 rounded-xl">
                <div className="flex items-center">
                  <div className="text-2xl mr-4">âœ…</div>
                  <div>
                    <h3 className="font-bold text-gray-900 mb-1">GiriÅŸ YapÄ±ldÄ±</h3>
                    <p className="text-gray-600 text-sm">
                      {user.email} olarak giriÅŸ yaptÄ±nÄ±z. MaÄŸaza kaydÄ±na devam edebilirsiniz.
                    </p>
                  </div>
                </div>
              </div>
            )}

            {/* Form */}
            <form onSubmit={handleSubmit} className="p-8">
              <div className="space-y-8">
                {/* Ä°ÅŸletme Bilgileri */}
                <div>
                  <h3 className="text-xl font-bold text-gray-900 mb-6 pb-3 border-b">
                    <span className="text-blue-600">ğŸª</span> Ä°ÅŸletme Bilgileri
                  </h3>
                  
                  <div className="grid md:grid-cols-2 gap-6">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Ä°ÅŸletme AdÄ± *
                      </label>
                      <input
                        type="text"
                        required
                        value={formData.shopName}
                        onChange={(e) => setFormData({...formData, shopName: e.target.value})}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        placeholder="Ã–rn: Retro EÅŸya MaÄŸazasÄ±, Tekno ParÃ§a"
                        disabled={!user && !editMode}
                      />
                      <p className="text-gray-500 text-xs mt-2">MÃ¼ÅŸterilerin gÃ¶receÄŸi isim</p>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Yetkili KiÅŸi AdÄ± *
                      </label>
                      <input
                        type="text"
                        required
                        value={formData.ownerName}
                        onChange={(e) => setFormData({...formData, ownerName: e.target.value})}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        placeholder="Ad Soyad"
                        disabled={!user && !editMode}
                      />
                      <p className="text-gray-500 text-xs mt-2">Ä°letiÅŸim iÃ§in gerekli</p>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Email Adresi *
                      </label>
                      <input
                        type="email"
                        required
                        value={formData.email}
                        onChange={(e) => setFormData({...formData, email: e.target.value})}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        placeholder="iletisim@magaza.com"
                        disabled={!user && !editMode}
                      />
                      <p className="text-gray-500 text-xs mt-2">Onay ve bildirimler iÃ§in</p>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Telefon *
                      </label>
                      <input
                        type="tel"
                        required
                        value={formData.phone}
                        onChange={(e) => setFormData({...formData, phone: e.target.value})}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        placeholder="05XX XXX XX XX"
                        disabled={!user && !editMode}
                      />
                      <p className="text-gray-500 text-xs mt-2">MÃ¼ÅŸterilerin arayabileceÄŸi numara</p>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Åehir *
                      </label>
                      <select
                        value={formData.city}
                        onChange={(e) => setFormData({...formData, city: e.target.value})}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        required
                        disabled={!user && !editMode}
                      >
                        <option value="">Åehir seÃ§in</option>
                        {cities.map(city => (
                          <option key={city} value={city}>{city}</option>
                        ))}
                      </select>
                      <p className="text-gray-500 text-xs mt-2">Ä°ÅŸletmenizin bulunduÄŸu ÅŸehir</p>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Ä°ÅŸletme TÃ¼rÃ¼ *
                      </label>
                      <select
                        value={formData.businessType}
                        onChange={(e) => setFormData({...formData, businessType: e.target.value})}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        required
                        disabled={!user && !editMode}
                      >
                        <option value="">SeÃ§iniz</option>
                        {businessTypes.map(type => (
                          <option key={type.id} value={type.id}>
                            {type.icon} {type.name} - {type.description}
                          </option>
                        ))}
                      </select>
                      <p className="text-gray-500 text-xs mt-2">Ana faaliyet alanÄ±nÄ±z</p>
                    </div>
                  </div>
                </div>

                {/* Adres */}
                <div>
                  <h3 className="text-xl font-bold text-gray-900 mb-4">
                    <span className="text-blue-600">ğŸ“</span> Adres Bilgileri
                  </h3>
                  
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Adres
                    </label>
                    <textarea
                      value={formData.address}
                      onChange={(e) => setFormData({...formData, address: e.target.value})}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      placeholder="Mahalle, cadde, sokak, bina no, daire no..."
                      rows={3}
                      disabled={!user && !editMode}
                    />
                    <p className="text-gray-500 text-xs mt-2">MÃ¼ÅŸterilerin bulabilmesi iÃ§in tam adres</p>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Website (varsa)
                    </label>
                    <input
                      type="url"
                      value={formData.website}
                      onChange={(e) => setFormData({...formData, website: e.target.value})}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      placeholder="https://www.ornek.com"
                      disabled={!user && !editMode}
                    />
                    <p className="text-gray-500 text-xs mt-2">MÃ¼ÅŸterilerin ziyaret edebileceÄŸi site</p>
                  </div>
                </div>

                {/* AÃ§Ä±klama */}
                <div>
                  <h3 className="text-xl font-bold text-gray-900 mb-4">
                    <span className="text-blue-600">ğŸ“</span> Ä°ÅŸletme AÃ§Ä±klamasÄ±
                  </h3>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      KÄ±sa TanÄ±tÄ±m *
                    </label>
                    <textarea
                      required
                      value={formData.description}
                      onChange={(e) => setFormData({...formData, description: e.target.value})}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      placeholder="Ä°ÅŸletmenizi kÄ±saca tanÄ±tÄ±n. UzmanlÄ±k alanlarÄ±nÄ±z, Ã¼rÃ¼n yelpazeniz, hizmetleriniz..."
                      rows={4}
                      disabled={!user && !editMode}
                    />
                    <p className="text-gray-500 text-xs mt-2">
                      MÃ¼ÅŸteriler bu aÃ§Ä±klamayÄ± gÃ¶recek. Net ve Ã§ekici olun.
                    </p>
                  </div>
                </div>

                {/* Tahmini Spot SayÄ±sÄ± */}
                <div>
                  <h3 className="text-xl font-bold text-gray-900 mb-4">
                    <span className="text-blue-600">ğŸ“Š</span> Tahmini Aktivite
                  </h3>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-4">
                      Ayda kaÃ§ spot oluÅŸturmayÄ± planlÄ±yorsunuz? *
                    </label>
                    <div className="grid grid-cols-2 md:grid-cols-5 gap-3">
                      {spotRanges.map(range => (
                        <label 
                          key={range.id}
                          className={`cursor-pointer border-2 rounded-xl p-4 text-center transition duration-200 ${
                            formData.monthlySpots === range.id
                              ? 'border-blue-500 bg-blue-50'
                              : 'border-gray-200 hover:border-gray-300'
                          } ${(!user && !editMode) ? 'opacity-50 cursor-not-allowed' : ''}`}
                        >
                          <input
                            type="radio"
                            name="monthlySpots"
                            value={range.id}
                            checked={formData.monthlySpots === range.id}
                            onChange={(e) => setFormData({...formData, monthlySpots: e.target.value})}
                            className="sr-only"
                            required
                            disabled={!user && !editMode}
                          />
                          <div className="font-bold text-gray-900">{range.name}</div>
                          <div className="text-xs text-gray-500 mt-1">{range.description}</div>
                        </label>
                      ))}
                    </div>
                    <p className="text-gray-500 text-xs mt-2">
                      Size Ã¶zel Ã¶neriler sunabilmemiz iÃ§in bu bilgi Ã¶nemlidir.
                    </p>
                  </div>
                </div>

                {/* KoÅŸullar */}
                <div>
                  <h3 className="text-xl font-bold text-gray-900 mb-4">
                    <span className="text-blue-600">ğŸ“œ</span> KoÅŸullar ve Onaylar
                  </h3>
                  
                  <div className="space-y-4">
                    <label className={`flex items-start ${(!user && !editMode) ? 'opacity-50' : ''}`}>
                      <input
                        type="checkbox"
                        checked={formData.acceptTerms}
                        onChange={(e) => setFormData({...formData, acceptTerms: e.target.checked})}
                        className="mt-1 mr-3"
                        required
                        disabled={!user && !editMode}
                      />
                      <span className="text-sm">
                        <a 
                          href="/terms" 
                          target="_blank"
                          className="text-blue-600 hover:text-blue-800 font-medium"
                        >
                          SpotItForMe KullanÄ±m KoÅŸullarÄ±
                        </a>'nÄ± okudum ve kabul ediyorum. *
                      </span>
                    </label>
                    
                    <label className={`flex items-start ${(!user && !editMode) ? 'opacity-50' : ''}`}>
                      <input
                        type="checkbox"
                        checked={formData.acceptPrivacy}
                        onChange={(e) => setFormData({...formData, acceptPrivacy: e.target.checked})}
                        className="mt-1 mr-3"
                        required
                        disabled={!user && !editMode}
                      />
                      <span className="text-sm">
                        <a 
                          href="/privacy" 
                          target="_blank"
                          className="text-blue-600 hover:text-blue-800 font-medium"
                        >
                          SpotItForMe Gizlilik PolitikasÄ±
                        </a>'nÄ± okudum ve kabul ediyorum. *
                      </span>
                    </label>
                    
                    <label className={`flex items-start ${(!user && !editMode) ? 'opacity-50' : ''}`}>
                      <input
                        type="checkbox"
                        checked={formData.acceptMarketing}
                        onChange={(e) => setFormData({...formData, acceptMarketing: e.target.checked})}
                        className="mt-1 mr-3"
                        disabled={!user && !editMode}
                      />
                      <span className="text-sm">
                        SpotItForMe'den kampanyalar, indirimler ve gÃ¼ncellemeler hakkÄ±nda 
                        email almak istiyorum. (Ä°steÄŸe baÄŸlÄ±)
                      </span>
                    </label>
                  </div>
                </div>

                {/* Submit Buttons */}
                <div className="pt-8 border-t">
                  <div className="flex flex-col sm:flex-row gap-4">
                    <button
                      type="submit"
                      disabled={loading || !user}
                      className="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-xl text-lg disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      {loading ? (
                        <span className="flex items-center justify-center">
                          <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                          </svg>
                          {editMode ? 'GÃ¼ncelleniyor...' : 'Kaydediliyor...'}
                        </span>
                      ) : editMode ? (
                        'MaÄŸaza Bilgilerini GÃ¼ncelle'
                      ) : user ? (
                        'Ãœcretsiz MaÄŸaza AÃ§'
                      ) : (
                        'Ã–nce GiriÅŸ YapÄ±n'
                      )}
                    </button>
                    
                    <button
                      type="button"
                      onClick={() => router.push('/')}
                      className="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-4 px-8 rounded-xl"
                    >
                      Ä°ptal
                    </button>
                  </div>
                  
                  {!user && (
                    <div className="mt-4 p-4 bg-blue-50 rounded-lg">
                      <p className="text-blue-800 text-sm text-center">
                        MaÄŸaza kaydÄ± iÃ§in Ã¶nce giriÅŸ yapmalÄ±sÄ±nÄ±z. 
                        <button
                          onClick={() => {
                            setAuthSuccessCallback(() => handleFormSubmit)
                            setShowAuthModal(true)
                          }}
                          className="text-blue-600 hover:text-blue-800 font-medium ml-2 underline"
                        >
                          Hemen giriÅŸ yapÄ±n
                        </button>
                      </p>
                    </div>
                  )}
                  
                  <p className="text-center text-gray-500 text-sm mt-4">
                    KayÄ±t iÅŸlemi tamamlandÄ±ÄŸÄ±nda size bir onay email'i gÃ¶ndereceÄŸiz.
                    <br />
                    Ãœcretsiz paketle baÅŸlayÄ±n, ileride premium Ã¶zelliklere geÃ§ebilirsiniz.
                  </p>
                </div>
              </div>
            </form>
          </div>
        </div>

        {/* SSS */}
        <div className="mt-16">
          <h2 className="text-3xl font-bold text-center mb-12">SÄ±kÃ§a Sorulan Sorular</h2>
          <div className="max-w-3xl mx-auto space-y-6">
            {[
              {
                q: "MaÄŸaza kaydÄ± Ã¼cretsiz mi?",
                a: "Evet! SpotItForMe'de maÄŸaza kaydÄ± tamamen Ã¼cretsizdir. SÄ±nÄ±rsÄ±z spot oluÅŸturabilir, binlerce potansiyel mÃ¼ÅŸteriye ulaÅŸabilirsiniz."
              },
              {
                q: "Premium paketler ne zaman gelecek?",
                a: "Premium paketler (PRO, BUSINESS) platform bÃ¼yÃ¼dÃ¼kÃ§e eklenecek. Åu anda tÃ¼m Ã¶zellikler Ã¼cretsiz kullanÄ±labilir."
              },
              {
                q: "MÃ¼ÅŸteriler beni nasÄ±l bulacak?",
                a: "MÃ¼ÅŸteriler aradÄ±klarÄ± Ã¼rÃ¼nÃ¼ sizde gÃ¶rdÃ¼ÄŸÃ¼nde, maÄŸaza profilinize yÃ¶nlendirilecek ve iletiÅŸim bilgilerinizi gÃ¶recek."
              },
              {
                q: "KaÃ§ tane spot oluÅŸturabilirim?",
                a: "Ãœcretsiz pakette aylÄ±k spot sÄ±nÄ±rÄ± yok! Ancak resim yÃ¼kleme iÃ§in ayda 20 adet Ã¼cretsiz hakkÄ±nÄ±z var."
              },
              {
                q: "Hangi tÃ¼r iÅŸletmeler katÄ±labilir?",
                a: "AntikacÄ±lar, koleksiyonerler, tamir servisleri, ikinci el maÄŸazalar, Ã¶zel Ã¼rÃ¼n satan tÃ¼m iÅŸletmeler katÄ±labilir."
              }
            ].map((faq, idx) => (
              <div key={idx} className="bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition duration-200">
                <h4 className="font-bold text-lg mb-3 flex items-center">
                  <span className="text-blue-600 mr-3">â“</span>
                  {faq.q}
                </h4>
                <p className="text-gray-600">{faq.a}</p>
              </div>
            ))}
          </div>
        </div>

        {/* Call to Action */}
        <div className="mt-16 text-center">
          <h3 className="text-2xl font-bold text-gray-900 mb-6">
            Hala sorularÄ±nÄ±z mÄ± var?
          </h3>
          <p className="text-gray-600 mb-8 max-w-2xl mx-auto">
            Ä°ÅŸletmeniz iÃ§in SpotItForMe'yi nasÄ±l kullanabileceÄŸinizi konuÅŸalÄ±m.
            Ãœcretsiz danÄ±ÅŸmanlÄ±k iÃ§in bize ulaÅŸÄ±n.
          </p>
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <a
              href="mailto:spotitformeweb@gmail.com"
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-lg"
            >
              ğŸ“§ Email GÃ¶nder
            </a>
            <a
              href="tel:+905555555555"
              className="bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-8 rounded-lg"
            >
              ğŸ“ Ara
            </a>
          </div>
        </div>
      </main>

      {/* Auth Modal */}
      {showAuthModal && (
        <AuthModal
          isOpen={showAuthModal}
          onClose={() => setShowAuthModal(false)}
          onSuccess={handleAuthSuccess}
        />
      )}
    </div>
  )
}

ğŸ“„ app/forgot-password/page.tsx
ğŸ“Š 215 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/forgot-password/page.tsx
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'
import { sendPasswordResetEmail } from '@/lib/email-server'
import Header from '@/components/Header'
import Footer from '@/components/Footer'
import Link from 'next/link'

export default function ForgotPasswordPage() {
  const [email, setEmail] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')
  const [success, setSuccess] = useState(false)

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')
    setSuccess(false)

    try {
      // 1. Supabase'den reset linki al
      const { data, error: resetError } = await supabase.auth.resetPasswordForEmail(email, {
        redirectTo: `${window.location.origin}/reset-password`,
      })

      if (resetError) throw resetError

      // 2. Email gÃ¶nder
      const resetLink = `${window.location.origin}/reset-password`
      const emailResult = await sendPasswordResetEmail(email, resetLink)

      if (!emailResult.success) {
        console.warn('Email gÃ¶nderilemedi ama reset linki oluÅŸturuldu')
      }

      setSuccess(true)
      
    } catch (err: any) {
      console.error('Åifre sÄ±fÄ±rlama hatasÄ±:', err)
      
      let errorMessage = err.message || 'Bir hata oluÅŸtu'
      
      if (errorMessage.includes('rate limit')) {
        errorMessage = 'Ã‡ok fazla deneme yaptÄ±nÄ±z. LÃ¼tfen bir sÃ¼re sonra tekrar deneyin.'
      } else if (errorMessage.includes('email')) {
        errorMessage = 'GeÃ§ersiz email adresi'
      } else if (errorMessage.includes('User not found')) {
        errorMessage = 'Bu email adresiyle kayÄ±tlÄ± kullanÄ±cÄ± bulunamadÄ±'
      }
      
      setError(errorMessage)
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-12">
        <div className="max-w-md mx-auto">
          <div className="bg-white rounded-2xl shadow-lg p-8">
            {/* BaÅŸlÄ±k */}
            <div className="text-center mb-8">
              <div className="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center text-2xl mx-auto mb-4">
                ğŸ”
              </div>
              <h1 className="text-2xl font-bold text-gray-900 mb-2">
                Åifremi Unuttum
              </h1>
              <p className="text-gray-600">
                Email adresinizi girerek ÅŸifre sÄ±fÄ±rlama linki alabilirsiniz
              </p>
            </div>

            {/* BaÅŸarÄ± MesajÄ± */}
            {success && (
              <div className="mb-6 bg-green-50 border border-green-200 text-green-700 p-4 rounded-lg">
                <div className="flex items-center">
                  <span className="text-green-600 mr-3">âœ…</span>
                  <div>
                    <p className="font-medium">Åifre sÄ±fÄ±rlama linki gÃ¶nderildi!</p>
                    <p className="text-sm mt-1">
                      <strong>{email}</strong> adresine ÅŸifre sÄ±fÄ±rlama linkini gÃ¶nderdik.
                      Email'inizi kontrol edin ve gelen linke tÄ±klayÄ±n.
                    </p>
                    <p className="text-xs mt-2 text-green-600">
                      ğŸ“§ Email gelmedi mi? Spam klasÃ¶rÃ¼nÃ¼zÃ¼ kontrol edin.
                    </p>
                  </div>
                </div>
              </div>
            )}

            {/* Hata MesajÄ± */}
            {error && (
              <div className="mb-6 bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg">
                <div className="flex items-center">
                  <span className="text-red-600 mr-3">âŒ</span>
                  <div>
                    <p className="font-medium">{error}</p>
                  </div>
                </div>
              </div>
            )}

            {/* Form */}
            {!success && (
              <form onSubmit={handleSubmit} className="space-y-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Email Adresiniz *
                  </label>
                  <input
                    type="email"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    placeholder="ornek@email.com"
                    required
                    disabled={loading}
                  />
                  <p className="text-gray-500 text-xs mt-2">
                    KayÄ±tlÄ± olduÄŸunuz email adresini girin
                  </p>
                </div>

                <button
                  type="submit"
                  disabled={loading}
                  className="w-full bg-red-600 hover:bg-red-700 text-white font-medium py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
                >
                  {loading ? (
                    <>
                      <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                        <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                      </svg>
                      GÃ¶nderiliyor...
                    </>
                  ) : (
                    'Åifre SÄ±fÄ±rlama Linki GÃ¶nder'
                  )}
                </button>
              </form>
            )}

            {/* Ek Bilgiler */}
            <div className="mt-8 pt-6 border-t border-gray-100">
              <div className="space-y-4">
                <div className="bg-blue-50 p-4 rounded-lg">
                  <p className="text-sm text-blue-700">
                    <span className="font-medium">ğŸ’¡ Bilgilendirme:</span> Åifre sÄ±fÄ±rlama linki 24 saat geÃ§erlidir. 
                    Link'e tÄ±kladÄ±ktan sonra yeni ÅŸifrenizi belirleyebilirsiniz.
                  </p>
                </div>

                <div className="text-center">
                  <Link
                    href="/login"
                    className="text-blue-600 hover:text-blue-800 font-medium"
                  >
                    â† GiriÅŸ sayfasÄ±na dÃ¶n
                  </Link>
                </div>

                <div className="text-center text-sm text-gray-500">
                  HesabÄ±nÄ±z yok mu?{' '}
                  <Link
                    href="/register"
                    className="text-blue-600 hover:text-blue-800 font-medium"
                  >
                    Yeni hesap oluÅŸturun
                  </Link>
                </div>
              </div>
            </div>
          </div>

          {/* GÃ¼venlik Ä°puÃ§larÄ± */}
          <div className="mt-8 bg-white rounded-2xl shadow p-6">
            <h3 className="font-bold text-gray-900 mb-4 flex items-center">
              <span className="text-blue-600 mr-2">ğŸ”’</span>
              GÃ¼venlik Ä°puÃ§larÄ±
            </h3>
            <ul className="space-y-3 text-sm text-gray-600">
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>GÃ¼Ã§lÃ¼ ÅŸifreler kullanÄ±n (en az 8 karakter, harf, rakam, Ã¶zel karakter)</span>
              </li>
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>FarklÄ± platformlarda aynÄ± ÅŸifreyi kullanmayÄ±n</span>
              </li>
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>Åifre sÄ±fÄ±rlama linkini kimseyle paylaÅŸmayÄ±n</span>
              </li>
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>ÅÃ¼pheli aktivitelerde hemen bizimle iletiÅŸime geÃ§in</span>
              </li>
            </ul>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/help/[id]/page.tsx
ğŸ“Š 350 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/help/[id]/page.tsx - BASÄ°T Ã‡ALIÅAN VERSÄ°YON
'use client'

import { useEffect, useState } from 'react'
import { useParams, useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Header from '@/components/Header'
import Footer from '@/components/Footer'

interface SpotInfo {
  id: string
  title: string
  description: string
  location: string | null
  image_url: string | null
}

export default function HelpPage() {
  const params = useParams()
  const router = useRouter()
  const spotId = params.id as string
  
  const [spot, setSpot] = useState<SpotInfo | null>(null)
  const [formData, setFormData] = useState({
    location: '',
    price: '',
    notes: ''
  })
  const [loading, setLoading] = useState(false)
  const [submitted, setSubmitted] = useState(false)
  const [error, setError] = useState('')

  useEffect(() => {
    fetchSpotDetails()
  }, [spotId])

  const fetchSpotDetails = async () => {
    try {
      const { data, error } = await supabase
        .from('spots')
        .select('id, title, description, location, image_url')
        .eq('id', spotId)
        .single()

      if (error) throw error
      setSpot(data)
    } catch (error) {
      console.error('Spot bilgileri yÃ¼klenemedi:', error)
      setError('Spot bulunamadÄ±')
    }
  }

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')

    try {
      // 1. KullanÄ±cÄ± kontrolÃ¼
      const { data: { user }, error: userError } = await supabase.auth.getUser()
      if (userError || !user) {
        setError('LÃ¼tfen Ã¶nce giriÅŸ yapÄ±n')
        setLoading(false)
        return
      }

      // 2. Validasyon
      if (!formData.location.trim()) {
        setError('LÃ¼tfen konum bilgisi girin')
        setLoading(false)
        return
      }

      console.log('Form data:', formData)
      console.log('User:', user.id)
      console.log('Spot ID:', spotId)

      // 3. sightings tablosuna ekle (BASÄ°T VERSÄ°YON)
      const { data, error: insertError } = await supabase
        .from('sightings')
        .insert([
          {
            spot_id: spotId,
            spotter_id: user.id,
            location_description: formData.location,
            price: formData.price ? parseFloat(formData.price) : null,
            notes: formData.notes || null
          }
        ])
        .select()

      console.log('Insert response:', { data, error: insertError })

      if (insertError) {
        console.error('Insert error details:', insertError)
        
        // EÄŸer tablo yoksa oluÅŸtur
        if (insertError.message.includes('relation "sightings" does not exist')) {
          setError('Tablo bulunamadÄ±. LÃ¼tfen database schema oluÅŸturun.')
        } else {
          throw insertError
        }
      }

      // 4. Spot'un helps sayÄ±sÄ±nÄ± artÄ±r
      const { error: updateError } = await supabase
        .from('spots')
        .update({ helps: (await getCurrentHelps()) + 1 })
        .eq('id', spotId)

      if (updateError) {
        console.error('Update error:', updateError)
        // Hata olsa bile devam et
      }

      // 5. BaÅŸarÄ±lÄ±
      setSubmitted(true)

    } catch (err: any) {
      console.error('YardÄ±m kaydedilemedi:', err)
      setError(err.message || 'Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.')
    } finally {
      setLoading(false)
    }
  }

  const getCurrentHelps = async (): Promise<number> => {
    const { data } = await supabase
      .from('spots')
      .select('helps')
      .eq('id', spotId)
      .single()
    
    return data?.helps || 0
  }

  if (!spot && error) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        <main className="container-custom py-12 text-center">
          <div className="text-red-600 mb-4">âŒ {error}</div>
          <button
            onClick={() => router.push('/spots')}
            className="btn-primary"
          >
            Spot'lara DÃ¶n
          </button>
        </main>
        <Footer />
      </div>
    )
  }

  if (!spot) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        <main className="container-custom py-12 text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">YÃ¼kleniyor...</p>
        </main>
        <Footer />
      </div>
    )
  }

  if (submitted) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        <main className="container-custom py-12">
          <div className="max-w-2xl mx-auto">
            <div className="bg-white rounded-2xl shadow-lg p-8 text-center">
              <div className="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-3xl mx-auto mb-6">
                âœ…
              </div>
              <h1 className="text-2xl font-bold text-gray-900 mb-4">TeÅŸekkÃ¼rler!</h1>
              <p className="text-gray-600 mb-6">
                YardÄ±mÄ±nÄ±z baÅŸarÄ±yla kaydedildi. Spot sahibi bilgilendirilecek.
              </p>
              <div className="space-y-4">
                <button
                  onClick={() => router.push(`/spots/${spotId}`)}
                  className="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg"
                >
                  Spot'a DÃ¶n
                </button>
                <button
                  onClick={() => router.push('/spots')}
                  className="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg"
                >
                  DiÄŸer Spot'lara GÃ¶z At
                </button>
              </div>
            </div>
          </div>
        </main>
        <Footer />
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8">
        <div className="max-w-2xl mx-auto">
          {/* Geri DÃ¶n Butonu */}
          <button
            onClick={() => router.push(`/spots/${spotId}`)}
            className="mb-6 text-blue-600 hover:text-blue-800 flex items-center"
          >
            â† Spot'a Geri DÃ¶n
          </button>

          {/* BaÅŸlÄ±k */}
          <div className="mb-8">
            <h1 className="text-3xl font-bold text-gray-900 mb-2">
              YardÄ±m Et: {spot.title}
            </h1>
            <p className="text-gray-600">
              Bu Ã¼rÃ¼nÃ¼ gÃ¶rdÃ¼yseniz, spot sahibine yardÄ±mcÄ± olun.
            </p>
          </div>

          <div className="bg-white rounded-2xl shadow-lg p-8">
            {/* Spot Ã–nizleme */}
            <div className="mb-8 p-4 bg-gray-50 rounded-lg">
              <div className="flex items-start">
                {spot.image_url && (
                  <img
                    src={spot.image_url}
                    alt={spot.title}
                    className="w-20 h-20 object-cover rounded-lg mr-4"
                  />
                )}
                <div>
                  <h3 className="font-bold text-gray-900">{spot.title}</h3>
                  <p className="text-sm text-gray-600 mt-1 line-clamp-2">
                    {spot.description}
                  </p>
                  {spot.location && (
                    <p className="text-sm text-gray-500 mt-2">
                      ğŸ“ {spot.location}
                    </p>
                  )}
                </div>
              </div>
            </div>

            {/* Form */}
            <form onSubmit={handleSubmit} className="space-y-6">
              {/* Konum */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Nerede gÃ¶rdÃ¼nÃ¼z? *
                </label>
                <textarea
                  value={formData.location}
                  onChange={(e) => setFormData({...formData, location: e.target.value})}
                  placeholder="Ã–rn: Ä°stiklal Caddesi'ndeki Retro Antika maÄŸazasÄ±nda, KadÄ±kÃ¶y Ã‡arÅŸÄ±'da bir sokak satÄ±cÄ±sÄ±nda..."
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                  rows={3}
                  required
                />
                <p className="text-sm text-gray-500 mt-2">
                  MÃ¼mkÃ¼n olduÄŸunca detaylÄ± yazÄ±n: MaÄŸaza adÄ±, adres, kat, raf vs.
                </p>
              </div>

              {/* Fiyat */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Fiyat (TL)
                </label>
                <input
                  type="number"
                  value={formData.price}
                  onChange={(e) => setFormData({...formData, price: e.target.value})}
                  placeholder="GÃ¶rdÃ¼ÄŸÃ¼nÃ¼z fiyat"
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                />
              </div>

              {/* Notlar */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Ek Notlar
                </label>
                <textarea
                  value={formData.notes}
                  onChange={(e) => setFormData({...formData, notes: e.target.value})}
                  placeholder="ÃœrÃ¼n durumu, maÄŸaza Ã§alÄ±ÅŸma saatleri, iletiÅŸim bilgileri, diÄŸer detaylar..."
                  rows={4}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                />
              </div>

              {/* Hata MesajÄ± */}
              {error && (
                <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg">
                  <div className="flex items-center">
                    <span className="mr-2">âŒ</span>
                    <span>{error}</span>
                  </div>
                </div>
              )}

              {/* Buton */}
              <div className="pt-6 border-t">
                <button
                  type="submit"
                  disabled={loading}
                  className="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl text-lg disabled:opacity-50"
                >
                  {loading ? (
                    <div className="flex items-center justify-center">
                      <div className="animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-white mr-3"></div>
                      GÃ¶nderiliyor...
                    </div>
                  ) : (
                    'YardÄ±mÄ± GÃ¶nder'
                  )}
                </button>
                <p className="text-center text-sm text-gray-500 mt-3">
                  Bilgiler spot sahibi ile paylaÅŸÄ±lacak
                </p>
              </div>
            </form>

            {/* YardÄ±m Ä°puÃ§larÄ± */}
            <div className="mt-8 p-4 bg-blue-50 rounded-lg">
              <h3 className="font-bold text-blue-900 mb-3">ğŸ’¡ YardÄ±m Ä°puÃ§larÄ±</h3>
              <ul className="text-sm text-blue-800 space-y-2">
                <li>â€¢ MaÄŸaza adÄ± ve tam adres yazÄ±n</li>
                <li>â€¢ Fiyat bilgisi Ã§ok deÄŸerli</li>
                <li>â€¢ ÃœrÃ¼n durumunu belirtin (yeni/ikinci el/hasarlÄ±)</li>
                <li>â€¢ MÃ¼mkÃ¼nse fotoÄŸraf Ã§ekin ve spot sahibine gÃ¶nderin</li>
              </ul>
            </div>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/page.tsx
ğŸ“Š 59 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/page.tsx - BASÄ°TLEÅTÄ°RÄ°LMÄ°Å
import Hero from '@/components/Hero'
import Stats from '@/components/Stats'
import HowItWorks from '@/components/HowItWorks'
import RecentSpots from '@/components/RecentSpots'
import Categories from '@/components/Categories'
import CTA from '@/components/CTA'
import RecentSightings from '@/components/RecentSightings'
import Leaderboard from '@/components/Leaderboard'
import DailyChallenges from '@/components/DailyChallenges'
import QuickSightingButton from '@/components/QuickSightingButton'

export default function HomePage() {
  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-50 to-white">
      <QuickSightingButton />
      
      <div className="container-custom">
        {/* Header'da zaten reklam var, burada TEKRAR EKLEME */}
        
        <div className="grid lg:grid-cols-3 gap-6 md:gap-8 py-4 md:py-8">
          <div className="lg:col-span-2">
            <Hero />
            <Stats />
            <RecentSightings />
            <HowItWorks />
            
            {/* Ä°Ã§erik arasÄ± reklam YOK - Native ads SpotList iÃ§inde */}
            <RecentSpots />
            
            <Categories />
            
            {/* Footer'da zaten reklam var, burada TEKRAR EKLEME */}
            <CTA />
          </div>

          <div className="space-y-6">
            <Leaderboard />
            <DailyChallenges />
            
            {/* Sidebar reklamÄ± - SADECE desktop */}
            <div className="hidden lg:block">
              <div className="sticky top-4">
                {/* Native reklam veya banner */}
                <div className="bg-gradient-to-br from-blue-50 to-white border border-blue-200 rounded-xl p-6 mb-6">
                  <div className="text-center">
                    <div className="text-lg font-bold text-blue-700 mb-2">REKLAM</div>
                    <div className="text-sm text-gray-600">Sidebar 300Ã—250</div>
                    <div className="text-xs text-gray-400 mt-4">Desktop reklam alanÄ±</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ app/privacy/page.tsx
ğŸ“Š 193 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/privacy/page.tsx
import Header from '@/components/Header'
import Footer from '@/components/Footer'
import Link from 'next/link'

export default function PrivacyPage() {
  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8 md:py-12">
        <div className="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg p-8">
          {/* Header */}
          <div className="text-center mb-10">
            <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
              SpotItForMe Gizlilik PolitikasÄ±
            </h1>
            <p className="text-gray-600">
              Son gÃ¼ncellenme: {new Date().toLocaleDateString('tr-TR', { day: 'numeric', month: 'long', year: 'numeric' })}
            </p>
          </div>

          {/* Content */}
          <div className="prose prose-lg max-w-none">
            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">1. GiriÅŸ</h2>
              <p className="text-gray-700">
                SpotItForMe ("Platform") olarak, gizliliÄŸinize Ã¶nem veriyoruz. Bu Gizlilik PolitikasÄ±, 
                kiÅŸisel verilerinizin nasÄ±l toplandÄ±ÄŸÄ±nÄ±, kullanÄ±ldÄ±ÄŸÄ±nÄ±, korunduÄŸunu ve paylaÅŸÄ±ldÄ±ÄŸÄ±nÄ± aÃ§Ä±klar.
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">2. Toplanan Veriler</h2>
              <p className="text-gray-700 mb-4">Platformu kullanÄ±rken ÅŸu verileri topluyoruz:</p>
              
              <h3 className="text-xl font-bold text-gray-900 mb-3">2.1. DoÄŸrudan SaÄŸladÄ±ÄŸÄ±nÄ±z Veriler:</h3>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>Ad, soyad (isteÄŸe baÄŸlÄ±)</li>
                <li>Email adresi</li>
                <li>Telefon numarasÄ± (maÄŸaza hesaplarÄ± iÃ§in)</li>
                <li>Ä°ÅŸletme bilgileri (maÄŸaza hesaplarÄ± iÃ§in)</li>
                <li>Profil fotoÄŸrafÄ± (isteÄŸe baÄŸlÄ±)</li>
              </ul>

              <h3 className="text-xl font-bold text-gray-900 mb-3">2.2. Otomatik Toplanan Veriler:</h3>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>IP adresi ve konum bilgisi</li>
                <li>Cihaz bilgileri (tarayÄ±cÄ± tÃ¼rÃ¼, iÅŸletim sistemi)</li>
                <li>KullanÄ±m verileri (ziyaret edilen sayfalar, tÄ±klamalar)</li>
                <li>Ã‡erezler (Cookies)</li>
              </ul>

              <h3 className="text-xl font-bold text-gray-900 mb-3">2.3. KullanÄ±cÄ± Ä°Ã§eriÄŸi:</h3>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>OluÅŸturduÄŸunuz spot'lar</li>
                <li>YÃ¼klediÄŸiniz fotoÄŸraflar</li>
                <li>YaptÄ±ÄŸÄ±nÄ±z yorumlar ve yardÄ±mlar</li>
                <li>MaÄŸaza aÃ§Ä±klamalarÄ±</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">3. Veri KullanÄ±m AmaÃ§larÄ±</h2>
              <p className="text-gray-700 mb-4">TopladÄ±ÄŸÄ±mÄ±z verileri ÅŸu amaÃ§larla kullanÄ±yoruz:</p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>Platform hizmetlerini saÄŸlamak ve iyileÅŸtirmek</li>
                <li>Hesap gÃ¼venliÄŸini saÄŸlamak</li>
                <li>KullanÄ±cÄ± deneyimini kiÅŸiselleÅŸtirmek</li>
                <li>Spot ve yardÄ±m bildirimleri gÃ¶ndermek</li>
                <li>Teknik sorunlarÄ± Ã§Ã¶zmek</li>
                <li>Yasal yÃ¼kÃ¼mlÃ¼lÃ¼kleri yerine getirmek</li>
                <li>Platform istatistikleri oluÅŸturmak (anonim)</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">4. Veri PaylaÅŸÄ±mÄ±</h2>
              <p className="text-gray-700 mb-4">Verilerinizi aÅŸaÄŸÄ±daki durumlarda paylaÅŸabiliriz:</p>
              
              <h3 className="text-xl font-bold text-gray-900 mb-3">4.1. DiÄŸer KullanÄ±cÄ±larla:</h3>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>Spot oluÅŸturduÄŸunuzda: KullanÄ±cÄ± adÄ±nÄ±z ve spot iÃ§eriÄŸiniz</li>
                <li>MaÄŸaza hesabÄ±nÄ±zda: Ä°ÅŸletme bilgileriniz ve iletiÅŸim detaylarÄ±</li>
                <li>YardÄ±m ettiÄŸinizde: KullanÄ±cÄ± adÄ±nÄ±z ve yardÄ±m iÃ§eriÄŸiniz</li>
              </ul>

              <h3 className="text-xl font-bold text-gray-900 mb-3">4.2. ÃœÃ§Ã¼ncÃ¼ Taraflarla:</h3>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>Yasal zorunluluklar gereÄŸi</li>
                <li>Hizmet saÄŸlayÄ±cÄ±larÄ±mÄ±z (hosting, email, analiz)</li>
                <li>Platform satÄ±ÅŸÄ± veya devri durumunda</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">5. Ã‡erezler (Cookies)</h2>
              <p className="text-gray-700 mb-4">
                Platform, kullanÄ±cÄ± deneyimini iyileÅŸtirmek iÃ§in Ã§erezler kullanÄ±r. Ã‡erez tÃ¼rleri:
              </p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li><strong>Zorunlu Ã‡erezler:</strong> Platformun Ã§alÄ±ÅŸmasÄ± iÃ§in gerekli</li>
                <li><strong>Performans Ã‡erezleri:</strong> KullanÄ±m istatistikleri iÃ§in</li>
                <li><strong>Ä°ÅŸlevsellik Ã‡erezleri:</strong> Tercihlerinizi hatÄ±rlamak iÃ§in</li>
              </ul>
              <p className="text-gray-700">
                TarayÄ±cÄ± ayarlarÄ±nÄ±zdan Ã§erezleri kontrol edebilirsiniz, ancak bu Platform deneyiminizi etkileyebilir.
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">6. Veri GÃ¼venliÄŸi</h2>
              <p className="text-gray-700 mb-4">
                Verilerinizi korumak iÃ§in uygun teknik ve organizasyonel Ã¶nlemler alÄ±yoruz:
              </p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>Veri ÅŸifreleme (SSL/TLS)</li>
                <li>GÃ¼venli sunucular</li>
                <li>EriÅŸim kontrolleri</li>
                <li>DÃ¼zenli gÃ¼venlik denetimleri</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">7. Veri Saklama SÃ¼resi</h2>
              <p className="text-gray-700 mb-4">
                Verilerinizi, hizmet saÄŸlamak iÃ§in gerekli olduÄŸu sÃ¼rece saklÄ±yoruz. HesabÄ±nÄ±zÄ± sildiÄŸinizde:
              </p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>KiÅŸisel bilgileriniz silinir</li>
                <li>OluÅŸturduÄŸunuz spot'lar anonim hale getirilir</li>
                <li>Yasal saklama yÃ¼kÃ¼mlÃ¼lÃ¼ÄŸÃ¼ olan veriler saklanmaya devam eder</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">8. KVKK HaklarÄ±nÄ±z</h2>
              <p className="text-gray-700 mb-4">
                6698 sayÄ±lÄ± KiÅŸisel Verilerin KorunmasÄ± Kanunu (KVKK) kapsamÄ±nda sahip olduÄŸunuz haklar:
              </p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>Verilerinizin iÅŸlenip iÅŸlenmediÄŸini Ã¶ÄŸrenme</li>
                <li>Eksik veya yanlÄ±ÅŸ verilerin dÃ¼zeltilmesini isteme</li>
                <li>Verilerinizin silinmesini veya yok edilmesini isteme</li>
                <li>Ä°ÅŸlenen verilerin aktarÄ±labileceÄŸi kiÅŸileri bildirme</li>
                <li>Ä°tiraz etme</li>
              </ul>
              <p className="text-gray-700">
                HaklarÄ±nÄ±zÄ± kullanmak iÃ§in:{" "}
                <a href="mailto:spotitformeweb@gmail.com" className="text-blue-600 hover:text-blue-800">
                  spotitformeweb@gmail.com
                </a>
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">9. Ã‡ocuklarÄ±n GizliliÄŸi</h2>
              <p className="text-gray-700">
                Platform 18 yaÅŸÄ±ndan kÃ¼Ã§Ã¼klerin kullanÄ±mÄ±na yÃ¶nelik deÄŸildir. Bilmeden Ã§ocuklardan veri 
                topladÄ±ÄŸÄ±mÄ±zÄ± fark edersek, bu verileri derhal sileriz.
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">10. DeÄŸiÅŸiklikler ve Ä°letiÅŸim</h2>
              <p className="text-gray-700 mb-4">
                Bu Gizlilik PolitikasÄ±nÄ± gÃ¼ncelleyebiliriz. DeÄŸiÅŸiklikler Platform Ã¼zerinden duyurulacaktÄ±r.
              </p>
              <p className="text-gray-700">
                Gizlilik ile ilgili sorularÄ±nÄ±z iÃ§in:{" "}
                <a href="mailto:spotitformeweb@gmail.com" className="text-blue-600 hover:text-blue-800">
                  spotitformeweb@gmail.com
                </a>
              </p>
            </div>
          </div>

          {/* Back Button */}
          <div className="text-center mt-10 pt-6 border-t">
            <Link
              href="/for-business"
              className="inline-block bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-3 px-8 rounded-lg"
            >
              â† Geri DÃ¶n
            </Link>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/product/[id]/page.tsx
ğŸ“Š 656 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/product/[id]/page.tsx - KULLANICILAR Ä°Ã‡Ä°N ÃœRÃœN DETAY
'use client';

import { useState, useEffect } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { supabase } from '@/lib/supabase';
import { 
  ArrowLeft, Heart, Share2, ShoppingCart, MessageCircle,
  MapPin, Truck, Star, Shield, Clock, Package,
  CheckCircle, XCircle, Phone, Mail, Instagram, Globe
} from 'lucide-react';
import Link from 'next/link';
import SimpleShareButtons from '@/components/SimpleShareButtons';
import NativeAd from '@/components/NativeAd';

export default function ProductPage() {
  const params = useParams();
  const router = useRouter();
  const productId = params.id as string;
  
  const [product, setProduct] = useState<any>(null);
  const [shop, setShop] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const [similarProducts, setSimilarProducts] = useState<any[]>([]);
  const [activeImageIndex, setActiveImageIndex] = useState(0);
  const [isFavorite, setIsFavorite] = useState(false);
  const [quantity, setQuantity] = useState(1);

  useEffect(() => {
    loadProduct();
  }, [productId]);

  const loadProduct = async () => {
    try {
      setLoading(true);
      
      // ÃœrÃ¼n bilgilerini getir
      const { data: productData, error } = await supabase
        .from('shop_inventory')
        .select('*')
        .eq('id', productId)
        .eq('status', 'active')
        .single();

      if (error) throw error;
      setProduct(productData);

      // MaÄŸaza bilgilerini getir
      if (productData.shop_id) {
        const { data: shopData } = await supabase
          .from('shops')
          .select('*')
          .eq('id', productData.shop_id)
          .eq('is_active', true)
          .single();
        
        setShop(shopData);
      }

      // GÃ¶rÃ¼ntÃ¼leme sayÄ±sÄ±nÄ± artÄ±r
      await supabase
        .from('shop_inventory')
        .update({ 
          view_count: (productData.view_count || 0) + 1,
          last_viewed_at: new Date().toISOString()
        })
        .eq('id', productId);

      // Benzer Ã¼rÃ¼nleri getir
      if (productData.category) {
        const { data: similar } = await supabase
          .from('shop_inventory')
          .select('*')
          .eq('category', productData.category)
          .eq('status', 'active')
          .neq('id', productId)
          .limit(4);

        setSimilarProducts(similar || []);
      }

    } catch (error) {
      console.error('ÃœrÃ¼n yÃ¼klenemedi:', error);
      router.push('/');
    } finally {
      setLoading(false);
    }
  };

  const handleContact = () => {
    if (shop?.phone) {
      window.open(`tel:${shop.phone}`, '_blank');
    } else if (shop?.email) {
      window.open(`mailto:${shop.email}`, '_blank');
    } else {
      alert('MaÄŸaza iletiÅŸim bilgileri bulunamadÄ±');
    }
  };

  const handleAddToFavorites = async () => {
    // TODO: Favorilere ekleme iÅŸlemi
    setIsFavorite(!isFavorite);
    alert(isFavorite ? 'Favorilerden Ã§Ä±karÄ±ldÄ±' : 'Favorilere eklendi');
  };

  const parseShippingOptions = (options: any) => {
    if (!options) return { shipping: false, local_pickup: false };
    
    if (typeof options === 'string') {
      try {
        return JSON.parse(options);
      } catch (error) {
        return { shipping: false, local_pickup: false };
      }
    }
    
    return options;
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="container mx-auto px-4">
          <div className="text-center py-12">
            <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
            <p className="mt-4 text-gray-600">ÃœrÃ¼n yÃ¼kleniyor...</p>
          </div>
        </div>
      </div>
    );
  }

  if (!product) {
    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="container mx-auto px-4">
          <div className="text-center py-12">
            <Package className="mx-auto text-gray-400 mb-4" size={48} />
            <h1 className="text-2xl font-bold text-gray-900 mb-4">ÃœrÃ¼n bulunamadÄ±</h1>
            <p className="text-gray-600 mb-8">Bu Ã¼rÃ¼n silinmiÅŸ veya mevcut deÄŸil.</p>
            <button
              onClick={() => router.push('/')}
              className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg"
            >
              Ana Sayfaya DÃ¶n
            </button>
          </div>
        </div>
      </div>
    );
  }

  const shippingOptions = parseShippingOptions(product.shipping_options);
  const discountPercent = product.discount_percent 
    ? Math.round((1 - product.price / product.original_price) * 100)
    : null;

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Ãœst Navigasyon */}
      <div className="bg-white shadow">
        <div className="container mx-auto px-4 py-3">
          <button
            onClick={() => router.back()}
            className="text-gray-600 hover:text-gray-900 flex items-center"
          >
            <ArrowLeft className="mr-2" size={20} />
            Geri DÃ¶n
          </button>
        </div>
      </div>

      <div className="container mx-auto px-4 py-8">
        <div className="grid lg:grid-cols-3 gap-8">
          {/* Sol Kolon - ÃœrÃ¼n Resimleri */}
          <div className="lg:col-span-2">
            <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
              {/* Resimler */}
              {product.images && product.images.length > 0 ? (
                <div>
                  {/* BÃ¼yÃ¼k Resim */}
                  <div className="relative h-96 bg-gray-100">
                    <img
                      src={product.images[activeImageIndex]}
                      alt={product.title}
                      className="w-full h-full object-contain"
                    />
                    
                    {/* Favori Butonu */}
                    <button
                      onClick={handleAddToFavorites}
                      className="absolute top-4 right-4 bg-white p-3 rounded-full shadow-lg hover:bg-gray-100"
                    >
                      <Heart 
                        size={24} 
                        className={isFavorite ? 'text-red-500 fill-red-500' : 'text-gray-400'} 
                      />
                    </button>
                    
                    {/* Ä°ndirim Badge */}
                    {discountPercent && (
                      <div className="absolute top-4 left-4 bg-red-500 text-white px-4 py-2 rounded-lg font-bold">
                        -%{discountPercent}
                      </div>
                    )}
                  </div>
                  
                  {/* KÃ¼Ã§Ã¼k Resimler */}
                  {product.images.length > 1 && (
                    <div className="p-4 border-t">
                      <div className="flex space-x-2 overflow-x-auto">
                        {product.images.map((image: string, index: number) => (
                          <button
                            key={index}
                            onClick={() => setActiveImageIndex(index)}
                            className={`flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden ${
                              activeImageIndex === index 
                                ? 'ring-2 ring-blue-500' 
                                : 'opacity-75 hover:opacity-100'
                            }`}
                          >
                            <img
                              src={image}
                              alt={`${product.title} - ${index + 1}`}
                              className="w-full h-full object-cover"
                            />
                          </button>
                        ))}
                      </div>
                    </div>
                  )}
                </div>
              ) : (
                <div className="h-96 bg-gray-100 flex items-center justify-center">
                  <Package className="text-gray-400" size={64} />
                </div>
              )}
              
              {/* ÃœrÃ¼n Bilgileri */}
              <div className="p-6">
                <div className="mb-6">
                  <div className="flex items-center flex-wrap gap-2 mb-3">
                    <span className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
                      {product.category || 'DiÄŸer'}
                    </span>
                    {product.brand && (
                      <span className="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm">
                        {product.brand}
                      </span>
                    )}
                    {product.condition && (
                      <span className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">
                        {product.condition === 'new' ? 'SÄ±fÄ±r' : 
                         product.condition === 'like_new' ? 'Az KullanÄ±lmÄ±ÅŸ' : 
                         product.condition === 'used' ? 'KullanÄ±lmÄ±ÅŸ' : 'Fabrika Ã‡Ä±kÄ±ÅŸlÄ±'}
                      </span>
                    )}
                  </div>
                  
                  <h1 className="text-3xl font-bold text-gray-900 mb-4">
                    {product.title}
                  </h1>
                  
                  <div className="flex items-center mb-6">
                    <div className="flex items-center mr-4">
                      {[...Array(5)].map((_, i) => (
                        <Star
                          key={i}
                          size={20}
                          className={`${
                            i < 4 ? 'text-yellow-400 fill-yellow-400' : 'text-gray-300'
                          }`}
                        />
                      ))}
                      <span className="ml-2 text-gray-600">(4.0)</span>
                    </div>
                    <span className="text-gray-500">
                      {product.view_count || 0} gÃ¶rÃ¼ntÃ¼lenme
                    </span>
                  </div>
                </div>
                
                {/* Fiyat */}
                <div className="mb-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl">
                  <div className="flex items-end">
                    <div className="mr-6">
                      <div className="text-4xl font-bold text-gray-900">
                        {product.price.toLocaleString('tr-TR')} {product.price_currency}
                      </div>
                      {product.original_price && product.original_price > product.price && (
                        <div className="text-xl text-gray-500 line-through">
                          {product.original_price.toLocaleString('tr-TR')} {product.price_currency}
                        </div>
                      )}
                    </div>
                    
                    <div className="flex-1">
                      <div className="text-sm text-gray-600 mb-2">Stok Durumu:</div>
                      <div className={`inline-flex items-center px-4 py-2 rounded-full font-medium ${
                        product.quantity > 0 
                          ? 'bg-green-100 text-green-800' 
                          : 'bg-red-100 text-red-800'
                      }`}>
                        {product.quantity > 0 
                          ? `âœ… ${product.quantity} adet stokta` 
                          : 'âŒ Stokta yok'}
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* AÃ§Ä±klama */}
                <div className="mb-8">
                  <h2 className="text-xl font-bold text-gray-900 mb-4">ÃœrÃ¼n AÃ§Ä±klamasÄ±</h2>
                  <div className="text-gray-700 whitespace-pre-line bg-gray-50 p-6 rounded-lg">
                    {product.description || 'AÃ§Ä±klama eklenmemiÅŸ.'}
                  </div>
                </div>
                
                {/* Detaylar */}
                <div className="grid md:grid-cols-2 gap-6">
                  <div className="space-y-4">
                    <div className="flex items-center">
                      <MapPin className="text-gray-400 mr-3" size={20} />
                      <div>
                        <div className="text-sm text-gray-600">Konum</div>
                        <div className="font-medium">{product.location || shop?.city || 'BelirtilmemiÅŸ'}</div>
                      </div>
                    </div>
                    
                    <div className="flex items-center">
                      <Truck className="text-gray-400 mr-3" size={20} />
                      <div>
                        <div className="text-sm text-gray-600">Kargo SeÃ§enekleri</div>
                        <div className="space-y-1">
                          <div className="flex items-center">
                            {shippingOptions.shipping ? (
                              <>
                                <CheckCircle className="text-green-500 mr-2" size={16} />
                                <span className="font-medium">Kargo ile gÃ¶nderim</span>
                              </>
                            ) : (
                              <>
                                <XCircle className="text-red-500 mr-2" size={16} />
                                <span className="text-gray-500">Kargo yok</span>
                              </>
                            )}
                          </div>
                          <div className="flex items-center">
                            {shippingOptions.local_pickup ? (
                              <>
                                <CheckCircle className="text-green-500 mr-2" size={16} />
                                <span className="font-medium">Yerinden teslim</span>
                              </>
                            ) : (
                              <>
                                <XCircle className="text-red-500 mr-2" size={16} />
                                <span className="text-gray-500">Yerinden teslim yok</span>
                              </>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div className="space-y-4">
                    {product.year && (
                      <div className="flex items-center">
                        <Clock className="text-gray-400 mr-3" size={20} />
                        <div>
                          <div className="text-sm text-gray-600">Ãœretim YÄ±lÄ±</div>
                          <div className="font-medium">{product.year}</div>
                        </div>
                      </div>
                    )}
                    
                    {product.dimensions && (
                      <div className="flex items-center">
                        <Package className="text-gray-400 mr-3" size={20} />
                        <div>
                          <div className="text-sm text-gray-600">Boyutlar</div>
                          <div className="font-medium">{product.dimensions}</div>
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>
            
            {/* Benzer ÃœrÃ¼nler */}
            {similarProducts.length > 0 && (
              <div className="mt-8">
                <h2 className="text-2xl font-bold text-gray-900 mb-6">Benzer ÃœrÃ¼nler</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                  {similarProducts.map((similar) => (
                    <Link
                      key={similar.id}
                      href={`/product/${similar.id}`}
                      className="bg-white rounded-xl shadow hover:shadow-md transition-shadow overflow-hidden"
                    >
                      {similar.images && similar.images.length > 0 ? (
                        <div className="h-48 overflow-hidden">
                          <img
                            src={similar.images[0]}
                            alt={similar.title}
                            className="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
                          />
                        </div>
                      ) : (
                        <div className="h-48 bg-gray-100 flex items-center justify-center">
                          <Package className="text-gray-400" size={40} />
                        </div>
                      )}
                      <div className="p-4">
                        <h3 className="font-medium text-gray-900 line-clamp-2 mb-2">
                          {similar.title}
                        </h3>
                        <div className="flex justify-between items-center">
                          <span className="font-bold text-blue-600">
                            {similar.price.toLocaleString('tr-TR')} {similar.price_currency}
                          </span>
                          <span className="text-sm text-gray-500">
                            {similar.view_count || 0} gÃ¶rÃ¼ntÃ¼leme
                          </span>
                        </div>
                      </div>
                    </Link>
                  ))}
                </div>
              </div>
            )}
            
            {/* Reklam */}
            <div className="mt-8">
              <NativeAd />
            </div>
          </div>
          
          {/* SaÄŸ Kolon - Ä°ÅŸlemler ve MaÄŸaza */}
          <div className="space-y-6">
            {/* SatÄ±n Alma Ä°ÅŸlemleri */}
            <div className="bg-white rounded-2xl shadow-lg p-6 sticky top-6">
              <h3 className="text-lg font-bold text-gray-900 mb-4">SatÄ±n Alma</h3>
              
              <div className="space-y-4">
                {/* Miktar SeÃ§imi */}
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Miktar
                  </label>
                  <div className="flex items-center">
                    <button
                      onClick={() => setQuantity(Math.max(1, quantity - 1))}
                      className="w-10 h-10 flex items-center justify-center border border-gray-300 rounded-l-lg hover:bg-gray-100"
                    >
                      -
                    </button>
                    <div className="w-16 h-10 flex items-center justify-center border-t border-b border-gray-300">
                      {quantity}
                    </div>
                    <button
                      onClick={() => setQuantity(quantity + 1)}
                      className="w-10 h-10 flex items-center justify-center border border-gray-300 rounded-r-lg hover:bg-gray-100"
                    >
                      +
                    </button>
                  </div>
                </div>
                
                {/* Toplam Fiyat */}
                <div className="border-t border-gray-200 pt-4">
                  <div className="flex justify-between mb-2">
                    <span className="text-gray-600">Toplam:</span>
                    <span className="text-2xl font-bold text-gray-900">
                      {(product.price * quantity).toLocaleString('tr-TR')} {product.price_currency}
                    </span>
                  </div>
                  <div className="text-sm text-gray-500">
                    {quantity} adet Ã— {product.price.toLocaleString('tr-TR')} {product.price_currency}
                  </div>
                </div>
                
                {/* Butonlar */}
                <div className="space-y-3">
                  <button
                    onClick={handleContact}
                    className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-4 rounded-xl font-bold flex items-center justify-center"
                  >
                    <MessageCircle className="mr-2" size={20} />
                    MaÄŸaza ile Ä°letiÅŸime GeÃ§
                  </button>
                  
                  <button
                    onClick={handleAddToFavorites}
                    className={`w-full py-3 rounded-xl font-medium flex items-center justify-center ${
                      isFavorite
                        ? 'bg-red-50 text-red-700 hover:bg-red-100'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                    }`}
                  >
                    <Heart className="mr-2" size={20} />
                    {isFavorite ? 'Favorilerden Ã‡Ä±kar' : 'Favorilere Ekle'}
                  </button>
                  
                  <div className="flex space-x-3">
                    <div className="flex-1">
                    <SimpleShareButtons 
                        url={`/product/${productId}`}
                        title={product.title}
                    />
                    </div>
                  </div>
                </div>
              </div>
              
              {/* GÃ¼venlik Bilgileri */}
              <div className="mt-6 pt-6 border-t border-gray-200">
                <div className="flex items-center space-x-3 text-sm text-gray-600">
                  <Shield className="text-green-500" size={20} />
                  <span>GÃ¼venli alÄ±ÅŸveriÅŸ</span>
                </div>
                <div className="flex items-center space-x-3 text-sm text-gray-600 mt-2">
                  <CheckCircle className="text-green-500" size={20} />
                  <span>SpotItForMe garantisi</span>
                </div>
              </div>
            </div>
            
            {/* MaÄŸaza Bilgileri */}
            {shop && (
              <div className="bg-white rounded-2xl shadow-lg p-6">
                <div className="flex items-center mb-4">
                  <div className="w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center text-white text-xl font-bold mr-4">
                    {shop.shop_name.substring(0, 2).toUpperCase()}
                  </div>
                  <div>
                    <h3 className="font-bold text-gray-900">{shop.shop_name}</h3>
                    <p className="text-gray-600">{shop.city}</p>
                    {shop.is_verified && (
                      <div className="flex items-center mt-1">
                        <Shield className="text-green-500 mr-1" size={14} />
                        <span className="text-xs text-green-600">DoÄŸrulanmÄ±ÅŸ MaÄŸaza</span>
                      </div>
                    )}
                  </div>
                </div>
                
                <div className="space-y-3 mb-6">
                  {shop.description && (
                    <p className="text-gray-700 text-sm">{shop.description}</p>
                  )}
                  
                  <div className="space-y-2">
                    {shop.phone && (
                      <div className="flex items-center">
                        <Phone className="text-gray-400 mr-3" size={16} />
                        <a 
                          href={`tel:${shop.phone}`}
                          className="text-blue-600 hover:text-blue-800"
                        >
                          {shop.phone}
                        </a>
                      </div>
                    )}
                    
                    {shop.email && (
                      <div className="flex items-center">
                        <Mail className="text-gray-400 mr-3" size={16} />
                        <a 
                          href={`mailto:${shop.email}`}
                          className="text-blue-600 hover:text-blue-800"
                        >
                          {shop.email}
                        </a>
                      </div>
                    )}
                    
                    {shop.address && (
                      <div className="flex items-center">
                        <MapPin className="text-gray-400 mr-3" size={16} />
                        <span className="text-gray-700">{shop.address}</span>
                      </div>
                    )}
                  </div>
                </div>
                
                {/* Sosyal Medya */}
                <div className="flex space-x-3 mb-6">
                  {shop.website && (
                    <a
                      href={shop.website}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="p-2 bg-gray-100 hover:bg-gray-200 rounded-lg"
                    >
                      <Globe size={20} className="text-gray-600" />
                    </a>
                  )}
                  
                  {shop.instagram && (
                    <a
                      href={`https://instagram.com/${shop.instagram}`}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="p-2 bg-gray-100 hover:bg-gray-200 rounded-lg"
                    >
                      <Instagram size={20} className="text-gray-600" />
                    </a>
                  )}
                </div>
                
                <Link
                  href={`/shop/${shop.id}`}
                  className="block w-full bg-blue-50 hover:bg-blue-100 text-blue-700 text-center py-3 rounded-xl font-medium"
                >
                  MaÄŸazayÄ± Ziyaret Et
                </Link>
              </div>
            )}
            
            {/* Ä°statistikler */}
            <div className="bg-white rounded-2xl shadow-lg p-6">
              <h3 className="font-bold text-gray-900 mb-4">ÃœrÃ¼n Ä°statistikleri</h3>
              <div className="space-y-4">
                <div className="flex justify-between">
                  <span className="text-gray-600">GÃ¶rÃ¼ntÃ¼lenme:</span>
                  <span className="font-bold">{product.view_count || 0}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Favorilere Ekleme:</span>
                  <span className="font-bold">{product.wishlist_count || 0}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Son GÃ¶rÃ¼ntÃ¼lenme:</span>
                  <span className="font-bold text-sm">
                    {product.last_viewed_at 
                      ? new Date(product.last_viewed_at).toLocaleDateString('tr-TR')
                      : 'Yeni'}
                  </span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">OluÅŸturulma:</span>
                  <span className="font-bold text-sm">
                    {new Date(product.created_at).toLocaleDateString('tr-TR')}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

ğŸ“„ app/products/[id]/page.tsx
ğŸ“Š 656 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/product/[id]/page.tsx - KULLANICILAR Ä°Ã‡Ä°N ÃœRÃœN DETAY
'use client';

import { useState, useEffect } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { supabase } from '@/lib/supabase';
import { 
  ArrowLeft, Heart, Share2, ShoppingCart, MessageCircle,
  MapPin, Truck, Star, Shield, Clock, Package,
  CheckCircle, XCircle, Phone, Mail, Instagram, Globe
} from 'lucide-react';
import Link from 'next/link';
import SimpleShareButtons from '@/components/SimpleShareButtons';
import NativeAd from '@/components/NativeAd';

export default function ProductPage() {
  const params = useParams();
  const router = useRouter();
  const productId = params.id as string;
  
  const [product, setProduct] = useState<any>(null);
  const [shop, setShop] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const [similarProducts, setSimilarProducts] = useState<any[]>([]);
  const [activeImageIndex, setActiveImageIndex] = useState(0);
  const [isFavorite, setIsFavorite] = useState(false);
  const [quantity, setQuantity] = useState(1);

  useEffect(() => {
    loadProduct();
  }, [productId]);

  const loadProduct = async () => {
    try {
      setLoading(true);
      
      // ÃœrÃ¼n bilgilerini getir
      const { data: productData, error } = await supabase
        .from('shop_inventory')
        .select('*')
        .eq('id', productId)
        .eq('status', 'active')
        .single();

      if (error) throw error;
      setProduct(productData);

      // MaÄŸaza bilgilerini getir
      if (productData.shop_id) {
        const { data: shopData } = await supabase
          .from('shops')
          .select('*')
          .eq('id', productData.shop_id)
          .eq('is_active', true)
          .single();
        
        setShop(shopData);
      }

      // GÃ¶rÃ¼ntÃ¼leme sayÄ±sÄ±nÄ± artÄ±r
      await supabase
        .from('shop_inventory')
        .update({ 
          view_count: (productData.view_count || 0) + 1,
          last_viewed_at: new Date().toISOString()
        })
        .eq('id', productId);

      // Benzer Ã¼rÃ¼nleri getir
      if (productData.category) {
        const { data: similar } = await supabase
          .from('shop_inventory')
          .select('*')
          .eq('category', productData.category)
          .eq('status', 'active')
          .neq('id', productId)
          .limit(4);

        setSimilarProducts(similar || []);
      }

    } catch (error) {
      console.error('ÃœrÃ¼n yÃ¼klenemedi:', error);
      router.push('/');
    } finally {
      setLoading(false);
    }
  };

  const handleContact = () => {
    if (shop?.phone) {
      window.open(`tel:${shop.phone}`, '_blank');
    } else if (shop?.email) {
      window.open(`mailto:${shop.email}`, '_blank');
    } else {
      alert('MaÄŸaza iletiÅŸim bilgileri bulunamadÄ±');
    }
  };

  const handleAddToFavorites = async () => {
    // TODO: Favorilere ekleme iÅŸlemi
    setIsFavorite(!isFavorite);
    alert(isFavorite ? 'Favorilerden Ã§Ä±karÄ±ldÄ±' : 'Favorilere eklendi');
  };

  const parseShippingOptions = (options: any) => {
    if (!options) return { shipping: false, local_pickup: false };
    
    if (typeof options === 'string') {
      try {
        return JSON.parse(options);
      } catch (error) {
        return { shipping: false, local_pickup: false };
      }
    }
    
    return options;
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="container mx-auto px-4">
          <div className="text-center py-12">
            <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
            <p className="mt-4 text-gray-600">ÃœrÃ¼n yÃ¼kleniyor...</p>
          </div>
        </div>
      </div>
    );
  }

  if (!product) {
    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="container mx-auto px-4">
          <div className="text-center py-12">
            <Package className="mx-auto text-gray-400 mb-4" size={48} />
            <h1 className="text-2xl font-bold text-gray-900 mb-4">ÃœrÃ¼n bulunamadÄ±</h1>
            <p className="text-gray-600 mb-8">Bu Ã¼rÃ¼n silinmiÅŸ veya mevcut deÄŸil.</p>
            <button
              onClick={() => router.push('/')}
              className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg"
            >
              Ana Sayfaya DÃ¶n
            </button>
          </div>
        </div>
      </div>
    );
  }

  const shippingOptions = parseShippingOptions(product.shipping_options);
  const discountPercent = product.discount_percent 
    ? Math.round((1 - product.price / product.original_price) * 100)
    : null;

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Ãœst Navigasyon */}
      <div className="bg-white shadow">
        <div className="container mx-auto px-4 py-3">
          <button
            onClick={() => router.back()}
            className="text-gray-600 hover:text-gray-900 flex items-center"
          >
            <ArrowLeft className="mr-2" size={20} />
            Geri DÃ¶n
          </button>
        </div>
      </div>

      <div className="container mx-auto px-4 py-8">
        <div className="grid lg:grid-cols-3 gap-8">
          {/* Sol Kolon - ÃœrÃ¼n Resimleri */}
          <div className="lg:col-span-2">
            <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
              {/* Resimler */}
              {product.images && product.images.length > 0 ? (
                <div>
                  {/* BÃ¼yÃ¼k Resim */}
                  <div className="relative h-96 bg-gray-100">
                    <img
                      src={product.images[activeImageIndex]}
                      alt={product.title}
                      className="w-full h-full object-contain"
                    />
                    
                    {/* Favori Butonu */}
                    <button
                      onClick={handleAddToFavorites}
                      className="absolute top-4 right-4 bg-white p-3 rounded-full shadow-lg hover:bg-gray-100"
                    >
                      <Heart 
                        size={24} 
                        className={isFavorite ? 'text-red-500 fill-red-500' : 'text-gray-400'} 
                      />
                    </button>
                    
                    {/* Ä°ndirim Badge */}
                    {discountPercent && (
                      <div className="absolute top-4 left-4 bg-red-500 text-white px-4 py-2 rounded-lg font-bold">
                        -%{discountPercent}
                      </div>
                    )}
                  </div>
                  
                  {/* KÃ¼Ã§Ã¼k Resimler */}
                  {product.images.length > 1 && (
                    <div className="p-4 border-t">
                      <div className="flex space-x-2 overflow-x-auto">
                        {product.images.map((image: string, index: number) => (
                          <button
                            key={index}
                            onClick={() => setActiveImageIndex(index)}
                            className={`flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden ${
                              activeImageIndex === index 
                                ? 'ring-2 ring-blue-500' 
                                : 'opacity-75 hover:opacity-100'
                            }`}
                          >
                            <img
                              src={image}
                              alt={`${product.title} - ${index + 1}`}
                              className="w-full h-full object-cover"
                            />
                          </button>
                        ))}
                      </div>
                    </div>
                  )}
                </div>
              ) : (
                <div className="h-96 bg-gray-100 flex items-center justify-center">
                  <Package className="text-gray-400" size={64} />
                </div>
              )}
              
              {/* ÃœrÃ¼n Bilgileri */}
              <div className="p-6">
                <div className="mb-6">
                  <div className="flex items-center flex-wrap gap-2 mb-3">
                    <span className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
                      {product.category || 'DiÄŸer'}
                    </span>
                    {product.brand && (
                      <span className="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm">
                        {product.brand}
                      </span>
                    )}
                    {product.condition && (
                      <span className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">
                        {product.condition === 'new' ? 'SÄ±fÄ±r' : 
                         product.condition === 'like_new' ? 'Az KullanÄ±lmÄ±ÅŸ' : 
                         product.condition === 'used' ? 'KullanÄ±lmÄ±ÅŸ' : 'Fabrika Ã‡Ä±kÄ±ÅŸlÄ±'}
                      </span>
                    )}
                  </div>
                  
                  <h1 className="text-3xl font-bold text-gray-900 mb-4">
                    {product.title}
                  </h1>
                  
                  <div className="flex items-center mb-6">
                    <div className="flex items-center mr-4">
                      {[...Array(5)].map((_, i) => (
                        <Star
                          key={i}
                          size={20}
                          className={`${
                            i < 4 ? 'text-yellow-400 fill-yellow-400' : 'text-gray-300'
                          }`}
                        />
                      ))}
                      <span className="ml-2 text-gray-600">(4.0)</span>
                    </div>
                    <span className="text-gray-500">
                      {product.view_count || 0} gÃ¶rÃ¼ntÃ¼lenme
                    </span>
                  </div>
                </div>
                
                {/* Fiyat */}
                <div className="mb-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl">
                  <div className="flex items-end">
                    <div className="mr-6">
                      <div className="text-4xl font-bold text-gray-900">
                        {product.price.toLocaleString('tr-TR')} {product.price_currency}
                      </div>
                      {product.original_price && product.original_price > product.price && (
                        <div className="text-xl text-gray-500 line-through">
                          {product.original_price.toLocaleString('tr-TR')} {product.price_currency}
                        </div>
                      )}
                    </div>
                    
                    <div className="flex-1">
                      <div className="text-sm text-gray-600 mb-2">Stok Durumu:</div>
                      <div className={`inline-flex items-center px-4 py-2 rounded-full font-medium ${
                        product.quantity > 0 
                          ? 'bg-green-100 text-green-800' 
                          : 'bg-red-100 text-red-800'
                      }`}>
                        {product.quantity > 0 
                          ? `âœ… ${product.quantity} adet stokta` 
                          : 'âŒ Stokta yok'}
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* AÃ§Ä±klama */}
                <div className="mb-8">
                  <h2 className="text-xl font-bold text-gray-900 mb-4">ÃœrÃ¼n AÃ§Ä±klamasÄ±</h2>
                  <div className="text-gray-700 whitespace-pre-line bg-gray-50 p-6 rounded-lg">
                    {product.description || 'AÃ§Ä±klama eklenmemiÅŸ.'}
                  </div>
                </div>
                
                {/* Detaylar */}
                <div className="grid md:grid-cols-2 gap-6">
                  <div className="space-y-4">
                    <div className="flex items-center">
                      <MapPin className="text-gray-400 mr-3" size={20} />
                      <div>
                        <div className="text-sm text-gray-600">Konum</div>
                        <div className="font-medium">{product.location || shop?.city || 'BelirtilmemiÅŸ'}</div>
                      </div>
                    </div>
                    
                    <div className="flex items-center">
                      <Truck className="text-gray-400 mr-3" size={20} />
                      <div>
                        <div className="text-sm text-gray-600">Kargo SeÃ§enekleri</div>
                        <div className="space-y-1">
                          <div className="flex items-center">
                            {shippingOptions.shipping ? (
                              <>
                                <CheckCircle className="text-green-500 mr-2" size={16} />
                                <span className="font-medium">Kargo ile gÃ¶nderim</span>
                              </>
                            ) : (
                              <>
                                <XCircle className="text-red-500 mr-2" size={16} />
                                <span className="text-gray-500">Kargo yok</span>
                              </>
                            )}
                          </div>
                          <div className="flex items-center">
                            {shippingOptions.local_pickup ? (
                              <>
                                <CheckCircle className="text-green-500 mr-2" size={16} />
                                <span className="font-medium">Yerinden teslim</span>
                              </>
                            ) : (
                              <>
                                <XCircle className="text-red-500 mr-2" size={16} />
                                <span className="text-gray-500">Yerinden teslim yok</span>
                              </>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div className="space-y-4">
                    {product.year && (
                      <div className="flex items-center">
                        <Clock className="text-gray-400 mr-3" size={20} />
                        <div>
                          <div className="text-sm text-gray-600">Ãœretim YÄ±lÄ±</div>
                          <div className="font-medium">{product.year}</div>
                        </div>
                      </div>
                    )}
                    
                    {product.dimensions && (
                      <div className="flex items-center">
                        <Package className="text-gray-400 mr-3" size={20} />
                        <div>
                          <div className="text-sm text-gray-600">Boyutlar</div>
                          <div className="font-medium">{product.dimensions}</div>
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>
            
            {/* Benzer ÃœrÃ¼nler */}
            {similarProducts.length > 0 && (
              <div className="mt-8">
                <h2 className="text-2xl font-bold text-gray-900 mb-6">Benzer ÃœrÃ¼nler</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                  {similarProducts.map((similar) => (
                    <Link
                      key={similar.id}
                      href={`/product/${similar.id}`}
                      className="bg-white rounded-xl shadow hover:shadow-md transition-shadow overflow-hidden"
                    >
                      {similar.images && similar.images.length > 0 ? (
                        <div className="h-48 overflow-hidden">
                          <img
                            src={similar.images[0]}
                            alt={similar.title}
                            className="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
                          />
                        </div>
                      ) : (
                        <div className="h-48 bg-gray-100 flex items-center justify-center">
                          <Package className="text-gray-400" size={40} />
                        </div>
                      )}
                      <div className="p-4">
                        <h3 className="font-medium text-gray-900 line-clamp-2 mb-2">
                          {similar.title}
                        </h3>
                        <div className="flex justify-between items-center">
                          <span className="font-bold text-blue-600">
                            {similar.price.toLocaleString('tr-TR')} {similar.price_currency}
                          </span>
                          <span className="text-sm text-gray-500">
                            {similar.view_count || 0} gÃ¶rÃ¼ntÃ¼leme
                          </span>
                        </div>
                      </div>
                    </Link>
                  ))}
                </div>
              </div>
            )}
            
            {/* Reklam */}
            <div className="mt-8">
              <NativeAd />
            </div>
          </div>
          
          {/* SaÄŸ Kolon - Ä°ÅŸlemler ve MaÄŸaza */}
          <div className="space-y-6">
            {/* SatÄ±n Alma Ä°ÅŸlemleri */}
            <div className="bg-white rounded-2xl shadow-lg p-6 sticky top-6">
              <h3 className="text-lg font-bold text-gray-900 mb-4">SatÄ±n Alma</h3>
              
              <div className="space-y-4">
                {/* Miktar SeÃ§imi */}
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Miktar
                  </label>
                  <div className="flex items-center">
                    <button
                      onClick={() => setQuantity(Math.max(1, quantity - 1))}
                      className="w-10 h-10 flex items-center justify-center border border-gray-300 rounded-l-lg hover:bg-gray-100"
                    >
                      -
                    </button>
                    <div className="w-16 h-10 flex items-center justify-center border-t border-b border-gray-300">
                      {quantity}
                    </div>
                    <button
                      onClick={() => setQuantity(quantity + 1)}
                      className="w-10 h-10 flex items-center justify-center border border-gray-300 rounded-r-lg hover:bg-gray-100"
                    >
                      +
                    </button>
                  </div>
                </div>
                
                {/* Toplam Fiyat */}
                <div className="border-t border-gray-200 pt-4">
                  <div className="flex justify-between mb-2">
                    <span className="text-gray-600">Toplam:</span>
                    <span className="text-2xl font-bold text-gray-900">
                      {(product.price * quantity).toLocaleString('tr-TR')} {product.price_currency}
                    </span>
                  </div>
                  <div className="text-sm text-gray-500">
                    {quantity} adet Ã— {product.price.toLocaleString('tr-TR')} {product.price_currency}
                  </div>
                </div>
                
                {/* Butonlar */}
                <div className="space-y-3">
                  <button
                    onClick={handleContact}
                    className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-4 rounded-xl font-bold flex items-center justify-center"
                  >
                    <MessageCircle className="mr-2" size={20} />
                    MaÄŸaza ile Ä°letiÅŸime GeÃ§
                  </button>
                  
                  <button
                    onClick={handleAddToFavorites}
                    className={`w-full py-3 rounded-xl font-medium flex items-center justify-center ${
                      isFavorite
                        ? 'bg-red-50 text-red-700 hover:bg-red-100'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                    }`}
                  >
                    <Heart className="mr-2" size={20} />
                    {isFavorite ? 'Favorilerden Ã‡Ä±kar' : 'Favorilere Ekle'}
                  </button>
                  
                  <div className="flex space-x-3">
                    <div className="flex-1">
                    <SimpleShareButtons 
                        url={`/product/${productId}`}
                        title={product.title}
                    />
                    </div>
                  </div>
                </div>
              </div>
              
              {/* GÃ¼venlik Bilgileri */}
              <div className="mt-6 pt-6 border-t border-gray-200">
                <div className="flex items-center space-x-3 text-sm text-gray-600">
                  <Shield className="text-green-500" size={20} />
                  <span>GÃ¼venli alÄ±ÅŸveriÅŸ</span>
                </div>
                <div className="flex items-center space-x-3 text-sm text-gray-600 mt-2">
                  <CheckCircle className="text-green-500" size={20} />
                  <span>SpotItForMe garantisi</span>
                </div>
              </div>
            </div>
            
            {/* MaÄŸaza Bilgileri */}
            {shop && (
              <div className="bg-white rounded-2xl shadow-lg p-6">
                <div className="flex items-center mb-4">
                  <div className="w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center text-white text-xl font-bold mr-4">
                    {shop.shop_name.substring(0, 2).toUpperCase()}
                  </div>
                  <div>
                    <h3 className="font-bold text-gray-900">{shop.shop_name}</h3>
                    <p className="text-gray-600">{shop.city}</p>
                    {shop.is_verified && (
                      <div className="flex items-center mt-1">
                        <Shield className="text-green-500 mr-1" size={14} />
                        <span className="text-xs text-green-600">DoÄŸrulanmÄ±ÅŸ MaÄŸaza</span>
                      </div>
                    )}
                  </div>
                </div>
                
                <div className="space-y-3 mb-6">
                  {shop.description && (
                    <p className="text-gray-700 text-sm">{shop.description}</p>
                  )}
                  
                  <div className="space-y-2">
                    {shop.phone && (
                      <div className="flex items-center">
                        <Phone className="text-gray-400 mr-3" size={16} />
                        <a 
                          href={`tel:${shop.phone}`}
                          className="text-blue-600 hover:text-blue-800"
                        >
                          {shop.phone}
                        </a>
                      </div>
                    )}
                    
                    {shop.email && (
                      <div className="flex items-center">
                        <Mail className="text-gray-400 mr-3" size={16} />
                        <a 
                          href={`mailto:${shop.email}`}
                          className="text-blue-600 hover:text-blue-800"
                        >
                          {shop.email}
                        </a>
                      </div>
                    )}
                    
                    {shop.address && (
                      <div className="flex items-center">
                        <MapPin className="text-gray-400 mr-3" size={16} />
                        <span className="text-gray-700">{shop.address}</span>
                      </div>
                    )}
                  </div>
                </div>
                
                {/* Sosyal Medya */}
                <div className="flex space-x-3 mb-6">
                  {shop.website && (
                    <a
                      href={shop.website}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="p-2 bg-gray-100 hover:bg-gray-200 rounded-lg"
                    >
                      <Globe size={20} className="text-gray-600" />
                    </a>
                  )}
                  
                  {shop.instagram && (
                    <a
                      href={`https://instagram.com/${shop.instagram}`}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="p-2 bg-gray-100 hover:bg-gray-200 rounded-lg"
                    >
                      <Instagram size={20} className="text-gray-600" />
                    </a>
                  )}
                </div>
                
                <Link
                  href={`/shop/${shop.id}`}
                  className="block w-full bg-blue-50 hover:bg-blue-100 text-blue-700 text-center py-3 rounded-xl font-medium"
                >
                  MaÄŸazayÄ± Ziyaret Et
                </Link>
              </div>
            )}
            
            {/* Ä°statistikler */}
            <div className="bg-white rounded-2xl shadow-lg p-6">
              <h3 className="font-bold text-gray-900 mb-4">ÃœrÃ¼n Ä°statistikleri</h3>
              <div className="space-y-4">
                <div className="flex justify-between">
                  <span className="text-gray-600">GÃ¶rÃ¼ntÃ¼lenme:</span>
                  <span className="font-bold">{product.view_count || 0}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Favorilere Ekleme:</span>
                  <span className="font-bold">{product.wishlist_count || 0}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Son GÃ¶rÃ¼ntÃ¼lenme:</span>
                  <span className="font-bold text-sm">
                    {product.last_viewed_at 
                      ? new Date(product.last_viewed_at).toLocaleDateString('tr-TR')
                      : 'Yeni'}
                  </span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">OluÅŸturulma:</span>
                  <span className="font-bold text-sm">
                    {new Date(product.created_at).toLocaleDateString('tr-TR')}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

ğŸ“„ app/products/page.tsx
ğŸ“Š 171 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/products/page.tsx - DÃœZELTÄ°LMÄ°Å
'use client';

import { useState, useEffect } from 'react';
import { supabase } from '@/lib/supabase';
import ShopProductCard from '@/components/ShopProductCard';
import { Search, Filter, Loader2 } from 'lucide-react';

// Type tanÄ±mlamalarÄ±
interface Product {
  id: string;
  title: string;
  description: string | null;
  category: string | null;
  price: number;
  price_currency: string;
  images: string[];
  status: string;
  shop_id: string;
  // DiÄŸer alanlar...
}

interface CategoryItem {
  category: string | null;
}

export default function ProductsPage() {
  const [products, setProducts] = useState<Product[]>([]);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState('');
  const [categoryFilter, setCategoryFilter] = useState('all');
  const [categories, setCategories] = useState<string[]>([]);

  useEffect(() => {
    loadProducts();
  }, []);

  const loadProducts = async () => {
    try {
      setLoading(true);
      
      let query = supabase
        .from('shop_inventory')
        .select('*')
        .eq('status', 'active')
        .order('created_at', { ascending: false });

      if (searchQuery) {
        query = query.or(`title.ilike.%${searchQuery}%,description.ilike.%${searchQuery}%`);
      }

      if (categoryFilter !== 'all') {
        query = query.eq('category', categoryFilter);
      }

      const { data, error } = await query;

      if (error) throw error;
      setProducts(data || []);

      // Kategorileri al
      const { data: categoriesData } = await supabase
        .from('shop_inventory')
        .select('category')
        .not('category', 'is', null);

      if (categoriesData) {
        const categoryMap: Record<string, boolean> = {};
        categoriesData.forEach((item: CategoryItem) => {  // DÃœZELTME BURADA
          if (item.category) {
            categoryMap[item.category] = true;
          }
        });
        setCategories(Object.keys(categoryMap));
      }

    } catch (error) {
      console.error('ÃœrÃ¼nler yÃ¼klenemedi:', error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="container mx-auto px-4">
        {/* BaÅŸlÄ±k */}
        <div className="mb-8">
          <h1 className="text-3xl font-bold text-gray-900 mb-2">TÃ¼m ÃœrÃ¼nler</h1>
          <p className="text-gray-600">MaÄŸazalarÄ±mÄ±zÄ±n sunduÄŸu tÃ¼m Ã¼rÃ¼nleri keÅŸfedin</p>
        </div>

        {/* Filtreler */}
        <div className="bg-white rounded-xl shadow p-6 mb-6">
          <div className="grid md:grid-cols-3 gap-4">
            {/* Arama */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                ÃœrÃ¼n Ara
              </label>
              <div className="relative">
                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={20} />
                <input
                  type="text"
                  value={searchQuery}
                  onChange={(e) => setSearchQuery(e.target.value)}
                  onKeyPress={(e) => e.key === 'Enter' && loadProducts()}
                  placeholder="Ne aradÄ±nÄ±z?"
                  className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                />
              </div>
            </div>

            {/* Kategori */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Kategori
              </label>
              <select
                value={categoryFilter}
                onChange={(e) => setCategoryFilter(e.target.value)}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              >
                <option value="all">TÃ¼m Kategoriler</option>
                {categories.map((cat) => (
                  <option key={cat} value={cat}>{cat}</option>
                ))}
              </select>
            </div>

            {/* Filtre Butonu */}
            <div className="flex items-end">
              <button
                onClick={loadProducts}
                className="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg flex items-center justify-center"
              >
                <Filter className="mr-2" size={20} />
                Filtrele
              </button>
            </div>
          </div>
        </div>

        {/* ÃœrÃ¼nler */}
        {loading ? (
          <div className="text-center py-12">
            <Loader2 className="animate-spin mx-auto text-blue-600 mb-4" size={48} />
            <p className="text-gray-600">ÃœrÃ¼nler yÃ¼kleniyor...</p>
          </div>
        ) : products.length === 0 ? (
          <div className="text-center py-12">
            <div className="text-4xl mb-4">ğŸ”</div>
            <h3 className="text-lg font-bold text-gray-900 mb-2">ÃœrÃ¼n bulunamadÄ±</h3>
            <p className="text-gray-600">Arama kriterlerinize uygun Ã¼rÃ¼n bulunamadÄ±.</p>
          </div>
        ) : (
          <>
            <div className="mb-4 text-gray-600">
              {products.length} Ã¼rÃ¼n bulundu
            </div>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
              {products.map((product) => (
                <ShopProductCard key={product.id} product={product} />
              ))}
            </div>
          </>
        )}
      </div>
    </div>
  );
}

ğŸ“„ app/profile/[id]/page.tsx
ğŸ“Š 327 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/profile/[id]/page.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { useParams, useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Header from '@/components/Header'
import Footer from '@/components/Footer'
import UserProfileCard from '@/components/UserProfileCard'
import SimpleTabs from '@/components/SimpleTabs'

type TabType = 'sightings' | 'spots' | 'reputation'

interface UserProfile {
  id: string
  name: string
  email: string
  avatar_url: string | null
  bio: string | null
  location: string | null
  created_at: string
}

export default function UserProfilePage() {
  const params = useParams()
  const router = useRouter()
  const userId = params.id as string
  
  const [user, setUser] = useState<UserProfile | null>(null)
  const [sightings, setSightings] = useState<any[]>([])
  const [spots, setSpots] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [activeTab, setActiveTab] = useState<TabType>('sightings')
  const [isCurrentUser, setIsCurrentUser] = useState(false)

  // Tab tanÄ±mlarÄ± - tip gÃ¼venli
  const tabs: { id: TabType; label: string }[] = [
    { id: 'sightings', label: `ğŸ‘ï¸ GÃ¶rÃ¼lenler (${sightings.length})` },
    { id: 'spots', label: `ğŸ“ Spot'lar (${spots.length})` },
    { id: 'reputation', label: 'ğŸ† Puan & Rozetler' }
  ]

  useEffect(() => {
    if (userId) {
      fetchUserData()
    }
  }, [userId])

  const fetchUserData = async () => {
    try {
      // Mevcut kullanÄ±cÄ± kontrolÃ¼
      const { data: { user: currentUser } } = await supabase.auth.getUser()
      setIsCurrentUser(currentUser?.id === userId)

      // KullanÄ±cÄ± bilgileri
      const { data: userData } = await supabase
        .from('user_profiles')
        .select('*')
        .eq('id', userId)
        .single()

      // Sightings
      const { data: sightingsData } = await supabase
        .from('quick_sightings')
        .select('*')
        .eq('user_id', userId)
        .eq('status', 'active')
        .order('created_at', { ascending: false })

      // Spots
      const { data: spotsData } = await supabase
        .from('spots')
        .select('*')
        .eq('user_id', userId)
        .order('created_at', { ascending: false })

      setUser(userData)
      setSightings(sightingsData || [])
      setSpots(spotsData || [])
    } catch (error) {
      console.error('Profil yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  // Tab deÄŸiÅŸtirme fonksiyonu - tip gÃ¼venli
  const handleTabChange = (tabId: string) => {
    // Type assertion ile tip gÃ¼venli hale getir
    if (tabId === 'sightings' || tabId === 'spots' || tabId === 'reputation') {
      setActiveTab(tabId)
    }
  }

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        <main className="container-custom py-12 text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">YÃ¼kleniyor...</p>
        </main>
        <Footer />
      </div>
    )
  }

  if (!user) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        <main className="container-custom py-12 text-center">
          <h1 className="text-2xl font-bold text-gray-900 mb-4">KullanÄ±cÄ± bulunamadÄ±</h1>
          <button
            onClick={() => router.push('/')}
            className="text-blue-600 hover:text-blue-800"
          >
            Ana sayfaya dÃ¶n
          </button>
        </main>
        <Footer />
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8">
        {/* Ãœst Bilgi */}
        <div className="bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl p-8 text-white mb-8">
          <div className="flex items-center justify-between">
            <div className="flex items-center space-x-6">
              <div className="relative">
                <div className="w-24 h-24 bg-white rounded-full flex items-center justify-center">
                  {user.avatar_url ? (
                    <img
                      src={user.avatar_url}
                      alt={user.name}
                      className="w-full h-full rounded-full object-cover"
                    />
                  ) : (
                    <div className="text-3xl font-bold text-blue-600">
                      {user.name[0].toUpperCase()}
                    </div>
                  )}
                </div>
                <div className="absolute -bottom-2 -right-2 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-bold">
                  ğŸ‘ï¸ {sightings.length}
                </div>
              </div>
              
              <div>
                <h1 className="text-3xl font-bold mb-2">{user.name}</h1>
                {user.bio && <p className="text-blue-100">{user.bio}</p>}
                {user.location && (
                  <p className="text-blue-100 text-sm mt-2">ğŸ“ {user.location}</p>
                )}
                <p className="text-blue-100 text-sm mt-2">
                  Ãœyelik: {new Date(user.created_at).toLocaleDateString('tr-TR')}
                </p>
              </div>
            </div>
            
            {isCurrentUser && (
              <button
                onClick={() => router.push('/profile/edit')}
                className="bg-white text-blue-600 hover:bg-gray-100 font-bold py-2 px-6 rounded-lg"
              >
                Profili DÃ¼zenle
              </button>
            )}
          </div>
        </div>

        {/* Ä°statistikler */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
          <div className="bg-white rounded-xl p-6 shadow text-center">
            <div className="text-2xl font-bold text-blue-600 mb-2">
              {sightings.length}
            </div>
            <div className="text-gray-600">GÃ¶rÃ¼len ÃœrÃ¼n</div>
          </div>
          <div className="bg-white rounded-xl p-6 shadow text-center">
            <div className="text-2xl font-bold text-green-600 mb-2">
              {spots.length}
            </div>
            <div className="text-gray-600">OluÅŸturulan Spot</div>
          </div>
          <div className="bg-white rounded-xl p-6 shadow text-center">
            <div className="text-2xl font-bold text-purple-600 mb-2">
              {sightings.filter(s => s.has_photo).length}
            </div>
            <div className="text-gray-600">FotoÄŸraflÄ± Bildirim</div>
          </div>
          <div className="bg-white rounded-xl p-6 shadow text-center">
            <div className="text-2xl font-bold text-orange-600 mb-2">
              {sightings.reduce((sum, s) => sum + s.points_earned, 0)}
            </div>
            <div className="text-gray-600">Toplam Puan</div>
          </div>
        </div>

        {/* Tab'ler */}
        <div className="bg-white rounded-xl shadow mb-6">
          <SimpleTabs 
            tabs={tabs}
            activeTab={activeTab}
            onTabChange={handleTabChange}
          />
        </div>

        {/* Ä°Ã§erik */}
        <div className="min-h-[400px]">
          {activeTab === 'sightings' && (
            <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
              {sightings.length === 0 ? (
                <div className="col-span-full text-center py-12">
                  <div className="text-4xl mb-4">ğŸ‘ï¸</div>
                  <h3 className="text-xl font-bold text-gray-900 mb-2">
                    HenÃ¼z gÃ¶rÃ¼len Ã¼rÃ¼n yok
                  </h3>
                  <p className="text-gray-600">
                    {isCurrentUser 
                      ? 'Ä°lk "Nadir GÃ¶rdÃ¼m" bildirimini sen yap!'
                      : 'Bu kullanÄ±cÄ± henÃ¼z bildirim yapmamÄ±ÅŸ'}
                  </p>
                </div>
              ) : (
                sightings.map((sighting) => (
                  <div
                    key={sighting.id}
                    className="bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition"
                  >
                    {sighting.photo_url && (
                      <div className="h-48">
                        <img
                          src={sighting.photo_url}
                          alt={sighting.description}
                          className="w-full h-full object-cover"
                        />
                      </div>
                    )}
                    
                    <div className="p-4">
                      <p className="font-medium mb-3 line-clamp-2">
                        {sighting.description}
                      </p>
                      
                      <div className="flex items-center text-sm text-gray-600 mb-3">
                        <span className="mr-2">ğŸ“</span>
                        <span className="truncate">{sighting.location_name}</span>
                      </div>
                      
                      <div className="flex justify-between items-center">
                        <div className="text-sm text-gray-500">
                          {new Date(sighting.created_at).toLocaleDateString('tr-TR')}
                        </div>
                        <div className="text-green-600 font-bold">
                          +{sighting.points_earned} puan
                        </div>
                      </div>
                    </div>
                  </div>
                ))
              )}
            </div>
          )}

          {activeTab === 'spots' && (
            <div className="bg-white rounded-xl shadow p-6">
              <h3 className="font-bold text-lg mb-4">ğŸ“ Spot'lar</h3>
              {spots.length === 0 ? (
                <div className="text-center py-8">
                  <div className="text-4xl mb-4">ğŸ“</div>
                  <p className="text-gray-600">
                    HenÃ¼z spot oluÅŸturulmamÄ±ÅŸ
                  </p>
                </div>
              ) : (
                <div className="space-y-4">
                  {spots.map((spot) => (
                    <div 
                      key={spot.id} 
                      className="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 cursor-pointer"
                      onClick={() => router.push(`/spots/${spot.id}`)}
                    >
                      <div className="flex items-start justify-between">
                        <div>
                          <h4 className="font-medium text-gray-900">{spot.title}</h4>
                          <p className="text-sm text-gray-600 mt-1 line-clamp-2">
                            {spot.description}
                          </p>
                        </div>
                        <span className={`px-2 py-1 text-xs rounded-full ${
                          spot.status === 'active' 
                            ? 'bg-green-100 text-green-800' 
                            : 'bg-blue-100 text-blue-800'
                        }`}>
                          {spot.status === 'active' ? 'Aktif' : 'Bulundu'}
                        </span>
                      </div>
                      <div className="flex items-center text-sm text-gray-500 mt-3">
                        <span className="mr-4">ğŸ‘ï¸ {spot.views || 0}</span>
                        <span>ğŸ¤ {spot.helps || 0}</span>
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          {activeTab === 'reputation' && (
            <div className="bg-white rounded-xl shadow p-6">
              <h3 className="font-bold text-lg mb-4">ğŸ† Puan & Rozetler</h3>
              <UserProfileCard userId={userId} />
            </div>
          )}
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/profile/page.tsx
ğŸ“Š 529 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/profile/page.tsx - DÃœZELTMÄ°Å VERSÄ°YON
'use client'

import { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Link from 'next/link'

interface UserProfile {
  id: string
  email: string
  name: string | null
  avatar_url: string | null
  created_at: string
}

interface UserSpot {
  id: string
  title: string
  status: string
  created_at: string
  helps: number
  views: number
  category: string | null
}

interface UserShop {
  id: string
  shop_name: string
  city: string
  subscription_type: string
  is_verified: boolean
}

export default function ProfilePage() {
  const router = useRouter()
  const [user, setUser] = useState<UserProfile | null>(null)
  const [userSpots, setUserSpots] = useState<UserSpot[]>([])
  const [userShop, setUserShop] = useState<UserShop | null>(null)
  const [loading, setLoading] = useState(true)
  const [activeTab, setActiveTab] = useState<'spots' | 'help' | 'shop' | 'settings'>('spots')

  useEffect(() => {
    checkAuth()
  }, [])

  const checkAuth = async () => {
    const { data: { user: authUser } } = await supabase.auth.getUser()
    
    if (!authUser) {
      router.push('/')
      return
    }
    
    fetchUserData(authUser.id)
  }

  const fetchUserData = async (userId: string) => {
    try {
      // KullanÄ±cÄ± bilgileri
      const { data: userData } = await supabase
        .from('user_profiles')
        .select('*')
        .eq('id', userId)
        .single()

      // KullanÄ±cÄ±nÄ±n spot'larÄ±
      const { data: spotsData } = await supabase
        .from('spots')
        .select('id, title, status, created_at, helps, views, category')
        .eq('user_id', userId)
        .order('created_at', { ascending: false })

      // KullanÄ±cÄ±nÄ±n maÄŸazasÄ±
      const { data: shopData } = await supabase
        .from('shops')
        .select('id, shop_name, city, subscription_type, is_verified')
        .eq('owner_id', userId)
        .single()

      setUser({
        id: userId,
        email: userData?.email || '',
        name: userData?.name || 'KullanÄ±cÄ±',
        avatar_url: userData?.avatar_url || null,
        created_at: userData?.created_at || new Date().toISOString()
      })
      
      setUserSpots(spotsData || [])
      setUserShop(shopData || null)

    } catch (error) {
      console.error('KullanÄ±cÄ± bilgileri yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const handleLogout = async () => {
    await supabase.auth.signOut()
    router.push('/')
  }

  const handleCreateSpot = () => {
    router.push('/create-spot')
  }

  const handleOpenShopDashboard = () => {
    if (userShop) {
      router.push('/shop/dashboard')
    } else {
      router.push('/for-business')
    }
  }

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50">
        <main className="container-custom py-12 text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
        </main>
      </div>
    )
  }

  if (!user) {
    return null
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <main className="container-custom py-8">
        {/* Profil Header */}
        <div className="bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl p-6 md:p-8 text-white mb-8">
          <div className="flex flex-col md:flex-row md:items-center justify-between">
            <div className="flex items-center mb-6 md:mb-0">
              <div className="w-20 h-20 bg-white text-blue-600 rounded-full flex items-center justify-center text-2xl font-bold mr-6">
                {user.name?.[0]?.toUpperCase() || user.email[0].toUpperCase()}
              </div>
              <div>
                <h1 className="text-2xl md:text-3xl font-bold mb-2">{user.name || 'KullanÄ±cÄ±'}</h1>
                <p className="text-blue-100">{user.email}</p>
                <p className="text-blue-100 text-sm mt-2">
                  Ãœyelik: {new Date(user.created_at).toLocaleDateString('tr-TR')}
                </p>
              </div>
            </div>
            <div className="flex flex-col sm:flex-row gap-3">
              <button
                onClick={handleCreateSpot}
                className="bg-white text-blue-600 hover:bg-blue-50 font-medium px-6 py-3 rounded-lg"
              >
                ğŸ“ Yeni Spot OluÅŸtur
              </button>
              <button
                onClick={handleLogout}
                className="bg-red-500 hover:bg-red-600 text-white font-medium px-6 py-3 rounded-lg"
              >
                ğŸšª Ã‡Ä±kÄ±ÅŸ Yap
              </button>
            </div>
          </div>
        </div>

        {/* Ä°statistik KartlarÄ± */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
          <div className="bg-white rounded-xl p-4 shadow text-center hover:shadow-md transition">
            <div className="text-2xl font-bold text-blue-600 mb-1">
              {userSpots.length}
            </div>
            <div className="text-gray-600">Spot'larÄ±m</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow text-center hover:shadow-md transition">
            <div className="text-2xl font-bold text-green-600 mb-1">
              {userSpots.filter(s => s.status === 'found').length}
            </div>
            <div className="text-gray-600">Bulunan</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow text-center hover:shadow-md transition">
            <div className="text-2xl font-bold text-purple-600 mb-1">
              {userSpots.reduce((sum, spot) => sum + spot.views, 0)}
            </div>
            <div className="text-gray-600">GÃ¶rÃ¼ntÃ¼lenme</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow text-center hover:shadow-md transition">
            <div className="text-2xl font-bold text-orange-600 mb-1">
              {userSpots.reduce((sum, spot) => sum + spot.helps, 0)}
            </div>
            <div className="text-gray-600">YardÄ±m</div>
          </div>
        </div>

        {/* MaÄŸaza KartÄ± */}
        {userShop && (
          <div className="bg-gradient-to-r from-green-500 to-green-600 text-white rounded-2xl p-6 mb-8">
            <div className="flex flex-col md:flex-row md:items-center justify-between">
              <div className="flex items-center mb-4 md:mb-0">
                <div className="w-12 h-12 bg-white text-green-600 rounded-full flex items-center justify-center text-xl font-bold mr-4">
                  ğŸª
                </div>
                <div>
                  <h3 className="text-xl font-bold">{userShop.shop_name}</h3>
                  <p className="text-green-100">
                    {userShop.city} â€¢ {userShop.subscription_type === 'free' ? 'Ãœcretsiz Paket' : 'Premium'}
                    {userShop.is_verified && ' â€¢ âœ“ DoÄŸrulanmÄ±ÅŸ'}
                  </p>
                </div>
              </div>
              <button
                onClick={handleOpenShopDashboard}
                className="bg-white text-green-600 hover:bg-green-50 font-bold px-6 py-3 rounded-lg"
              >
                MaÄŸaza Paneline Git
              </button>
            </div>
          </div>
        )}

        {!userShop && (
          <div className="bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-2xl p-6 mb-8">
            <div className="flex flex-col md:flex-row md:items-center justify-between">
              <div className="mb-4 md:mb-0">
                <h3 className="text-xl font-bold mb-2">ğŸª MaÄŸaza Sahibi misiniz?</h3>
                <p className="text-yellow-100">
                  Ãœcretsiz maÄŸaza aÃ§Ä±n, mÃ¼ÅŸterilerinizi artÄ±rÄ±n ve satÄ±ÅŸlarÄ±nÄ±zÄ± bÃ¼yÃ¼tÃ¼n!
                </p>
              </div>
              <button
                onClick={() => router.push('/for-business')}
                className="bg-white text-orange-600 hover:bg-orange-50 font-bold px-6 py-3 rounded-lg"
              >
                Ãœcretsiz MaÄŸaza AÃ§
              </button>
            </div>
          </div>
        )}

        {/* Tab Navigation */}
        <div className="bg-white rounded-xl shadow mb-6">
          <div className="flex border-b overflow-x-auto">
            <button
              onClick={() => setActiveTab('spots')}
              className={`flex-shrink-0 px-6 py-4 text-center font-medium whitespace-nowrap ${
                activeTab === 'spots'
                  ? 'text-blue-600 border-b-2 border-blue-600'
                  : 'text-gray-600 hover:text-gray-900'
              }`}
            >
              ğŸ“ Spot'larÄ±m
            </button>
            <button
              onClick={() => setActiveTab('help')}
              className={`flex-shrink-0 px-6 py-4 text-center font-medium whitespace-nowrap ${
                activeTab === 'help'
                  ? 'text-blue-600 border-b-2 border-blue-600'
                  : 'text-gray-600 hover:text-gray-900'
              }`}
            >
              ğŸ¤ YardÄ±m Ettiklerim
            </button>
            {userShop && (
              <button
                onClick={() => setActiveTab('shop')}
                className={`flex-shrink-0 px-6 py-4 text-center font-medium whitespace-nowrap ${
                  activeTab === 'shop'
                    ? 'text-blue-600 border-b-2 border-blue-600'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                ğŸª MaÄŸazam
              </button>
            )}
            <button
              onClick={() => setActiveTab('settings')}
              className={`flex-shrink-0 px-6 py-4 text-center font-medium whitespace-nowrap ${
                activeTab === 'settings'
                  ? 'text-blue-600 border-b-2 border-blue-600'
                  : 'text-gray-600 hover:text-gray-900'
              }`}
            >
              âš™ï¸ Ayarlar
            </button>
          </div>
          
          <div className="p-6">
            {activeTab === 'spots' && (
              <div>
                <div className="flex justify-between items-center mb-6">
                  <h3 className="text-xl font-bold text-gray-900">Spot'larÄ±m</h3>
                  <button
                    onClick={handleCreateSpot}
                    className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg"
                  >
                    + Yeni Spot
                  </button>
                </div>
                
                {userSpots.length === 0 ? (
                  <div className="bg-gray-50 rounded-xl p-8 text-center">
                    <div className="text-4xl mb-4">ğŸ“</div>
                    <h4 className="text-lg font-bold text-gray-900 mb-2">HenÃ¼z spot oluÅŸturmadÄ±nÄ±z</h4>
                    <p className="text-gray-600 mb-6">Ä°lk spot'unuzu oluÅŸturun ve topluluÄŸumuzdan yardÄ±m alÄ±n</p>
                    <button
                      onClick={handleCreateSpot}
                      className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg"
                    >
                      Ä°lk Spot'u OluÅŸturun
                    </button>
                  </div>
                ) : (
                  <div className="overflow-x-auto">
                    <table className="w-full">
                      <thead className="bg-gray-50">
                        <tr>
                          <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">BaÅŸlÄ±k</th>
                          <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Kategori</th>
                          <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Durum</th>
                          <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">GÃ¶rÃ¼ntÃ¼lenme</th>
                          <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">YardÄ±m</th>
                          <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Tarih</th>
                          <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Ä°ÅŸlemler</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-gray-100">
                        {userSpots.map((spot) => (
                          <tr key={spot.id} className="hover:bg-gray-50">
                            <td className="py-3 px-4">
                              <Link
                                href={`/spots/${spot.id}`}
                                className="font-medium text-blue-600 hover:text-blue-800"
                              >
                                {spot.title.length > 40 ? spot.title.substring(0, 40) + '...' : spot.title}
                              </Link>
                            </td>
                            <td className="py-3 px-4">
                              {spot.category ? (
                                <span className="bg-gray-100 text-gray-800 text-xs font-medium px-3 py-1 rounded-full">
                                  {spot.category}
                                </span>
                              ) : (
                                <span className="text-gray-400">-</span>
                              )}
                            </td>
                            <td className="py-3 px-4">
                              <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                                spot.status === 'active'
                                  ? 'bg-green-100 text-green-800'
                                  : 'bg-blue-100 text-blue-800'
                              }`}>
                                {spot.status === 'active' ? 'Aktif' : 'Bulundu'}
                              </span>
                            </td>
                            <td className="py-3 px-4">{spot.views}</td>
                            <td className="py-3 px-4">{spot.helps}</td>
                            <td className="py-3 px-4 text-sm text-gray-500">
                              {new Date(spot.created_at).toLocaleDateString('tr-TR')}
                            </td>
                            <td className="py-3 px-4">
                              <div className="flex space-x-2">
                                <Link
                                  href={`/spots/${spot.id}`}
                                  className="text-blue-600 hover:text-blue-800 text-sm"
                                >
                                  GÃ¶rÃ¼ntÃ¼le
                                </Link>
                              </div>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                )}
              </div>
            )}
            
            {activeTab === 'help' && (
              <div className="bg-gray-50 rounded-xl p-8 text-center">
                <div className="text-4xl mb-4">ğŸ¤</div>
                <h4 className="text-lg font-bold text-gray-900 mb-2">YardÄ±m Ettikleriniz</h4>
                <p className="text-gray-600 mb-6">
                  DiÄŸer kullanÄ±cÄ±lara yardÄ±m ettiÄŸiniz spot'lar yakÄ±nda burada gÃ¶rÃ¼necek.
                </p>
                <button
                  onClick={() => router.push('/spots')}
                  className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg"
                >
                  Spot'lara GÃ¶z AtÄ±n
                </button>
              </div>
            )}
            
            {activeTab === 'shop' && userShop && (
              <div>
                <h3 className="text-xl font-bold text-gray-900 mb-6">MaÄŸaza Bilgilerim</h3>
                
                <div className="grid md:grid-cols-2 gap-6">
                  <div className="bg-white border border-gray-200 rounded-xl p-6">
                    <h4 className="font-bold text-gray-900 mb-4">MaÄŸaza DetaylarÄ±</h4>
                    <div className="space-y-3">
                      <div>
                        <p className="text-sm text-gray-600">MaÄŸaza AdÄ±</p>
                        <p className="font-medium">{userShop.shop_name}</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Åehir</p>
                        <p className="font-medium">{userShop.city}</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Paket</p>
                        <p className="font-medium">
                          {userShop.subscription_type === 'free' ? 'Ãœcretsiz BaÅŸlangÄ±Ã§' : 'Premium'}
                        </p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Durum</p>
                        <p className="font-medium">
                          {userShop.is_verified ? 'âœ“ DoÄŸrulanmÄ±ÅŸ' : 'DoÄŸrulanmamÄ±ÅŸ'}
                        </p>
                      </div>
                    </div>
                    
                    <button
                      onClick={handleOpenShopDashboard}
                      className="mt-6 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg"
                    >
                      MaÄŸaza Paneline Git
                    </button>
                  </div>
                  
                  <div className="bg-white border border-gray-200 rounded-xl p-6">
                    <h4 className="font-bold text-gray-900 mb-4">HÄ±zlÄ± Ä°ÅŸlemler</h4>
                    <div className="space-y-3">
                      <button
                        onClick={() => router.push('/for-business?edit=true')}
                        className="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 py-3 rounded-lg"
                      >
                        ğŸ“ MaÄŸaza Bilgilerini DÃ¼zenle
                      </button>
                      <button
                        onClick={handleCreateSpot}
                        className="w-full bg-blue-100 hover:bg-blue-200 text-blue-800 py-3 rounded-lg"
                      >
                        ğŸª MaÄŸaza Ä°Ã§in Spot OluÅŸtur
                      </button>
                      <button
                        onClick={() => router.push(`/shop/${userShop.id}`)}
                        className="w-full bg-green-100 hover:bg-green-200 text-green-800 py-3 rounded-lg"
                      >
                        ğŸ‘ï¸ MaÄŸazayÄ± GÃ¶rÃ¼ntÃ¼le
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            )}
            
            {activeTab === 'settings' && (
              <div>
                <h3 className="text-xl font-bold text-gray-900 mb-6">Hesap AyarlarÄ±</h3>
                
                <div className="grid md:grid-cols-2 gap-6">
                  <div className="bg-white border border-gray-200 rounded-xl p-6">
                    <h4 className="font-bold text-gray-900 mb-4">Profil Bilgileri</h4>
                    <div className="space-y-4">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Ad Soyad
                        </label>
                        <p className="font-medium">{user.name || 'BelirtilmemiÅŸ'}</p>
                      </div>
                      
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Email
                        </label>
                        <p className="font-medium">{user.email}</p>
                      </div>
                      
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Ãœyelik Tarihi
                        </label>
                        <p className="font-medium">
                          {new Date(user.created_at).toLocaleDateString('tr-TR')}
                        </p>
                      </div>
                    </div>
                  </div>
                  
                  <div className="bg-white border border-gray-200 rounded-xl p-6">
                    <h4 className="font-bold text-gray-900 mb-4">Bildirimler</h4>
                    <div className="space-y-3">
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3" defaultChecked />
                        <span className="text-sm">Yeni spot cevaplarÄ±</span>
                      </label>
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3" defaultChecked />
                        <span className="text-sm">Spot durum deÄŸiÅŸiklikleri</span>
                      </label>
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3" />
                        <span className="text-sm">Kampanya ve duyurular</span>
                      </label>
                    </div>
                    
                    <div className="mt-6 pt-6 border-t">
                      <h4 className="font-bold text-gray-900 mb-3">GÃ¼venlik</h4>
                      <button
                        onClick={() => router.push('/forgot-password')}
                        className="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 py-2 rounded-lg"
                      >
                        ğŸ” Åifre DeÄŸiÅŸtir
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      </main>
    </div>
  )
}

ğŸ“„ app/reset-password/page.tsx
ğŸ“Š 311 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/reset-password/page.tsx
'use client'

import { useState, useEffect } from 'react'
import { useRouter, useSearchParams } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Header from '@/components/Header'
import Footer from '@/components/Footer'
import Link from 'next/link'

export default function ResetPasswordPage() {
  const router = useRouter()
  const searchParams = useSearchParams()
  const token = searchParams.get('token') || ''
  const type = searchParams.get('type') || ''

  const [password, setPassword] = useState('')
  const [confirmPassword, setConfirmPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')
  const [success, setSuccess] = useState(false)
  const [isValidToken, setIsValidToken] = useState<boolean | null>(null)

  useEffect(() => {
    // Token geÃ§erliliÄŸini kontrol et
    checkToken()
  }, [token])

  const checkToken = async () => {
    if (!token) {
      setIsValidToken(false)
      return
    }

    try {
      // Token'Ä± kontrol et
      const { error } = await supabase.auth.verifyOtp({
        token_hash: token,
        type: 'recovery'
      })

      if (error) {
        console.error('Token geÃ§ersiz:', error)
        setIsValidToken(false)
      } else {
        setIsValidToken(true)
      }
    } catch (err) {
      console.error('Token kontrol hatasÄ±:', err)
      setIsValidToken(false)
    }
  }

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')

    // Validasyon
    if (password.length < 6) {
      setError('Åifre en az 6 karakter olmalÄ±dÄ±r')
      setLoading(false)
      return
    }

    if (password !== confirmPassword) {
      setError('Åifreler eÅŸleÅŸmiyor')
      setLoading(false)
      return
    }

    try {
      // Åifreyi gÃ¼ncelle
      const { error } = await supabase.auth.updateUser({
        password: password
      })

      if (error) throw error

      setSuccess(true)
      
      // 3 saniye sonra giriÅŸ sayfasÄ±na yÃ¶nlendir
      setTimeout(() => {
        router.push('/login')
      }, 3000)
      
    } catch (err: any) {
      console.error('Åifre gÃ¼ncelleme hatasÄ±:', err)
      
      let errorMessage = err.message || 'Bir hata oluÅŸtu'
      
      if (errorMessage.includes('password')) {
        errorMessage = 'GeÃ§ersiz ÅŸifre formatÄ±'
      } else if (errorMessage.includes('session')) {
        errorMessage = 'Oturum sÃ¼resi doldu. LÃ¼tfen yeni bir ÅŸifre sÄ±fÄ±rlama linki talep edin.'
      }
      
      setError(errorMessage)
    } finally {
      setLoading(false)
    }
  }

  // Token geÃ§ersizse
  if (isValidToken === false) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        
        <main className="container-custom py-12">
          <div className="max-w-md mx-auto">
            <div className="bg-white rounded-2xl shadow-lg p-8 text-center">
              <div className="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center text-2xl mx-auto mb-4">
                âš ï¸
              </div>
              <h1 className="text-2xl font-bold text-gray-900 mb-4">
                GeÃ§ersiz veya SÃ¼resi DolmuÅŸ Link
              </h1>
              <p className="text-gray-600 mb-6">
                Bu ÅŸifre sÄ±fÄ±rlama linki geÃ§ersiz veya sÃ¼resi dolmuÅŸ.
                LÃ¼tfen yeni bir ÅŸifre sÄ±fÄ±rlama talebinde bulunun.
              </p>
              <div className="space-y-3">
                <Link
                  href="/forgot-password"
                  className="block w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg"
                >
                  Yeni Åifre SÄ±fÄ±rlama Linki Ä°ste
                </Link>
                <Link
                  href="/login"
                  className="block w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-3 rounded-lg"
                >
                  GiriÅŸ SayfasÄ±na DÃ¶n
                </Link>
              </div>
            </div>
          </div>
        </main>

        <Footer />
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-12">
        <div className="max-w-md mx-auto">
          <div className="bg-white rounded-2xl shadow-lg p-8">
            {/* BaÅŸlÄ±k */}
            <div className="text-center mb-8">
              <div className="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-2xl mx-auto mb-4">
                ğŸ”
              </div>
              <h1 className="text-2xl font-bold text-gray-900 mb-2">
                Yeni Åifre Belirleyin
              </h1>
              <p className="text-gray-600">
                Yeni ÅŸifrenizi belirleyin ve hesabÄ±nÄ±za giriÅŸ yapÄ±n
              </p>
            </div>

            {/* BaÅŸarÄ± MesajÄ± */}
            {success && (
              <div className="mb-6 bg-green-50 border border-green-200 text-green-700 p-4 rounded-lg">
                <div className="flex items-center">
                  <span className="text-green-600 mr-3">âœ…</span>
                  <div>
                    <p className="font-medium">Åifreniz baÅŸarÄ±yla gÃ¼ncellendi!</p>
                    <p className="text-sm mt-1">
                      Yeni ÅŸifrenizle giriÅŸ yapabilirsiniz. 3 saniye iÃ§inde giriÅŸ sayfasÄ±na yÃ¶nlendirileceksiniz.
                    </p>
                  </div>
                </div>
              </div>
            )}

            {/* Hata MesajÄ± */}
            {error && (
              <div className="mb-6 bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg">
                <div className="flex items-center">
                  <span className="text-red-600 mr-3">âŒ</span>
                  <div>
                    <p className="font-medium">{error}</p>
                  </div>
                </div>
              </div>
            )}

            {/* Form */}
            {!success && (
              <form onSubmit={handleSubmit} className="space-y-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Yeni Åifre *
                  </label>
                  <input
                    type="password"
                    value={password}
                    onChange={(e) => setPassword(e.target.value)}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    placeholder="En az 6 karakter"
                    required
                    minLength={6}
                    disabled={loading}
                  />
                  <p className="text-gray-500 text-xs mt-2">
                    GÃ¼Ã§lÃ¼ bir ÅŸifre seÃ§in (harf, rakam, Ã¶zel karakter kombinasyonu)
                  </p>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Åifreyi Tekrar Girin *
                  </label>
                  <input
                    type="password"
                    value={confirmPassword}
                    onChange={(e) => setConfirmPassword(e.target.value)}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Åifreyi tekrar girin"
                    required
                    minLength={6}
                    disabled={loading}
                  />
                  <p className="text-gray-500 text-xs mt-2">
                    Åifrenizi doÄŸrulamak iÃ§in tekrar girin
                  </p>
                </div>

                <button
                  type="submit"
                  disabled={loading || !isValidToken}
                  className="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
                >
                  {loading ? (
                    <>
                      <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                        <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                      </svg>
                      GÃ¼ncelleniyor...
                    </>
                  ) : (
                    'Åifremi GÃ¼ncelle'
                  )}
                </button>
              </form>
            )}

            {/* Ek Bilgiler */}
            <div className="mt-8 pt-6 border-t border-gray-100">
              <div className="space-y-4">
                <div className="bg-yellow-50 p-4 rounded-lg">
                  <p className="text-sm text-yellow-700">
                    <span className="font-medium">âš ï¸ GÃ¼venlik UyarÄ±sÄ±:</span> Åifrenizi kimseyle paylaÅŸmayÄ±n. 
                    HesabÄ±nÄ±zda ÅŸÃ¼pheli bir aktivite gÃ¶rÃ¼rseniz hemen bizimle iletiÅŸime geÃ§in.
                  </p>
                </div>

                <div className="text-center">
                  <Link
                    href="/login"
                    className="text-blue-600 hover:text-blue-800 font-medium"
                  >
                    â† GiriÅŸ sayfasÄ±na dÃ¶n
                  </Link>
                </div>
              </div>
            </div>
          </div>

          {/* Åifre Ã–nerileri */}
          <div className="mt-8 bg-white rounded-2xl shadow p-6">
            <h3 className="font-bold text-gray-900 mb-4 flex items-center">
              <span className="text-blue-600 mr-2">ğŸ’¡</span>
              GÃ¼Ã§lÃ¼ Åifre Ä°puÃ§larÄ±
            </h3>
            <ul className="space-y-2 text-sm text-gray-600">
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>En az 8 karakter kullanÄ±n</span>
              </li>
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>BÃ¼yÃ¼k ve kÃ¼Ã§Ã¼k harf karÄ±ÅŸÄ±mÄ± kullanÄ±n</span>
              </li>
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>Rakam ve Ã¶zel karakter ekleyin (!@#$%^&*)</span>
              </li>
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>KiÅŸisel bilgilerinizi (doÄŸum tarihi, isim) kullanmayÄ±n</span>
              </li>
              <li className="flex items-start">
                <span className="text-green-500 mr-2">âœ“</span>
                <span>FarklÄ± hesaplar iÃ§in farklÄ± ÅŸifreler kullanÄ±n</span>
              </li>
            </ul>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/shop/[id]/inventory/[productId]/page.tsx
ğŸ“Š 730 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/shop/[id]/inventory/[productId]/page.tsx - TAMAMI DÃœZELTMÄ°Å
'use client';

import { useState, useEffect } from 'react';
import { useRouter, useParams } from 'next/navigation';
import { supabase } from '@/lib/supabase';
import { 
  ArrowLeft, Edit, Trash2, Package, Tag, Calendar, 
  MapPin, Truck, Eye, Share2, Loader2, DollarSign,
  CheckCircle, XCircle, AlertCircle, ShoppingCart
} from 'lucide-react';
import Link from 'next/link';

// Helper fonksiyonu
const parseShippingOptions = (options: any) => {
  if (!options) return { shipping: false, local_pickup: false };
  
  if (typeof options === 'string') {
    try {
      return JSON.parse(options);
    } catch (error) {
      console.error('JSON parse error:', error);
      return { shipping: false, local_pickup: false };
    }
  }
  
  return options;
};

export default function ProductDetailPage() {
  const router = useRouter();
  const params = useParams();
  const shopId = params.id as string;
  const productId = params.productId as string;
  
  const [product, setProduct] = useState<any>(null);
  const [shop, setShop] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const [deleting, setDeleting] = useState(false);
  const [activeImageIndex, setActiveImageIndex] = useState(0);
  const [similarProducts, setSimilarProducts] = useState<any[]>([]);

  useEffect(() => {
    loadProduct();
  }, [shopId, productId]);

  const loadProduct = async () => {
    try {
      setLoading(true);
      
      // MaÄŸaza bilgilerini getir
      const { data: shopData } = await supabase
        .from('shops')
        .select('*')
        .eq('id', shopId)
        .single();
      
      if (shopData) {
        setShop(shopData);
      }

      // ÃœrÃ¼n bilgilerini getir
      const { data: productData, error } = await supabase
        .from('shop_inventory')
        .select('*')
        .eq('id', productId)
        .eq('shop_id', shopId)
        .single();

      if (error) throw error;
      setProduct(productData);

      // GÃ¶rÃ¼ntÃ¼leme sayÄ±sÄ±nÄ± artÄ±r
      await supabase
        .from('shop_inventory')
        .update({ 
          view_count: (productData.view_count || 0) + 1,
          last_viewed_at: new Date().toISOString()
        })
        .eq('id', productId);

      // Benzer Ã¼rÃ¼nleri getir
      if (productData.category) {
        const { data: similar } = await supabase
          .from('shop_inventory')
          .select('*')
          .eq('shop_id', shopId)
          .eq('category', productData.category)
          .eq('status', 'active')
          .neq('id', productId)
          .limit(4);

        setSimilarProducts(similar || []);
      }

    } catch (error) {
      console.error('ÃœrÃ¼n yÃ¼klenemedi:', error);
      alert('ÃœrÃ¼n bulunamadÄ± veya yÃ¼klenirken bir hata oluÅŸtu');
      router.push(`/shop/${shopId}/inventory`);
    } finally {
      setLoading(false);
    }
  };

  const handleDelete = async () => {
    if (!confirm('Bu Ã¼rÃ¼nÃ¼ silmek istediÄŸinizden emin misiniz? Bu iÅŸlem geri alÄ±namaz.')) {
      return;
    }

    setDeleting(true);
    try {
      const { error } = await supabase
        .from('shop_inventory')
        .delete()
        .eq('id', productId)
        .eq('shop_id', shopId);

      if (error) throw error;

      // Resim sayacÄ±nÄ± gÃ¼ncelle
      if (product?.images && shop) {
        const imageCount = product.images.length;
        await supabase
          .from('shops')
          .update({ free_images_used: Math.max(0, shop.free_images_used - imageCount) })
          .eq('id', shopId);
      }

      alert('ÃœrÃ¼n baÅŸarÄ±yla silindi');
      router.push(`/shop/${shopId}/inventory`);
    } catch (error) {
      console.error('Silme hatasÄ±:', error);
      alert('ÃœrÃ¼n silinirken bir hata oluÅŸtu');
    } finally {
      setDeleting(false);
    }
  };

  const handleUpdateStatus = async (newStatus: string) => {
    try {
      const { error } = await supabase
        .from('shop_inventory')
        .update({ status: newStatus })
        .eq('id', productId)
        .eq('shop_id', shopId);

      if (error) throw error;

      setProduct({ ...product, status: newStatus });
      alert(`ÃœrÃ¼n durumu "${getStatusText(newStatus)}" olarak gÃ¼ncellendi`);
    } catch (error) {
      console.error('Durum gÃ¼ncelleme hatasÄ±:', error);
      alert('Durum gÃ¼ncellenirken bir hata oluÅŸtu');
    }
  };

  const handleShare = () => {
    const url = `${window.location.origin}/product/${productId}`;
    navigator.clipboard.writeText(url);
    alert('ÃœrÃ¼n linki kopyalandÄ±!');
  };

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'active': return 'bg-green-100 text-green-800';
      case 'draft': return 'bg-yellow-100 text-yellow-800';
      case 'inactive': return 'bg-red-100 text-red-800';
      case 'sold': return 'bg-blue-100 text-blue-800';
      default: return 'bg-gray-100 text-gray-800';
    }
  };

  const getStatusText = (status: string) => {
    switch (status) {
      case 'active': return 'Aktif';
      case 'draft': return 'Taslak';
      case 'inactive': return 'Pasif';
      case 'sold': return 'SatÄ±ldÄ±';
      default: return status;
    }
  };

  const getConditionText = (condition: string) => {
    switch (condition) {
      case 'new': return 'SÄ±fÄ±r / Yeni';
      case 'like_new': return 'Az KullanÄ±lmÄ±ÅŸ';
      case 'used': return 'KullanÄ±lmÄ±ÅŸ';
      case 'refurbished': return 'Fabrika Ã‡Ä±kÄ±ÅŸlÄ±';
      case 'for_parts': return 'ParÃ§a Ä°Ã§in';
      default: return condition;
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="container mx-auto px-4">
          <div className="text-center py-12">
            <Loader2 className="animate-spin mx-auto text-blue-600 mb-4" size={48} />
            <p className="text-gray-600">ÃœrÃ¼n yÃ¼kleniyor...</p>
          </div>
        </div>
      </div>
    );
  }

  if (!product) {
    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="container mx-auto px-4">
          <div className="text-center py-12">
            <Package className="mx-auto text-gray-400 mb-4" size={48} />
            <h3 className="text-lg font-bold text-gray-900 mb-2">ÃœrÃ¼n bulunamadÄ±</h3>
            <p className="text-gray-600 mb-6">
              Bu Ã¼rÃ¼n silinmiÅŸ veya mevcut deÄŸil
            </p>
            <Link
              href={`/shop/${shopId}/inventory`}
              className="inline-block bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg"
            >
              Envantere DÃ¶n
            </Link>
          </div>
        </div>
      </div>
    );
  }

  // Shipping options'Ä± parse et
  const shippingOptions = parseShippingOptions(product.shipping_options);

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="container mx-auto px-4">
        {/* Ãœst Navigasyon */}
        <div className="mb-6">
          <Link
            href={`/shop/${shopId}/inventory`}
            className="text-blue-600 hover:text-blue-800 flex items-center"
          >
            <ArrowLeft className="mr-2" size={20} />
            Envantere DÃ¶n
          </Link>
        </div>

        <div className="grid lg:grid-cols-3 gap-8">
          {/* Ana Ä°Ã§erik */}
          <div className="lg:col-span-2 space-y-6">
            {/* ÃœrÃ¼n BaÅŸlÄ±k ve Durum */}
            <div className="bg-white rounded-xl shadow p-6">
              <div className="flex flex-col md:flex-row md:items-start justify-between mb-6">
                <div className="mb-4 md:mb-0">
                  <div className="flex items-center flex-wrap gap-2 mb-3">
                    <span className={`px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(product.status)}`}>
                      {getStatusText(product.status)}
                    </span>
                    <span className="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm">
                      {product.category || 'Kategorisiz'}
                    </span>
                    {product.sku && (
                      <span className="px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm">
                        SKU: {product.sku}
                      </span>
                    )}
                  </div>
                  <h1 className="text-2xl md:text-3xl font-bold text-gray-900 mb-2">
                    {product.title}
                  </h1>
                  {product.brand && (
                    <p className="text-lg text-gray-600">
                      Marka: <span className="font-medium">{product.brand}</span>
                      {product.model && ` â€¢ Model: ${product.model}`}
                    </p>
                  )}
                </div>

                <div className="flex space-x-3">
                  <button
                    onClick={handleShare}
                    className="p-2 text-blue-600 hover:bg-blue-50 rounded-lg"
                    title="PaylaÅŸ"
                  >
                    <Share2 size={20} />
                  </button>
                  <Link
                    href={`/shop/${shopId}/inventory/${productId}/edit`}
                    className="p-2 text-green-600 hover:bg-green-50 rounded-lg"
                    title="DÃ¼zenle"
                  >
                    <Edit size={20} />
                  </Link>
                  <button
                    onClick={handleDelete}
                    disabled={deleting}
                    className="p-2 text-red-600 hover:bg-red-50 rounded-lg disabled:opacity-50"
                    title="Sil"
                  >
                    {deleting ? (
                      <Loader2 className="animate-spin" size={20} />
                    ) : (
                      <Trash2 size={20} />
                    )}
                  </button>
                </div>
              </div>

              {/* ÃœrÃ¼n Resimleri */}
              {product.images && product.images.length > 0 ? (
                <div className="mb-6">
                  <div className="mb-4">
                    <div className="relative h-96 w-full rounded-xl overflow-hidden bg-gray-100">
                      <img
                        src={product.images[activeImageIndex]}
                        alt={product.title}
                        className="w-full h-full object-contain"
                      />
                    </div>
                  </div>

                  {product.images.length > 1 && (
                    <div className="grid grid-cols-4 md:grid-cols-6 gap-2">
                      {product.images.map((image: string, index: number) => (
                        <button
                          key={index}
                          onClick={() => setActiveImageIndex(index)}
                          className={`relative h-20 rounded-lg overflow-hidden ${
                            activeImageIndex === index 
                              ? 'ring-2 ring-blue-500 ring-offset-2' 
                              : 'opacity-75 hover:opacity-100'
                          }`}
                        >
                          <img
                            src={image}
                            alt={`${product.title} - Resim ${index + 1}`}
                            className="w-full h-full object-cover"
                          />
                        </button>
                      ))}
                    </div>
                  )}
                </div>
              ) : (
                <div className="mb-6 h-96 bg-gray-100 rounded-xl flex items-center justify-center">
                  <Package className="text-gray-400" size={64} />
                </div>
              )}

              {/* AÃ§Ä±klama */}
              <div className="mb-8">
                <h2 className="text-xl font-bold text-gray-900 mb-3">AÃ§Ä±klama</h2>
                <div className="text-gray-700 whitespace-pre-line bg-gray-50 p-4 rounded-lg">
                  {product.description || 'AÃ§Ä±klama eklenmemiÅŸ'}
                </div>
              </div>

              {/* Detaylar Grid */}
              <div className="grid md:grid-cols-2 gap-6">
                <div className="space-y-4">
                  <div>
                    <h3 className="text-sm font-medium text-gray-500 mb-1 flex items-center">
                      <Package className="mr-2" size={16} />
                      ÃœrÃ¼n Bilgileri
                    </h3>
                    <div className="space-y-2">
                      <div className="flex justify-between">
                        <span className="text-gray-600">Durum:</span>
                        <span className="font-medium">{getConditionText(product.condition)}</span>
                      </div>
                      {product.year && (
                        <div className="flex justify-between">
                          <span className="text-gray-600">YÄ±l:</span>
                          <span className="font-medium">{product.year}</span>
                        </div>
                      )}
                      <div className="flex justify-between">
                        <span className="text-gray-600">Stok:</span>
                        <span className={`font-medium ${
                          product.quantity > 0 ? 'text-green-600' : 'text-red-600'
                        }`}>
                          {product.quantity} adet
                        </span>
                      </div>
                      {product.weight_kg && (
                        <div className="flex justify-between">
                          <span className="text-gray-600">AÄŸÄ±rlÄ±k:</span>
                          <span className="font-medium">{product.weight_kg} kg</span>
                        </div>
                      )}
                      {product.dimensions && (
                        <div className="flex justify-between">
                          <span className="text-gray-600">Boyutlar:</span>
                          <span className="font-medium">{product.dimensions}</span>
                        </div>
                      )}
                    </div>
                  </div>

                  <div>
                    <h3 className="text-sm font-medium text-gray-500 mb-1 flex items-center">
                      <Calendar className="mr-2" size={16} />
                      Zaman Bilgileri
                    </h3>
                    <div className="space-y-2">
                      <div className="flex justify-between">
                        <span className="text-gray-600">OluÅŸturulma:</span>
                        <span className="font-medium">
                          {new Date(product.created_at).toLocaleDateString('tr-TR')}
                        </span>
                      </div>
                      {product.last_viewed_at && (
                        <div className="flex justify-between">
                          <span className="text-gray-600">Son GÃ¶rÃ¼ntÃ¼lenme:</span>
                          <span className="font-medium">
                            {new Date(product.last_viewed_at).toLocaleDateString('tr-TR')}
                          </span>
                        </div>
                      )}
                      {product.last_inquiry_at && (
                        <div className="flex justify-between">
                          <span className="text-gray-600">Son Soru:</span>
                          <span className="font-medium">
                            {new Date(product.last_inquiry_at).toLocaleDateString('tr-TR')}
                          </span>
                        </div>
                      )}
                    </div>
                  </div>
                </div>

                <div className="space-y-4">
                  <div>
                    <h3 className="text-sm font-medium text-gray-500 mb-1 flex items-center">
                      <MapPin className="mr-2" size={16} />
                      Lokasyon & Kargo
                    </h3>
                    <div className="space-y-2">
                      <div className="flex justify-between">
                        <span className="text-gray-600">Konum:</span>
                        <span className="font-medium">{product.location || shop?.city || '-'}</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">Kargo:</span>
                        <span className="font-medium flex items-center">
                          {shippingOptions.shipping ? (
                            <>
                              <CheckCircle className="text-green-500 mr-1" size={16} />
                              Var
                            </>
                          ) : (
                            <>
                              <XCircle className="text-red-500 mr-1" size={16} />
                              Yok
                            </>
                          )}
                        </span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">Yerinden Teslim:</span>
                        <span className="font-medium flex items-center">
                          {shippingOptions.local_pickup ? (
                            <>
                              <CheckCircle className="text-green-500 mr-1" size={16} />
                              Var
                            </>
                          ) : (
                            <>
                              <XCircle className="text-red-500 mr-1" size={16} />
                              Yok
                            </>
                          )}
                        </span>
                      </div>
                    </div>
                  </div>

                  <div>
                    <h3 className="text-sm font-medium text-gray-500 mb-1 flex items-center">
                      <Eye className="mr-2" size={16} />
                      Ä°statistikler
                    </h3>
                    <div className="space-y-2">
                      <div className="flex justify-between">
                        <span className="text-gray-600">GÃ¶rÃ¼ntÃ¼lenme:</span>
                        <span className="font-medium">{product.view_count || 0}</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">Soru SayÄ±sÄ±:</span>
                        <span className="font-medium">{product.inquiry_count || 0}</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">SatÄ±lan Adet:</span>
                        <span className="font-medium">{product.sold_count || 0}</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">Favori:</span>
                        <span className="font-medium">{product.wishlist_count || 0}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* Etiketler */}
            {product.tags && product.tags.length > 0 && (
              <div className="bg-white rounded-xl shadow p-6">
                <h2 className="text-xl font-bold text-gray-900 mb-3 flex items-center">
                  <Tag className="mr-2" size={20} />
                  Etiketler
                </h2>
                <div className="flex flex-wrap gap-2">
                  {product.tags.map((tag: string, index: number) => (
                    <span
                      key={index}
                      className="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm"
                    >
                      #{tag}
                    </span>
                  ))}
                </div>
              </div>
            )}

            {/* Benzer ÃœrÃ¼nler */}
            {similarProducts.length > 0 && (
              <div className="bg-white rounded-xl shadow p-6">
                <h2 className="text-xl font-bold text-gray-900 mb-4">Benzer ÃœrÃ¼nler</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  {similarProducts.map((similar) => (
                    <Link
                      key={similar.id}
                      href={`/shop/${shopId}/inventory/${similar.id}`}
                      className="border border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:shadow-sm transition-all"
                    >
                      <div className="flex">
                        {similar.images && similar.images.length > 0 ? (
                          <img
                            src={similar.images[0]}
                            alt={similar.title}
                            className="w-16 h-16 object-cover rounded-lg mr-4"
                          />
                        ) : (
                          <div className="w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center mr-4">
                            <Package className="text-gray-400" size={20} />
                          </div>
                        )}
                        <div className="flex-1">
                          <h3 className="font-medium text-gray-900 line-clamp-2">
                            {similar.title}
                          </h3>
                          <div className="flex items-center justify-between mt-2">
                            <span className="font-bold text-blue-600">
                              {similar.price.toLocaleString('tr-TR')} {similar.price_currency}
                            </span>
                            <span className={`px-2 py-1 rounded text-xs ${getStatusColor(similar.status)}`}>
                              {getStatusText(similar.status)}
                            </span>
                          </div>
                        </div>
                      </div>
                    </Link>
                  ))}
                </div>
              </div>
            )}
          </div>

          {/* Yan Panel */}
          <div className="space-y-6">
            {/* Fiyat ve Ä°ÅŸlemler */}
            <div className="bg-white rounded-xl shadow p-6">
              <h3 className="text-lg font-bold text-gray-900 mb-4 flex items-center">
                <DollarSign className="mr-2" size={20} />
                Fiyat ve Ä°ÅŸlemler
              </h3>
              
              <div className="space-y-4 mb-6">
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Fiyat:</span>
                  <span className="text-2xl font-bold text-gray-900">
                    {product.price.toLocaleString('tr-TR')} {product.price_currency}
                  </span>
                </div>
                
                {product.original_price && product.original_price > product.price && (
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Orijinal Fiyat:</span>
                    <span className="text-lg text-gray-500 line-through">
                      {product.original_price.toLocaleString('tr-TR')} {product.price_currency}
                    </span>
                  </div>
                )}
                
                {product.discount_percent && (
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Ä°ndirim:</span>
                    <span className="text-lg font-bold text-green-600">
                      %{product.discount_percent}
                    </span>
                  </div>
                )}
                
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Stok Durumu:</span>
                  <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                    product.quantity > 0 
                      ? 'bg-green-100 text-green-800' 
                      : 'bg-red-100 text-red-800'
                  }`}>
                    {product.quantity > 0 ? 'Stokta Var' : 'Stokta Yok'}
                  </span>
                </div>
              </div>

              {/* Durum DeÄŸiÅŸtirme */}
              <div className="mb-6">
                <h4 className="font-medium text-gray-900 mb-2">Durum DeÄŸiÅŸtir</h4>
                <div className="grid grid-cols-2 gap-2">
                  <button
                    onClick={() => handleUpdateStatus('active')}
                    disabled={product.status === 'active'}
                    className={`p-2 rounded-lg text-sm font-medium ${
                      product.status === 'active'
                        ? 'bg-green-600 text-white'
                        : 'bg-green-100 text-green-700 hover:bg-green-200'
                    }`}
                  >
                    Aktif
                  </button>
                  <button
                    onClick={() => handleUpdateStatus('draft')}
                    disabled={product.status === 'draft'}
                    className={`p-2 rounded-lg text-sm font-medium ${
                      product.status === 'draft'
                        ? 'bg-yellow-600 text-white'
                        : 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200'
                    }`}
                  >
                    Taslak
                  </button>
                  <button
                    onClick={() => handleUpdateStatus('inactive')}
                    disabled={product.status === 'inactive'}
                    className={`p-2 rounded-lg text-sm font-medium ${
                      product.status === 'inactive'
                        ? 'bg-red-600 text-white'
                        : 'bg-red-100 text-red-700 hover:bg-red-200'
                    }`}
                  >
                    Pasif
                  </button>
                  <button
                    onClick={() => handleUpdateStatus('sold')}
                    disabled={product.status === 'sold'}
                    className={`p-2 rounded-lg text-sm font-medium ${
                      product.status === 'sold'
                        ? 'bg-blue-600 text-white'
                        : 'bg-blue-100 text-blue-700 hover:bg-blue-200'
                    }`}
                  >
                    SatÄ±ldÄ±
                  </button>
                </div>
              </div>

              {/* HÄ±zlÄ± Ä°ÅŸlemler */}
              <div className="space-y-3">
                <Link
                  href={`/shop/${shopId}/inventory/${productId}/edit`}
                  className="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg flex items-center justify-center"
                >
                  <Edit className="mr-2" size={18} />
                  ÃœrÃ¼nÃ¼ DÃ¼zenle
                </Link>
                <button
                  onClick={handleShare}
                  className="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 py-2 rounded-lg flex items-center justify-center"
                >
                  <Share2 className="mr-2" size={18} />
                  PaylaÅŸ
                </button>
                <button
                  onClick={() => {
                    const url = `${window.location.origin}/product/${productId}`;
                    window.open(url, '_blank');
                  }}
                  className="w-full bg-green-100 hover:bg-green-200 text-green-700 py-2 rounded-lg flex items-center justify-center"
                >
                  <Eye className="mr-2" size={18} />
                  CanlÄ± Ã–nizleme
                </button>
              </div>
            </div>

            {/* MaÄŸaza Bilgileri */}
            {shop && (
              <div className="bg-white rounded-xl shadow p-6">
                <h3 className="font-bold text-gray-900 mb-4">ğŸª MaÄŸaza Bilgileri</h3>
                <div className="space-y-3">
                  <div>
                    <p className="font-medium text-gray-900">{shop.shop_name}</p>
                    <p className="text-sm text-gray-600">{shop.city}</p>
                  </div>
                  {shop.email && (
                    <div>
                      <p className="text-sm text-gray-600">Email:</p>
                      <p className="font-medium">{shop.email}</p>
                    </div>
                  )}
                  {shop.phone && (
                    <div>
                      <p className="text-sm text-gray-600">Telefon:</p>
                      <p className="font-medium">{shop.phone}</p>
                    </div>
                  )}
                  <Link
                    href={`/shop/${shopId}`}
                    className="inline-block text-blue-600 hover:text-blue-800 text-sm"
                  >
                    MaÄŸazayÄ± GÃ¶rÃ¼ntÃ¼le â†’
                  </Link>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
}

ğŸ“„ app/shop/[id]/inventory/add/page.tsx
ğŸ“Š 534 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/shop/[id]/inventory/add/page.tsx - STORAGE ONLY VERSION
'use client';

import { useState, useEffect } from 'react';
import { useRouter, useParams } from 'next/navigation';
import { supabase } from '@/lib/supabase';
import { Upload, X, Loader2, Save, ArrowLeft } from 'lucide-react';

export default function AddProductPage() {
  const router = useRouter();
  const params = useParams();
  const shopId = params.id as string;
  
  const [loading, setLoading] = useState(false);
  const [shop, setShop] = useState<any>(null);
  const [categories, setCategories] = useState<any[]>([]);
  const [imageFile, setImageFile] = useState<File | null>(null);
  const [imagePreview, setImagePreview] = useState<string | null>(null);

  const [formData, setFormData] = useState({
    title: '',
    description: '',
    category: '',
    price: '',
    price_currency: 'TRY',
    quantity: 1,
    location: '',
    status: 'draft'
  });

  useEffect(() => {
    loadShopAndCategories();
  }, [shopId]);

  const loadShopAndCategories = async () => {
    try {
      // MaÄŸaza bilgilerini getir
      const { data: shopData } = await supabase
        .from('shops')
        .select('*')
        .eq('id', shopId)
        .single();

      if (shopData) {
        setShop(shopData);
        setFormData(prev => ({ ...prev, location: shopData.city || '' }));
      }

      // Kategorileri getir
      const { data: categoriesData } = await supabase
        .from('categories')
        .select('*')
        .eq('is_active', true)
        .order('sort_order');

      if (categoriesData) {
        setCategories(categoriesData);
      }
    } catch (error) {
      console.error('Veriler yÃ¼klenemedi:', error);
    }
  };

  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    if (!e.target.files || e.target.files.length === 0) return;
    
    const file = e.target.files[0];
    
    // Dosya validasyonu
    if (!file.type.startsWith('image/')) {
      alert('LÃ¼tfen sadece resim dosyasÄ± seÃ§in');
      return;
    }
    
    if (file.size > 5 * 1024 * 1024) { // 5MB
      alert('Resim boyutu maksimum 5MB olmalÄ±dÄ±r');
      return;
    }
    
    setImageFile(file);
    
    // Ã–nizleme oluÅŸtur
    const reader = new FileReader();
    reader.onloadend = () => {
      setImagePreview(reader.result as string);
    };
    reader.readAsDataURL(file);
  };

  const removeImage = () => {
    setImageFile(null);
    setImagePreview(null);
  };

  // STORAGE'A YÃœKLEME (TypeScript-safe)
  const uploadImageToStorage = async (): Promise<string | null> => {
    if (!imageFile) return null;

    try {
      // 1. Bucket kontrolÃ¼
      const { data: buckets, error: bucketsError } = await supabase.storage.listBuckets();
      
      if (bucketsError) {
        console.error('Bucket listeleme hatasÄ±:', bucketsError);
        throw new Error('Storage eriÅŸim hatasÄ±');
      }

      // TypeScript iÃ§in null kontrolÃ¼
      if (!buckets) {
        throw new Error('Bucket listesi alÄ±namadÄ±');
      }

      const hasProductImagesBucket = buckets.some(b => b.name === 'product-images');
      
      if (!hasProductImagesBucket) {
        throw new Error('"product-images" bucket bulunamadÄ±. LÃ¼tfen Supabase Storage\'da oluÅŸturun.');
      }

      // 2. Dosya adÄ±nÄ± oluÅŸtur
      const timestamp = Date.now();
      const randomString = Math.random().toString(36).substring(2, 8);
      const fileExt = imageFile.name.split('.').pop() || 'jpg';
      const fileName = `${shopId}/products/${timestamp}_${randomString}.${fileExt}`;
      
      console.log(`Resim yÃ¼kleniyor: product-images/${fileName}`);

      // 3. Resmi yÃ¼kle
      const { error: uploadError } = await supabase.storage
        .from('product-images')
        .upload(fileName, imageFile, {
          cacheControl: '3600',
          upsert: false
        });

      if (uploadError) {
        console.error('Resim yÃ¼kleme hatasÄ±:', uploadError);
        throw uploadError;
      }

      // 4. Public URL'i al
      const { data: { publicUrl } } = supabase.storage
        .from('product-images')
        .getPublicUrl(fileName);

      console.log('Public URL:', publicUrl);
      return publicUrl;

    } catch (error: any) {
      console.error('Resim yÃ¼kleme hatasÄ±:', error);
      throw error; // Hata durumunda Ã¼st seviyeye fÄ±rlat
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    // Validasyon
    if (!formData.title.trim()) {
      alert('ÃœrÃ¼n adÄ± zorunludur');
      return;
    }
    
    if (!formData.price || parseFloat(formData.price) <= 0) {
      alert('GeÃ§erli bir fiyat girin');
      return;
    }
    
    if (!imageFile) {
      alert('LÃ¼tfen bir resim yÃ¼kleyin');
      return;
    }

    setLoading(true);

    try {
      // Resim yÃ¼kle
      const imageUrl = await uploadImageToStorage();
      
      if (!imageUrl) {
        throw new Error('Resim yÃ¼klenemedi');
      }

      // ÃœrÃ¼nÃ¼ veritabanÄ±na kaydet
      const productData = {
        shop_id: shopId,
        title: formData.title.trim(),
        description: formData.description.trim(),
        category: formData.category || null,
        price: parseFloat(formData.price),
        price_currency: formData.price_currency,
        quantity: formData.quantity,
        location: formData.location.trim() || null,
        images: [imageUrl],
        status: formData.status,
        is_negotiable: false,
        view_count: 0,
        inquiry_count: 0,
        created_at: new Date().toISOString(),
        updated_at: new Date().toISOString()
      };

      const { data: product, error: productError } = await supabase
        .from('shop_inventory')
        .insert(productData)
        .select()
        .single();

      if (productError) {
        console.error('ÃœrÃ¼n kaydetme hatasÄ±:', productError);
        throw productError;
      }

      // Resim sayacÄ±nÄ± gÃ¼ncelle
      if (shop) {
        await supabase
          .from('shops')
          .update({ 
            free_images_used: (shop.free_images_used || 0) + 1,
            updated_at: new Date().toISOString()
          })
          .eq('id', shopId);
      }

      alert('âœ… ÃœrÃ¼n baÅŸarÄ±yla eklendi!');
      router.push(`/shop/${shopId}/dashboard`);
      router.refresh();

    } catch (error: any) {
      console.error('ÃœrÃ¼n ekleme hatasÄ±:', error);
      
      // KullanÄ±cÄ± dostu hata mesajlarÄ±
      let errorMessage = 'ÃœrÃ¼n eklenirken bir hata oluÅŸtu';
      
      if (error.message?.includes('product-images')) {
        errorMessage = 'Storage bucket bulunamadÄ±. LÃ¼tfen Supabase Storage\'da "product-images" bucket oluÅŸturun.';
      } else if (error.message?.includes('storage')) {
        errorMessage = 'Storage eriÅŸim hatasÄ±. LÃ¼tfen storage ayarlarÄ±nÄ± kontrol edin.';
      } else if (error.message) {
        errorMessage = error.message;
      }
      
      alert(`âŒ ${errorMessage}`);
    } finally {
      setLoading(false);
    }
  };

  if (!shop) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"></div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Ãœst Navigasyon */}
      <div className="bg-white border-b border-gray-200">
        <div className="container mx-auto px-4 py-4">
          <div className="flex items-center justify-between">
            <button
              onClick={() => router.push(`/shop/${shopId}/dashboard`)}
              className="text-blue-600 hover:text-blue-800 flex items-center"
            >
              <ArrowLeft className="mr-2" size={20} />
              Dashboard'a DÃ¶n
            </button>
            
            <div className="text-sm text-gray-600">
              MaÄŸaza: <span className="font-semibold">{shop.shop_name}</span>
            </div>
          </div>
        </div>
      </div>

      {/* Ana Ä°Ã§erik */}
      <div className="container mx-auto px-4 py-8 max-w-4xl">
        
        {/* BaÅŸlÄ±k */}
        <div className="mb-8">
          <h1 className="text-3xl font-bold text-gray-900">Yeni ÃœrÃ¼n Ekle</h1>
          <p className="text-gray-600 mt-2">MaÄŸazanÄ±za yeni Ã¼rÃ¼n ekleyin</p>
        </div>

        {/* Form */}
        <div className="bg-white rounded-xl shadow-lg overflow-hidden">
          <form onSubmit={handleSubmit}>
            <div className="p-6">
              
              {/* Resim YÃ¼kleme */}
              <div className="mb-8">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-lg font-bold text-gray-900">ÃœrÃ¼n Resmi *</h3>
                  {imageFile && (
                    <button
                      type="button"
                      onClick={removeImage}
                      className="text-red-600 hover:text-red-800 text-sm flex items-center"
                    >
                      <X className="mr-1" size={16} />
                      KaldÄ±r
                    </button>
                  )}
                </div>
                
                <div className="flex flex-col items-center">
                  {imagePreview ? (
                    <div className="w-full max-w-md">
                      <img
                        src={imagePreview}
                        alt="ÃœrÃ¼n resmi Ã¶nizleme"
                        className="w-full h-64 object-cover rounded-lg"
                      />
                    </div>
                  ) : (
                    <div className="w-full max-w-md">
                      <input
                        type="file"
                        id="image-upload"
                        accept="image/*"
                        onChange={handleImageChange}
                        className="hidden"
                      />
                      <label
                        htmlFor="image-upload"
                        className="block cursor-pointer"
                      >
                        <div className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors">
                          <div className="flex flex-col items-center">
                            <Upload className="text-gray-400 mb-4" size={48} />
                            <p className="text-gray-600 font-medium mb-2">
                              Resim YÃ¼kleyin
                            </p>
                            <p className="text-sm text-gray-500">
                              PNG, JPG veya GIF (max 5MB)
                            </p>
                            <p className="text-xs text-gray-400 mt-2">
                              Kalan resim hakkÄ±: {shop.total_images - (shop.free_images_used || 0)}
                            </p>
                          </div>
                        </div>
                      </label>
                    </div>
                  )}
                </div>
                
                {imageFile && (
                  <div className="mt-4 text-center text-sm text-gray-600">
                    <p>{imageFile.name} ({(imageFile.size / 1024).toFixed(2)} KB)</p>
                  </div>
                )}
              </div>

              {/* ÃœrÃ¼n Bilgileri */}
              <div className="space-y-6">
                {/* ÃœrÃ¼n AdÄ± */}
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    ÃœrÃ¼n AdÄ± *
                  </label>
                  <input
                    type="text"
                    required
                    value={formData.title}
                    onChange={(e) => setFormData({...formData, title: e.target.value})}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Ã–rn: Sony A7 III FotoÄŸraf Makinesi"
                  />
                </div>

                {/* AÃ§Ä±klama */}
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    AÃ§Ä±klama
                  </label>
                  <textarea
                    rows={3}
                    value={formData.description}
                    onChange={(e) => setFormData({...formData, description: e.target.value})}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    placeholder="ÃœrÃ¼nÃ¼n Ã¶zellikleri, durumu, teknik detaylarÄ±..."
                  />
                </div>

                {/* Kategori ve Fiyat */}
                <div className="grid md:grid-cols-2 gap-6">
                  {/* Kategori */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Kategori
                    </label>
                    <select
                      value={formData.category}
                      onChange={(e) => setFormData({...formData, category: e.target.value})}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    >
                      <option value="">Kategori SeÃ§in</option>
                      {categories.map((cat) => (
                        <option key={cat.id} value={cat.name}>{cat.name}</option>
                      ))}
                    </select>
                  </div>

                  {/* Fiyat */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Fiyat (TRY) *
                    </label>
                    <div className="relative">
                      <span className="absolute left-3 top-3 text-gray-500">â‚º</span>
                      <input
                        type="number"
                        required
                        step="0.01"
                        min="0"
                        value={formData.price}
                        onChange={(e) => setFormData({...formData, price: e.target.value})}
                        className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        placeholder="0.00"
                      />
                    </div>
                  </div>
                </div>

                {/* Miktar ve Konum */}
                <div className="grid md:grid-cols-2 gap-6">
                  {/* Miktar */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Stok Adedi
                    </label>
                    <input
                      type="number"
                      value={formData.quantity}
                      onChange={(e) => setFormData({...formData, quantity: parseInt(e.target.value) || 1})}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      placeholder="1"
                      min="1"
                    />
                  </div>

                  {/* Konum */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Konum
                    </label>
                    <input
                      type="text"
                      value={formData.location}
                      onChange={(e) => setFormData({...formData, location: e.target.value})}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      placeholder="Ä°stanbul - KadÄ±kÃ¶y"
                    />
                  </div>
                </div>

                {/* Durum */}
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    ÃœrÃ¼n Durumu
                  </label>
                  <div className="flex space-x-6">
                    <label className="flex items-center">
                      <input
                        type="radio"
                        name="status"
                        value="draft"
                        checked={formData.status === 'draft'}
                        onChange={(e) => setFormData({...formData, status: e.target.value})}
                        className="mr-2 h-5 w-5 text-blue-600"
                      />
                      <span className="text-gray-700">Taslak</span>
                    </label>
                    <label className="flex items-center">
                      <input
                        type="radio"
                        name="status"
                        value="active"
                        checked={formData.status === 'active'}
                        onChange={(e) => setFormData({...formData, status: e.target.value})}
                        className="mr-2 h-5 w-5 text-blue-600"
                      />
                      <span className="text-gray-700">Aktif</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>

            {/* Alt Bilgi ve Butonlar */}
            <div className="bg-gray-50 px-6 py-4 border-t border-gray-200">
              <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div className="text-sm text-gray-600">
                  <div className="flex items-center">
                    <span>Kalan Resim: {shop.total_images - (shop.free_images_used || 0)}</span>
                  </div>
                </div>
                
                <div className="flex space-x-4">
                  <button
                    type="button"
                    onClick={() => router.push(`/shop/${shopId}/dashboard`)}
                    className="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 text-gray-700"
                    disabled={loading}
                  >
                    Ä°ptal
                  </button>
                  <button
                    type="submit"
                    disabled={loading || !imageFile}
                    className="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center disabled:opacity-50 disabled:cursor-not-allowed"
                  >
                    {loading ? (
                      <>
                        <Loader2 className="animate-spin mr-2" size={20} />
                        Kaydediliyor...
                      </>
                    ) : (
                      <>
                        <Save className="mr-2" size={20} />
                        ÃœrÃ¼nÃ¼ Kaydet
                      </>
                    )}
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  );
}

ğŸ“„ app/shop/[id]/inventory/page.tsx
ğŸ“Š 499 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/shop/[id]/inventory/page.tsx - DÃœZELTÄ°LMÄ°Å VERSÄ°YON
'use client';

import { useState, useEffect } from 'react';
import { useRouter, useParams } from 'next/navigation';
import { supabase } from '@/lib/supabase';
import { Plus, Search, Filter, Eye, Edit, Trash2, Package, Loader2 } from 'lucide-react';

export default function InventoryPage() {
  const router = useRouter();
  const params = useParams();
  const shopId = params.id as string;
  
  const [products, setProducts] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [shop, setShop] = useState<any>(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [statusFilter, setStatusFilter] = useState<string>('all');
  const [categoryFilter, setCategoryFilter] = useState<string>('all');
  const [categories, setCategories] = useState<string[]>([]);
  const [deletingId, setDeletingId] = useState<string | null>(null);

  useEffect(() => {
    loadData();
  }, [shopId]);

  const loadData = async () => {
    try {
      // MaÄŸaza bilgilerini getir
      const { data: shopData } = await supabase
        .from('shops')
        .select('*')
        .eq('id', shopId)
        .single();
      
      if (shopData) {
        setShop(shopData);
      }

      // ÃœrÃ¼nleri getir
      await loadProducts();
      
      // Kategorileri getir - DÃœZELTÄ°LMÄ°Å KISIM
      const { data: categoriesData } = await supabase
        .from('shop_inventory')
        .select('category')
        .eq('shop_id', shopId)
        .not('category', 'is', null);

      if (categoriesData) {
        // ESKÄ°: const uniqueCategories = [...new Set(categoriesData.map(item => item.category))] as string[];
        // YENÄ°: Set yerine object kullan
        const categoryMap: Record<string, boolean> = {};
        categoriesData.forEach((item: { category: string | null }) => {
          if (item.category) {
            categoryMap[item.category] = true;
          }
        });
        const uniqueCategories = Object.keys(categoryMap);
        setCategories(uniqueCategories);
      }

    } catch (error) {
      console.error('Veriler yÃ¼klenemedi:', error);
      alert('Veriler yÃ¼klenirken bir hata oluÅŸtu');
    } finally {
      setLoading(false);
    }
  };

  const loadProducts = async () => {
    try {
      let query = supabase
        .from('shop_inventory')
        .select('*')
        .eq('shop_id', shopId)
        .order('created_at', { ascending: false });

      // Filtreler
      if (statusFilter !== 'all') {
        query = query.eq('status', statusFilter);
      }

      if (categoryFilter !== 'all') {
        query = query.eq('category', categoryFilter);
      }

      if (searchQuery) {
        query = query.or(`title.ilike.%${searchQuery}%,description.ilike.%${searchQuery}%,brand.ilike.%${searchQuery}%`);
      }

      const { data, error } = await query;

      if (error) throw error;
      setProducts(data || []);
    } catch (error) {
      console.error('ÃœrÃ¼nler yÃ¼klenemedi:', error);
    }
  };

  const handleDeleteProduct = async (productId: string) => {
    if (!confirm('Bu Ã¼rÃ¼nÃ¼ silmek istediÄŸinizden emin misiniz? Bu iÅŸlem geri alÄ±namaz.')) {
      return;
    }

    setDeletingId(productId);
    try {
      const { error } = await supabase
        .from('shop_inventory')
        .delete()
        .eq('id', productId)
        .eq('shop_id', shopId);

      if (error) throw error;

      // ÃœrÃ¼n resim sayacÄ±nÄ± gÃ¼ncelle
      const product = products.find(p => p.id === productId);
      if (product && product.images && shop) {
        const imageCount = product.images.length;
        await supabase
          .from('shops')
          .update({ free_images_used: Math.max(0, shop.free_images_used - imageCount) })
          .eq('id', shopId);
      }

      // Listeyi yenile
      await loadProducts();
      alert('ÃœrÃ¼n baÅŸarÄ±yla silindi');
    } catch (error) {
      console.error('ÃœrÃ¼n silme hatasÄ±:', error);
      alert('ÃœrÃ¼n silinirken bir hata oluÅŸtu');
    } finally {
      setDeletingId(null);
    }
  };

  const handleViewProduct = (productId: string) => {
    router.push(`/shop/${shopId}/inventory/${productId}`);
  };

  const handleEditProduct = (productId: string) => {
    router.push(`/shop/${shopId}/inventory/${productId}/edit`);
  };

  const handleAddProduct = () => {
    router.push(`/shop/${shopId}/inventory/add`);
  };

  const handleUpgradePackage = () => {
    router.push('/for-business?upgrade=true');
  };

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'active': return 'bg-green-100 text-green-800';
      case 'draft': return 'bg-yellow-100 text-yellow-800';
      case 'inactive': return 'bg-red-100 text-red-800';
      case 'sold': return 'bg-blue-100 text-blue-800';
      default: return 'bg-gray-100 text-gray-800';
    }
  };

  const getStatusText = (status: string) => {
    switch (status) {
      case 'active': return 'Aktif';
      case 'draft': return 'Taslak';
      case 'inactive': return 'Pasif';
      case 'sold': return 'SatÄ±ldÄ±';
      default: return status;
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="container mx-auto px-4">
          <div className="text-center py-12">
            <Loader2 className="animate-spin mx-auto text-blue-600 mb-4" size={48} />
            <p className="text-gray-600">Envanter yÃ¼kleniyor...</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="container mx-auto px-4">
        {/* BaÅŸlÄ±k ve Ä°statistikler */}
        <div className="mb-8">
          <div className="flex flex-col md:flex-row md:items-center justify-between mb-6">
            <div>
              <h1 className="text-3xl font-bold text-gray-900">ÃœrÃ¼n Envanteri</h1>
              <p className="text-gray-600">
                {shop?.shop_name} maÄŸazanÄ±zÄ±n tÃ¼m Ã¼rÃ¼nleri
              </p>
            </div>
            <button
              onClick={handleAddProduct}
              className="mt-4 md:mt-0 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg flex items-center"
            >
              <Plus className="mr-2" size={20} />
              Yeni ÃœrÃ¼n Ekle
            </button>
          </div>

          {/* Ä°statistik KartlarÄ± */}
          <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div className="bg-white rounded-xl shadow p-4">
              <div className="flex items-center">
                <div className="bg-blue-100 text-blue-600 p-3 rounded-lg mr-4">
                  <Package size={24} />
                </div>
                <div>
                  <p className="text-sm text-gray-600">Toplam ÃœrÃ¼n</p>
                  <p className="text-2xl font-bold text-gray-900">
                    {products.length}
                  </p>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-xl shadow p-4">
              <div className="flex items-center">
                <div className="bg-green-100 text-green-600 p-3 rounded-lg mr-4">
                  <Package size={24} />
                </div>
                <div>
                  <p className="text-sm text-gray-600">Aktif ÃœrÃ¼n</p>
                  <p className="text-2xl font-bold text-gray-900">
                    {products.filter(p => p.status === 'active').length}
                  </p>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-xl shadow p-4">
              <div className="flex items-center">
                <div className="bg-yellow-100 text-yellow-600 p-3 rounded-lg mr-4">
                  <Package size={24} />
                </div>
                <div>
                  <p className="text-sm text-gray-600">Taslak ÃœrÃ¼n</p>
                  <p className="text-2xl font-bold text-gray-900">
                    {products.filter(p => p.status === 'draft').length}
                  </p>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-xl shadow p-4">
              <div className="flex items-center">
                <div className="bg-red-100 text-red-600 p-3 rounded-lg mr-4">
                  <Package size={24} />
                </div>
                <div>
                  <p className="text-sm text-gray-600">SatÄ±lan ÃœrÃ¼n</p>
                  <p className="text-2xl font-bold text-gray-900">
                    {products.filter(p => p.status === 'sold').length}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* Filtreler ve Arama */}
        <div className="bg-white rounded-xl shadow p-6 mb-6">
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            {/* Arama */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                ÃœrÃ¼n Ara
              </label>
              <div className="relative">
                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={20} />
                <input
                  type="text"
                  value={searchQuery}
                  onChange={(e) => setSearchQuery(e.target.value)}
                  onKeyPress={(e) => e.key === 'Enter' && loadProducts()}
                  placeholder="ÃœrÃ¼n adÄ±, marka, aÃ§Ä±klama..."
                  className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                />
              </div>
            </div>

            {/* Durum Filtresi */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Durum
              </label>
              <select
                value={statusFilter}
                onChange={(e) => setStatusFilter(e.target.value)}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              >
                <option value="all">TÃ¼m Durumlar</option>
                <option value="active">Aktif</option>
                <option value="draft">Taslak</option>
                <option value="inactive">Pasif</option>
                <option value="sold">SatÄ±ldÄ±</option>
              </select>
            </div>

            {/* Kategori Filtresi */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Kategori
              </label>
              <select
                value={categoryFilter}
                onChange={(e) => setCategoryFilter(e.target.value)}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              >
                <option value="all">TÃ¼m Kategoriler</option>
                {categories.map((cat) => (
                  <option key={cat} value={cat}>{cat}</option>
                ))}
              </select>
            </div>
          </div>

          <div className="flex justify-between">
            <button
              onClick={loadProducts}
              className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg flex items-center"
            >
              <Filter className="mr-2" size={20} />
              Filtrele
            </button>
            <button
              onClick={() => {
                setSearchQuery('');
                setStatusFilter('all');
                setCategoryFilter('all');
                loadProducts();
              }}
              className="text-gray-600 hover:text-gray-900"
            >
              Filtreleri Temizle
            </button>
          </div>
        </div>

        {/* ÃœrÃ¼n Listesi */}
        <div className="bg-white rounded-xl shadow overflow-hidden">
          {products.length === 0 ? (
            <div className="p-12 text-center">
              <Package className="mx-auto text-gray-400 mb-4" size={48} />
              <h3 className="text-lg font-bold text-gray-900 mb-2">HenÃ¼z Ã¼rÃ¼n eklenmemiÅŸ</h3>
              <p className="text-gray-600 mb-6">
                MaÄŸazanÄ±za ilk Ã¼rÃ¼nÃ¼nÃ¼zÃ¼ ekleyerek baÅŸlayÄ±n
              </p>
              <button
                onClick={handleAddProduct}
                className="inline-block bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg"
              >
                Ä°lk ÃœrÃ¼nÃ¼ Ekle
              </button>
            </div>
          ) : (
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead className="bg-gray-50">
                  <tr>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">ÃœrÃ¼n</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Kategori</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Durum</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Fiyat</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Stok</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">GÃ¶rÃ¼ntÃ¼lenme</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Tarih</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Ä°ÅŸlemler</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-100">
                  {products.map((product) => (
                    <tr key={product.id} className="hover:bg-gray-50">
                      <td className="py-4 px-4">
                        <div className="flex items-center">
                          {product.images && product.images.length > 0 ? (
                            <img
                              src={product.images[0]}
                              alt={product.title}
                              className="w-12 h-12 object-cover rounded-lg mr-3"
                            />
                          ) : (
                            <div className="w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center mr-3">
                              <Package className="text-gray-400" size={20} />
                            </div>
                          )}
                          <div>
                            <div className="font-medium text-gray-900">
                              {product.title.length > 50 
                                ? product.title.substring(0, 50) + '...' 
                                : product.title}
                            </div>
                            {product.brand && (
                              <div className="text-sm text-gray-500">{product.brand}</div>
                            )}
                          </div>
                        </div>
                      </td>
                      <td className="py-4 px-4">
                        <span className="text-gray-700">{product.category || '-'}</span>
                      </td>
                      <td className="py-4 px-4">
                        <span className={`px-3 py-1 rounded-full text-xs font-medium ${getStatusColor(product.status)}`}>
                          {getStatusText(product.status)}
                        </span>
                      </td>
                      <td className="py-4 px-4">
                        <div className="font-bold text-gray-900">
                          {product.price.toLocaleString('tr-TR')} {product.price_currency}
                        </div>
                        {product.discount_percent && (
                          <div className="text-sm text-green-600">
                            %{product.discount_percent} indirim
                          </div>
                        )}
                      </td>
                      <td className="py-4 px-4">
                        <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                          product.quantity > 0 
                            ? 'bg-green-100 text-green-800' 
                            : 'bg-red-100 text-red-800'
                        }`}>
                          {product.quantity} adet
                        </span>
                      </td>
                      <td className="py-4 px-4">
                        <div className="text-gray-700">{product.view_count || 0}</div>
                        <div className="text-xs text-gray-500">gÃ¶rÃ¼ntÃ¼lenme</div>
                      </td>
                      <td className="py-4 px-4">
                        <div className="text-sm text-gray-500">
                          {new Date(product.created_at).toLocaleDateString('tr-TR')}
                        </div>
                      </td>
                      <td className="py-4 px-4">
                        <div className="flex space-x-2">
                          <button
                            onClick={() => handleViewProduct(product.id)}
                            className="p-2 text-blue-600 hover:bg-blue-50 rounded-lg"
                            title="GÃ¶rÃ¼ntÃ¼le"
                          >
                            <Eye size={18} />
                          </button>
                          <button
                            onClick={() => handleEditProduct(product.id)}
                            className="p-2 text-green-600 hover:bg-green-50 rounded-lg"
                            title="DÃ¼zenle"
                          >
                            <Edit size={18} />
                          </button>
                          <button
                            onClick={() => handleDeleteProduct(product.id)}
                            disabled={deletingId === product.id}
                            className="p-2 text-red-600 hover:bg-red-50 rounded-lg disabled:opacity-50"
                            title="Sil"
                          >
                            {deletingId === product.id ? (
                              <Loader2 className="animate-spin" size={18} />
                            ) : (
                              <Trash2 size={18} />
                            )}
                          </button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>

        {/* Resim Limiti UyarÄ±sÄ± */}
        {shop && shop.free_images_used >= shop.total_images && (
          <div className="mt-6 bg-yellow-50 border border-yellow-200 rounded-xl p-4">
            <div className="flex items-center">
              <div className="text-yellow-800">
                âš ï¸ Resim limitiniz doldu ({shop.free_images_used}/{shop.total_images}). 
                Yeni Ã¼rÃ¼n eklemek iÃ§in resim yÃ¼kleyemezsiniz.
              </div>
              <button
                onClick={handleUpgradePackage}
                className="ml-4 bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg text-sm"
              >
                Paket YÃ¼kselt
              </button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}

ğŸ“„ app/shop/[id]/page.tsx
ğŸ“Š 685 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/shop/[id]/page.tsx - TAM KOD (ÃœRÃœNLER GÃ–STERÄ°LECEK)
'use client'

import { useState, useEffect } from 'react'
import { useParams, useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'

export default function ShopPage() {
  const params = useParams()
  const router = useRouter()
  const shopId = params.id as string
  
  const [shop, setShop] = useState<any>(null)
  const [owner, setOwner] = useState<any>(null)
  const [inventory, setInventory] = useState<any[]>([]) // ÃœrÃ¼nler iÃ§in state ekle
  const [loading, setLoading] = useState(true)
  const [activeTab, setActiveTab] = useState<'products' | 'searches' | 'social' | 'about'>('products')
  const [followersCount, setFollowersCount] = useState(0)
  const [isFollowing, setIsFollowing] = useState(false)

  useEffect(() => {
    fetchShopData()
    checkIfFollowing()
  }, [shopId])

  const fetchShopData = async () => {
    try {
      console.log('Fetching shop with ID:', shopId)
      
      // 1. MaÄŸaza bilgilerini al
      const { data: shopData, error: shopError } = await supabase
        .from('shops')
        .select('*')
        .eq('id', shopId)
        .eq('is_active', true)
        .single()

      if (shopError) {
        console.error('Shop load error:', shopError)
        setLoading(false)
        return
      }

      console.log('Shop found:', shopData)
      
      setShop(shopData)
      fetchOwnerData(shopData.owner_id)
      fetchFollowersCount(shopData.id)
      fetchInventory(shopData.id) // ÃœrÃ¼nleri getir
      
    } catch (error) {
      console.error('Shop data fetch error:', error)
      setLoading(false)
    }
  }

  const fetchOwnerData = async (ownerId: string) => {
    try {
      const { data: ownerData } = await supabase
        .from('user_profiles')
        .select('*')
        .eq('id', ownerId)
        .single()
      
      setOwner(ownerData || { name: 'MaÄŸaza Sahibi', email: '' })
    } catch (error) {
      console.error('Owner fetch error:', error)
      setOwner({ name: 'MaÄŸaza Sahibi', email: '' })
    }
  }

  const fetchInventory = async (shopId: string) => {
    try {
      console.log('Fetching inventory for shop:', shopId)
      
      // shop_inventory tablosundan Ã¼rÃ¼nleri getir
      const { data: inventoryData, error: inventoryError } = await supabase
        .from('shop_inventory')
        .select('*')
        .eq('shop_id', shopId)
        .eq('status', 'active')
        .order('created_at', { ascending: false })
        .limit(12)

      if (inventoryError) {
        console.error('Inventory load error:', inventoryError)
        setInventory([])
        return
      }

      console.log('Inventory found:', inventoryData?.length || 0, 'items')
      setInventory(inventoryData || [])
    } catch (error) {
      console.error('Inventory fetch error:', error)
      setInventory([])
    }
  }

  const fetchFollowersCount = async (shopId: string) => {
    try {
      const { count } = await supabase
        .from('shop_customer_relationships')
        .select('*', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('relationship_type', 'follower')

      setFollowersCount(count || 0)
    } catch (error) {
      console.error('Followers count error:', error)
      setFollowersCount(0)
    } finally {
      setLoading(false)
    }
  }

  const checkIfFollowing = async () => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      const { data: follow } = await supabase
        .from('shop_customer_relationships')
        .select('id')
        .eq('shop_id', shopId)
        .eq('customer_id', user.id)
        .eq('relationship_type', 'follower')
        .single()

      setIsFollowing(!!follow)
    } catch (error) {
      console.log('Follow check - not following')
    }
  }

  const handleFollowToggle = async () => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) {
        router.push('/login?redirect=' + window.location.pathname)
        return
      }

      if (isFollowing) {
        // Takibi bÄ±rak
        await supabase
          .from('shop_customer_relationships')
          .delete()
          .eq('shop_id', shopId)
          .eq('customer_id', user.id)
          .eq('relationship_type', 'follower')

        setFollowersCount(prev => Math.max(0, prev - 1))
        setIsFollowing(false)
      } else {
        // Takip et
        await supabase
          .from('shop_customer_relationships')
          .insert({
            shop_id: shopId,
            customer_id: user.id,
            relationship_type: 'follower'
          })

        setFollowersCount(prev => prev + 1)
        setIsFollowing(true)
      }
    } catch (error) {
      console.error('Follow toggle error:', error)
      alert('Ä°ÅŸlem sÄ±rasÄ±nda bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.')
    }
  }

  // Loading state
  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50">
        <div className="container-custom py-8">
          <div className="animate-pulse">
            <div className="h-48 bg-gray-200 rounded-xl mb-6"></div>
            <div className="h-8 bg-gray-200 rounded w-1/4 mb-4"></div>
            <div className="h-4 bg-gray-200 rounded w-1/2 mb-8"></div>
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
              {[...Array(8)].map((_, i) => (
                <div key={i} className="h-64 bg-gray-200 rounded-lg"></div>
              ))}
            </div>
          </div>
        </div>
      </div>
    )
  }

  // Shop not found
  if (!shop) {
    return (
      <div className="min-h-screen bg-gray-50">
        <div className="container-custom py-12 text-center">
          <div className="text-4xl mb-4">ğŸª</div>
          <h1 className="text-3xl font-bold text-gray-900 mb-4">MaÄŸaza bulunamadÄ±</h1>
          <p className="text-gray-600 mb-8">
            ID: <code className="bg-gray-200 px-2 py-1 rounded">{shopId}</code> ile maÄŸaza bulunamadÄ±.
          </p>
          
          <button
            onClick={() => router.push('/')}
            className="btn-primary"
          >
            Ana Sayfaya DÃ¶n
          </button>
        </div>
      </div>
    )
  }

  // Main render
  return (
    <div className="min-h-screen bg-gray-50">
      <div className="container-custom py-8">
        {/* Geri dÃ¶n butonu */}
        <div className="mb-6">
          <button
            onClick={() => router.push('/')}
            className="text-blue-600 hover:text-blue-800 flex items-center"
          >
            â† Ana Sayfaya DÃ¶n
          </button>
        </div>

        {/* MaÄŸaza Header */}
        <div className="bg-white rounded-2xl shadow-lg overflow-hidden mb-8">
          {/* Cover Image */}
          <div className="h-48 bg-gradient-to-r from-blue-500 to-purple-600 relative">
            {shop.cover_url ? (
              <img 
                src={shop.cover_url} 
                alt={shop.shop_name} 
                className="w-full h-full object-cover"
              />
            ) : (
              <div className="w-full h-full flex items-center justify-center">
                <span className="text-white text-4xl">ğŸª</span>
              </div>
            )}
            
            {/* Logo */}
            <div className="absolute -bottom-8 left-8">
              <div className="w-24 h-24 bg-white rounded-xl shadow-lg border-4 border-white flex items-center justify-center">
                {shop.logo_url ? (
                  <img 
                    src={shop.logo_url} 
                    alt={shop.shop_name} 
                    className="w-full h-full object-cover rounded-lg"
                  />
                ) : (
                  <span className="text-3xl text-blue-600">ğŸ¬</span>
                )}
              </div>
            </div>
          </div>

          {/* Shop Info */}
          <div className="pt-12 pb-6 px-8">
            <div className="flex flex-col md:flex-row justify-between items-start md:items-center">
              <div>
                <div className="flex items-center space-x-3 mb-2">
                  <h1 className="text-3xl font-bold text-gray-900">
                    {shop.shop_name}
                  </h1>
                  {shop.is_verified && (
                    <span className="bg-blue-100 text-blue-700 text-xs font-semibold px-2 py-1 rounded">
                      âœ” DoÄŸrulanmÄ±ÅŸ
                    </span>
                  )}
                </div>
                
                <p className="text-gray-600 mb-4">
                  {shop.description || 'MaÄŸaza aÃ§Ä±klamasÄ± bulunmuyor.'}
                </p>
                
                <div className="flex items-center space-x-6 text-sm text-gray-500">
                  <div className="flex items-center">
                    <span className="mr-2">ğŸ“</span>
                    <span>{shop.city || 'Konum belirtilmemiÅŸ'}</span>
                  </div>
                  <div className="flex items-center">
                    <span className="mr-2">ğŸ‘¤</span>
                    <span>{owner?.name || 'MaÄŸaza Sahibi'}</span>
                  </div>
                  <div className="flex items-center">
                    <span className="mr-2">ğŸ“…</span>
                    <span>
                      {new Date(shop.created_at).toLocaleDateString('tr-TR')} tarihinde aÃ§Ä±ldÄ±
                    </span>
                  </div>
                </div>
              </div>

              {/* Action Buttons */}
              <div className="mt-4 md:mt-0 flex space-x-3">
                <button
                  onClick={handleFollowToggle}
                  className={`px-6 py-3 rounded-lg font-medium flex items-center ${
                    isFollowing
                      ? 'bg-gray-100 text-gray-800 hover:bg-gray-200'
                      : 'bg-blue-600 text-white hover:bg-blue-700'
                  }`}
                >
                  <span className="mr-2">
                    {isFollowing ? 'âœ“' : '+'}
                  </span>
                  {isFollowing ? 'Takip Ediliyor' : 'Takip Et'}
                  <span className="ml-2 text-sm opacity-80">
                    ({followersCount})
                  </span>
                </button>
                
                <button
                  onClick={() => console.log('Contact shop')}
                  className="px-6 py-3 border border-blue-600 text-blue-600 rounded-lg font-medium hover:bg-blue-50"
                >
                  ğŸ“ Ä°letiÅŸim
                </button>
                
                <button
                  onClick={() => console.log('Share shop')}
                  className="px-4 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50"
                >
                  ğŸ“¤ PaylaÅŸ
                </button>
              </div>
            </div>
          </div>
        </div>

        {/* Ä°statistikler */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
          <div className="bg-white rounded-xl shadow p-4 text-center">
            <div className="text-2xl font-bold text-blue-700">{inventory.length}</div>
            <div className="text-sm text-blue-600">ÃœrÃ¼n</div>
          </div>
          <div className="bg-white rounded-xl shadow p-4 text-center">
            <div className="text-2xl font-bold text-green-700">0</div>
            <div className="text-sm text-green-600">Arama</div>
          </div>
          <div className="bg-white rounded-xl shadow p-4 text-center">
            <div className="text-2xl font-bold text-purple-700">{followersCount}</div>
            <div className="text-sm text-purple-600">TakipÃ§i</div>
          </div>
          <div className="bg-white rounded-xl shadow p-4 text-center">
            <div className="text-2xl font-bold text-orange-700">
              {new Date(shop.created_at).toLocaleDateString('tr-TR')}
            </div>
            <div className="text-sm text-orange-600">AÃ§Ä±lma</div>
          </div>
        </div>

        {/* Tabs */}
        <div className="bg-white rounded-xl shadow mb-6">
          <div className="flex border-b">
            {['products', 'searches', 'social', 'about'].map((tab) => (
              <button
                key={tab}
                onClick={() => setActiveTab(tab as any)}
                className={`px-6 py-4 font-medium ${
                  activeTab === tab
                    ? 'text-blue-600 border-b-2 border-blue-600'
                    : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
                }`}
              >
                {tab === 'products' && 'ğŸ“¦ ÃœrÃ¼nler'}
                {tab === 'searches' && 'ğŸ” AradÄ±klarÄ±'}
                {tab === 'social' && 'ğŸ’¬ Sosyal'}
                {tab === 'about' && 'â„¹ï¸ HakkÄ±nda'}
              </button>
            ))}
          </div>
        </div>

        {/* Tab Content */}
        <div className="mt-8">
          {activeTab === 'products' && (
            <div>
              {/* ÃœrÃ¼nler Grid */}
              {inventory.length === 0 ? (
                <div className="bg-white rounded-xl shadow p-8 text-center">
                  <div className="text-4xl mb-4">ğŸ“¦</div>
                  <h3 className="text-2xl font-bold text-gray-900 mb-4">HenÃ¼z Ã¼rÃ¼n eklenmemiÅŸ</h3>
                  <p className="text-gray-600 mb-8">
                    Bu maÄŸaza henÃ¼z Ã¼rÃ¼n eklememiÅŸ. ÃœrÃ¼n eklemek iÃ§in maÄŸaza dashboard'una gidin.
                  </p>
                  <button
                    onClick={() => router.push(`/dashboard/shop/${shopId}`)}
                    className="btn-primary"
                  >
                    MaÄŸaza Dashboard'una Git
                  </button>
                </div>
              ) : (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                  {inventory.map((product) => (
                    <div 
                      key={product.id}
                      className="bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow overflow-hidden group cursor-pointer"
                      onClick={() => router.push(`/shop/${shopId}/products/${product.id}`)}
                    >
                      {/* ÃœrÃ¼n Resmi */}
                      <div className="relative h-48 bg-gray-100 overflow-hidden">
                        {product.images && product.images.length > 0 ? (
                          <img
                            src={product.images[0]}
                            alt={product.title}
                            className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                          />
                        ) : (
                          <div className="w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200">
                            <div className="text-center">
                              <span className="text-3xl text-gray-400">ğŸ“¦</span>
                              <p className="text-sm text-gray-500 mt-2">Resim Yok</p>
                            </div>
                          </div>
                        )}
                        
                        {/* ÃœrÃ¼n Durumu */}
                        <div className="absolute top-3 left-3">
                          <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                            product.condition === 'new' ? 'bg-green-100 text-green-800' :
                            product.condition === 'used' ? 'bg-yellow-100 text-yellow-800' :
                            'bg-gray-100 text-gray-800'
                          }`}>
                            {product.condition === 'new' ? 'Yeni' : 
                             product.condition === 'used' ? 'KullanÄ±lmÄ±ÅŸ' : 'DiÄŸer'}
                          </span>
                        </div>
                        
                        {/* GÃ¶rÃ¼ntÃ¼lenme SayÄ±sÄ± */}
                        {product.view_count > 0 && (
                          <div className="absolute top-3 right-3 bg-black bg-opacity-60 text-white px-2 py-1 rounded-full text-xs">
                            ğŸ‘ï¸ {product.view_count}
                          </div>
                        )}
                      </div>

                      {/* ÃœrÃ¼n Bilgileri */}
                      <div className="p-4">
                        <h3 className="font-bold text-gray-900 mb-2 line-clamp-1 group-hover:text-blue-600">
                          {product.title}
                        </h3>
                        
                        {product.description && (
                          <p className="text-gray-600 text-sm mb-3 line-clamp-2">
                            {product.description}
                          </p>
                        )}

                        <div className="flex items-center justify-between">
                          <div className="font-bold text-lg text-gray-900">
                            {product.price ? `${product.price.toLocaleString('tr-TR')} ${product.currency || 'â‚º'}` : 'Fiyat BelirtilmemiÅŸ'}
                          </div>
                          
                          {product.location && (
                            <div className="text-sm text-gray-500 flex items-center">
                              <span className="mr-1">ğŸ“</span>
                              {product.location.split(',')[0]}
                            </div>
                          )}
                        </div>

                        {/* ÃœrÃ¼n DetaylarÄ± */}
                        <div className="mt-3 pt-3 border-t border-gray-100">
                          <div className="flex justify-between text-xs text-gray-500">
                            <span>
                              {product.category || 'Kategori yok'}
                            </span>
                            <span>
                              {new Date(product.created_at).toLocaleDateString('tr-TR')}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              )}
              
              {/* Daha Fazla ÃœrÃ¼n Butonu */}
              {inventory.length > 0 && (
                <div className="mt-8 text-center">
                  <button
                    onClick={() => router.push(`/shop/${shopId}/products`)}
                    className="bg-white border-2 border-blue-600 text-blue-600 hover:bg-blue-50 font-medium py-3 px-8 rounded-lg"
                  >
                    TÃ¼m ÃœrÃ¼nleri GÃ¶r ({inventory.length})
                  </button>
                </div>
              )}
            </div>
          )}

          {activeTab === 'searches' && (
            <div className="bg-white rounded-xl shadow p-8">
              <h3 className="text-2xl font-bold text-gray-900 mb-6">ğŸ” MaÄŸazanÄ±n AradÄ±klarÄ±</h3>
              <div className="text-center py-12">
                <div className="text-4xl mb-4">ğŸ”</div>
                <h4 className="text-xl font-semibold text-gray-800 mb-2">HenÃ¼z arama eklenmemiÅŸ</h4>
                <p className="text-gray-600">
                  MaÄŸaza henÃ¼z ne aradÄ±ÄŸÄ±nÄ± belirtmemiÅŸ.
                </p>
              </div>
            </div>
          )}

          {activeTab === 'social' && (
            <div className="bg-white rounded-xl shadow p-8">
              <h3 className="text-2xl font-bold text-gray-900 mb-6">ğŸ’¬ Sosyal PaylaÅŸÄ±mlar</h3>
              <div className="text-center py-12">
                <div className="text-4xl mb-4">ğŸ’¬</div>
                <h4 className="text-xl font-semibold text-gray-800 mb-2">HenÃ¼z paylaÅŸÄ±m yok</h4>
                <p className="text-gray-600">
                  MaÄŸaza henÃ¼z sosyal paylaÅŸÄ±m yapmamÄ±ÅŸ.
                </p>
              </div>
            </div>
          )}

          {activeTab === 'about' && (
            <div className="bg-white rounded-xl shadow p-8">
              <h3 className="text-2xl font-bold text-gray-900 mb-6">â„¹ï¸ MaÄŸaza HakkÄ±nda</h3>
              
              <div className="prose max-w-none mb-8">
                {shop.description ? (
                  <div className="text-gray-700 whitespace-pre-line">
                    {shop.description}
                  </div>
                ) : (
                  <p className="text-gray-500 italic">
                    MaÄŸaza henÃ¼z bir aÃ§Ä±klama eklememiÅŸ.
                  </p>
                )}
              </div>

              {/* Ä°letiÅŸim bilgileri */}
              <div className="grid md:grid-cols-2 gap-8">
                <div>
                  <h4 className="font-bold text-gray-900 mb-4 flex items-center">
                    <span className="mr-2">ğŸ“</span> Ä°letiÅŸim Bilgileri
                  </h4>
                  <div className="space-y-3">
                    {shop.phone && (
                      <div className="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span className="mr-3 text-xl">ğŸ“±</span>
                        <div>
                          <div className="font-medium">Telefon</div>
                          <div className="text-gray-600">{shop.phone}</div>
                        </div>
                      </div>
                    )}
                    {shop.email && (
                      <div className="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span className="mr-3 text-xl">ğŸ“§</span>
                        <div>
                          <div className="font-medium">E-posta</div>
                          <div className="text-gray-600">{shop.email}</div>
                        </div>
                      </div>
                    )}
                    {shop.website && (
                      <div className="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span className="mr-3 text-xl">ğŸŒ</span>
                        <div>
                          <div className="font-medium">Website</div>
                          <a 
                            href={shop.website.startsWith('http') ? shop.website : `https://${shop.website}`}
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-blue-600 hover:text-blue-800"
                          >
                            {shop.website}
                          </a>
                        </div>
                      </div>
                    )}
                  </div>
                </div>

                <div>
                  <h4 className="font-bold text-gray-900 mb-4 flex items-center">
                    <span className="mr-2">ğŸ“</span> Lokasyon
                  </h4>
                  <div className="space-y-3">
                    {shop.address && (
                      <div className="p-3 bg-gray-50 rounded-lg">
                        <div className="flex items-start">
                          <span className="mr-3 text-xl">ğŸ </span>
                          <div>
                            <div className="font-medium">Adres</div>
                            <div className="text-gray-600">{shop.address}</div>
                          </div>
                        </div>
                      </div>
                    )}
                    {shop.city && (
                      <div className="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span className="mr-3 text-xl">ğŸ™ï¸</span>
                        <div>
                          <div className="font-medium">Åehir</div>
                          <div className="text-gray-600">{shop.city}</div>
                        </div>
                      </div>
                    )}
                  </div>
                  
                  <div className="mt-6">
                    <button 
                      onClick={() => console.log('Show map')}
                      className="w-full py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700"
                    >
                      ğŸ—ºï¸ Haritada GÃ¶ster
                    </button>
                  </div>
                </div>
              </div>

              {/* Ä°statistikler */}
              <div className="mt-12 pt-8 border-t border-gray-200">
                <h4 className="font-bold text-gray-900 mb-6">ğŸ“Š MaÄŸaza Ä°statistikleri</h4>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                  <div className="bg-blue-50 p-4 rounded-lg text-center">
                    <div className="text-2xl font-bold text-blue-700">{inventory.length}</div>
                    <div className="text-sm text-blue-600">ÃœrÃ¼n</div>
                  </div>
                  <div className="bg-green-50 p-4 rounded-lg text-center">
                    <div className="text-2xl font-bold text-green-700">0</div>
                    <div className="text-sm text-green-600">Arama</div>
                  </div>
                  <div className="bg-purple-50 p-4 rounded-lg text-center">
                    <div className="text-2xl font-bold text-purple-700">{followersCount}</div>
                    <div className="text-sm text-purple-600">TakipÃ§i</div>
                  </div>
                  <div className="bg-orange-50 p-4 rounded-lg text-center">
                    <div className="text-2xl font-bold text-orange-700">
                      {new Date(shop.created_at).toLocaleDateString('tr-TR')}
                    </div>
                    <div className="text-sm text-orange-600">AÃ§Ä±lma Tarihi</div>
                  </div>
                </div>
              </div>
            </div>
          )}
        </div>

        {/* Call to Action */}
        <div className="mt-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl p-8 text-white text-center">
          <h3 className="text-2xl font-bold mb-4">Bu maÄŸazayla iletiÅŸime geÃ§mek ister misiniz?</h3>
          <p className="mb-6 opacity-90">
            ÃœrÃ¼n satÄ±n almak, satmak veya iÅŸbirliÄŸi yapmak iÃ§in direkt iletiÅŸime geÃ§in.
          </p>
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <button
              onClick={() => setActiveTab('searches')}
              className="bg-white text-blue-600 hover:bg-gray-100 font-bold py-3 px-6 rounded-lg"
            >
              ğŸ” Neler ArÄ±yor?
            </button>
            <button
              onClick={() => console.log('contact shop')}
              className="bg-transparent border-2 border-white hover:bg-white hover:bg-opacity-20 font-bold py-3 px-6 rounded-lg"
            >
              ğŸ“ Ä°letiÅŸime GeÃ§
            </button>
            <button
              onClick={handleFollowToggle}
              className={`border-2 font-bold py-3 px-6 rounded-lg ${
                isFollowing
                  ? 'border-white text-white'
                  : 'bg-white text-blue-600 hover:bg-gray-100'
              }`}
            >
              {isFollowing ? 'âœ“ Takip Ediliyor' : '+ Takip Et'}
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ app/shop/analytics/page.tsx
ğŸ“Š 480 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/shop/analytics/page.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Header from '@/components/Header'
import Footer from '@/components/Footer'

interface AnalyticsData {
  date: string
  views: number
  clicks: number
  helps: number
}

interface SpotPerformance {
  id: string
  title: string
  views: number
  helps: number
  conversion_rate: number
}

interface TimeRange {
  label: string
  value: '7days' | '30days' | '90days' | 'year'
}

interface Spot {
  id: string
  title: string
  views: number
  helps: number
  created_at: string
}

interface Shop {
  id: string
  shop_name: string
  owner_id: string
}

export default function AnalyticsPage() {
  const router = useRouter()
  const [loading, setLoading] = useState(true)
  const [shop, setShop] = useState<Shop | null>(null)
  const [timeRange, setTimeRange] = useState<TimeRange['value']>('30days')
  const [analyticsData, setAnalyticsData] = useState<AnalyticsData[]>([])
  const [topSpots, setTopSpots] = useState<SpotPerformance[]>([])
  const [stats, setStats] = useState({
    totalViews: 0,
    totalClicks: 0,
    totalHelps: 0,
    avgResponseTime: '24s',
    successRate: '68%'
  })

  useEffect(() => {
    checkAuthAndLoadData()
  }, [timeRange])

  const checkAuthAndLoadData = async () => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      
      if (!user) {
        router.push('/login?redirect=/shop/analytics')
        return
      }

      // MaÄŸazayÄ± getir
      const { data: shopData } = await supabase
        .from('shops')
        .select('*')
        .eq('owner_id', user.id)
        .single()

      if (!shopData) {
        router.push('/for-business')
        return
      }

      setShop(shopData)
      await loadAnalyticsData(user.id)
      
    } catch (error) {
      console.error('Analitik verileri yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const loadAnalyticsData = async (ownerId: string) => {
    try {
      // Son 30 gÃ¼nÃ¼n spot'larÄ±nÄ± getir
      const thirtyDaysAgo = new Date()
      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30)

      const { data: spots } = await supabase
        .from('spots')
        .select('id, title, views, helps, created_at')
        .eq('user_id', ownerId)
        .gte('created_at', thirtyDaysAgo.toISOString())
        .order('created_at', { ascending: false })

      // Analytics verilerini oluÅŸtur
      const analytics: AnalyticsData[] = []
      const now = new Date()
      
      // Son 7, 30 veya 90 gÃ¼n iÃ§in veri oluÅŸtur
      const days = timeRange === '7days' ? 7 : timeRange === '30days' ? 30 : timeRange === '90days' ? 90 : 365
      
      for (let i = days - 1; i >= 0; i--) {
        const date = new Date()
        date.setDate(date.getDate() - i)
        const dateStr = date.toISOString().split('T')[0]
        
        // Bu tarihteki spot'larÄ± filtrele
        const daySpots = (spots || []).filter((spot: Spot) => 
          new Date(spot.created_at).toISOString().split('T')[0] === dateStr
        )
        
        const dayStats = daySpots.reduce((acc: { views: number; clicks: number; helps: number }, spot: Spot) => ({
          views: acc.views + (spot.views || 0),
          clicks: acc.clicks + 0, // Burada click tracking olacak
          helps: acc.helps + (spot.helps || 0)
        }), { views: 0, clicks: 0, helps: 0 })
        
        analytics.push({
          date: date.toLocaleDateString('tr-TR', { day: '2-digit', month: 'short' }),
          ...dayStats
        })
      }

      setAnalyticsData(analytics)

      // Top spot'larÄ± belirle
      const spotPerformance: SpotPerformance[] = (spots || []).map((spot: Spot) => ({
        id: spot.id,
        title: spot.title.length > 40 ? spot.title.substring(0, 40) + '...' : spot.title,
        views: spot.views || 0,
        helps: spot.helps || 0,
        conversion_rate: spot.views ? Math.round((spot.helps / spot.views) * 100) : 0
      })).sort((a: SpotPerformance, b: SpotPerformance) => b.views - a.views).slice(0, 5)

      setTopSpots(spotPerformance)

      // Toplam istatistikler
      const totalViews = (spots || []).reduce((sum: number, spot: Spot) => sum + (spot.views || 0), 0)
      const totalHelps = (spots || []).reduce((sum: number, spot: Spot) => sum + (spot.helps || 0), 0)

      setStats({
        totalViews,
        totalClicks: Math.round(totalViews * 0.3), // Tahmini click oranÄ±
        totalHelps,
        avgResponseTime: '24s',
        successRate: totalViews ? Math.round((totalHelps / totalViews) * 100) + '%' : '0%'
      })

    } catch (error) {
      console.error('Analitik veri yÃ¼kleme hatasÄ±:', error)
    }
  }

  const timeRanges: TimeRange[] = [
    { label: '7 GÃ¼n', value: '7days' },
    { label: '30 GÃ¼n', value: '30days' },
    { label: '90 GÃ¼n', value: '90days' },
    { label: '1 YÄ±l', value: 'year' }
  ]

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        <main className="container-custom py-12 text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">Analitik yÃ¼kleniyor...</p>
        </main>
        <Footer />
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8">
        {/* BaÅŸlÄ±k */}
        <div className="mb-8">
          <div className="flex flex-col md:flex-row md:items-center justify-between mb-6">
            <div>
              <h1 className="text-3xl font-bold text-gray-900 mb-2">MaÄŸaza Analitik</h1>
              <p className="text-gray-600">
                {shop?.shop_name} maÄŸazanÄ±zÄ±n performans verileri
              </p>
            </div>
            
            <div className="flex items-center space-x-4 mt-4 md:mt-0">
              {/* Zaman AralÄ±ÄŸÄ± */}
              <div className="bg-white rounded-lg border border-gray-300">
                <select
                  value={timeRange}
                  onChange={(e) => setTimeRange(e.target.value as TimeRange['value'])}
                  className="px-4 py-2 bg-transparent focus:outline-none"
                >
                  {timeRanges.map(range => (
                    <option key={range.value} value={range.value}>
                      {range.label}
                    </option>
                  ))}
                </select>
              </div>
              
              <button
                onClick={() => router.push('/shop/dashboard')}
                className="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg"
              >
                â† Dashboard'a DÃ¶n
              </button>
            </div>
          </div>
        </div>

        {/* Ä°statistik KartlarÄ± */}
        <div className="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
          <div className="bg-white rounded-xl p-4 shadow">
            <div className="text-2xl font-bold text-blue-600 mb-1">{stats.totalViews}</div>
            <div className="text-sm text-gray-600">Toplam GÃ¶rÃ¼ntÃ¼lenme</div>
            <div className="text-xs text-green-600 mt-2">â†‘ %12 artÄ±ÅŸ</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow">
            <div className="text-2xl font-bold text-purple-600 mb-1">{stats.totalClicks}</div>
            <div className="text-sm text-gray-600">TÄ±klanma</div>
            <div className="text-xs text-green-600 mt-2">â†‘ %8 artÄ±ÅŸ</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow">
            <div className="text-2xl font-bold text-green-600 mb-1">{stats.totalHelps}</div>
            <div className="text-sm text-gray-600">YardÄ±m</div>
            <div className="text-xs text-green-600 mt-2">â†‘ %15 artÄ±ÅŸ</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow">
            <div className="text-2xl font-bold text-orange-600 mb-1">{stats.avgResponseTime}</div>
            <div className="text-sm text-gray-600">Ort. YanÄ±t SÃ¼resi</div>
            <div className="text-xs text-red-600 mt-2">â†“ %5 azalma</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow">
            <div className="text-2xl font-bold text-indigo-600 mb-1">{stats.successRate}</div>
            <div className="text-sm text-gray-600">BaÅŸarÄ± OranÄ±</div>
            <div className="text-xs text-green-600 mt-2">â†‘ %3 artÄ±ÅŸ</div>
          </div>
        </div>

        {/* Grafik ve Performans */}
        <div className="grid lg:grid-cols-2 gap-8 mb-8">
          {/* GÃ¶rÃ¼ntÃ¼lenme GrafiÄŸi */}
          <div className="bg-white rounded-xl shadow p-6">
            <h3 className="text-lg font-bold text-gray-900 mb-6">GÃ¶rÃ¼ntÃ¼lenme Trendi</h3>
            <div className="h-64">
              <div className="flex items-end h-48 space-x-2">
                {analyticsData.map((data, index) => (
                  <div key={index} className="flex-1 flex flex-col items-center">
                    <div 
                      className="w-full bg-blue-500 rounded-t-lg"
                      style={{ height: `${Math.min(100, (data.views / Math.max(...analyticsData.map(d => d.views))) * 100)}%` }}
                    ></div>
                    <div className="text-xs text-gray-500 mt-2">{data.date}</div>
                  </div>
                ))}
              </div>
              <div className="flex justify-between mt-4 text-sm text-gray-600">
                <div className="flex items-center">
                  <div className="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                  GÃ¶rÃ¼ntÃ¼lenme
                </div>
                <div className="flex items-center">
                  <div className="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                  YardÄ±m
                </div>
              </div>
            </div>
          </div>

          {/* Performans Metrikleri */}
          <div className="bg-white rounded-xl shadow p-6">
            <h3 className="text-lg font-bold text-gray-900 mb-6">Performans Metrikleri</h3>
            <div className="space-y-6">
              <div>
                <div className="flex justify-between mb-2">
                  <span className="text-sm font-medium text-gray-700">GÃ¶rÃ¼ntÃ¼lenme â†’ YardÄ±m DÃ¶nÃ¼ÅŸÃ¼mÃ¼</span>
                  <span className="text-sm font-bold text-green-600">%{stats.successRate.replace('%', '')}</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div 
                    className="bg-green-500 h-2 rounded-full"
                    style={{ width: stats.successRate }}
                  ></div>
                </div>
              </div>

              <div>
                <div className="flex justify-between mb-2">
                  <span className="text-sm font-medium text-gray-700">Spot Tamamlama OranÄ±</span>
                  <span className="text-sm font-bold text-blue-600">%42</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div 
                    className="bg-blue-500 h-2 rounded-full"
                    style={{ width: '42%' }}
                  ></div>
                </div>
              </div>

              <div>
                <div className="flex justify-between mb-2">
                  <span className="text-sm font-medium text-gray-700">MÃ¼ÅŸteri Memnuniyeti</span>
                  <span className="text-sm font-bold text-purple-600">%89</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div 
                    className="bg-purple-500 h-2 rounded-full"
                    style={{ width: '89%' }}
                  ></div>
                </div>
              </div>

              <div>
                <div className="flex justify-between mb-2">
                  <span className="text-sm font-medium text-gray-700">Aktif Spot OranÄ±</span>
                  <span className="text-sm font-bold text-orange-600">%76</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div 
                    className="bg-orange-500 h-2 rounded-full"
                    style={{ width: '76%' }}
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* En Ä°yi PerformanslÄ± Spot'lar */}
        <div className="bg-white rounded-xl shadow p-6 mb-8">
          <h3 className="text-lg font-bold text-gray-900 mb-6">En Ä°yi PerformanslÄ± Spot'lar</h3>
          
          {topSpots.length === 0 ? (
            <div className="text-center py-8">
              <div className="text-4xl mb-4">ğŸ“Š</div>
              <p className="text-gray-600">HenÃ¼z yeterli veri bulunmuyor</p>
            </div>
          ) : (
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead>
                  <tr className="bg-gray-50">
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Spot</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">GÃ¶rÃ¼ntÃ¼lenme</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">YardÄ±m</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">DÃ¶nÃ¼ÅŸÃ¼m OranÄ±</th>
                    <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Performans</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-100">
                  {topSpots.map((spot) => (
                    <tr key={spot.id} className="hover:bg-gray-50">
                      <td className="py-3 px-4">
                        <a 
                          href={`/spots/${spot.id}`}
                          className="font-medium text-blue-600 hover:text-blue-800"
                        >
                          {spot.title}
                        </a>
                      </td>
                      <td className="py-3 px-4">{spot.views}</td>
                      <td className="py-3 px-4">{spot.helps}</td>
                      <td className="py-3 px-4">
                        <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                          spot.conversion_rate > 50 
                            ? 'bg-green-100 text-green-800'
                            : spot.conversion_rate > 20
                            ? 'bg-yellow-100 text-yellow-800'
                            : 'bg-red-100 text-red-800'
                        }`}>
                          %{spot.conversion_rate}
                        </span>
                      </td>
                      <td className="py-3 px-4">
                        <div className="flex items-center">
                          {spot.conversion_rate > 50 ? (
                            <>
                              <span className="text-green-500 mr-2">ğŸ”¥</span>
                              <span className="text-sm text-green-600">MÃ¼kemmel</span>
                            </>
                          ) : spot.conversion_rate > 20 ? (
                            <>
                              <span className="text-yellow-500 mr-2">âš¡</span>
                              <span className="text-sm text-yellow-600">Ä°yi</span>
                            </>
                          ) : (
                            <>
                              <span className="text-red-500 mr-2">ğŸ“‰</span>
                              <span className="text-sm text-red-600">GeliÅŸtirilmeli</span>
                            </>
                          )}
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>

        {/* Ä°yileÅŸtirme Ã–nerileri */}
        <div className="bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-6 mb-8">
          <h3 className="text-lg font-bold text-blue-900 mb-4">ğŸ“ˆ Ä°yileÅŸtirme Ã–nerileri</h3>
          <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div className="bg-white rounded-lg p-4">
              <div className="text-blue-600 text-2xl mb-2">ğŸ“¸</div>
              <h4 className="font-bold text-gray-900 mb-2">Daha Kaliteli FotoÄŸraflar</h4>
              <p className="text-sm text-gray-600">FotoÄŸraflÄ± spot'lar %70 daha fazla gÃ¶rÃ¼ntÃ¼leniyor</p>
            </div>
            
            <div className="bg-white rounded-lg p-4">
              <div className="text-green-600 text-2xl mb-2">â°</div>
              <h4 className="font-bold text-gray-900 mb-2">HÄ±zlÄ± YanÄ±t Verin</h4>
              <p className="text-sm text-gray-600">30 dakika iÃ§inde yanÄ±t veren maÄŸazalar %40 daha baÅŸarÄ±lÄ±</p>
            </div>
            
            <div className="bg-white rounded-lg p-4">
              <div className="text-purple-600 text-2xl mb-2">ğŸ“</div>
              <h4 className="font-bold text-gray-900 mb-2">DetaylÄ± AÃ§Ä±klamalar</h4>
              <p className="text-sm text-gray-600">DetaylÄ± aÃ§Ä±klamalar yardÄ±m ÅŸansÄ±nÄ± %60 artÄ±rÄ±yor</p>
            </div>
            
            <div className="bg-white rounded-lg p-4">
              <div className="text-orange-600 text-2xl mb-2">ğŸ¯</div>
              <h4 className="font-bold text-gray-900 mb-2">Hedefli Spot'lar</h4>
              <p className="text-sm text-gray-600">Spesifik Ã¼rÃ¼nler genel aramalardan daha iyi performans gÃ¶steriyor</p>
            </div>
          </div>
        </div>

        {/* Zamanlama Analizi */}
        <div className="bg-white rounded-xl shadow p-6">
          <h3 className="text-lg font-bold text-gray-900 mb-6">â° En Aktif Zamanlar</h3>
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
            {[
              { time: 'Sabah 09:00-11:00', activity: 'YÃ¼ksek', color: 'bg-green-100 text-green-800' },
              { time: 'Ã–ÄŸlen 12:00-14:00', activity: 'Ã‡ok YÃ¼ksek', color: 'bg-green-500 text-white' },
              { time: 'AkÅŸam 18:00-20:00', activity: 'YÃ¼ksek', color: 'bg-green-100 text-green-800' },
              { time: 'Gece 22:00-24:00', activity: 'Orta', color: 'bg-yellow-100 text-yellow-800' }
            ].map((item, index) => (
              <div key={index} className="border rounded-lg p-4 text-center">
                <div className="font-bold text-gray-900 mb-2">{item.time}</div>
                <span className={`px-3 py-1 rounded-full text-sm font-medium ${item.color}`}>
                  {item.activity}
                </span>
                <p className="text-xs text-gray-500 mt-2">Aktif kullanÄ±cÄ± sayÄ±sÄ±</p>
              </div>
            ))}
          </div>
          <p className="text-sm text-gray-600 mt-4 text-center">
            ğŸ’¡ Ä°pucu: En aktif saatlerde yeni spot'lar paylaÅŸarak gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼nÃ¼zÃ¼ artÄ±rÄ±n.
          </p>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/shop/dashboard/page.tsx
ğŸ“Š 836 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/shop/dashboard/page.tsx - DÃœZELTMÄ°Å HALÄ°
'use client'

import { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Link from 'next/link'

// YENÄ° BÄ°LEÅENLERÄ° IMPORT EDEBÄ°LÄ°RSÄ°NÄ°Z
import ShopStats from '@/components/shop/ShopStats'
import RecentMatches from '@/components/shop/RecentMatches'
import QuickActions from '@/components/shop/QuickActions'
import InventoryOverview from '@/components/shop/InventoryOverview'
import SearchOverview from '@/components/shop/SearchOverview'
import ShopHeader from '@/components/shop/ShopHeader'
import ActiveSearches from '@/components/shop/ActiveSearches'
import ShopSocialFeed from '@/components/shop/ShopSocialFeed'
import ShopStatsPublic from '@/components/shop/ShopStatsPublic'

interface Shop {
  id: string
  shop_name: string
  description: string
  city: string
  subscription_type: string
  free_images_used: number
  total_images: number
  is_verified: boolean
  created_at: string
  email: string
  phone: string
  address: string
  owner_id: string
  logo_url?: string
  cover_url?: string
}

interface ShopStat {
  total_spots: number
  active_spots: number
  found_spots: number
  total_views: number
  total_helps: number
  monthly_spots: number
}

interface RecentSpot {
  id: string
  title: string
  status: string
  created_at: string
  views: number
  helps: number
}

interface ShopAnalyticsDay {
  revenue: number
  // diÄŸer field'larÄ± ekleyebilirsin
  [key: string]: any
}

interface SpotStat {
  views: number
  helps: number
}

export default function ShopDashboardPage() {
  const router = useRouter()
  const [shop, setShop] = useState<Shop | null>(null)
  const [stats, setStats] = useState<ShopStat | null>(null)
  const [recentSpots, setRecentSpots] = useState<RecentSpot[]>([])
  const [loading, setLoading] = useState(true)
  const [activeTab, setActiveTab] = useState<'overview' | 'spots' | 'analytics' | 'settings'>('overview')
  
  // YENÄ°: Dashboard istatistikleri
  const [dashboardStats, setDashboardStats] = useState({
    totalProducts: 0,
    activeSearches: 0,
    totalMatches: 0,
    pendingMatches: 0,
    totalFollowers: 0,
    revenue: 0
  })

  useEffect(() => {
    checkAuthAndLoadShop()
  }, [])

  const checkAuthAndLoadShop = async () => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      
      if (!user) {
        router.push('/login?redirect=/shop/dashboard')
        return
      }

      // MaÄŸazayÄ± getir
      const { data: shopData, error: shopError } = await supabase
        .from('shops')
        .select('*')
        .eq('owner_id', user.id)
        .single()

      if (shopError) {
        if (shopError.code === 'PGRST116') {
          router.push('/for-business')
          return
        }
        throw shopError
      }

      setShop(shopData)

      // Ä°statistikleri ve spot'larÄ± getir
      await loadShopData(shopData.id, user.id)
      
      // YENÄ°: Dashboard istatistiklerini yÃ¼kle
      await loadDashboardStats(shopData.id)

    } catch (error) {
      console.error('MaÄŸaza yÃ¼klenemedi:', error)
      alert('MaÄŸaza bilgileri yÃ¼klenirken bir hata oluÅŸtu')
    } finally {
      setLoading(false)
    }
  }

  const loadDashboardStats = async (shopId: string) => {
    try {
      // Paralel olarak tÃ¼m istatistikleri al
      const [
        { count: productCount },
        { count: searchCount },
        { count: matchCount },
        { count: pendingMatchCount },
        { count: followerCount },
        { data: revenueData }
      ] = await Promise.all([
        supabase
          .from('shop_inventory')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('status', 'active'),
        supabase
          .from('shop_searches')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('status', 'active'),
        supabase
          .from('shop_search_matches')
          .select('count', { count: 'exact', head: true })
          .eq('search_id', shopId),
        supabase
          .from('shop_search_matches')
          .select('count', { count: 'exact', head: true })
          .eq('search_id', shopId)
          .eq('status', 'pending'),
        supabase
          .from('shop_customer_relationships')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('relationship_type', 'follower'),
        supabase
          .from('shop_analytics_daily')
          .select('revenue')
          .eq('shop_id', shopId)
          .gte('date', new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString())
      ])

      // TÄ°P TANIMLAMASI EKLENDÄ°
      const totalRevenue = (revenueData as ShopAnalyticsDay[])?.reduce(
        (sum: number, day: ShopAnalyticsDay) => sum + (day.revenue || 0), 
        0
      ) || 0

      setDashboardStats({
        totalProducts: productCount || 0,
        activeSearches: searchCount || 0,
        totalMatches: matchCount || 0,
        pendingMatches: pendingMatchCount || 0,
        totalFollowers: followerCount || 0,
        revenue: totalRevenue
      })

    } catch (error) {
      console.error('Dashboard istatistikleri yÃ¼klenemedi:', error)
    }
  }

  const loadShopData = async (shopId: string, ownerId: string) => {
    try {
      // Ä°statistikleri getir
      const { count: totalSpots } = await supabase
        .from('spots')
        .select('*', { count: 'exact', head: true })
        .eq('user_id', ownerId)

      const { count: activeSpots } = await supabase
        .from('spots')
        .select('*', { count: 'exact', head: true })
        .eq('user_id', ownerId)
        .eq('status', 'active')

      const { count: foundSpots } = await supabase
        .from('spots')
        .select('*', { count: 'exact', head: true })
        .eq('user_id', ownerId)
        .eq('status', 'found')

      const { data: spotStats } = await supabase
        .from('spots')
        .select('views, helps')
        .eq('user_id', ownerId)

      // TÄ°P TANIMLAMASI EKLENDÄ°
      const totalViews = (spotStats as SpotStat[])?.reduce(
        (sum: number, spot: SpotStat) => sum + (spot.views || 0), 
        0
      ) || 0
      
      // TÄ°P TANIMLAMASI EKLENDÄ°
      const totalHelps = (spotStats as SpotStat[])?.reduce(
        (sum: number, spot: SpotStat) => sum + (spot.helps || 0), 
        0
      ) || 0

      // Bu ayki spot sayÄ±sÄ±
      const startOfMonth = new Date()
      startOfMonth.setDate(1)
      startOfMonth.setHours(0, 0, 0, 0)

      const { count: monthlySpots } = await supabase
        .from('spots')
        .select('*', { count: 'exact', head: true })
        .eq('user_id', ownerId)
        .gte('created_at', startOfMonth.toISOString())

      setStats({
        total_spots: totalSpots || 0,
        active_spots: activeSpots || 0,
        found_spots: foundSpots || 0,
        total_views: totalViews,
        total_helps: totalHelps,
        monthly_spots: monthlySpots || 0
      })

      // Son spot'larÄ± getir
      const { data: spotsData } = await supabase
        .from('spots')
        .select('id, title, status, created_at, views, helps')
        .eq('user_id', ownerId)
        .order('created_at', { ascending: false })
        .limit(5)

      setRecentSpots(spotsData as RecentSpot[] || [])

    } catch (error) {
      console.error('Veriler yÃ¼klenemedi:', error)
    }
  }

  const handleCreateSpot = () => {
    router.push('/create-spot')
  }

  const handleViewShop = () => {
    if (shop) {
      router.push(`/shop/${shop.id}`)
    }
  }

  const handleUpgrade = () => {
    router.push('/for-business?upgrade=true')
  }

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50">
        <main className="container-custom py-12 text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">MaÄŸaza yÃ¼kleniyor...</p>
        </main>
      </div>
    )
  }

  if (!shop) {
    return (
      <div className="min-h-screen bg-gray-50">
        <main className="container-custom py-12 text-center">
          <h1 className="text-2xl font-bold text-gray-900 mb-4">MaÄŸaza BulunamadÄ±</h1>
          <p className="text-gray-600 mb-8">HenÃ¼z bir maÄŸazanÄ±z yok. Hemen Ã¼cretsiz oluÅŸturun!</p>
          <button
            onClick={() => router.push('/for-business')}
            className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-lg"
          >
            Ãœcretsiz MaÄŸaza AÃ§
          </button>
        </main>
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <main className="container-custom py-8">
        {/* YENÄ°: MaÄŸaza Dashboard Header */}
        <div className="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 md:p-8 text-white mb-8">
          <div className="flex flex-col md:flex-row md:items-center justify-between">
            <div className="mb-6 md:mb-0">
              <div className="flex items-center mb-4">
                <div className="w-16 h-16 bg-white text-blue-600 rounded-xl flex items-center justify-center text-2xl font-bold mr-4">
                  {shop.shop_name.substring(0, 2).toUpperCase()}
                </div>
                <div>
                  <h1 className="text-2xl md:text-3xl font-bold mb-2">{shop.shop_name}</h1>
                  <div className="flex flex-wrap gap-2">
                    <span className="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">
                      {shop.city}
                    </span>
                    <span className={`px-3 py-1 rounded-full text-sm ${
                      shop.is_verified 
                        ? 'bg-green-500' 
                        : 'bg-yellow-500'
                    }`}>
                      {shop.is_verified ? 'âœ“ DoÄŸrulanmÄ±ÅŸ' : 'DoÄŸrulanmamÄ±ÅŸ'}
                    </span>
                    <span className="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">
                      {shop.subscription_type === 'free' ? 'Ãœcretsiz Paket' : shop.subscription_type}
                    </span>
                  </div>
                </div>
              </div>
            </div>
            
            <div className="flex flex-col sm:flex-row gap-3">
              <button
                onClick={handleViewShop}
                className="bg-white text-blue-600 hover:bg-blue-50 font-medium px-6 py-3 rounded-lg"
              >
                ğŸ‘ï¸ MaÄŸazayÄ± GÃ¶rÃ¼ntÃ¼le
              </button>
              <button
                onClick={handleUpgrade}
                className="bg-yellow-500 hover:bg-yellow-600 text-white font-medium px-6 py-3 rounded-lg"
              >
                â­ Paketi YÃ¼kselt
              </button>
            </div>
          </div>
        </div>

        {/* YENÄ°: Dashboard Grid Layout */}
        <div className="grid lg:grid-cols-3 gap-8">
          {/* Ana Kolon */}
          <div className="lg:col-span-2 space-y-8">
            {/* HÄ±zlÄ± Ä°statistikler */}
            {shop && (
              <ShopStats 
                stats={dashboardStats} 
                shopId={shop.id}
              />
            )}

            {/* HÄ±zlÄ± Eylemler */}
            {shop && (
              <QuickActions 
                shopId={shop.id}
                onActionComplete={() => {
                  // Yenileme iÅŸlemi
                  loadDashboardStats(shop.id)
                  loadShopData(shop.id, shop.owner_id)
                }}
              />
            )}

            {/* Son EÅŸleÅŸmeler */}
            {shop && (
              <RecentMatches 
                shopId={shop.id}
                limit={5}
              />
            )}

            {/* Stok Ã–zeti */}
            {shop && (
              <InventoryOverview 
                shopId={shop.id}
              />
            )}

            {/* Aktif Aramalar */}
            {shop && (
              <ActiveSearches 
                shopId={shop.id}
                showCreateButton={true}
                limit={5}
              />
            )}

            {/* Sosyal PaylaÅŸÄ±mlar */}
            {shop && (
              <ShopSocialFeed 
                shopId={shop.id}
                limit={3}
                compact={true}
              />
            )}
          </div>

          {/* Yan Kolon */}
          <div className="space-y-8">
            {/* Arama Ã–zeti */}
            {shop && (
              <SearchOverview 
                shopId={shop.id}
              />
            )}

            {/* Resim Limiti */}
            <div className="bg-white rounded-xl shadow p-6">
              <div className="flex items-center justify-between mb-4">
                <div>
                  <h3 className="text-lg font-bold text-gray-900">Resim Limiti</h3>
                  <p className="text-gray-600 text-sm">
                    {shop.free_images_used}/{shop.total_images} resim kullanÄ±ldÄ±
                  </p>
                </div>
                <div className="text-right">
                  <span className={`text-lg font-bold ${
                    shop.free_images_used >= shop.total_images 
                      ? 'text-red-600' 
                      : 'text-green-600'
                  }`}>
                    {shop.total_images - shop.free_images_used} resim kaldÄ±
                  </span>
                </div>
              </div>
              
              <div className="w-full bg-gray-200 rounded-full h-3">
                <div 
                  className={`h-3 rounded-full ${
                    shop.free_images_used >= shop.total_images 
                      ? 'bg-red-600' 
                      : 'bg-blue-600'
                  }`}
                  style={{ 
                    width: `${Math.min(100, (shop.free_images_used / shop.total_images) * 100)}%` 
                  }}
                ></div>
              </div>
              
              {shop.free_images_used >= shop.total_images && (
                <div className="mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
                  <p className="text-red-700 text-sm">
                    âš ï¸ Resim limitiniz doldu. Yeni resim yÃ¼klemek iÃ§in paketinizi yÃ¼kseltin.
                  </p>
                </div>
              )}
            </div>

            {/* MaÄŸaza Linki */}
            <div className="bg-white rounded-xl shadow p-6">
              <h3 className="font-bold text-gray-900 mb-4">ğŸ”— MaÄŸaza Linkiniz</h3>
              <div className="space-y-3">
                <p className="text-gray-600 text-sm">
                  MÃ¼ÅŸteriler bu link Ã¼zerinden maÄŸazanÄ±za ulaÅŸabilir:
                </p>
                
                <div className="flex">
                  <input
                    type="text"
                    readOnly
                    value={`${typeof window !== 'undefined' ? window.location.origin : ''}/shop/${shop.id}`}
                    className="flex-grow px-4 py-2 border border-gray-300 rounded-l-lg bg-gray-50 text-sm"
                  />
                  <button
                    onClick={() => {
                      navigator.clipboard.writeText(`${typeof window !== 'undefined' ? window.location.origin : ''}/shop/${shop.id}`)
                      alert('Link kopyalandÄ±!')
                    }}
                    className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-r-lg text-sm"
                  >
                    Kopyala
                  </button>
                </div>
                
                <div className="flex space-x-3 mt-4">
                  <button
                    onClick={handleViewShop}
                    className="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 rounded-lg text-sm"
                  >
                    MaÄŸazayÄ± GÃ¶r
                  </button>
                  <button
                    onClick={() => {
                      window.open(`/shop/${shop.id}`, '_blank')
                    }}
                    className="flex-1 bg-blue-100 hover:bg-blue-200 text-blue-800 font-medium py-2 rounded-lg text-sm"
                  >
                    Yeni Sekmede
                  </button>
                </div>
              </div>
            </div>

            {/* HÄ±zlÄ± Ä°statistikler */}
            {stats && (
              <div className="bg-white rounded-xl shadow p-6">
                <h3 className="font-bold text-gray-900 mb-4">ğŸ“Š Spot Ä°statistikleri</h3>
                <div className="space-y-4">
                  <div className="flex justify-between">
                    <span className="text-gray-600">Toplam Spot:</span>
                    <span className="font-bold">{stats.total_spots}</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-600">Aktif Spot:</span>
                    <span className="font-bold text-green-600">{stats.active_spots}</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-600">Bulunan Spot:</span>
                    <span className="font-bold text-blue-600">{stats.found_spots}</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-600">GÃ¶rÃ¼ntÃ¼lenme:</span>
                    <span className="font-bold">{stats.total_views}</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-600">YardÄ±m Edenler:</span>
                    <span className="font-bold">{stats.total_helps}</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-600">Bu Ay:</span>
                    <span className="font-bold">{stats.monthly_spots}</span>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>

        {/* Alt KÄ±sÄ±m - Klasik Dashboard */}
        <div className="mt-12 bg-white rounded-xl shadow-lg">
          <div className="p-6 border-b">
            <div className="flex overflow-x-auto">
              <button
                onClick={() => setActiveTab('overview')}
                className={`flex-shrink-0 px-6 py-3 text-center font-medium whitespace-nowrap ${
                  activeTab === 'overview'
                    ? 'text-blue-600 border-b-2 border-blue-600'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                ğŸ‘ï¸ Genel BakÄ±ÅŸ
              </button>
              <button
                onClick={() => setActiveTab('spots')}
                className={`flex-shrink-0 px-6 py-3 text-center font-medium whitespace-nowrap ${
                  activeTab === 'spots'
                    ? 'text-blue-600 border-b-2 border-blue-600'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                ğŸ“ Spot'larÄ±m
              </button>
              <button
                onClick={() => setActiveTab('analytics')}
                className={`flex-shrink-0 px-6 py-3 text-center font-medium whitespace-nowrap ${
                  activeTab === 'analytics'
                    ? 'text-blue-600 border-b-2 border-blue-600'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                ğŸ“ˆ Analitik
              </button>
              <button
                onClick={() => setActiveTab('settings')}
                className={`flex-shrink-0 px-6 py-3 text-center font-medium whitespace-nowrap ${
                  activeTab === 'settings'
                    ? 'text-blue-600 border-b-2 border-blue-600'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                âš™ï¸ Ayarlar
              </button>
            </div>
          </div>
          
          <div className="p-6">
            {activeTab === 'overview' && (
              <div>
                <div className="mb-8">
                  <h3 className="text-xl font-bold text-gray-900 mb-4">HoÅŸ Geldiniz!</h3>
                  <p className="text-gray-600 mb-6">
                    MaÄŸaza panelinize hoÅŸ geldiniz. Buradan spot'larÄ±nÄ±zÄ± yÃ¶netebilir, 
                    istatistiklerinizi gÃ¶rÃ¼ntÃ¼leyebilir ve maÄŸaza ayarlarÄ±nÄ±zÄ± dÃ¼zenleyebilirsiniz.
                  </p>
                  
                  <div className="grid md:grid-cols-2 gap-6">
                    <div className="bg-blue-50 p-6 rounded-xl">
                      <h4 className="font-bold text-blue-900 mb-3">ğŸ“ˆ Performans Ä°puÃ§larÄ±</h4>
                      <ul className="space-y-2 text-sm text-blue-800">
                        <li>â€¢ Resimli spot'lar %70 daha hÄ±zlÄ± bulunuyor</li>
                        <li>â€¢ DetaylÄ± aÃ§Ä±klamalar yardÄ±m ÅŸansÄ±nÄ± artÄ±rÄ±r</li>
                        <li>â€¢ Aktif kalmak gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼nÃ¼zÃ¼ artÄ±rÄ±r</li>
                        <li>â€¢ HÄ±zlÄ± cevap vermek mÃ¼ÅŸteri memnuniyetini artÄ±rÄ±r</li>
                      </ul>
                    </div>
                    
                    <div className="bg-green-50 p-6 rounded-xl">
                      <h4 className="font-bold text-green-900 mb-3">ğŸš€ HÄ±zlÄ± BaÅŸlangÄ±Ã§</h4>
                      <ul className="space-y-2 text-sm text-green-800">
                        <li>â€¢ MaÄŸaza profilinizi tamamlayÄ±n</li>
                        <li>â€¢ Ä°lk spot'unuzu oluÅŸturun</li>
                        <li>â€¢ DiÄŸer kullanÄ±cÄ±lara yardÄ±m edin</li>
                        <li>â€¢ MÃ¼ÅŸteri yorumlarÄ±nÄ± takip edin</li>
                      </ul>
                    </div>
                  </div>
                </div>

                {/* Son Spot'lar */}
                <div>
                  <div className="flex justify-between items-center mb-4">
                    <h3 className="text-lg font-bold text-gray-900">Son Spot'lar</h3>
                    <button
                      onClick={() => setActiveTab('spots')}
                      className="text-blue-600 hover:text-blue-800 text-sm"
                    >
                      TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
                    </button>
                  </div>
                  
                  {recentSpots.length === 0 ? (
                    <div className="bg-gray-50 rounded-xl p-8 text-center">
                      <div className="text-4xl mb-4">ğŸ“</div>
                      <p className="text-gray-600">HenÃ¼z spot oluÅŸturmadÄ±nÄ±z</p>
                      <button
                        onClick={handleCreateSpot}
                        className="mt-4 text-blue-600 hover:text-blue-800 font-medium"
                      >
                        Ä°lk Spot'unu OluÅŸtur â†’
                      </button>
                    </div>
                  ) : (
                    <div className="bg-white border border-gray-200 rounded-xl overflow-hidden">
                      <table className="w-full">
                        <thead className="bg-gray-50">
                          <tr>
                            <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">BaÅŸlÄ±k</th>
                            <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Durum</th>
                            <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">GÃ¶rÃ¼ntÃ¼lenme</th>
                            <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">YardÄ±m</th>
                            <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Tarih</th>
                          </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-100">
                          {recentSpots.map((spot) => (
                            <tr key={spot.id} className="hover:bg-gray-50">
                              <td className="py-3 px-4">
                                <Link
                                  href={`/spots/${spot.id}`}
                                  className="font-medium text-blue-600 hover:text-blue-800"
                                >
                                  {spot.title.length > 40 ? spot.title.substring(0, 40) + '...' : spot.title}
                                </Link>
                              </td>
                              <td className="py-3 px-4">
                                <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                                  spot.status === 'active'
                                    ? 'bg-green-100 text-green-800'
                                    : 'bg-blue-100 text-blue-800'
                                }`}>
                                  {spot.status === 'active' ? 'Aktif' : 'Bulundu'}
                                </span>
                              </td>
                              <td className="py-3 px-4">{spot.views}</td>
                              <td className="py-3 px-4">{spot.helps}</td>
                              <td className="py-3 px-4 text-sm text-gray-500">
                                {new Date(spot.created_at).toLocaleDateString('tr-TR')}
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  )}
                </div>
              </div>
            )}
            
            {activeTab === 'spots' && (
              <div>
                <h3 className="text-xl font-bold text-gray-900 mb-6">TÃ¼m Spot'larÄ±m</h3>
                <div className="bg-gray-50 rounded-xl p-8 text-center">
                  <div className="text-4xl mb-4">ğŸš§</div>
                  <h4 className="text-lg font-bold text-gray-900 mb-2">YakÄ±nda Burada!</h4>
                  <p className="text-gray-600 mb-6">
                    TÃ¼m spot'larÄ±nÄ±zÄ± gÃ¶rÃ¼ntÃ¼leyeceÄŸiniz panel yakÄ±nda eklenecek.
                  </p>
                  <button
                    onClick={() => router.push('/spots')}
                    className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg"
                  >
                    TÃ¼m Spot'larÄ± GÃ¶rÃ¼ntÃ¼le
                  </button>
                </div>
              </div>
            )}
            
            {activeTab === 'analytics' && (
              <div>
                <h3 className="text-xl font-bold text-gray-900 mb-6">MaÄŸaza Analitik</h3>
                <div className="bg-gray-50 rounded-xl p-8 text-center">
                  <div className="text-4xl mb-4">ğŸ“Š</div>
                  <h4 className="text-lg font-bold text-gray-900 mb-2">DetaylÄ± Raporlar YakÄ±nda!</h4>
                  <p className="text-gray-600">
                    HaftalÄ±k, aylÄ±k istatistikler ve performans raporlarÄ± yakÄ±nda eklenecek.
                  </p>
                </div>
              </div>
            )}
            
            {activeTab === 'settings' && (
              <div>
                <h3 className="text-xl font-bold text-gray-900 mb-6">MaÄŸaza AyarlarÄ±</h3>
                
                <div className="space-y-6">
                  {/* Temel Bilgiler */}
                  <div className="bg-white border border-gray-200 rounded-xl p-6">
                    <h4 className="font-bold text-gray-900 mb-4 flex items-center">
                      <span className="text-blue-600 mr-2">ğŸª</span>
                      Temel Bilgiler
                    </h4>
                    
                    <div className="grid md:grid-cols-2 gap-4 mb-4">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          MaÄŸaza AdÄ±
                        </label>
                        <p className="font-medium">{shop.shop_name}</p>
                      </div>
                      
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Åehir
                        </label>
                        <p className="font-medium">{shop.city}</p>
                      </div>
                      
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Email
                        </label>
                        <p className="font-medium">{shop.email}</p>
                      </div>
                      
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Telefon
                        </label>
                        <p className="font-medium">{shop.phone || 'BelirtilmemiÅŸ'}</p>
                      </div>
                    </div>
                    
                    <div className="mt-4">
                      <label className="block text-sm font-medium text-gray-700 mb-1">
                        AÃ§Ä±klama
                      </label>
                      <p className="text-gray-700 whitespace-pre-line">
                        {shop.description || 'AÃ§Ä±klama eklenmemiÅŸ'}
                      </p>
                    </div>
                    
                    <button
                      onClick={() => router.push('/for-business?edit=true')}
                      className="mt-6 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg"
                    >
                      Bilgileri DÃ¼zenle
                    </button>
                  </div>

                  {/* Paket Bilgileri */}
                  <div className="bg-white border border-gray-200 rounded-xl p-6">
                    <h4 className="font-bold text-gray-900 mb-4 flex items-center">
                      <span className="text-yellow-600 mr-2">â­</span>
                      Paket Bilgileri
                    </h4>
                    
                    <div className="space-y-4">
                      <div className="flex justify-between items-center">
                        <div>
                          <p className="font-medium">Mevcut Paket</p>
                          <p className="text-sm text-gray-600">
                            {shop.subscription_type === 'free' ? 'Ãœcretsiz BaÅŸlangÄ±Ã§' : shop.subscription_type}
                          </p>
                        </div>
                        <span className="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                          {shop.subscription_type === 'free' ? 'ÃœCRETSÄ°Z' : 'PREMIUM'}
                        </span>
                      </div>
                      
                      <div className="flex justify-between items-center">
                        <div>
                          <p className="font-medium">Resim Limiti</p>
                          <p className="text-sm text-gray-600">
                            {shop.free_images_used}/{shop.total_images} kullanÄ±ldÄ±
                          </p>
                        </div>
                        <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                          shop.free_images_used >= shop.total_images 
                            ? 'bg-red-100 text-red-800' 
                            : 'bg-green-100 text-green-800'
                        }`}>
                          {shop.total_images - shop.free_images_used} kaldÄ±
                        </span>
                      </div>
                      
                      <button
                        onClick={handleUpgrade}
                        className="w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white font-medium py-3 rounded-lg"
                      >
                        â­ Premium'a YÃ¼kselt
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      </main>
    </div>
  )
}

ğŸ“„ app/shop/spots/page.tsx
ğŸ“Š 769 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/shop/spots/page.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Header from '@/components/Header'
import Footer from '@/components/Footer'
import Link from 'next/link'

interface ShopSpot {
  id: string
  title: string
  description: string
  category: string | null
  location: string | null
  status: 'active' | 'found' | 'expired'
  image_url: string | null
  views: number
  helps: number
  created_at: string
  updated_at: string
}

interface FilterState {
  status: string
  category: string
  sortBy: string
  search: string
}

// Supabase'den gelen raw spot tipi
interface RawSpot {
  id: string
  title: string
  description: string
  category: string | null
  location: string | null
  status: 'active' | 'found' | 'expired'
  image_url: string | null
  views: number
  helps: number
  created_at: string
  updated_at: string
  user_id: string
}

export default function ShopSpotsPage() {
  const router = useRouter()
  const [spots, setSpots] = useState<ShopSpot[]>([])
  const [loading, setLoading] = useState(true)
  const [shop, setShop] = useState<any>(null)
  const [stats, setStats] = useState({
    total: 0,
    active: 0,
    found: 0,
    expired: 0,
    totalViews: 0,
    totalHelps: 0
  })
  
  const [filters, setFilters] = useState<FilterState>({
    status: 'all',
    category: 'all',
    sortBy: 'newest',
    search: ''
  })

  const categories = [
    'TÃ¼mÃ¼', 'Elektronik', 'FotoÄŸraf Makineleri', 'Giyim & Aksesuar', 
    'Ev & BahÃ§e', 'Koleksiyon', 'Kitap & MÃ¼zik', 'Oyuncak & Oyun',
    'Spor & Outdoor', 'AraÃ§ & ParÃ§a', 'DiÄŸer'
  ]

  useEffect(() => {
    checkAuthAndLoadSpots()
  }, [filters])

  const checkAuthAndLoadSpots = async () => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      
      if (!user) {
        router.push('/login?redirect=/shop/spots')
        return
      }

      // MaÄŸazayÄ± getir
      const { data: shopData } = await supabase
        .from('shops')
        .select('*')
        .eq('owner_id', user.id)
        .single()

      if (!shopData) {
        router.push('/for-business')
        return
      }

      setShop(shopData)
      
      // Spot'larÄ± getir
      await loadShopSpots(user.id)

    } catch (error) {
      console.error('Veriler yÃ¼klenemedi:', error)
      alert('Spot bilgileri yÃ¼klenirken bir hata oluÅŸtu')
    } finally {
      setLoading(false)
    }
  }

  const loadShopSpots = async (ownerId: string) => {
    try {
      // Base query
      let query = supabase
        .from('spots')
        .select('*')
        .eq('user_id', ownerId)

      // Filtreler
      if (filters.status !== 'all') {
        query = query.eq('status', filters.status)
      }
      
      if (filters.category !== 'all' && filters.category !== 'TÃ¼mÃ¼') {
        query = query.eq('category', filters.category)
      }
      
      if (filters.search) {
        query = query.or(`title.ilike.%${filters.search}%,description.ilike.%${filters.search}%`)
      }

      // SÄ±ralama
      if (filters.sortBy === 'newest') {
        query = query.order('created_at', { ascending: false })
      } else if (filters.sortBy === 'oldest') {
        query = query.order('created_at', { ascending: true })
      } else if (filters.sortBy === 'most_viewed') {
        query = query.order('views', { ascending: false })
      } else if (filters.sortBy === 'most_helped') {
        query = query.order('helps', { ascending: false })
      }

      const { data: spotsData, error } = await query

      if (error) throw error

      // Spot'larÄ± iÅŸle - DÃœZELTÄ°LDÄ° (134. satÄ±r)
      const processedSpots = (spotsData as RawSpot[] | null)?.map((spot: RawSpot) => {
        // Spot'un durumunu kontrol et (30 gÃ¼nden eski spot'larÄ± expired yap)
        const createdDate = new Date(spot.created_at)
        const now = new Date()
        const daysDiff = Math.floor((now.getTime() - createdDate.getTime()) / (1000 * 3600 * 24))
        
        let status = spot.status
        if (status === 'active' && daysDiff > 30) {
          status = 'expired'
        }

        return {
          id: spot.id,
          title: spot.title,
          description: spot.description,
          category: spot.category,
          location: spot.location,
          status: status,
          image_url: spot.image_url,
          views: spot.views || 0,
          helps: spot.helps || 0,
          created_at: spot.created_at,
          updated_at: spot.updated_at
        } as ShopSpot
      }) || []

      setSpots(processedSpots)

      // Ä°statistikleri hesapla
      calculateStats(processedSpots)

    } catch (error) {
      console.error('Spotlar yÃ¼klenemedi:', error)
    }
  }

  const calculateStats = (spots: ShopSpot[]) => {
    const total = spots.length
    const active = spots.filter(s => s.status === 'active').length
    const found = spots.filter(s => s.status === 'found').length
    const expired = spots.filter(s => s.status === 'expired').length
    const totalViews = spots.reduce((sum, spot) => sum + (spot.views || 0), 0)
    const totalHelps = spots.reduce((sum, spot) => sum + (spot.helps || 0), 0)

    setStats({
      total,
      active,
      found,
      expired,
      totalViews,
      totalHelps
    })
  }

  const handleCreateSpot = () => {
    router.push('/create-spot')
  }

  const handleEditSpot = (spotId: string) => {
    router.push(`/spots/${spotId}/edit`)
  }

  const handleRenewSpot = async (spotId: string) => {
    if (!confirm('Bu spot\'u yenilemek istediÄŸinize emin misiniz? Spot 30 gÃ¼n daha aktif kalacaktÄ±r.')) {
      return
    }

    try {
      const { error } = await supabase
        .from('spots')
        .update({ 
          status: 'active',
          updated_at: new Date().toISOString()
        })
        .eq('id', spotId)

      if (error) throw error

      alert('Spot baÅŸarÄ±yla yenilendi!')
      // Spot'larÄ± yenile
      const { data: { user } } = await supabase.auth.getUser()
      if (user) {
        loadShopSpots(user.id)
      }
    } catch (error) {
      console.error('Spot yenilenemedi:', error)
      alert('Spot yenilenirken bir hata oluÅŸtu')
    }
  }

  const handleDeleteSpot = async (spotId: string, spotTitle: string) => {
    if (!confirm(`"${spotTitle}" spot'unu silmek istediÄŸinize emin misiniz? Bu iÅŸlem geri alÄ±namaz.`)) {
      return
    }

    try {
      const { error } = await supabase
        .from('spots')
        .delete()
        .eq('id', spotId)

      if (error) throw error

      alert('Spot baÅŸarÄ±yla silindi!')
      // Spot'larÄ± yenile
      const { data: { user } } = await supabase.auth.getUser()
      if (user) {
        loadShopSpots(user.id)
      }
    } catch (error) {
      console.error('Spot silinemedi:', error)
      alert('Spot silinirken bir hata oluÅŸtu')
    }
  }

  const handleUpdateStatus = async (spotId: string, newStatus: 'active' | 'found') => {
    try {
      const { error } = await supabase
        .from('spots')
        .update({ 
          status: newStatus,
          updated_at: new Date().toISOString()
        })
        .eq('id', spotId)

      if (error) throw error

      alert(`Spot durumu "${newStatus === 'active' ? 'Aktif' : 'Bulundu'}" olarak gÃ¼ncellendi!`)
      // Spot'larÄ± yenile
      const { data: { user } } = await supabase.auth.getUser()
      if (user) {
        loadShopSpots(user.id)
      }
    } catch (error) {
      console.error('Spot durumu gÃ¼ncellenemedi:', error)
      alert('Spot durumu gÃ¼ncellenirken bir hata oluÅŸtu')
    }
  }

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'active': return 'bg-green-100 text-green-800'
      case 'found': return 'bg-blue-100 text-blue-800'
      case 'expired': return 'bg-red-100 text-red-800'
      default: return 'bg-gray-100 text-gray-800'
    }
  }

  const getStatusText = (status: string) => {
    switch (status) {
      case 'active': return 'Aktif'
      case 'found': return 'Bulundu'
      case 'expired': return 'SÃ¼resi DolmuÅŸ'
      default: return status
    }
  }

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        <main className="container-custom py-12 text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">Spot'lar yÃ¼kleniyor...</p>
        </main>
        <Footer />
      </div>
    )
  }

  if (!shop) {
    return (
      <div className="min-h-screen bg-gray-50">
        <Header />
        <main className="container-custom py-12 text-center">
          <h1 className="text-2xl font-bold text-gray-900 mb-4">MaÄŸaza BulunamadÄ±</h1>
          <button
            onClick={() => router.push('/for-business')}
            className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-lg"
          >
            Ãœcretsiz MaÄŸaza AÃ§
          </button>
        </main>
        <Footer />
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8">
        {/* Ãœst Navigasyon */}
        <div className="mb-8">
          <div className="flex items-center space-x-2 text-sm text-gray-600 mb-4">
            <Link href="/shop/dashboard" className="hover:text-blue-600">
              Dashboard
            </Link>
            <span>â€º</span>
            <span className="font-medium text-gray-900">Spot'larÄ±m</span>
          </div>
          
          <div className="flex flex-col md:flex-row md:items-center justify-between">
            <div>
              <h1 className="text-3xl font-bold text-gray-900 mb-2">Spot'larÄ±m</h1>
              <p className="text-gray-600">
                TÃ¼m spot'larÄ±nÄ±zÄ± buradan yÃ¶netebilirsiniz
              </p>
            </div>
            
            <button
              onClick={handleCreateSpot}
              className="mt-4 md:mt-0 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg flex items-center"
            >
              <span className="mr-2">â•</span>
              Yeni Spot OluÅŸtur
            </button>
          </div>
        </div>

        {/* Ä°statistik KartlarÄ± */}
        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8">
          <div className="bg-white rounded-xl p-4 shadow text-center">
            <div className="text-2xl font-bold text-blue-600 mb-1">{stats.total}</div>
            <div className="text-sm text-gray-600">Toplam Spot</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow text-center">
            <div className="text-2xl font-bold text-green-600 mb-1">{stats.active}</div>
            <div className="text-sm text-gray-600">Aktif</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow text-center">
            <div className="text-2xl font-bold text-purple-600 mb-1">{stats.found}</div>
            <div className="text-sm text-gray-600">Bulunan</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow text-center">
            <div className="text-2xl font-bold text-red-600 mb-1">{stats.expired}</div>
            <div className="text-sm text-gray-600">SÃ¼resi DolmuÅŸ</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow text-center">
            <div className="text-2xl font-bold text-orange-600 mb-1">{stats.totalViews}</div>
            <div className="text-sm text-gray-600">Toplam GÃ¶rÃ¼ntÃ¼lenme</div>
          </div>
          
          <div className="bg-white rounded-xl p-4 shadow text-center">
            <div className="text-2xl font-bold text-indigo-600 mb-1">{stats.totalHelps}</div>
            <div className="text-sm text-gray-600">Toplam YardÄ±m</div>
          </div>
        </div>

        {/* Filtreler */}
        <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
          <div className="grid md:grid-cols-4 gap-4">
            {/* Arama */}
            <div className="md:col-span-2">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Arama
              </label>
              <div className="relative">
                <div className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                  ğŸ”
                </div>
                <input
                  type="text"
                  value={filters.search}
                  onChange={(e) => setFilters({...filters, search: e.target.value})}
                  className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                  placeholder="Spot ara..."
                />
              </div>
            </div>

            {/* Durum Filtresi */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Durum
              </label>
              <select
                value={filters.status}
                onChange={(e) => setFilters({...filters, status: e.target.value})}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              >
                <option value="all">TÃ¼m Durumlar</option>
                <option value="active">Aktif</option>
                <option value="found">Bulundu</option>
                <option value="expired">SÃ¼resi DolmuÅŸ</option>
              </select>
            </div>

            {/* Kategori Filtresi */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Kategori
              </label>
              <select
                value={filters.category}
                onChange={(e) => setFilters({...filters, category: e.target.value})}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              >
                {categories.map(cat => (
                  <option key={cat} value={cat}>{cat}</option>
                ))}
              </select>
            </div>

            {/* SÄ±ralama */}
            <div className="md:col-span-2">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                SÄ±rala
              </label>
              <div className="flex space-x-2">
                {[
                  { value: 'newest', label: 'En Yeni' },
                  { value: 'oldest', label: 'En Eski' },
                  { value: 'most_viewed', label: 'En Ã‡ok GÃ¶rÃ¼ntÃ¼lenen' },
                  { value: 'most_helped', label: 'En Ã‡ok YardÄ±m Alan' }
                ].map((option) => (
                  <button
                    key={option.value}
                    onClick={() => setFilters({...filters, sortBy: option.value})}
                    className={`px-4 py-2 rounded-lg text-sm font-medium ${
                      filters.sortBy === option.value
                        ? 'bg-blue-600 text-white'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                    }`}
                  >
                    {option.label}
                  </button>
                ))}
              </div>
            </div>

            {/* Filtreleri SÄ±fÄ±rla */}
            <div className="md:col-span-2 flex items-end">
              <button
                onClick={() => setFilters({
                  status: 'all',
                  category: 'all',
                  sortBy: 'newest',
                  search: ''
                })}
                className="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 rounded-lg"
              >
                Filtreleri SÄ±fÄ±rla
              </button>
            </div>
          </div>
        </div>

        {/* Spot Listesi */}
        <div className="bg-white rounded-xl shadow overflow-hidden">
          {spots.length === 0 ? (
            <div className="p-12 text-center">
              <div className="text-4xl mb-4">ğŸ“</div>
              <h3 className="text-xl font-bold text-gray-900 mb-2">
                {filters.search || filters.status !== 'all' || filters.category !== 'all' 
                  ? 'Filtrelere uygun spot bulunamadÄ±' 
                  : 'HenÃ¼z spot oluÅŸturmadÄ±nÄ±z'}
              </h3>
              <p className="text-gray-600 mb-6">
                {filters.search || filters.status !== 'all' || filters.category !== 'all'
                  ? 'Filtrelerinizi deÄŸiÅŸtirmeyi deneyin veya yeni bir spot oluÅŸturun'
                  : 'Ä°lk spot\'unuzu oluÅŸturarak baÅŸlayÄ±n'}
              </p>
              <button
                onClick={handleCreateSpot}
                className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-lg"
              >
                Ä°lk Spot'u OluÅŸturun
              </button>
            </div>
          ) : (
            <>
              {/* Mobil GÃ¶rÃ¼nÃ¼m */}
              <div className="md:hidden divide-y divide-gray-100">
                {spots.map((spot) => (
                  <div key={spot.id} className="p-4">
                    <div className="flex items-start justify-between mb-3">
                      <div className="flex-grow">
                        <h4 className="font-bold text-gray-900 mb-1 line-clamp-1">
                          {spot.title}
                        </h4>
                        <span className={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(spot.status)}`}>
                          {getStatusText(spot.status)}
                        </span>
                      </div>
                      <div className="text-right">
                        <div className="text-sm font-bold text-gray-900">{spot.views}</div>
                        <div className="text-xs text-gray-500">gÃ¶rÃ¼ntÃ¼lenme</div>
                      </div>
                    </div>
                    
                    <p className="text-gray-600 text-sm mb-3 line-clamp-2">
                      {spot.description}
                    </p>
                    
                    <div className="flex items-center justify-between text-sm text-gray-500 mb-3">
                      <span>{spot.category || 'Kategori yok'}</span>
                      <span>{new Date(spot.created_at).toLocaleDateString('tr-TR')}</span>
                    </div>
                    
                    <div className="flex space-x-2">
                      <Link
                        href={`/spots/${spot.id}`}
                        className="flex-1 bg-blue-50 text-blue-600 hover:bg-blue-100 text-center py-2 rounded-lg text-sm font-medium"
                      >
                        GÃ¶rÃ¼ntÃ¼le
                      </Link>
                      {spot.status === 'expired' && (
                        <button
                          onClick={() => handleRenewSpot(spot.id)}
                          className="flex-1 bg-green-50 text-green-600 hover:bg-green-100 text-center py-2 rounded-lg text-sm font-medium"
                        >
                          Yenile
                        </button>
                      )}
                      <button
                        onClick={() => handleDeleteSpot(spot.id, spot.title)}
                        className="flex-1 bg-red-50 text-red-600 hover:bg-red-100 text-center py-2 rounded-lg text-sm font-medium"
                      >
                        Sil
                      </button>
                    </div>
                  </div>
                ))}
              </div>

              {/* MasaÃ¼stÃ¼ GÃ¶rÃ¼nÃ¼m */}
              <div className="hidden md:block overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="py-3 px-6 text-left text-sm font-medium text-gray-700">Spot</th>
                      <th className="py-3 px-6 text-left text-sm font-medium text-gray-700">Kategori</th>
                      <th className="py-3 px-6 text-left text-sm font-medium text-gray-700">Durum</th>
                      <th className="py-3 px-6 text-left text-sm font-medium text-gray-700">GÃ¶rÃ¼ntÃ¼lenme</th>
                      <th className="py-3 px-6 text-left text-sm font-medium text-gray-700">YardÄ±m</th>
                      <th className="py-3 px-6 text-left text-sm font-medium text-gray-700">Tarih</th>
                      <th className="py-3 px-6 text-left text-sm font-medium text-gray-700">Ä°ÅŸlemler</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-100">
                    {spots.map((spot) => (
                      <tr key={spot.id} className="hover:bg-gray-50">
                        <td className="py-4 px-6">
                          <div>
                            <Link
                              href={`/spots/${spot.id}`}
                              className="font-medium text-blue-600 hover:text-blue-800 block mb-1"
                            >
                              {spot.title.length > 50 ? spot.title.substring(0, 50) + '...' : spot.title}
                            </Link>
                            <p className="text-gray-500 text-sm line-clamp-1">
                              {spot.description?.substring(0, 60)}...
                            </p>
                          </div>
                        </td>
                        <td className="py-4 px-6">
                          {spot.category ? (
                            <span className="bg-gray-100 text-gray-800 text-xs font-medium px-3 py-1 rounded-full">
                              {spot.category}
                            </span>
                          ) : (
                            <span className="text-gray-400">-</span>
                          )}
                        </td>
                        <td className="py-4 px-6">
                          <span className={`px-3 py-1 rounded-full text-xs font-medium ${getStatusColor(spot.status)}`}>
                            {getStatusText(spot.status)}
                          </span>
                          {spot.status === 'expired' && (
                            <p className="text-red-600 text-xs mt-1">30 gÃ¼n doldu</p>
                          )}
                        </td>
                        <td className="py-4 px-6">
                          <div className="text-center">
                            <div className="font-bold text-gray-900">{spot.views}</div>
                            <div className="text-xs text-gray-500">kez</div>
                          </div>
                        </td>
                        <td className="py-4 px-6">
                          <div className="text-center">
                            <div className="font-bold text-gray-900">{spot.helps}</div>
                            <div className="text-xs text-gray-500">yardÄ±m</div>
                          </div>
                        </td>
                        <td className="py-4 px-6">
                          <div className="text-sm text-gray-500">
                            <div>{new Date(spot.created_at).toLocaleDateString('tr-TR')}</div>
                            <div className="text-xs">
                              {new Date(spot.created_at).toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' })}
                            </div>
                          </div>
                        </td>
                        <td className="py-4 px-6">
                          <div className="flex flex-col space-y-2">
                            <div className="flex space-x-2">
                              <Link
                                href={`/spots/${spot.id}`}
                                className="flex-1 bg-blue-50 text-blue-600 hover:bg-blue-100 text-center py-2 rounded text-sm font-medium"
                              >
                                ğŸ‘ï¸ GÃ¶rÃ¼ntÃ¼le
                              </Link>
                              {spot.status === 'active' && spot.helps === 0 && (
                                <button
                                  onClick={() => handleDeleteSpot(spot.id, spot.title)}
                                  className="flex-1 bg-red-50 text-red-600 hover:bg-red-100 text-center py-2 rounded text-sm font-medium"
                                >
                                  ğŸ—‘ï¸ Sil
                                </button>
                              )}
                            </div>
                            
                            {spot.status === 'expired' && (
                              <button
                                onClick={() => handleRenewSpot(spot.id)}
                                className="w-full bg-green-50 text-green-600 hover:bg-green-100 text-center py-2 rounded text-sm font-medium"
                              >
                                ğŸ”„ Yenile (30 gÃ¼n)
                              </button>
                            )}
                            
                            {spot.status === 'active' && (
                              <button
                                onClick={() => handleUpdateStatus(spot.id, 'found')}
                                className="w-full bg-blue-50 text-blue-600 hover:bg-blue-100 text-center py-2 rounded text-sm font-medium"
                              >
                                âœ… Bulundu Ä°ÅŸaretle
                              </button>
                            )}
                            
                            {spot.status === 'found' && (
                              <button
                                onClick={() => handleUpdateStatus(spot.id, 'active')}
                                className="w-full bg-yellow-50 text-yellow-600 hover:bg-yellow-100 text-center py-2 rounded text-sm font-medium"
                              >
                                â†©ï¸ Aktif Yap
                              </button>
                            )}
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </>
          )}
        </div>

        {/* Sayfalama ve Bilgi */}
        {spots.length > 0 && (
          <div className="mt-6 flex flex-col md:flex-row md:items-center justify-between text-sm text-gray-600">
            <div>
              Toplam <span className="font-bold">{spots.length}</span> spot gÃ¶steriliyor
            </div>
            <div className="mt-2 md:mt-0">
              {/* Basit sayfalama - ileride geliÅŸtirilebilir */}
              <div className="flex items-center space-x-2">
                <button className="px-3 py-1 border border-gray-300 rounded disabled:opacity-50">
                  â† Ã–nceki
                </button>
                <span className="px-3 py-1 bg-blue-600 text-white rounded">1</span>
                <button className="px-3 py-1 border border-gray-300 rounded">
                  Sonraki â†’
                </button>
              </div>
            </div>
          </div>
        )}

        {/* Ä°puÃ§larÄ± ve Bilgiler */}
        <div className="mt-12 grid md:grid-cols-2 gap-6">
          <div className="bg-blue-50 rounded-xl p-6">
            <h3 className="font-bold text-blue-900 mb-3 flex items-center">
              <span className="text-blue-600 mr-2">ğŸ’¡</span>
              Spot YÃ¶netimi Ä°puÃ§larÄ±
            </h3>
            <ul className="space-y-2 text-sm text-blue-800">
              <li>â€¢ SÃ¼resi dolan spot'larÄ± "Yenile" butonuyla 30 gÃ¼n uzatabilirsiniz</li>
              <li>â€¢ Bulunan spot'larÄ± "Bulundu" olarak iÅŸaretleyin</li>
              <li>â€¢ YardÄ±m alÄ±nmayan spot'larÄ± silebilirsiniz</li>
              <li>â€¢ Resimli spot'lar daha hÄ±zlÄ± bulunuyor</li>
              <li>â€¢ AÃ§Ä±klamalar ne kadar detaylÄ± olursa o kadar iyi</li>
            </ul>
          </div>
          
          <div className="bg-green-50 rounded-xl p-6">
            <h3 className="font-bold text-green-900 mb-3 flex items-center">
              <span className="text-green-600 mr-2">âš¡</span>
              HÄ±zlÄ± Eylemler
            </h3>
            <div className="space-y-3">
              <button
                onClick={handleCreateSpot}
                className="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 rounded-lg flex items-center justify-center"
              >
                <span className="mr-2">â•</span>
                Yeni Spot OluÅŸtur
              </button>
              
              <Link
                href="/shop/dashboard"
                className="block w-full bg-white hover:bg-gray-100 text-gray-800 font-medium py-3 rounded-lg border border-gray-300 text-center"
              >
                â† Dashboard'a DÃ¶n
              </Link>
            </div>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/spots/[id]/page.tsx
ğŸ“Š 293 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/spots/[id]/page.tsx - DÃœZELTMÄ°Å HALÄ°
'use client'

import { useEffect, useState } from 'react'
import { useParams, useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import SimpleMap from '@/components/SimpleMap'
import SimpleShareButtons from '@/components/SimpleShareButtons'

interface Spot {
  id: string
  title: string
  description: string
  category: string | null
  location: string | null
  image_url: string | null
  status: string
  created_at: string
  user_id: string
  views: number
  helps: number
  user?: {
    name: string | null
    email: string
  }
}

export default function SpotDetailPage() {
  const params = useParams()
  const router = useRouter()
  const spotId = params.id as string
  
  const [spot, setSpot] = useState<Spot | null>(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    if (spotId) {
      fetchSpotDetails()
    }
  }, [spotId])

  const fetchSpotDetails = async () => {
    try {
      // Spot bilgilerini getir
      const { data: spotData, error: spotError } = await supabase
        .from('spots')
        .select('*')
        .eq('id', spotId)
        .single()

      if (spotError) {
        console.error('Spot bulunamadÄ±:', spotError)
        return
      }

      // KullanÄ±cÄ± bilgilerini getir
      const { data: userData } = await supabase
        .from('user_profiles')
        .select('name, email')
        .eq('id', spotData.user_id)
        .single()

      // GÃ¶rÃ¼ntÃ¼leme sayÄ±sÄ±nÄ± artÄ±r
      await supabase
        .from('spots')
        .update({ views: (spotData.views || 0) + 1 })
        .eq('id', spotId)

      setSpot({
        ...spotData,
        user: userData || { name: null, email: spotData.user_id }
      })
    } catch (error) {
      console.error('Spot detaylarÄ± yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const handleHelpClick = () => {
    router.push(`/help/${spotId}`)
  }

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50">
        <main className="container-custom py-12 text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">YÃ¼kleniyor...</p>
        </main>
      </div>
    )
  }

  if (!spot) {
    return (
      <div className="min-h-screen bg-gray-50">
        <main className="container-custom py-12 text-center">
          <h1 className="text-3xl font-bold text-gray-900 mb-4">Spot bulunamadÄ±</h1>
          <p className="text-gray-600 mb-8">Bu spot silinmiÅŸ veya mevcut deÄŸil.</p>
          <button
            onClick={() => router.push('/spots')}
            className="btn-primary"
          >
            TÃ¼m Spot'lara DÃ¶n
          </button>
        </main>
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <main className="container-custom py-8">
        {/* Ãœst Navigasyon */}
        <div className="mb-6">
          <button
            onClick={() => router.push('/spots')}
            className="text-blue-600 hover:text-blue-800 flex items-center"
          >
            â† TÃ¼m Spot'lara DÃ¶n
          </button>
        </div>

        <div className="grid lg:grid-cols-3 gap-8">
          {/* Sol Kolon - Spot DetaylarÄ± */}
          <div className="lg:col-span-2 space-y-6">
            {/* Spot BaÅŸlÄ±ÄŸÄ± */}
            <div className="bg-white rounded-2xl shadow-lg p-6">
              <div className="flex items-start justify-between mb-4">
                <div>
                  <div className="flex items-center space-x-3 mb-2">
                    <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                      spot.status === 'active' 
                        ? 'bg-green-100 text-green-800' 
                        : 'bg-blue-100 text-blue-800'
                    }`}>
                      {spot.status === 'active' ? 'Aktif' : 'Bulundu'}
                    </span>
                    <span className="text-gray-500 text-sm">
                      {new Date(spot.created_at).toLocaleDateString('tr-TR')}
                    </span>
                  </div>
                  <h1 className="text-3xl font-bold text-gray-900 mb-4">
                    {spot.title}
                  </h1>
                </div>
              </div>

              {/* Spot Resmi */}
              {spot.image_url && (
                <div className="mb-6">
                  <div className="relative h-96 w-full rounded-xl overflow-hidden bg-gray-100">
                    <img
                      src={spot.image_url}
                      alt={spot.title}
                      className="w-full h-full object-cover"
                      onError={(e) => {
                        const target = e.target as HTMLImageElement
                        target.style.display = 'none'
                      }}
                    />
                  </div>
                </div>
              )}

              {/* AÃ§Ä±klama */}
              <div className="mb-8">
                <h2 className="text-xl font-bold text-gray-900 mb-3">AÃ§Ä±klama</h2>
                <p className="text-gray-700 whitespace-pre-line">
                  {spot.description}
                </p>
              </div>

              {/* Detaylar */}
              <div className="grid md:grid-cols-2 gap-6">
                <div>
                  <h3 className="text-sm font-medium text-gray-500 mb-2">Kategori</h3>
                  <p className="font-medium">{spot.category || 'BelirtilmemiÅŸ'}</p>
                </div>
                <div>
                  <h3 className="text-sm font-medium text-gray-500 mb-2">Konum</h3>
                  <p className="font-medium">{spot.location || 'BelirtilmemiÅŸ'}</p>
                </div>
                <div>
                  <h3 className="text-sm font-medium text-gray-500 mb-2">GÃ¶rÃ¼ntÃ¼lenme</h3>
                  <p className="font-medium">{spot.views} kez</p>
                </div>
                <div>
                  <h3 className="text-sm font-medium text-gray-500 mb-2">YardÄ±m</h3>
                  <p className="font-medium">{spot.helps} kiÅŸi yardÄ±m etti</p>
                </div>
              </div>
            </div>

            {/* Harita BÃ¶lÃ¼mÃ¼ */}
            {spot.location && (
              <div className="bg-white rounded-2xl shadow-lg p-6">
                <h2 className="text-xl font-bold text-gray-900 mb-4">
                  ğŸ“ Konum Bilgisi
                </h2>
                <SimpleMap location={spot.location} />
              </div>
            )}

            {/* YardÄ±m Butonu */}
            <div className="bg-gradient-to-r from-green-500 to-green-600 rounded-2xl p-8 text-center text-white">
              <h3 className="text-2xl font-bold mb-4">Bu Ã¼rÃ¼nÃ¼ gÃ¶rdÃ¼nÃ¼z mÃ¼?</h3>
              <p className="mb-6 opacity-90">TopluluÄŸa yardÄ±m edin, baÅŸkalarÄ±nÄ± mutlu edin</p>
              <button
                onClick={handleHelpClick}
                className="bg-white text-green-600 hover:bg-gray-100 font-bold py-4 px-8 rounded-xl text-lg"
              >
                Evet, Ben GÃ¶rdÃ¼m!
              </button>
            </div>
          </div>

          {/* SaÄŸ Kolon - Yan Bilgiler */}
          <div className="space-y-6">
            {/* PaylaÅŸÄ±m */}
            <SimpleShareButtons 
              url={`/spots/${spot.id}`} 
              title={spot.title} 
            />

            {/* Spot Sahibi */}
            <div className="bg-white rounded-2xl shadow-lg p-6">
              <h3 className="text-lg font-bold text-gray-900 mb-4">
                Spot Sahibi
              </h3>
              <div className="flex items-center space-x-3">
                <div className="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
                  {spot.user?.name?.[0]?.toUpperCase() || 'K'}
                </div>
                <div>
                  <p className="font-medium">{spot.user?.name || 'KullanÄ±cÄ±'}</p>
                  <p className="text-sm text-gray-500">
                    Topluluk Ã¼yesi
                  </p>
                </div>
              </div>
            </div>

            {/* Ä°statistikler */}
            <div className="bg-white rounded-2xl shadow-lg p-6">
              <h3 className="text-lg font-bold text-gray-900 mb-4">
                Ä°statistikler
              </h3>
              <div className="space-y-4">
                <div className="flex justify-between">
                  <span className="text-gray-600">GÃ¶rÃ¼ntÃ¼lenme:</span>
                  <span className="font-bold">{spot.views}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">YardÄ±m Edenler:</span>
                  <span className="font-bold">{spot.helps}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">OluÅŸturulma:</span>
                  <span className="font-bold">
                    {new Date(spot.created_at).toLocaleDateString('tr-TR')}
                  </span>
                </div>
              </div>
            </div>

            {/* Kategori Bilgisi */}
            {spot.category && (
              <div className="bg-white rounded-2xl shadow-lg p-6">
                <h3 className="text-lg font-bold text-gray-900 mb-4">
                  Kategori
                </h3>
                <div className="flex items-center">
                  <span className="text-2xl mr-3">
                    {spot.category === 'Elektronik' && 'ğŸ”Œ'}
                    {spot.category === 'FotoÄŸraf Makineleri' && 'ğŸ“·'}
                    {spot.category === 'Giyim & Aksesuar' && 'ğŸ‘•'}
                    {spot.category === 'Ev & BahÃ§e' && 'ğŸ '}
                    {spot.category === 'Koleksiyon' && 'ğŸ¨'}
                    {spot.category === 'Kitap & MÃ¼zik' && 'ğŸ“š'}
                    {spot.category === 'DiÄŸer' && 'ğŸ“¦'}
                  </span>
                  <span className="font-medium">{spot.category}</span>
                </div>
              </div>
            )}
          </div>
        </div>
      </main>
    </div>
  )
}

ğŸ“„ app/spots/page.tsx
ğŸ“Š 78 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/spots/page.tsx - BASÄ°TLEÅTÄ°RÄ°LMÄ°Å
import SpotList from '@/components/SpotList'
import SearchFilters from '@/components/SearchFilters'

export default function SpotsPage({
  searchParams,
}: {
  searchParams: { [key: string]: string | string[] | undefined }
}) {
  const getSearchParam = (key: string): string => {
    const param = searchParams[key]
    if (Array.isArray(param)) {
      return param[0] || ''
    }
    return param || ''
  }

  const searchQuery = getSearchParam('search')
  const category = getSearchParam('category')
  const location = getSearchParam('location')
  const status = getSearchParam('status')

  return (
    <div className="min-h-screen bg-gray-50">
      <main className="container-custom py-4 md:py-8">
        {/* Layout'ta zaten header reklamÄ± var */}
        
        <div className="mb-6 md:mb-8">
          <h1 className="text-2xl md:text-3xl font-bold text-gray-900 mb-2">
            {searchQuery 
              ? `"${searchQuery}" iÃ§in sonuÃ§lar` 
              : category !== 'all' && category 
                ? `${category} Spot'larÄ±` 
                : location !== 'all' && location 
                  ? `${location} Spot'larÄ±` 
                  : 'TÃ¼m Spot\'lar'}
          </h1>
          
          <p className="text-gray-600">
            {searchQuery 
              ? 'AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼ bulmak iÃ§in filtreleri kullanÄ±n' 
              : 'TopluluÄŸumuzun aradÄ±ÄŸÄ± tÃ¼m Ã¼rÃ¼nleri keÅŸfedin ve yardÄ±m edin'}
          </p>
        </div>

        {/* Arama Ã§ubuÄŸu */}
        <div className="mb-6">
          <form action="/spots" method="GET" className="relative">
            <div className="flex">
              <input
                type="text"
                name="search"
                defaultValue={searchQuery}
                placeholder="Ne aramÄ±ÅŸtÄ±nÄ±z? ÃœrÃ¼n adÄ±, marka, model..."
                className="flex-grow px-4 md:px-6 py-3 md:py-4 text-base md:text-lg border border-gray-300 rounded-l-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"
              />
              <button
                type="submit"
                className="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 md:px-8 py-3 md:py-4 rounded-r-xl"
              >
                Ara
              </button>
            </div>
          </form>
        </div>

        <SearchFilters />

        {/* Spot listesi (iÃ§inde native reklamlar var) */}
        <div className="mt-6">
          <SpotList />
        </div>

        {/* Layout'ta zaten footer reklamÄ± var */}
      </main>
    </div>
  )
}

ğŸ“„ app/terms/page.tsx
ğŸ“Š 158 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/terms/page.tsx
import Header from '@/components/Header'
import Footer from '@/components/Footer'
import Link from 'next/link'

export default function TermsPage() {
  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8 md:py-12">
        <div className="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg p-8">
          {/* Header */}
          <div className="text-center mb-10">
            <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
              SpotItForMe KullanÄ±m KoÅŸullarÄ±
            </h1>
            <p className="text-gray-600">
              Son gÃ¼ncellenme: {new Date().toLocaleDateString('tr-TR', { day: 'numeric', month: 'long', year: 'numeric' })}
            </p>
          </div>

          {/* Content */}
          <div className="prose prose-lg max-w-none">
            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">1. Kabul ve DeÄŸiÅŸiklikler</h2>
              <p className="text-gray-700 mb-4">
                SpotItForMe platformunu ("Platform") kullanarak bu KullanÄ±m KoÅŸullarÄ±nÄ± kabul etmiÅŸ sayÄ±lÄ±rsÄ±nÄ±z. 
                Platform sahibi, koÅŸullarÄ± herhangi bir zamanda deÄŸiÅŸtirme hakkÄ±nÄ± saklÄ± tutar.
              </p>
              <p className="text-gray-700">
                DeÄŸiÅŸiklikler Platform Ã¼zerinden duyurulacak olup, deÄŸiÅŸikliklerden sonra Platformu 
                kullanmaya devam etmeniz gÃ¼ncel koÅŸullarÄ± kabul ettiÄŸiniz anlamÄ±na gelir.
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">2. Hizmet TanÄ±mÄ±</h2>
              <p className="text-gray-700 mb-4">
                SpotItForMe, kullanÄ±cÄ±larÄ±n bulmakta zorlandÄ±ÄŸÄ± Ã¼rÃ¼nleri ("Spot") topluluk gÃ¼cÃ¼yle 
                bulmalarÄ±nÄ± saÄŸlayan bir platformdur. Hizmetler ÅŸunlarÄ± iÃ§erir:
              </p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>Spot oluÅŸturma ve yayÄ±nlama</li>
                <li>Spot'lara yardÄ±m etme ("Ben gÃ¶rdÃ¼m" bildirimi)</li>
                <li>KullanÄ±cÄ± profili oluÅŸturma</li>
                <li>MaÄŸaza profili oluÅŸturma (iÅŸletmeler iÃ§in)</li>
                <li>Spot'larÄ± filtreleme ve arama</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">3. KullanÄ±cÄ± YÃ¼kÃ¼mlÃ¼lÃ¼kleri</h2>
              <p className="text-gray-700 mb-4">
                Platformu kullanÄ±rken aÅŸaÄŸÄ±daki kurallara uymayÄ± kabul edersiniz:
              </p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>DoÄŸru, gÃ¼ncel ve eksiksiz bilgi saÄŸlamak</li>
                <li>YasadÄ±ÅŸÄ±, hakaret iÃ§eren veya spam iÃ§erik paylaÅŸmamak</li>
                <li>BaÅŸkalarÄ±nÄ±n gizlilik haklarÄ±na saygÄ± gÃ¶stermek</li>
                <li>Platformun gÃ¼venliÄŸini tehlikeye atmamak</li>
                <li>Telif hakkÄ± ihlali yapmamak</li>
                <li>YanÄ±ltÄ±cÄ± veya aldatÄ±cÄ± bilgi paylaÅŸmamak</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">4. Ä°Ã§erik ve Fikri MÃ¼lkiyet</h2>
              <p className="text-gray-700 mb-4">
                Platforma yÃ¼klediÄŸiniz iÃ§eriklerin (fotoÄŸraflar, aÃ§Ä±klamalar, yorumlar) size ait olduÄŸunu 
                veya yayÄ±nlama hakkÄ±nÄ±z bulunduÄŸunu garanti edersiniz.
              </p>
              <p className="text-gray-700 mb-4">
                SpotItForMe logosu, tasarÄ±mÄ± ve yazÄ±lÄ±mÄ± Platform sahibine aittir. Ä°zinsiz kullanÄ±lamaz.
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">5. MaÄŸaza HesaplarÄ±</h2>
              <p className="text-gray-700 mb-4">
                Ä°ÅŸletme sahipleri maÄŸaza hesabÄ± aÃ§abilir. MaÄŸaza hesaplarÄ± iÃ§in ek kurallar:
              </p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>GerÃ§ek ve doÄŸru iÅŸletme bilgileri saÄŸlamak</li>
                <li>Ticari faaliyetlere uygun iÃ§erik paylaÅŸmak</li>
                <li>MÃ¼ÅŸteri ÅŸikayetlerine zamanÄ±nda cevap vermek</li>
                <li>Fiyat ve stok bilgilerini gÃ¼ncel tutmak</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">6. Ãœcretler ve Ã–demeler</h2>
              <p className="text-gray-700 mb-4">
                Åu anda Platform tÃ¼m kullanÄ±cÄ±lar iÃ§in Ã¼cretsizdir. Ä°leride eklenebilecek premium 
                Ã¶zellikler iÃ§in ayrÄ± Ã¼cret politikalarÄ± duyurulacaktÄ±r.
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">7. Sorumluluk Reddi</h2>
              <p className="text-gray-700 mb-4">
                SpotItForMe, kullanÄ±cÄ±lar arasÄ±ndaki iletiÅŸimden, satÄ±ÅŸ iÅŸlemlerinden veya 
                anlaÅŸmazlÄ±klardan sorumlu deÄŸildir. Platform bir aracÄ± platformdur.
              </p>
              <p className="text-gray-700">
                KullanÄ±cÄ±lar kendi gÃ¼venliklerinden sorumludur. YÃ¼z yÃ¼ze buluÅŸmalarda dikkatli olunmasÄ± 
                ve gÃ¼venli yerler tercih edilmesi Ã¶nerilir.
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">8. Hesap AskÄ±ya Alma ve SonlandÄ±rma</h2>
              <p className="text-gray-700 mb-4">
                AÅŸaÄŸÄ±daki durumlarda hesabÄ±nÄ±z askÄ±ya alÄ±nabilir veya sonlandÄ±rÄ±labilir:
              </p>
              <ul className="list-disc pl-6 text-gray-700 mb-4 space-y-2">
                <li>KoÅŸullarÄ± ihlal ettiÄŸiniz tespit edilirse</li>
                <li>YasadÄ±ÅŸÄ± faaliyetlerde bulunursanÄ±z</li>
                <li>DiÄŸer kullanÄ±cÄ±larÄ± rahatsÄ±z ederseniz</li>
                <li>Sistemi kÃ¶tÃ¼ye kullanÄ±rsanÄ±z</li>
              </ul>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">9. Gizlilik</h2>
              <p className="text-gray-700 mb-4">
                KiÅŸisel verileriniz <Link href="/privacy" className="text-blue-600 hover:text-blue-800">Gizlilik PolitikamÄ±z</Link> 
                uyarÄ±nca korunur ve iÅŸlenir.
              </p>
            </div>

            <div className="mb-10">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">10. Ä°letiÅŸim</h2>
              <p className="text-gray-700">
                KullanÄ±m KoÅŸullarÄ± ile ilgili sorularÄ±nÄ±z iÃ§in:{" "}
                <a href="mailto:spotitformeweb@gmail.com" className="text-blue-600 hover:text-blue-800">
                  spotitformeweb@gmail.com
                </a>
              </p>
            </div>
          </div>

          {/* Back Button */}
          <div className="text-center mt-10 pt-6 border-t">
            <Link
              href="/for-business"
              className="inline-block bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-3 px-8 rounded-lg"
            >
              â† Geri DÃ¶n
            </Link>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/test-email/page.tsx
ğŸ“Š 459 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/test-email/page.tsx
'use client'

import { useState, useEffect } from 'react'
import Header from '@/components/Header'
import Footer from '@/components/Footer'
import { supabase } from '@/lib/supabase'
import { 
  sendSpotCreatedEmail, 
  sendSightingNotificationEmail, 
  sendWelcomeEmail,
  sendTestEmail 
} from '@/lib/email'

export default function TestEmailPage() {
  const [user, setUser] = useState<any>(null)
  const [loading, setLoading] = useState(false)
  const [testEmail, setTestEmail] = useState('')
  const [results, setResults] = useState<Array<{type: string, success: boolean, message: string}>>([])
  const [spotId, setSpotId] = useState('test-spot-123')
  const [spotTitle, setSpotTitle] = useState('Test Spot BaÅŸlÄ±ÄŸÄ±')

  useEffect(() => {
    checkUser()
  }, [])

  const checkUser = async () => {
    const { data: { user } } = await supabase.auth.getUser()
    setUser(user)
    if (user?.email) {
      setTestEmail(user.email)
    }
  }

  const addResult = (type: string, success: boolean, message: string = '') => {
    setResults(prev => [...prev, { type, success, message }])
  }

  const clearResults = () => {
    setResults([])
  }

  const testSpotCreatedEmail = async () => {
    setLoading(true)
    addResult('Spot OluÅŸturuldu', false, 'GÃ¶nderiliyor...')
    
    try {
      const success = await sendSpotCreatedEmail(
        testEmail,
        spotTitle,
        spotId
      )
      
      addResult('Spot OluÅŸturuldu', success, 
        success ? 'âœ… Email baÅŸarÄ±yla gÃ¶nderildi!' : 'âŒ GÃ¶nderilemedi'
      )
    } catch (error: any) {
      addResult('Spot OluÅŸturuldu', false, `âŒ Hata: ${error.message}`)
    } finally {
      setLoading(false)
    }
  }

  const testSightingNotification = async () => {
    setLoading(true)
    addResult('YardÄ±m Bildirimi', false, 'GÃ¶nderiliyor...')
    
    try {
      const success = await sendSightingNotificationEmail(
        testEmail,
        spotTitle,
        'Test KullanÄ±cÄ±',
        spotId
      )
      
      addResult('YardÄ±m Bildirimi', success,
        success ? 'âœ… YardÄ±m bildirimi gÃ¶nderildi!' : 'âŒ GÃ¶nderilemedi'
      )
    } catch (error: any) {
      addResult('YardÄ±m Bildirimi', false, `âŒ Hata: ${error.message}`)
    } finally {
      setLoading(false)
    }
  }

  const testWelcomeEmail = async () => {
    setLoading(true)
    addResult('HoÅŸgeldin', false, 'GÃ¶nderiliyor...')
    
    try {
      const success = await sendWelcomeEmail(
        testEmail,
        'Test KullanÄ±cÄ± AdÄ±'
      )
      
      addResult('HoÅŸgeldin', success,
        success ? 'âœ… HoÅŸgeldin emaili gÃ¶nderildi!' : 'âŒ GÃ¶nderilemedi'
      )
    } catch (error: any) {
      addResult('HoÅŸgeldin', false, `âŒ Hata: ${error.message}`)
    } finally {
      setLoading(false)
    }
  }

  const testAllEmails = async () => {
    clearResults()
    await testSpotCreatedEmail()
    await new Promise(resolve => setTimeout(resolve, 1000))
    await testSightingNotification()
    await new Promise(resolve => setTimeout(resolve, 1000))
    await testWelcomeEmail()
  }

  const testCustomEmail = async () => {
    if (!testEmail.includes('@')) {
      addResult('Ã–zel Test', false, 'âŒ GeÃ§erli bir email adresi girin')
      return
    }

    setLoading(true)
    addResult('Ã–zel Test', false, 'GÃ¶nderiliyor...')
    
    try {
      const response = await fetch('/api/send-email', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          to: testEmail,
          template: 'welcome',
          data: { name: 'Ã–zel Test KullanÄ±cÄ±sÄ±' }
        })
      })

      const result = await response.json()
      
      addResult('Ã–zel Test', response.ok,
        response.ok ? `âœ… Test emaili gÃ¶nderildi! (${result.messageId || 'ID yok'})` 
        : `âŒ Hata: ${result.error || 'Bilinmeyen hata'}`
      )
    } catch (error: any) {
      addResult('Ã–zel Test', false, `âŒ Hata: ${error.message}`)
    } finally {
      setLoading(false)
    }
  }

  const checkEmailConfig = () => {
    const config = {
      gmailUser: process.env.NEXT_PUBLIC_GMAIL_USER || 'TanÄ±mlanmamÄ±ÅŸ',
      nodeEnv: process.env.NODE_ENV,
      siteUrl: process.env.NEXT_PUBLIC_SITE_URL || 'TanÄ±mlanmamÄ±ÅŸ',
      apiUrl: typeof window !== 'undefined' ? window.location.origin : 'TanÄ±mlanmamÄ±ÅŸ'
    }
    
    alert(`
ğŸ“§ Email KonfigÃ¼rasyonu:
------------------------
Gmail User: ${config.gmailUser}
NODE_ENV: ${config.nodeEnv}
Site URL: ${config.siteUrl}
API URL: ${config.apiUrl}
------------------------
Not: GMAIL_APP_PASS environment variable'Ä± kontrol edilmiyor (gÃ¼venlik iÃ§in)
    `)
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8">
        <div className="max-w-4xl mx-auto">
          {/* BaÅŸlÄ±k */}
          <div className="text-center mb-10">
            <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
              ğŸ“§ Email Sistemi Test SayfasÄ±
            </h1>
            <p className="text-gray-600">
              SpotItForMe email sistemini test edin. TÃ¼m email'ler {testEmail} adresine gÃ¶nderilecek.
            </p>
          </div>

          {/* KullanÄ±cÄ± Bilgisi */}
          <div className="bg-white rounded-xl shadow p-6 mb-8">
            <div className="flex items-center justify-between mb-4">
              <div>
                <h3 className="text-lg font-bold text-gray-900">KullanÄ±cÄ± Bilgisi</h3>
                <p className="text-gray-600">
                  {user ? `GiriÅŸ yapÄ±lmÄ±ÅŸ: ${user.email}` : 'GiriÅŸ yapÄ±lmamÄ±ÅŸ'}
                </p>
              </div>
              <button
                onClick={checkEmailConfig}
                className="text-sm bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg"
              >
                KonfigÃ¼rasyonu GÃ¶r
              </button>
            </div>

            {/* Email Input */}
            <div className="mt-4">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Test Email Adresi
              </label>
              <input
                type="email"
                value={testEmail}
                onChange={(e) => setTestEmail(e.target.value)}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                placeholder="test@example.com"
              />
              <p className="text-sm text-gray-500 mt-2">
                TÃ¼m test email'leri bu adrese gÃ¶nderilecek
              </p>
            </div>

            {/* Spot Bilgileri */}
            <div className="mt-6 grid md:grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Spot ID
                </label>
                <input
                  type="text"
                  value={spotId}
                  onChange={(e) => setSpotId(e.target.value)}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Spot BaÅŸlÄ±ÄŸÄ±
                </label>
                <input
                  type="text"
                  value={spotTitle}
                  onChange={(e) => setSpotTitle(e.target.value)}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                />
              </div>
            </div>
          </div>

          {/* Test ButonlarÄ± */}
          <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
            <button
              onClick={testSpotCreatedEmail}
              disabled={loading || !testEmail}
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg disabled:opacity-50 flex flex-col items-center"
            >
              <span className="text-2xl mb-2">ğŸ“</span>
              <span>Spot OluÅŸturma</span>
              <span className="text-xs opacity-75">(Template 1)</span>
            </button>

            <button
              onClick={testSightingNotification}
              disabled={loading || !testEmail}
              className="bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg disabled:opacity-50 flex flex-col items-center"
            >
              <span className="text-2xl mb-2">ğŸ¯</span>
              <span>YardÄ±m Bildirimi</span>
              <span className="text-xs opacity-75">(Template 2)</span>
            </button>

            <button
              onClick={testWelcomeEmail}
              disabled={loading || !testEmail}
              className="bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-4 rounded-lg disabled:opacity-50 flex flex-col items-center"
            >
              <span className="text-2xl mb-2">ğŸ‘‹</span>
              <span>HoÅŸgeldin</span>
              <span className="text-xs opacity-75">(Template 3)</span>
            </button>

            <button
              onClick={testCustomEmail}
              disabled={loading || !testEmail}
              className="bg-orange-600 hover:bg-orange-700 text-white font-medium py-3 px-4 rounded-lg disabled:opacity-50 flex flex-col items-center"
            >
              <span className="text-2xl mb-2">ğŸ”§</span>
              <span>API Test</span>
              <span className="text-xs opacity-75">(Direct API)</span>
            </button>
          </div>

          {/* TÃ¼mÃ¼nÃ¼ Test Et Butonu */}
          <div className="text-center mb-8">
            <button
              onClick={testAllEmails}
              disabled={loading || !testEmail}
              className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-lg text-lg disabled:opacity-50"
            >
              {loading ? 'Test Ediliyor...' : 'TÃœM EMAÄ°L\'LERÄ° TEST ET'}
            </button>
            <p className="text-sm text-gray-500 mt-2">
              3 farklÄ± email template'ini sÄ±rayla test eder
            </p>
          </div>

          {/* SonuÃ§lar */}
          <div className="bg-white rounded-xl shadow">
            <div className="border-b p-6">
              <div className="flex justify-between items-center">
                <h3 className="text-lg font-bold text-gray-900">Test SonuÃ§larÄ±</h3>
                <button
                  onClick={clearResults}
                  className="text-sm text-gray-600 hover:text-gray-900"
                >
                  Temizle
                </button>
              </div>
            </div>

            {results.length === 0 ? (
              <div className="p-12 text-center text-gray-500">
                <div className="text-4xl mb-4">ğŸ“¨</div>
                <p>HenÃ¼z test yapÄ±lmadÄ±</p>
                <p className="text-sm mt-2">YukarÄ±daki butonlardan birine tÄ±klayarak test baÅŸlatÄ±n</p>
              </div>
            ) : (
              <div className="p-6">
                <div className="space-y-4">
                  {results.map((result, index) => (
                    <div 
                      key={index} 
                      className={`p-4 rounded-lg border ${
                        result.success 
                          ? 'border-green-200 bg-green-50' 
                          : 'border-red-200 bg-red-50'
                      }`}
                    >
                      <div className="flex items-center justify-between">
                        <div className="flex items-center">
                          {result.success ? (
                            <span className="text-green-600 mr-3">âœ…</span>
                          ) : (
                            <span className="text-red-600 mr-3">âŒ</span>
                          )}
                          <div>
                            <h4 className="font-medium">{result.type}</h4>
                            <p className={`text-sm ${result.success ? 'text-green-700' : 'text-red-700'}`}>
                              {result.message}
                            </p>
                          </div>
                        </div>
                        <span className="text-xs text-gray-500">
                          #{index + 1}
                        </span>
                      </div>
                    </div>
                  ))}
                </div>

                {/* Ä°statistikler */}
                {results.length > 0 && (
                  <div className="mt-8 pt-6 border-t">
                    <h4 className="font-bold text-gray-900 mb-4">Test Ä°statistikleri</h4>
                    <div className="grid grid-cols-3 gap-4">
                      <div className="text-center p-4 bg-blue-50 rounded-lg">
                        <div className="text-2xl font-bold text-blue-600">
                          {results.length}
                        </div>
                        <div className="text-sm text-gray-600">Toplam Test</div>
                      </div>
                      <div className="text-center p-4 bg-green-50 rounded-lg">
                        <div className="text-2xl font-bold text-green-600">
                          {results.filter(r => r.success).length}
                        </div>
                        <div className="text-sm text-gray-600">BaÅŸarÄ±lÄ±</div>
                      </div>
                      <div className="text-center p-4 bg-red-50 rounded-lg">
                        <div className="text-2xl font-bold text-red-600">
                          {results.filter(r => !r.success).length}
                        </div>
                        <div className="text-sm text-gray-600">BaÅŸarÄ±sÄ±z</div>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            )}
          </div>

          {/* Debug Bilgileri */}
          <div className="mt-8 bg-gray-900 text-white rounded-xl p-6">
            <h3 className="text-lg font-bold mb-4">ğŸ” Debug Bilgileri</h3>
            <div className="space-y-3">
              <div className="flex justify-between">
                <span>KullanÄ±cÄ± Durumu:</span>
                <span className={user ? 'text-green-400' : 'text-red-400'}>
                  {user ? 'GiriÅŸ YapÄ±lmÄ±ÅŸ' : 'GiriÅŸ YapÄ±lmamÄ±ÅŸ'}
                </span>
              </div>
              <div className="flex justify-between">
                <span>Email Adresi:</span>
                <span className="font-mono">{testEmail || 'BelirtilmemiÅŸ'}</span>
              </div>
              <div className="flex justify-between">
                <span>API URL:</span>
                <span className="font-mono text-sm">
                  {typeof window !== 'undefined' ? window.location.origin + '/api/send-email' : ''}
                </span>
              </div>
              <div className="flex justify-between">
                <span>Environment:</span>
                <span className="font-mono">{process.env.NODE_ENV}</span>
              </div>
            </div>
            
            <div className="mt-6 pt-6 border-t border-gray-800">
              <h4 className="font-bold mb-3">ğŸ¯ HÄ±zlÄ± Test KomutlarÄ± (Console)</h4>
              <div className="space-y-2">
                <button
                  onClick={() => {
                    const commands = `
// Console'da test etmek iÃ§in:
await fetch('/api/send-email', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    to: '${testEmail}',
    template: 'welcome',
    data: { name: 'Console Test' }
  })
}).then(r => r.json()).then(console.log)
                    `.trim()
                    
                    navigator.clipboard.writeText(commands)
                    alert('Komutlar kopyalandÄ±! Console\'a yapÄ±ÅŸtÄ±rÄ±n.')
                  }}
                  className="text-sm bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-lg w-full text-left font-mono"
                >
                  ğŸ“‹ Test KomutlarÄ±nÄ± Kopyala
                </button>
              </div>
            </div>
          </div>

          {/* NasÄ±l KullanÄ±lÄ±r */}
          <div className="mt-8 bg-blue-50 rounded-xl p-6">
            <h3 className="text-lg font-bold text-gray-900 mb-4">ğŸ“– NasÄ±l KullanÄ±lÄ±r</h3>
            <ol className="space-y-3 list-decimal list-inside text-gray-700">
              <li>Gmail App Password'unuzu aldÄ±ÄŸÄ±nÄ±zdan emin olun</li>
              <li><code>.env.local</code> dosyasÄ±nda <code>GMAIL_USER</code> ve <code>GMAIL_APP_PASS</code> deÄŸiÅŸkenlerini ayarlayÄ±n</li>
              <li>Test email adresinizi girin (kendi email'iniz)</li>
              <li>Test butonlarÄ±ndan birine tÄ±klayÄ±n</li>
              <li>Email'inizi kontrol edin (Spam klasÃ¶rÃ¼ne de bakÄ±n)</li>
              <li>Vercel'de environment variables'larÄ± ayarlayÄ±n</li>
            </ol>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/test-geolocation/page.tsx
ğŸ“Š 337 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/test-geolocation/page.tsx - EN BASÄ°T TEST
'use client'

import { useState } from 'react'
import Header from '@/components/Header'
import Footer from '@/components/Footer'

export default function TestGeolocationPage() {
  const [status, setStatus] = useState('Teste hazÄ±r')
  const [permissionState, setPermissionState] = useState('unknown')
  const [coords, setCoords] = useState<{lat: number, lng: number} | null>(null)
  const [browserInfo, setBrowserInfo] = useState('')

  // 1. ADIM: TarayÄ±cÄ± desteÄŸi kontrolÃ¼
  const checkBrowserSupport = () => {
    setBrowserInfo(navigator.userAgent)
    
    if (!navigator.geolocation) {
      setStatus('âŒ TarayÄ±cÄ±nÄ±z konum servisini DESTEKLEMÄ°YOR')
      return false
    }
    
    setStatus('âœ… TarayÄ±cÄ± konum servisini destekliyor')
    return true
  }

  // 2. ADIM: Ä°zin durumu kontrolÃ¼
  const checkPermission = async () => {
    if ('permissions' in navigator) {
      try {
        const permission = await navigator.permissions.query({ name: 'geolocation' as PermissionName })
        setPermissionState(permission.state)
        
        permission.onchange = () => {
          setPermissionState(permission.state)
          setStatus(`Ä°zin durumu deÄŸiÅŸti: ${permission.state}`)
        }
        
        setStatus(`Ä°zin durumu: ${permission.state}`)
        return permission.state
      } catch (err) {
        setStatus(`Ä°zin sorgulama hatasÄ±: ${err}`)
        return 'error'
      }
    } else {
      setStatus('âš ï¸ TarayÄ±cÄ± izin API"sini desteklemiyor')
      return 'not_supported'
    }
  }

  // 3. ADIM: Konum alma (SADECE BU KISIM Ä°ZÄ°N Ä°STER!)
  const getLocation = () => {
    setStatus('â³ Konum isteniyor... (TarayÄ±cÄ± izin isteyecek)')
    
    // BU FONKSÄ°YON TARAYICIDAN Ä°ZÄ°N Ä°STER!
    navigator.geolocation.getCurrentPosition(
      // BaÅŸarÄ±lÄ±
      (position) => {
        const { latitude, longitude, accuracy } = position.coords
        setCoords({ lat: latitude, lng: longitude })
        setStatus(`âœ… Konum alÄ±ndÄ±! DoÄŸruluk: ${accuracy}m`)
        setPermissionState('granted')
      },
      // Hata
      (error) => {
        let errorMessage = ''
        switch(error.code) {
          case error.PERMISSION_DENIED:
            errorMessage = 'âŒ KullanÄ±cÄ± konum iznini REDDETTÄ°'
            setPermissionState('denied')
            break
          case error.POSITION_UNAVAILABLE:
            errorMessage = 'âŒ Konum bilgisi ULAÅILAMIYOR'
            break
          case error.TIMEOUT:
            errorMessage = 'â±ï¸ Konum alÄ±mÄ± ZAMAN AÅIMINA uÄŸradÄ±'
            break
          default:
            errorMessage = `âŒ Bilinmeyen hata: ${error.message}`
        }
        setStatus(errorMessage)
      },
      // SeÃ§enekler
      {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      }
    )
  }

  // 4. ADIM: TÃ¼m testleri Ã§alÄ±ÅŸtÄ±r
  const runAllTests = () => {
    setStatus('Testler baÅŸlÄ±yor...')
    setCoords(null)
    
    if (checkBrowserSupport()) {
      setTimeout(() => {
        checkPermission().then(() => {
          setTimeout(() => {
            getLocation()
          }, 1000)
        })
      }, 500)
    }
  }

  // 5. ADIM: Ä°zin sÄ±fÄ±rlama (geliÅŸtirici iÃ§in)
  const resetPermissions = () => {
    if ('permissions' in navigator) {
      // Not: Bu sadece geliÅŸtirici modunda Ã§alÄ±ÅŸÄ±r
      setStatus('Ä°zin durumu sÄ±fÄ±rlanÄ±yor... sayfayÄ± yenileyin')
      setPermissionState('prompt')
      setCoords(null)
    }
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8">
        <div className="max-w-3xl mx-auto">
          <h1 className="text-3xl font-bold text-center mb-2">
            Konum Ä°zin Testi
          </h1>
          <p className="text-gray-600 text-center mb-8">
            Nerede takÄ±ldÄ±ÄŸÄ±mÄ±zÄ± gÃ¶relim
          </p>

          {/* TEST KONTROL PANELÄ° */}
          <div className="bg-white rounded-2xl shadow-lg p-6 mb-8">
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <button
                onClick={checkBrowserSupport}
                className="bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg"
              >
                1. TarayÄ±cÄ± DesteÄŸi
              </button>
              <button
                onClick={checkPermission}
                className="bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg"
              >
                2. Ä°zin Durumu
              </button>
              <button
                onClick={getLocation}
                className="bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg"
              >
                3. Konum Al (Ä°ZÄ°N Ä°STER!)
              </button>
            </div>

            <div className="text-center">
              <button
                onClick={runAllTests}
                className="bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-8 rounded-xl text-lg mb-4"
              >
                TÃœM TESTLERÄ° Ã‡ALIÅTIR
              </button>
              <p className="text-sm text-gray-600">
                Bu buton tÃ¼m testleri sÄ±rayla Ã§alÄ±ÅŸtÄ±rÄ±r
              </p>
            </div>
          </div>

          {/* SONUÃ‡LAR */}
          <div className="space-y-6">
            {/* DURUM */}
            <div className={`p-6 rounded-xl ${
              status.includes('âœ…') ? 'bg-green-50 border border-green-200' :
              status.includes('âŒ') ? 'bg-red-50 border border-red-200' :
              status.includes('âš ï¸') ? 'bg-yellow-50 border border-yellow-200' :
              'bg-blue-50 border border-blue-200'
            }`}>
              <h3 className="font-bold text-gray-900 mb-2">Durum</h3>
              <p className={`
                ${status.includes('âœ…') ? 'text-green-800' : ''}
                ${status.includes('âŒ') ? 'text-red-800' : ''}
                ${status.includes('âš ï¸') ? 'text-yellow-800' : ''}
                ${status.includes('â³') ? 'text-blue-800' : ''}
              `}>
                {status}
              </p>
            </div>

            {/* Ä°ZÄ°N DURUMU */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div className="bg-white rounded-xl shadow p-6">
                <h3 className="font-bold text-gray-900 mb-4">Ä°zin Durumu</h3>
                <div className={`inline-block px-4 py-2 rounded-full text-sm font-medium ${
                  permissionState === 'granted' ? 'bg-green-100 text-green-800' :
                  permissionState === 'denied' ? 'bg-red-100 text-red-800' :
                  permissionState === 'prompt' ? 'bg-yellow-100 text-yellow-800' :
                  'bg-gray-100 text-gray-800'
                }`}>
                  {permissionState === 'granted' && 'âœ… Ä°ZÄ°N VERÄ°LDÄ°'}
                  {permissionState === 'denied' && 'âŒ Ä°ZÄ°N REDDEDÄ°LDÄ°'}
                  {permissionState === 'prompt' && 'ğŸ“ Ä°ZÄ°N BEKLENÄ°YOR'}
                  {permissionState === 'unknown' && 'â“ BÄ°LÄ°NMÄ°YOR'}
                </div>
                
                {permissionState === 'denied' && (
                  <div className="mt-4 p-3 bg-red-50 rounded-lg">
                    <p className="text-sm text-red-700">
                      Ä°zin verilmedi. TarayÄ±cÄ± ayarlarÄ±ndan ÅŸu site iÃ§in konum izni aÃ§Ä±n:
                    </p>
                    <p className="font-mono text-xs mt-1">spotitforme.vercel.app</p>
                  </div>
                )}
              </div>

              {/* KOORDÄ°NATLAR */}
              <div className="bg-white rounded-xl shadow p-6">
                <h3 className="font-bold text-gray-900 mb-4">Koordinatlar</h3>
                {coords ? (
                  <div className="space-y-3">
                    <div>
                      <p className="text-sm text-gray-600">Enlem</p>
                      <p className="font-mono">{coords.lat}</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600">Boylam</p>
                      <p className="font-mono">{coords.lng}</p>
                    </div>
                    <a
                      href={`https://maps.google.com/?q=${coords.lat},${coords.lng}`}
                      target="_blank"
                      className="inline-block text-blue-600 hover:text-blue-800"
                    >
                      Haritada gÃ¶ster â†’
                    </a>
                  </div>
                ) : (
                  <p className="text-gray-500">HenÃ¼z koordinat alÄ±nmadÄ±</p>
                )}
              </div>
            </div>

            {/* TARAYICI BÄ°LGÄ°SÄ° */}
            <div className="bg-white rounded-xl shadow p-6">
              <h3 className="font-bold text-gray-900 mb-4">TarayÄ±cÄ± Bilgisi</h3>
              <div className="bg-gray-50 p-4 rounded-lg overflow-x-auto">
                <code className="text-sm text-gray-700">
                  {browserInfo || 'TarayÄ±cÄ± bilgisi henÃ¼z alÄ±nmadÄ±'}
                </code>
              </div>
            </div>

            {/* TELEFON TESTÄ° TALÄ°MATLARI */}
            <div className="bg-yellow-50 border border-yellow-200 rounded-xl p-6">
              <h3 className="font-bold text-yellow-800 mb-4">ğŸ“± Telefon Testi</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <h4 className="font-medium text-yellow-800 mb-2">AdÄ±m 1: Telefon AyarlarÄ±</h4>
                  <ul className="text-sm text-yellow-700 space-y-1">
                    <li>â€¢ Ayarlar â†’ Konum â†’ AÃ§Ä±k</li>
                    <li>â€¢ TarayÄ±cÄ± iÃ§in konum izni ver</li>
                    <li>â€¢ GPS/HÄ±zlÄ± konum aÃ§Ä±k olsun</li>
                  </ul>
                </div>
                <div>
                  <h4 className="font-medium text-yellow-800 mb-2">AdÄ±m 2: TarayÄ±cÄ± Ä°zni</h4>
                  <ul className="text-sm text-yellow-700 space-y-1">
                    <li>â€¢ "3. Konum Al" butonuna tÄ±kla</li>
                    <li>â€¢ Ekran Ã¼stÃ¼nde izin isteÄŸi Ã§Ä±kacak</li>
                    <li>â€¢ "Ä°zin Ver" veya "Allow" seÃ§</li>
                  </ul>
                </div>
              </div>
            </div>

            {/* HATA AYIKLAMA */}
            <div className="bg-gray-50 rounded-xl p-6">
              <h3 className="font-bold text-gray-900 mb-4">ğŸ”§ Hata AyÄ±klama</h3>
              
              <div className="space-y-4">
                <details className="group">
                  <summary className="flex items-center justify-between cursor-pointer p-3 bg-white rounded-lg">
                    <span className="font-medium">SÄ±k KarÅŸÄ±laÅŸÄ±lan Sorunlar</span>
                    <span className="transition group-open:rotate-180">â–¼</span>
                  </summary>
                  <div className="mt-3 space-y-3 p-3 bg-white rounded-lg">
                    <div>
                      <h5 className="font-medium text-red-600 mb-1">1. HTTPS Gerekli</h5>
                      <p className="text-sm text-gray-600">
                        Telefonlarda konum servisi sadece HTTPS sitelerde Ã§alÄ±ÅŸÄ±r.
                        Vercel'de HTTPS otomatik.
                      </p>
                    </div>
                    <div>
                      <h5 className="font-medium text-red-600 mb-1">2. TarayÄ±cÄ± Engel</h5>
                      <p className="text-sm text-gray-600">
                        Safari'de bazÄ± gÃ¼venlik kÄ±sÄ±tlamalarÄ± olabilir.
                        Chrome veya Firefox kullanÄ±n.
                      </p>
                    </div>
                    <div>
                      <h5 className="font-medium text-red-600 mb-1">3. Ä°zin Ã–nbelleÄŸi</h5>
                      <p className="text-sm text-gray-600">
                        Daha Ã¶nce izin reddedilmiÅŸse tarayÄ±cÄ± tekrar sormaz.
                        Ayarlardan izni sÄ±fÄ±rlayÄ±n.
                      </p>
                    </div>
                  </div>
                </details>

                <button
                  onClick={resetPermissions}
                  className="w-full bg-gray-800 hover:bg-gray-900 text-white py-3 rounded-lg"
                >
                  Ä°zin Durumunu SÄ±fÄ±rla (SayfayÄ± Yenileyin)
                </button>
              </div>
            </div>

            {/* VERCEL LINK */}
            <div className="text-center">
              <a
                href="https://spotitforme.vercel.app/test-geolocation"
                target="_blank"
                className="inline-block bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg"
              >
                ğŸ”— Vercel'de Test Et
              </a>
              <p className="text-sm text-gray-600 mt-2">
                Telefonunuzdan bu linki aÃ§Ä±n ve test edin
              </p>
            </div>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/test-panel/page.tsx
ğŸ“Š 870 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/test-panel/page.tsx
'use client'

import { useState, useEffect } from 'react'
import Header from '@/components/Header'
import Footer from '@/components/Footer'
import { supabase } from '@/lib/supabase'
import {
  sendWelcomeEmail,
  sendBusinessRegistrationEmail,
  sendSpotCreatedEmail,
  sendSightingNotificationEmail,
  sendPasswordResetEmail
} from '@/lib/email-server'

type TestStatus = 'pending' | 'running' | 'success' | 'error' | 'skipped'

interface TestCase {
  id: string
  name: string
  description: string
  status: TestStatus
  result?: string
  error?: string
  duration?: number
}

export default function TestPanelPage() {
  const [user, setUser] = useState<any>(null)
  const [testUser, setTestUser] = useState<any>(null)
  const [loading, setLoading] = useState(false)
  const [logs, setLogs] = useState<string[]>([])
  const [testCases, setTestCases] = useState<TestCase[]>([
    {
      id: 'auth',
      name: 'ğŸ” Authentication Test',
      description: 'KullanÄ±cÄ± giriÅŸ/kayÄ±t testi',
      status: 'pending'
    },
    {
      id: 'welcome-email',
      name: 'ğŸ“§ HoÅŸgeldin Email Testi',
      description: 'Yeni kullanÄ±cÄ± kayÄ±t emaili',
      status: 'pending'
    },
    {
      id: 'business-email',
      name: 'ğŸª MaÄŸaza KayÄ±t Email Testi',
      description: 'MaÄŸaza kayÄ±t emaili',
      status: 'pending'
    },
    {
      id: 'spot-email',
      name: 'ğŸ“ Spot OluÅŸturma Email Testi',
      description: 'Spot oluÅŸturma bildirimi',
      status: 'pending'
    },
    {
      id: 'sighting-email',
      name: 'ğŸ‘ï¸ YardÄ±m Bildirimi Email Testi',
      description: 'Ben gÃ¶rdÃ¼m bildirimi',
      status: 'pending'
    },
    {
      id: 'password-reset-email',
      name: 'ğŸ”‘ Åifre SÄ±fÄ±rlama Email Testi',
      description: 'Åifre sÄ±fÄ±rlama emaili',
      status: 'pending'
    },
    {
      id: 'database',
      name: 'ğŸ—„ï¸ Database Connection Test',
      description: 'Supabase baÄŸlantÄ± testi',
      status: 'pending'
    },
    {
      id: 'storage',
      name: 'ğŸ“¦ Storage Test',
      description: 'Resim yÃ¼kleme testi',
      status: 'pending'
    },
    {
      id: 'api',
      name: 'ğŸŒ API Routes Test',
      description: 'Next.js API routes testi',
      status: 'pending'
    },
    {
      id: 'env',
      name: 'âš™ï¸ Environment Variables Test',
      description: 'Ã‡evre deÄŸiÅŸkenleri kontrolÃ¼',
      status: 'pending'
    }
  ])

  useEffect(() => {
    checkCurrentUser()
    checkEnvironment()
  }, [])

  const checkCurrentUser = async () => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      setUser(user)
      addLog(`KullanÄ±cÄ± durumu: ${user ? 'GiriÅŸ yapÄ±ldÄ±' : 'GiriÅŸ yapÄ±lmadÄ±'}`)
    } catch (error) {
      addLog(`âŒ KullanÄ±cÄ± kontrolÃ¼ hatasÄ±: ${error}`)
    }
  }

  const checkEnvironment = () => {
    const envVars = {
      'NEXT_PUBLIC_SUPABASE_URL': process.env.NEXT_PUBLIC_SUPABASE_URL,
      'NEXT_PUBLIC_SUPABASE_ANON_KEY': process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,
      'GMAIL_USER': process.env.GMAIL_USER ? 'âœ“ Set' : 'âœ— Missing',
      'NEXT_PUBLIC_SITE_URL': process.env.NEXT_PUBLIC_SITE_URL,
      'ADMIN_EMAIL': process.env.ADMIN_EMAIL
    }

    addLog('ğŸ” Environment Variables:')
    Object.entries(envVars).forEach(([key, value]) => {
      const status = value && !value.includes('Missing') ? 'âœ“' : 'âŒ'
      addLog(`  ${status} ${key}: ${value || 'Not set'}`)
    })
  }

  const addLog = (message: string) => {
    const timestamp = new Date().toLocaleTimeString('tr-TR', {
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      fractionalSecondDigits: 3
    })
    setLogs(prev => [`[${timestamp}] ${message}`, ...prev.slice(0, 100)])
  }

  const updateTestCase = (id: string, updates: Partial<TestCase>) => {
    setTestCases(prev => prev.map(test => 
      test.id === id ? { ...test, ...updates } : test
    ))
  }

  const runAllTests = async () => {
    setLoading(true)
    setLogs([])
    addLog('ğŸš€ TÃ¼m testler baÅŸlatÄ±lÄ±yor...')
    
    // TÃ¼m test caselerini resetle
    setTestCases(prev => prev.map(test => ({ ...test, status: 'pending' })))
    
    // Testleri sÄ±rayla Ã§alÄ±ÅŸtÄ±r
    await runSingleTest('env')
    await runSingleTest('database')
    await runSingleTest('auth')
    await runSingleTest('welcome-email')
    await runSingleTest('business-email')
    await runSingleTest('spot-email')
    await runSingleTest('sighting-email')
    await runSingleTest('password-reset-email')
    await runSingleTest('storage')
    await runSingleTest('api')
    
    setLoading(false)
    addLog('âœ… TÃ¼m testler tamamlandÄ±!')
  }

  const runSingleTest = async (testId: string) => {
    const testCase = testCases.find(t => t.id === testId)
    if (!testCase) return

    updateTestCase(testId, { status: 'running', result: undefined, error: undefined })
    addLog(`â–¶ï¸ Test baÅŸlatÄ±lÄ±yor: ${testCase.name}`)
    
    const startTime = Date.now()

    try {
      switch (testId) {
        case 'env':
          await testEnvironment()
          break
        case 'database':
          await testDatabase()
          break
        case 'auth':
          await testAuthentication()
          break
        case 'welcome-email':
          await testWelcomeEmail()
          break
        case 'business-email':
          await testBusinessEmail()
          break
        case 'spot-email':
          await testSpotEmail()
          break
        case 'sighting-email':
          await testSightingEmail()
          break
        case 'password-reset-email':
          await testPasswordResetEmail()
          break
        case 'storage':
          await testStorage()
          break
        case 'api':
          await testApiRoutes()
          break
      }
      
      const duration = Date.now() - startTime
      updateTestCase(testId, { 
        status: 'success', 
        result: `BaÅŸarÄ±lÄ± (${duration}ms)`,
        duration 
      })
      addLog(`âœ… Test baÅŸarÄ±lÄ±: ${testCase.name} (${duration}ms)`)
      
    } catch (error: any) {
      const duration = Date.now() - startTime
      const errorMessage = error.message || error.toString()
      updateTestCase(testId, { 
        status: 'error', 
        error: errorMessage,
        duration 
      })
      addLog(`âŒ Test hatasÄ±: ${testCase.name} - ${errorMessage}`)
    }
  }

  // ğŸ§ª TEST FONKSÄ°YONLARI
  const testEnvironment = async () => {
    const requiredVars = [
      'NEXT_PUBLIC_SUPABASE_URL',
      'NEXT_PUBLIC_SUPABASE_ANON_KEY',
      'GMAIL_USER',
      'GMAIL_APP_PASS',
      'NEXT_PUBLIC_SITE_URL'
    ]

    const missing = requiredVars.filter(varName => !process.env[varName])
    if (missing.length > 0) {
      throw new Error(`Eksik environment variables: ${missing.join(', ')}`)
    }

    addLog('âœ… TÃ¼m environment variables mevcut')
  }

  const testDatabase = async () => {
    // 1. Connection test
    const { data: tables, error } = await supabase
      .from('spots')
      .select('count', { count: 'exact', head: true })
      .limit(1)

    if (error) throw new Error(`Database connection failed: ${error.message}`)

    // 2. Check required tables
    const requiredTables = ['spots', 'sightings', 'shops', 'user_profiles']
    for (const table of requiredTables) {
      try {
        const { error: tableError } = await supabase
          .from(table)
          .select('*')
          .limit(1)
        
        if (tableError && !tableError.message.includes('does not exist')) {
          addLog(`âš ï¸ Tablo eriÅŸim hatasÄ± (${table}): ${tableError.message}`)
        } else if (tableError) {
          addLog(`âš ï¸ Tablo bulunamadÄ±: ${table}`)
        } else {
          addLog(`âœ… Tablo eriÅŸilebilir: ${table}`)
        }
      } catch (e) {
        addLog(`âš ï¸ Tablo kontrol hatasÄ± (${table}): ${e}`)
      }
    }

    addLog('âœ… Database baÄŸlantÄ±sÄ± baÅŸarÄ±lÄ±')
  }

  const testAuthentication = async () => {
    // Test kullanÄ±cÄ±sÄ± oluÅŸtur veya giriÅŸ yap
    const testEmail = `test_${Date.now()}@spotitforme.test`
    const testPassword = 'Test123!@#'
    
    addLog(`ğŸ” Test kullanÄ±cÄ±sÄ± oluÅŸturuluyor: ${testEmail}`)

    // 1. KayÄ±t ol
    const { data: signUpData, error: signUpError } = await supabase.auth.signUp({
      email: testEmail,
      password: testPassword,
      options: {
        data: {
          name: 'Test KullanÄ±cÄ±',
          is_test_user: true
        }
      }
    })

    if (signUpError) {
      // KullanÄ±cÄ± zaten varsa giriÅŸ yap
      const { data: signInData, error: signInError } = await supabase.auth.signInWithPassword({
        email: testEmail,
        password: testPassword
      })

      if (signInError) throw new Error(`GiriÅŸ hatasÄ±: ${signInError.message}`)
      
      setTestUser(signInData.user)
      addLog('âœ… Mevcut test kullanÄ±cÄ±sÄ± ile giriÅŸ yapÄ±ldÄ±')
    } else {
      setTestUser(signUpData.user)
      addLog('âœ… Yeni test kullanÄ±cÄ±sÄ± oluÅŸturuldu')
    }

    // 2. Session kontrolÃ¼
    const { data: { session } } = await supabase.auth.getSession()
    if (!session) throw new Error('Session oluÅŸturulamadÄ±')

    addLog('âœ… Authentication testi baÅŸarÄ±lÄ±')
  }

  const testWelcomeEmail = async () => {
    if (!testUser) throw new Error('Test kullanÄ±cÄ±sÄ± bulunamadÄ±')
    
    const result = await sendWelcomeEmail(testUser.email, 'Test KullanÄ±cÄ±')
    
    if (!result.success) {
      throw new Error(`Email gÃ¶nderilemedi: ${result.message}`)
    }
    
    addLog(`âœ… HoÅŸgeldin emaili gÃ¶nderildi: ${testUser.email}`)
  }

  const testBusinessEmail = async () => {
    if (!testUser) throw new Error('Test kullanÄ±cÄ±sÄ± bulunamadÄ±')
    
    const result = await sendBusinessRegistrationEmail(
      testUser.email,
      'Test MaÄŸaza',
      testUser.id
    )
    
    if (!result.success) {
      throw new Error(`Email gÃ¶nderilemedi: ${result.message}`)
    }
    
    addLog(`âœ… MaÄŸaza kayÄ±t emaili gÃ¶nderildi: ${testUser.email}`)
  }

  const testSpotEmail = async () => {
    if (!testUser) throw new Error('Test kullanÄ±cÄ±sÄ± bulunamadÄ±')
    
    const result = await sendSpotCreatedEmail(
      testUser.email,
      'Test Spot BaÅŸlÄ±ÄŸÄ±',
      'test-spot-id'
    )
    
    if (!result.success) {
      throw new Error(`Email gÃ¶nderilemedi: ${result.message}`)
    }
    
    addLog(`âœ… Spot oluÅŸturma emaili gÃ¶nderildi: ${testUser.email}`)
  }

  const testSightingEmail = async () => {
    if (!testUser) throw new Error('Test kullanÄ±cÄ±sÄ± bulunamadÄ±')
    
    const result = await sendSightingNotificationEmail(
      testUser.email,
      'Test Spot BaÅŸlÄ±ÄŸÄ±',
      'Test YardÄ±m Eden',
      'test-spot-id'
    )
    
    if (!result.success) {
      throw new Error(`Email gÃ¶nderilemedi: ${result.message}`)
    }
    
    addLog(`âœ… YardÄ±m bildirimi emaili gÃ¶nderildi: ${testUser.email}`)
  }

  const testPasswordResetEmail = async () => {
    if (!testUser) throw new Error('Test kullanÄ±cÄ±sÄ± bulunamadÄ±')
    
    const result = await sendPasswordResetEmail(
      testUser.email,
      'https://spotitforme.vercel.app/reset-password?token=test-token'
    )
    
    if (!result.success) {
      throw new Error(`Email gÃ¶nderilemedi: ${result.message}`)
    }
    
    addLog(`âœ… Åifre sÄ±fÄ±rlama emaili gÃ¶nderildi: ${testUser.email}`)
  }

  const testStorage = async () => {
    // 1. Bucket kontrolÃ¼
    const { data: buckets, error: bucketsError } = await supabase.storage.listBuckets()
    
    if (bucketsError) throw new Error(`Storage bucket listesi alÄ±namadÄ±: ${bucketsError.message}`)
    
    const spotImagesBucket = buckets.find(b => b.name === 'spot-images')
    if (!spotImagesBucket) {
      addLog('âš ï¸ spot-images bucket bulunamadÄ±')
    } else {
      addLog('âœ… spot-images bucket mevcut')
    }

    // 2. Test dosyasÄ± yÃ¼kleme
    const testFile = new File(['test-content'], 'test.txt', { type: 'text/plain' })
    const testFileName = `test-files/test-${Date.now()}.txt`

    try {
      const { error: uploadError } = await supabase.storage
        .from('spot-images')
        .upload(testFileName, testFile)

      if (uploadError) {
        addLog(`âš ï¸ Test dosyasÄ± yÃ¼klenemedi: ${uploadError.message}`)
      } else {
        addLog('âœ… Test dosyasÄ± baÅŸarÄ±yla yÃ¼klendi')
        
        // 3. Silme testi
        const { error: deleteError } = await supabase.storage
          .from('spot-images')
          .remove([testFileName])
        
        if (deleteError) {
          addLog(`âš ï¸ Test dosyasÄ± silinemedi: ${deleteError.message}`)
        } else {
          addLog('âœ… Test dosyasÄ± baÅŸarÄ±yla silindi')
        }
      }
    } catch (uploadError) {
      addLog(`âš ï¸ Storage testi atlandÄ±: ${uploadError}`)
    }
  }

  const testApiRoutes = async () => {
    // API route'larÄ±nÄ± test et
    const apiEndpoints = [
      '/api/health',
      // DiÄŸer API endpoint'lerinizi buraya ekleyin
    ]

    for (const endpoint of apiEndpoints) {
      try {
        const response = await fetch(endpoint)
        const data = await response.json()
        
        if (response.ok) {
          addLog(`âœ… API ${endpoint}: ${response.status}`)
        } else {
          addLog(`âš ï¸ API ${endpoint}: ${response.status} - ${JSON.stringify(data)}`)
        }
      } catch (error) {
        addLog(`âŒ API ${endpoint}: ${error}`)
      }
    }
  }

  const createTestSpot = async () => {
    if (!testUser) {
      addLog('âŒ Ã–nce test kullanÄ±cÄ±sÄ± oluÅŸturun')
      return
    }

    try {
      const { data, error } = await supabase
        .from('spots')
        .insert({
          user_id: testUser.id,
          title: 'Test Spot - ' + new Date().toLocaleString(),
          description: 'Bu bir test spotudur. Test amacÄ±yla oluÅŸturulmuÅŸtur.',
          category: 'Test',
          location: 'Test Åehir',
          status: 'active',
          views: 0,
          helps: 0
        })
        .select()
        .single()

      if (error) throw error

      addLog(`âœ… Test spot oluÅŸturuldu: ${data.id}`)
      return data
    } catch (error) {
      addLog(`âŒ Test spot oluÅŸturulamadÄ±: ${error}`)
    }
  }

  const cleanUpTestData = async () => {
    setLogs([])
    addLog('ğŸ§¹ Test verileri temizleniyor...')

    if (testUser) {
      try {
        // Test kullanÄ±cÄ±sÄ±nÄ±n spot'larÄ±nÄ± sil
        const { error: spotsError } = await supabase
          .from('spots')
          .delete()
          .eq('user_id', testUser.id)

        if (spotsError) {
          addLog(`âš ï¸ Test spotlarÄ± silinemedi: ${spotsError.message}`)
        } else {
          addLog('âœ… Test spotlarÄ± temizlendi')
        }

        // Test kullanÄ±cÄ±sÄ±nÄ± sil (opsiyonel - dikkatli kullanÄ±n)
        // await supabase.auth.admin.deleteUser(testUser.id)
        // addLog('âœ… Test kullanÄ±cÄ±sÄ± silindi')

        setTestUser(null)
      } catch (error) {
        addLog(`âš ï¸ Temizleme hatasÄ±: ${error}`)
      }
    }

    // Test storage dosyalarÄ±nÄ± temizle
    try {
      const { data: files, error: listError } = await supabase.storage
        .from('spot-images')
        .list('test-files')

      if (!listError && files) {
        const filePaths = files.map(file => `test-files/${file.name}`)
        if (filePaths.length > 0) {
          const { error: deleteError } = await supabase.storage
            .from('spot-images')
            .remove(filePaths)
          
          if (!deleteError) {
            addLog(`âœ… ${filePaths.length} test dosyasÄ± silindi`)
          }
        }
      }
    } catch (error) {
      addLog(`âš ï¸ Storage temizleme hatasÄ±: ${error}`)
    }

    addLog('âœ… Temizleme iÅŸlemi tamamlandÄ±')
  }

  const exportLogs = () => {
    const logText = logs.join('\n')
    const blob = new Blob([logText], { type: 'text/plain' })
    const url = URL.createObjectURL(blob)
    const a = document.createElement('a')
    a.href = url
    a.download = `spotitforme-test-logs-${new Date().toISOString()}.txt`
    document.body.appendChild(a)
    a.click()
    document.body.removeChild(a)
    URL.revokeObjectURL(url)
  }

  const getStatusColor = (status: TestStatus) => {
    switch (status) {
      case 'success': return 'bg-green-100 text-green-800 border-green-200'
      case 'error': return 'bg-red-100 text-red-800 border-red-200'
      case 'running': return 'bg-blue-100 text-blue-800 border-blue-200'
      case 'skipped': return 'bg-gray-100 text-gray-800 border-gray-200'
      default: return 'bg-gray-50 text-gray-600 border-gray-200'
    }
  }

  const getStatusIcon = (status: TestStatus) => {
    switch (status) {
      case 'success': return 'âœ…'
      case 'error': return 'âŒ'
      case 'running': return 'ğŸ”„'
      case 'skipped': return 'â­ï¸'
      default: return 'â³'
    }
  }

  const successCount = testCases.filter(t => t.status === 'success').length
  const errorCount = testCases.filter(t => t.status === 'error').length
  const totalCount = testCases.length

  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      
      <main className="container-custom py-8">
        {/* BaÅŸlÄ±k */}
        <div className="mb-8">
          <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            ğŸ§ª SpotItForMe Test Paneli
          </h1>
          <p className="text-gray-600">
            TÃ¼m sistem bileÅŸenlerini test edin ve hatalarÄ± tespit edin
          </p>
        </div>

        {/* Ä°statistik KartlarÄ± */}
        <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
          <div className="bg-white rounded-xl p-6 shadow text-center">
            <div className="text-2xl font-bold text-blue-600 mb-1">{totalCount}</div>
            <div className="text-sm text-gray-600">Toplam Test</div>
          </div>
          
          <div className="bg-white rounded-xl p-6 shadow text-center">
            <div className="text-2xl font-bold text-green-600 mb-1">{successCount}</div>
            <div className="text-sm text-gray-600">BaÅŸarÄ±lÄ±</div>
          </div>
          
          <div className="bg-white rounded-xl p-6 shadow text-center">
            <div className="text-2xl font-bold text-red-600 mb-1">{errorCount}</div>
            <div className="text-sm text-gray-600">HatalÄ±</div>
          </div>
          
          <div className="bg-white rounded-xl p-6 shadow text-center">
            <div className="text-2xl font-bold text-gray-600 mb-1">
              {successCount}/{totalCount}
            </div>
            <div className="text-sm text-gray-600">BaÅŸarÄ± OranÄ±</div>
          </div>
        </div>

        {/* Kontrol ButonlarÄ± */}
        <div className="bg-white rounded-2xl shadow-lg p-6 mb-8">
          <div className="flex flex-wrap gap-4">
            <button
              onClick={runAllTests}
              disabled={loading}
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg disabled:opacity-50 flex items-center"
            >
              {loading ? (
                <>
                  <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  Testler Ã‡alÄ±ÅŸÄ±yor...
                </>
              ) : (
                'ğŸš€ TÃ¼m Testleri Ã‡alÄ±ÅŸtÄ±r'
              )}
            </button>

            <button
              onClick={createTestSpot}
              disabled={loading || !testUser}
              className="bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-6 rounded-lg disabled:opacity-50"
            >
              ğŸ“ Test Spot OluÅŸtur
            </button>

            <button
              onClick={cleanUpTestData}
              className="bg-red-600 hover:bg-red-700 text-white font-medium py-3 px-6 rounded-lg"
            >
              ğŸ§¹ Test Verilerini Temizle
            </button>

            <button
              onClick={exportLogs}
              className="bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-6 rounded-lg"
            >
              ğŸ“¥ LoglarÄ± Ä°ndir
            </button>

            <button
              onClick={() => setLogs([])}
              className="bg-gray-600 hover:bg-gray-700 text-white font-medium py-3 px-6 rounded-lg"
            >
              ğŸ—‘ï¸ LoglarÄ± Temizle
            </button>
          </div>

          {/* KullanÄ±cÄ± Bilgisi */}
          <div className="mt-6 p-4 bg-gray-50 rounded-lg">
            <div className="flex items-center justify-between">
              <div>
                <p className="font-medium text-gray-900">
                  {testUser ? 'ğŸŸ¢ Test KullanÄ±cÄ±sÄ± Aktif' : 'âšª Test KullanÄ±cÄ±sÄ± Yok'}
                </p>
                <p className="text-sm text-gray-600">
                  {testUser ? testUser.email : 'Test iÃ§in bir kullanÄ±cÄ± oluÅŸturun'}
                </p>
              </div>
              <div>
                <p className="text-sm text-gray-600">
                  Mevcut KullanÄ±cÄ±: {user ? user.email : 'GiriÅŸ yapÄ±lmadÄ±'}
                </p>
              </div>
            </div>
          </div>
        </div>

        <div className="grid lg:grid-cols-2 gap-8">
          {/* Test Caseleri */}
          <div>
            <h2 className="text-xl font-bold text-gray-900 mb-4">ğŸ§ª Test Caseleri</h2>
            
            <div className="space-y-4">
              {testCases.map(test => (
                <div 
                  key={test.id}
                  className={`border-2 rounded-xl p-4 transition-all duration-300 ${getStatusColor(test.status)}`}
                >
                  <div className="flex items-center justify-between mb-2">
                    <div className="flex items-center">
                      <span className="text-xl mr-3">{getStatusIcon(test.status)}</span>
                      <h3 className="font-bold">{test.name}</h3>
                    </div>
                    <button
                      onClick={() => runSingleTest(test.id)}
                      disabled={loading}
                      className="text-sm bg-white hover:bg-gray-100 text-gray-800 px-3 py-1 rounded-lg disabled:opacity-50"
                    >
                      Ã‡alÄ±ÅŸtÄ±r
                    </button>
                  </div>
                  
                  <p className="text-sm mb-2">{test.description}</p>
                  
                  <div className="flex justify-between items-center text-sm">
                    <div>
                      {test.status === 'running' && (
                        <span className="flex items-center">
                          <svg className="animate-spin h-4 w-4 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                          </svg>
                          Ã‡alÄ±ÅŸÄ±yor...
                        </span>
                      )}
                      {test.result && (
                        <span className="text-green-700">âœ… {test.result}</span>
                      )}
                      {test.error && (
                        <span className="text-red-700">âŒ {test.error}</span>
                      )}
                    </div>
                    
                    {test.duration && (
                      <span className="text-gray-500">{test.duration}ms</span>
                    )}
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Loglar */}
          <div>
            <div className="flex justify-between items-center mb-4">
              <h2 className="text-xl font-bold text-gray-900">ğŸ“‹ Sistem LoglarÄ±</h2>
              <span className="text-sm text-gray-500">
                {logs.length} log kaydÄ±
              </span>
            </div>
            
            <div className="bg-gray-900 text-gray-100 rounded-xl p-4 h-[600px] overflow-y-auto font-mono text-sm">
              {logs.length === 0 ? (
                <div className="text-center text-gray-500 py-8">
                  Log kaydÄ± bulunmuyor. Testleri Ã§alÄ±ÅŸtÄ±rmak iÃ§in yukarÄ±daki butonlarÄ± kullanÄ±n.
                </div>
              ) : (
                logs.map((log, index) => {
                  const isError = log.includes('âŒ') || log.includes('âš ï¸') || log.includes('Hata:')
                  const isSuccess = log.includes('âœ…')
                  const isInfo = log.includes('ğŸ”') || log.includes('â–¶ï¸') || log.includes('ğŸš€')
                  
                  let colorClass = 'text-gray-300'
                  if (isError) colorClass = 'text-red-400'
                  if (isSuccess) colorClass = 'text-green-400'
                  if (isInfo) colorClass = 'text-blue-400'
                  
                  return (
                    <div key={index} className={`py-1 border-b border-gray-800 last:border-0 ${colorClass}`}>
                      {log}
                    </div>
                  )
                })
              )}
            </div>

            {/* HÄ±zlÄ± Testler */}
            <div className="mt-8">
              <h3 className="text-lg font-bold text-gray-900 mb-3">âš¡ HÄ±zlÄ± Testler</h3>
              
              <div className="grid grid-cols-2 gap-3">
                {[
                  { id: 'email', name: 'ğŸ“§ Email Testi', test: () => runSingleTest('welcome-email') },
                  { id: 'auth', name: 'ğŸ” Auth Testi', test: () => runSingleTest('auth') },
                  { id: 'db', name: 'ğŸ—„ï¸ DB Testi', test: () => runSingleTest('database') },
                  { id: 'storage', name: 'ğŸ“¦ Storage Testi', test: () => runSingleTest('storage') },
                ].map(quickTest => (
                  <button
                    key={quickTest.id}
                    onClick={quickTest.test}
                    disabled={loading}
                    className="bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 px-4 rounded-lg disabled:opacity-50"
                  >
                    {quickTest.name}
                  </button>
                ))}
              </div>
            </div>

            {/* Sistem Bilgisi */}
            <div className="mt-8 bg-white rounded-xl p-6 shadow">
              <h3 className="text-lg font-bold text-gray-900 mb-3">â„¹ï¸ Sistem Bilgisi</h3>
              
              <div className="space-y-3 text-sm">
                <div className="flex justify-between">
                  <span className="text-gray-600">Node.js Version:</span>
                  <span className="font-mono">{process.version}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Next.js Version:</span>
                  <span className="font-mono">14.0.4</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Supabase Client:</span>
                  <span className="font-mono">âœ“ BaÄŸlÄ±</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Environment:</span>
                  <span className="font-mono">{process.env.NODE_ENV}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Site URL:</span>
                  <span className="font-mono truncate">{process.env.NEXT_PUBLIC_SITE_URL}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* Debug Bilgileri */}
        <div className="mt-8 bg-yellow-50 border border-yellow-200 rounded-xl p-6">
          <h3 className="text-lg font-bold text-yellow-900 mb-3">ğŸ› Debug Bilgileri</h3>
          
          <div className="grid md:grid-cols-2 gap-6">
            <div>
              <h4 className="font-medium text-yellow-800 mb-2">YaygÄ±n Hatalar ve Ã‡Ã¶zÃ¼mler:</h4>
              <ul className="text-sm text-yellow-700 space-y-2">
                <li>â€¢ <strong>Email gÃ¶nderilemiyor:</strong> Gmail App Password kontrol edin</li>
                <li>â€¢ <strong>Database baÄŸlantÄ± hatasÄ±:</strong> Supabase URL ve Key kontrolÃ¼</li>
                <li>â€¢ <strong>Storage hatasÄ±:</strong> Bucket permissions kontrol edin</li>
                <li>â€¢ <strong>Auth hatasÄ±:</strong> RLS politikalarÄ±nÄ± kontrol edin</li>
              </ul>
            </div>
            
            <div>
              <h4 className="font-medium text-yellow-800 mb-2">Test SonrasÄ± Ä°ÅŸlemler:</h4>
              <ul className="text-sm text-yellow-700 space-y-2">
                <li>â€¢ Test verilerini dÃ¼zenli olarak temizleyin</li>
                <li>â€¢ LoglarÄ± indirerek arÅŸivleyin</li>
                <li>â€¢ HatalarÄ± dÃ¼zeltip testleri tekrar Ã§alÄ±ÅŸtÄ±rÄ±n</li>
                <li>â€¢ Production'a geÃ§meden tÃ¼m testlerin baÅŸarÄ±lÄ± olduÄŸundan emin olun</li>
              </ul>
            </div>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  )
}

ğŸ“„ app/test/page.tsx
ğŸ“Š 74 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// Basit bir test komponenti oluÅŸtur
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'

export default function StorageTest() {
  const [result, setResult] = useState<any>(null)
  const [loading, setLoading] = useState(false)

  const testStorage = async () => {
    setLoading(true)
    try {
      // 1. Bucket listesi
      const { data: buckets, error: bucketsError } = await supabase.storage.listBuckets()
      console.log('ğŸ“¦ Buckets:', buckets)
      
      // 2. spot-images bucket detayÄ±
      const spotImagesBucket = buckets?.find(b => b.id === 'spot-images')
      console.log('ğŸ¯ spot-images bucket:', spotImagesBucket)
      
      // 3. Bucket'a dosya yÃ¼kleme testi (kÃ¼Ã§Ã¼k bir test dosyasÄ±)
      const testFile = new File(['test'], 'test.txt', { type: 'text/plain' })
      
      const { data: uploadData, error: uploadError } = await supabase.storage
        .from('spot-images')
        .upload(`test-${Date.now()}.txt`, testFile)
      
      console.log('ğŸ“¤ Upload sonucu:', { uploadData, uploadError })
      
      // 4. YÃ¼klenen dosyayÄ± sil
      if (uploadData) {
        await supabase.storage
          .from('spot-images')
          .remove([uploadData.path])
      }
      
      setResult({
        buckets,
        spotImagesBucket,
        uploadResult: uploadError ? { error: uploadError.message } : { success: true, path: uploadData?.path },
        timestamp: new Date().toISOString()
      })
      
    } catch (error: any) {
      console.error('âŒ Storage test hatasÄ±:', error)
      setResult({ error: error.message })
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="p-8">
      <h1 className="text-2xl font-bold mb-4">ğŸ› ï¸ Storage Test</h1>
      <button
        onClick={testStorage}
        disabled={loading}
        className="bg-blue-600 text-white px-6 py-3 rounded-lg disabled:opacity-50"
      >
        {loading ? 'Testing...' : 'Storage Test Ã‡alÄ±ÅŸtÄ±r'}
      </button>
      
      {result && (
        <div className="mt-6 p-4 bg-gray-100 rounded-lg">
          <h3 className="font-bold mb-2">SonuÃ§lar:</h3>
          <pre className="text-sm overflow-auto">
            {JSON.stringify(result, null, 2)}
          </pre>
        </div>
      )}
    </div>
  )
}

====================================================================================================
ğŸ—ï¸  APP LAYOUT'LARI
====================================================================================================

ğŸ“„ app/admin/layout.tsx
ğŸ“Š 163 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/admin/layout.tsx - YENÄ° VERSÄ°YON (RLS OLMADAN)
'use client'

import { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import AdminSidebar from '@/components/admin/AdminSidebar'
import AdminHeader from '@/components/admin/AdminHeader'

export default function AdminLayout({
  children,
}: {
  children: React.ReactNode
}) {
  const router = useRouter()
  const [isAdmin, setIsAdmin] = useState(false)
  const [loading, setLoading] = useState(true)
  const [debugInfo, setDebugInfo] = useState('')

  useEffect(() => {
    checkAdmin()
  }, [])

  const checkAdmin = async () => {
    try {
      setDebugInfo('Admin kontrolÃ¼ baÅŸlÄ±yor...')
      
      // 1. KullanÄ±cÄ± kontrolÃ¼
      const { data: { user }, error: authError } = await supabase.auth.getUser()
      
      if (authError || !user) {
        setDebugInfo('KullanÄ±cÄ± giriÅŸ yapmamÄ±ÅŸ')
        router.push('/login?redirect=/admin')
        return
      }

      setDebugInfo(`KullanÄ±cÄ±: ${user.email}`)

      // 2. DOÄRUDAN user_profiles TABLOSUNDAN KONTROL (RLS YOK)
      // Bu artÄ±k Ã§alÄ±ÅŸacak Ã§Ã¼nkÃ¼ RLS kapalÄ±
      const { data: profile, error: profileError } = await supabase
        .from('user_profiles')
        .select('is_admin')
        .eq('id', user.id)
        .single()

      console.log('ğŸ” Profile sorgusu sonucu:', { profile, profileError })

      // 3. HATA DURUMUNDA EMAÄ°L BAZLI KONTROL
      let isUserAdmin = false
      
      if (profileError || !profile) {
        console.log('Profile sorgusu hatasÄ±, email bazlÄ± kontrol yapÄ±lÄ±yor...')
        // Email bazlÄ± fallback
        const adminEmails = [
          'prolinemama@gmail.com',
          'mehmet@spotitforme.com', 
          'saniy@spotitforme.com',
          'senasilmailin@gmail.com'  // KENDÄ° EMAÄ°L'Ä°NÄ° YAZ
        ]
        isUserAdmin = adminEmails.includes(user.email?.toLowerCase() || '')
      } else {
        isUserAdmin = profile.is_admin === true
      }

      setDebugInfo(`Admin durumu: ${isUserAdmin}`)
      console.log('âœ… Final admin kontrolÃ¼:', {
        email: user.email,
        isAdminFromDB: profile?.is_admin,
        finalIsAdmin: isUserAdmin
      })

      if (!isUserAdmin) {
        setDebugInfo('Admin deÄŸil, yÃ¶nlendiriliyor...')
        // Development'da bile admin panelini gÃ¶ster
        if (process.env.NODE_ENV === 'development') {
          console.log('ğŸ› ï¸ Development modu: Admin panele izin veriliyor')
          setIsAdmin(true)
        } else {
          router.push('/')
        }
        return
      }

      setIsAdmin(true)
      
    } catch (error: any) {
      console.error('âŒ Admin kontrol hatasÄ±:', error)
      setDebugInfo(`Hata: ${error.message}`)
      
      // Development'da hata olsa bile devam et
      if (process.env.NODE_ENV === 'development') {
        console.log('âš ï¸ Hata durumunda development modu: Admin panele izin veriliyor')
        setIsAdmin(true)
      }
    } finally {
      setLoading(false)
    }
  }

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">Admin kontrolÃ¼ yapÄ±lÄ±yor...</p>
          <p className="text-sm text-gray-500 mt-2 max-w-md">{debugInfo}</p>
          <button
            onClick={() => setIsAdmin(true)}
            className="mt-4 px-4 py-2 bg-yellow-500 text-white rounded-lg text-sm"
          >
            Devam et (development)
          </button>
        </div>
      </div>
    )
  }

  if (!isAdmin) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-center">
          <div className="text-4xl mb-4">ğŸš«</div>
          <h1 className="text-2xl font-bold text-gray-900 mb-2">EriÅŸim Reddedildi</h1>
          <p className="text-gray-600 mb-4">Bu sayfaya eriÅŸim yetkiniz yok.</p>
          <p className="text-sm text-gray-500 mb-6 max-w-md">{debugInfo}</p>
          <div className="space-x-4">
            <button
              onClick={() => router.push('/')}
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg"
            >
              Ana Sayfaya DÃ¶n
            </button>
            <button
              onClick={() => window.location.reload()}
              className="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-lg"
            >
              Tekrar Dene
            </button>
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <AdminHeader />
      <div className="flex">
        <AdminSidebar />
        <main className="flex-1 p-6 overflow-auto">
          {/* Debug info - sadece development'da */}
          {process.env.NODE_ENV === 'development' && (
            <div className="mb-4 p-3 bg-yellow-50 text-yellow-800 text-sm rounded-lg">
              ğŸ› ï¸ Development Modu: Admin kontrolÃ¼ aktif
            </div>
          )}
          {children}
        </main>
      </div>
    </div>
  )
}

ğŸ“„ app/layout.tsx
ğŸ“Š 69 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/layout.tsx - DÃœZGÃœN KONUMLANDIRMA
import { Inter } from "next/font/google";
import "./globals.css";
import Script from "next/script";
import Header from "@/components/Header";
import Footer from "@/components/Footer";
import ResponsiveAd from "@/components/ResponsiveAd";

const inter = Inter({ subsets: ["latin"] });

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  const adsenseClientId = process.env.NEXT_PUBLIC_ADSENSE_CLIENT_ID;
  
  return (
    <html lang="tr">
      <head>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        {adsenseClientId && (
          <Script
            async
            src={`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${adsenseClientId}`}
            strategy="lazyOnload"
            crossOrigin="anonymous"
          />
        )}
      </head>
      <body className={inter.className}>
        {/* REKLAM CONTAINER - Sabit yÃ¼kseklik */}
        <div className="bg-gray-50">
          <div className="container mx-auto px-2 md:px-4">
            <div className="relative">
              {/* Reklam - Sabit Ã¶lÃ§Ã¼ler */}
              <div className="py-2">
                <ResponsiveAd 
                  placement="banner" 
                  className="h-16 md:h-20" 
                />
              </div>
              
              {/* Header - ReklamÄ±n ALTINDA */}
              <div className="relative z-10">
                <Header />
              </div>
            </div>
          </div>
        </div>
        
        <main className="min-h-screen bg-white">
          <div className="container mx-auto px-2 md:px-4 py-4 md:py-8">
            {children}
          </div>
        </main>
        
        {/* Footer Ã–ncesi Reklam - Sabit alan */}
        <div className="bg-gray-50 border-t border-gray-200">
          <div className="container mx-auto px-2 md:px-4 py-6 md:py-8">
            <ResponsiveAd placement="inline" />
          </div>
        </div>
        
        <Footer />
      </body>
    </html>
  );
}

ğŸ“„ app/test-email/layout.tsx
ğŸ“Š 15 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// app/test-email/layout.tsx
import type { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'Email Test - SpotItForMe',
  description: 'SpotItForMe email sistemini test edin',
}

export default function TestEmailLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return children
}

====================================================================================================
ğŸ§© COMPONENT'LER
====================================================================================================

ğŸ“„ components/admin/AdminHeader.tsx
ğŸ“Š 46 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdminHeader.tsx
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

export default function AdminHeader() {
  const router = useRouter()
  const [user, setUser] = useState<any>(null)

  const handleLogout = async () => {
    await supabase.auth.signOut()
    router.push('/')
  }

  return (
    <header className="bg-white shadow">
      <div className="px-6 py-4 flex justify-between items-center">
        <div className="flex items-center space-x-3">
          <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
            <span className="text-white font-bold text-xl">A</span>
          </div>
          <div>
            <h1 className="text-lg font-bold text-gray-900">Admin Panel</h1>
            <p className="text-sm text-gray-600">spotitforme.com yÃ¶netimi</p>
          </div>
        </div>

        <div className="flex items-center space-x-4">
          <div className="text-right">
            <p className="font-medium text-gray-900">Admin</p>
            <p className="text-sm text-gray-600">YÃ¶netici</p>
          </div>
          
          <button
            onClick={handleLogout}
            className="bg-red-100 hover:bg-red-200 text-red-700 font-medium py-2 px-4 rounded-lg"
          >
            Ã‡Ä±kÄ±ÅŸ
          </button>
        </div>
      </div>
    </header>
  )
}

ğŸ“„ components/admin/AdminSidebar.tsx
ğŸ“Š 59 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdminSidebar.tsx
'use client'

import Link from 'next/link'
import { usePathname } from 'next/navigation'

export default function AdminSidebar() {
  const pathname = usePathname()
  
  const menuItems = [
    { name: 'Dashboard', href: '/admin', icon: 'ğŸ“Š' },
    { name: 'KullanÄ±cÄ±lar', href: '/admin/users', icon: 'ğŸ‘¥' },
    { name: 'Spot\'lar', href: '/admin/spots', icon: 'ğŸ“' },
    { name: 'MaÄŸazalar', href: '/admin/shops', icon: 'ğŸª' },
    { name: 'AdSense', href: '/admin/adsense', icon: 'ğŸ’°' },
    { name: 'Ã–demeler', href: '/admin/payments', icon: 'ğŸ’³' },
    { name: 'Ayarlar', href: '/admin/settings', icon: 'âš™ï¸' },
    { name: 'Loglar', href: '/admin/logs', icon: 'ğŸ“‹' },
  ]

  return (
    <aside className="w-64 bg-gray-900 text-white min-h-screen">
      <div className="p-6">
        <h2 className="text-xl font-bold">Admin Panel</h2>
        <p className="text-gray-400 text-sm mt-1">SpotItForMe YÃ¶netim</p>
      </div>

      <nav className="mt-6">
        {menuItems.map((item) => {
          const isActive = pathname === item.href
          
          return (
            <Link
              key={item.name}
              href={item.href}
              className={`flex items-center space-x-3 px-6 py-3 hover:bg-gray-800 ${
                isActive ? 'bg-blue-600 text-white' : 'text-gray-300'
              }`}
            >
              <span>{item.icon}</span>
              <span>{item.name}</span>
            </Link>
          )
        })}
      </nav>

      {/* Footer */}
      <div className="absolute bottom-0 w-full p-4 border-t border-gray-800">
        <Link
          href="/"
          className="flex items-center space-x-3 text-gray-400 hover:text-white"
        >
          <span>â†</span>
          <span>Siteye DÃ¶n</span>
        </Link>
      </div>
    </aside>
  )
}

ğŸ“„ components/admin/AdPerformance.tsx
ğŸ“Š 167 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdPerformance.tsx
'use client'

import { useState } from 'react'

interface AdPerformanceData {
  name: string
  impressions: number
  clicks: number
  revenue: number
  ctr: number
  rpm: number
}

export default function AdPerformance() {
  const [timeRange, setTimeRange] = useState<'today' | 'week' | 'month'>('week')

  const performanceData: AdPerformanceData[] = [
    {
      name: 'Header Reklam',
      impressions: 3245,
      clicks: 58,
      revenue: 24.50,
      ctr: 1.79,
      rpm: 7.55
    },
    {
      name: 'Sidebar Reklam',
      impressions: 2890,
      clicks: 42,
      revenue: 18.75,
      ctr: 1.45,
      rpm: 6.49
    },
    {
      name: 'In-Article Reklam',
      impressions: 1567,
      clicks: 31,
      revenue: 15.20,
      ctr: 1.98,
      rpm: 9.70
    },
    {
      name: 'Footer Reklam',
      impressions: 4321,
      clicks: 65,
      revenue: 28.90,
      ctr: 1.50,
      rpm: 6.69
    },
    {
      name: 'Mobile Banner',
      impressions: 2789,
      clicks: 49,
      revenue: 21.30,
      ctr: 1.76,
      rpm: 7.64
    }
  ]

  const totals = performanceData.reduce(
    (acc, item) => ({
      impressions: acc.impressions + item.impressions,
      clicks: acc.clicks + item.clicks,
      revenue: acc.revenue + item.revenue
    }),
    { impressions: 0, clicks: 0, revenue: 0 }
  )

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">Reklam PerformansÄ±</h3>
          <p className="text-gray-600">Reklam Ã¼nitelerinin performansÄ±</p>
        </div>
        <div className="flex space-x-2">
          {(['today', 'week', 'month'] as const).map((range) => (
            <button
              key={range}
              onClick={() => setTimeRange(range)}
              className={`px-3 py-1 rounded-lg text-sm font-medium ${
                timeRange === range
                  ? 'bg-blue-600 text-white'
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              {range === 'today' ? 'BugÃ¼n' : range === 'week' ? 'Bu Hafta' : 'Bu Ay'}
            </button>
          ))}
        </div>
      </div>

      {/* Performans Tablosu */}
      <div className="overflow-x-auto">
        <table className="w-full">
          <thead>
            <tr className="bg-gray-50">
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Reklam AdÄ±</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">GÃ¶sterim</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">TÄ±klama</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">CTR</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Gelir</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">RPM</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-200">
            {performanceData.map((item, index) => (
              <tr key={index} className="hover:bg-gray-50">
                <td className="py-3 px-4 font-medium">{item.name}</td>
                <td className="py-3 px-4">{item.impressions.toLocaleString()}</td>
                <td className="py-3 px-4">{item.clicks}</td>
                <td className="py-3 px-4">
                  <span className="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">
                    {item.ctr}%
                  </span>
                </td>
                <td className="py-3 px-4 font-medium">{item.revenue.toFixed(2)} â‚º</td>
                <td className="py-3 px-4">{item.rpm.toFixed(2)} â‚º</td>
              </tr>
            ))}
          </tbody>
          <tfoot className="bg-gray-50 font-bold">
            <tr>
              <td className="py-3 px-4">TOPLAM</td>
              <td className="py-3 px-4">{totals.impressions.toLocaleString()}</td>
              <td className="py-3 px-4">{totals.clicks}</td>
              <td className="py-3 px-4">
                {((totals.clicks / totals.impressions) * 100).toFixed(2)}%
              </td>
              <td className="py-3 px-4">{totals.revenue.toFixed(2)} â‚º</td>
              <td className="py-3 px-4">
                {((totals.revenue / totals.impressions) * 1000).toFixed(2)} â‚º
              </td>
            </tr>
          </tfoot>
        </table>
      </div>

      {/* Ã–zet */}
      <div className="mt-6 grid grid-cols-3 gap-4">
        <div className="text-center p-4 bg-blue-50 rounded-lg">
          <p className="text-sm text-blue-600">Ortalama CTR</p>
          <p className="text-xl font-bold">
            {(
              performanceData.reduce((sum, item) => sum + item.ctr, 0) / performanceData.length
            ).toFixed(2)}%
          </p>
        </div>
        <div className="text-center p-4 bg-green-50 rounded-lg">
          <p className="text-sm text-green-600">Ortalama RPM</p>
          <p className="text-xl font-bold">
            {(
              performanceData.reduce((sum, item) => sum + item.rpm, 0) / performanceData.length
            ).toFixed(2)} â‚º
          </p>
        </div>
        <div className="text-center p-4 bg-purple-50 rounded-lg">
          <p className="text-sm text-purple-600">GÃ¼nlÃ¼k Ortalama</p>
          <p className="text-xl font-bold">
            {(totals.revenue / (timeRange === 'week' ? 7 : timeRange === 'month' ? 30 : 1)).toFixed(2)} â‚º
          </p>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/admin/AdSenseStatus.tsx
ğŸ“Š 179 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdSenseStatus.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

interface AdSenseStatus {
  isActive: boolean
  clientId: string
  revenue: number
  impressions: number
  ctr: number
  lastUpdate: string
}

export default function AdSenseStatus() {
  const [status, setStatus] = useState<AdSenseStatus>({
    isActive: false,
    clientId: '',
    revenue: 0,
    impressions: 0,
    ctr: 0,
    lastUpdate: new Date().toISOString()
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchAdSenseStatus()
  }, [])

  const fetchAdSenseStatus = async () => {
    try {
      // Database'den AdSense durumunu getir
      const { data } = await supabase
        .from('site_settings')
        .select('value')
        .eq('key', 'adsense_config')
        .single()

      if (data) {
        const config = JSON.parse(data.value)
        // Mock data - gerÃ§ek uygulamada Google AdSense API'sÄ±na baÄŸlanacak
        setStatus({
          isActive: config.isActive || false,
          clientId: config.clientId || '',
          revenue: 245.67,
          impressions: 12543,
          ctr: 1.8,
          lastUpdate: new Date().toISOString()
        })
      }
    } catch (error) {
      console.error('AdSense durumu yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const toggleAdSense = async () => {
    try {
      const newStatus = !status.isActive
      
      // Database'de gÃ¼ncelle
      const { data } = await supabase
        .from('site_settings')
        .select('value')
        .eq('key', 'adsense_config')
        .single()

      if (data) {
        const config = JSON.parse(data.value)
        config.isActive = newStatus

        await supabase
          .from('site_settings')
          .update({ value: JSON.stringify(config) })
          .eq('key', 'adsense_config')

        setStatus(prev => ({ ...prev, isActive: newStatus }))
        alert(`AdSense ${newStatus ? 'aktif' : 'devre dÄ±ÅŸÄ±'} edildi`)
      }
    } catch (error) {
      console.error('AdSense durumu gÃ¼ncellenemedi:', error)
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/3 mb-4"></div>
          <div className="space-y-3">
            <div className="h-4 bg-gray-200 rounded w-full"></div>
            <div className="h-4 bg-gray-200 rounded w-3/4"></div>
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">AdSense Durumu</h3>
          <p className="text-gray-600">
            Son gÃ¼ncelleme: {new Date(status.lastUpdate).toLocaleDateString('tr-TR')}
          </p>
        </div>
        
        <button
          onClick={toggleAdSense}
          className={`px-4 py-2 rounded-lg font-medium ${
            status.isActive
              ? 'bg-red-100 hover:bg-red-200 text-red-700'
              : 'bg-green-100 hover:bg-green-200 text-green-700'
          }`}
        >
          {status.isActive ? 'ReklamlarÄ± Durdur' : 'ReklamlarÄ± BaÅŸlat'}
        </button>
      </div>

      {/* Status Cards */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div className="bg-blue-50 p-4 rounded-lg">
          <p className="text-sm text-blue-600">Durum</p>
          <div className="flex items-center mt-2">
            <div className={`w-3 h-3 rounded-full mr-2 ${status.isActive ? 'bg-green-500' : 'bg-red-500'}`} />
            <p className="font-bold">
              {status.isActive ? 'Aktif' : 'Devre DÄ±ÅŸÄ±'}
            </p>
          </div>
        </div>

        <div className="bg-green-50 p-4 rounded-lg">
          <p className="text-sm text-green-600">Toplam Gelir</p>
          <p className="text-2xl font-bold text-gray-900 mt-2">
            {status.revenue.toFixed(2)} â‚º
          </p>
        </div>

        <div className="bg-purple-50 p-4 rounded-lg">
          <p className="text-sm text-purple-600">GÃ¶sterim</p>
          <p className="text-2xl font-bold text-gray-900 mt-2">
            {status.impressions.toLocaleString()}
          </p>
        </div>

        <div className="bg-yellow-50 p-4 rounded-lg">
          <p className="text-sm text-yellow-600">TÄ±klama OranÄ± (CTR)</p>
          <p className="text-2xl font-bold text-gray-900 mt-2">
            {status.ctr}%
          </p>
        </div>
      </div>

      {/* Client ID */}
      {status.clientId && (
        <div className="mt-6 p-4 bg-gray-50 rounded-lg">
          <p className="text-sm font-medium text-gray-700 mb-2">Client ID</p>
          <code className="text-sm bg-white px-3 py-2 rounded border">
            {status.clientId}
          </code>
        </div>
      )}

      {!status.clientId && (
        <div className="mt-6 p-4 bg-yellow-50 rounded-lg">
          <p className="text-yellow-800">
            âš ï¸ AdSense Client ID henÃ¼z ayarlanmamÄ±ÅŸ. 
            <a href="/admin/adsense" className="font-medium underline ml-1">
              Hemen ayarla
            </a>
          </p>
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/admin/AdUnitManager.tsx
ğŸ“Š 351 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdUnitManager.tsx
'use client'

import { useState } from 'react'

// Tip tanÄ±mlarÄ± - export edelim
export interface AdUnit {
  id: string
  name: string
  type: 'display' | 'in-article' | 'in-feed'
  size: string
  position: string
  status: 'active' | 'paused'
  revenue: number
}

export interface AdUnitManagerProps {
  adUnits: AdUnit[]
  onUpdate: (units: AdUnit[]) => void
  clientId: string
}

export default function AdUnitManager({ adUnits, onUpdate, clientId }: AdUnitManagerProps) {
  const [showForm, setShowForm] = useState(false)
  const [newAdUnit, setNewAdUnit] = useState({
    name: '',
    type: 'display' as 'display' | 'in-article' | 'in-feed',
    size: '300x250',
    position: 'sidebar',
    status: 'active' as 'active' | 'paused'
  })

  const sizes = [
    '300x250', '336x280', '728x90', '970x250',
    '300x600', '320x100', '160x600'
  ]

  const positions = [
    'header', 'sidebar', 'footer',
    'content-top', 'content-middle', 'content-bottom',
    'in-article', 'in-feed'
  ]

  const addAdUnit = () => {
    if (!newAdUnit.name.trim()) {
      alert('LÃ¼tfen reklam adÄ± girin')
      return
    }

    const unit: AdUnit = {
      id: `ad-${Date.now()}`,
      name: newAdUnit.name,
      type: newAdUnit.type,
      size: newAdUnit.size,
      position: newAdUnit.position,
      status: newAdUnit.status,
      revenue: 0
    }

    // onUpdate'i Ã§aÄŸÄ±r - TÄ°P GÃœVENLÄ°
    onUpdate([...adUnits, unit])
    
    // Formu sÄ±fÄ±rla
    setNewAdUnit({
      name: '',
      type: 'display',
      size: '300x250',
      position: 'sidebar',
      status: 'active'
    })
    setShowForm(false)
  }

  const toggleAdStatus = (id: string) => {
    // updated deÄŸiÅŸkenine aÃ§Ä±k tip atamasÄ± yap
    const updated: AdUnit[] = adUnits.map(unit => {
      if (unit.id === id) {
        return {
          ...unit,
          status: unit.status === 'active' ? 'paused' : 'active'
        }
      }
      return unit
    })
    
    // onUpdate'i Ã§aÄŸÄ±r - artÄ±k tip gÃ¼venli
    onUpdate(updated)
  }

  const deleteAdUnit = (id: string) => {
    const updated = adUnits.filter(unit => unit.id !== id)
    onUpdate(updated)
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-lg font-bold text-gray-900">Reklam Ãœniteleri</h2>
        <button
          onClick={() => setShowForm(!showForm)}
          className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg"
        >
          {showForm ? 'Ä°ptal' : '+ Yeni Reklam'}
        </button>
      </div>

      {/* Yeni Reklam Formu */}
      {showForm && (
        <div className="bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200">
          <h3 className="font-bold text-gray-900 mb-4">Yeni Reklam Ãœnitesi</h3>
          
          <div className="grid md:grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Reklam AdÄ± *
              </label>
              <input
                type="text"
                value={newAdUnit.name}
                onChange={(e) => setNewAdUnit(prev => ({...prev, name: e.target.value}))}
                placeholder="Ã–rn: Ana Sayfa Sidebar"
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                required
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Reklam Tipi
              </label>
              <select
                value={newAdUnit.type}
                onChange={(e) => setNewAdUnit(prev => ({
                  ...prev, 
                  type: e.target.value as 'display' | 'in-article' | 'in-feed'
                }))}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              >
                <option value="display">Display Reklam</option>
                <option value="in-article">Makale Ä°Ã§i</option>
                <option value="in-feed">Feed Ä°Ã§i</option>
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Boyut
              </label>
              <select
                value={newAdUnit.size}
                onChange={(e) => setNewAdUnit(prev => ({...prev, size: e.target.value}))}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              >
                {sizes.map(size => (
                  <option key={size} value={size}>{size}</option>
                ))}
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Pozisyon
              </label>
              <select
                value={newAdUnit.position}
                onChange={(e) => setNewAdUnit(prev => ({...prev, position: e.target.value}))}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              >
                {positions.map(pos => (
                  <option key={pos} value={pos}>{pos}</option>
                ))}
              </select>
            </div>

            <div className="md:col-span-2">
              <label className="block text-sm font-medium text-gray-700 mb-3">
                BaÅŸlangÄ±Ã§ Durumu
              </label>
              <div className="flex space-x-6">
                <label className="flex items-center space-x-2 cursor-pointer">
                  <input
                    type="radio"
                    name="status"
                    value="active"
                    checked={newAdUnit.status === 'active'}
                    onChange={() => setNewAdUnit(prev => ({...prev, status: 'active'}))}
                    className="w-4 h-4 text-blue-600"
                  />
                  <span className="text-sm font-medium text-gray-700">Aktif</span>
                  <span className="text-xs text-gray-500">(Hemen yayÄ±nda)</span>
                </label>
                <label className="flex items-center space-x-2 cursor-pointer">
                  <input
                    type="radio"
                    name="status"
                    value="paused"
                    checked={newAdUnit.status === 'paused'}
                    onChange={() => setNewAdUnit(prev => ({...prev, status: 'paused'}))}
                    className="w-4 h-4 text-blue-600"
                  />
                  <span className="text-sm font-medium text-gray-700">DuraklatÄ±lmÄ±ÅŸ</span>
                  <span className="text-xs text-gray-500">(Daha sonra aktif edilecek)</span>
                </label>
              </div>
            </div>
          </div>

          <div className="mt-6 flex justify-end space-x-3">
            <button
              type="button"
              onClick={() => setShowForm(false)}
              className="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium"
            >
              Ä°ptal
            </button>
            <button
              onClick={addAdUnit}
              disabled={!newAdUnit.name.trim()}
              className="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
            >
              Reklam Ekle
            </button>
          </div>
        </div>
      )}

      {/* Reklam Listesi */}
      {adUnits.length === 0 ? (
        <div className="text-center py-12 text-gray-500 border-2 border-dashed border-gray-200 rounded-lg">
          <div className="text-4xl mb-4">ğŸ“º</div>
          <p className="text-lg font-medium">HenÃ¼z reklam Ã¼niteniz yok</p>
          <p className="text-sm mt-2">Yeni reklam eklemek iÃ§in "Yeni Reklam" butonuna tÄ±klayÄ±n</p>
        </div>
      ) : (
        <>
          <div className="overflow-x-auto">
            <table className="w-full min-w-full divide-y divide-gray-200">
              <thead className="bg-gray-50">
                <tr>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Ad
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Tip
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Boyut
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Pozisyon
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Durum
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Gelir
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Ä°ÅŸlemler
                  </th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {adUnits.map((unit) => (
                  <tr key={unit.id} className="hover:bg-gray-50">
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="font-medium text-gray-900">{unit.name}</div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <span className="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                        {unit.type === 'display' ? 'Display' : 
                         unit.type === 'in-article' ? 'Makale Ä°Ã§i' : 'Feed Ä°Ã§i'}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {unit.size}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {unit.position}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${
                        unit.status === 'active' 
                          ? 'bg-green-100 text-green-800' 
                          : 'bg-red-100 text-red-800'
                      }`}>
                        {unit.status === 'active' ? 'Aktif' : 'DuraklatÄ±ldÄ±'}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                      {unit.revenue.toFixed(2)} â‚º
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                      <div className="flex space-x-2">
                        <button
                          onClick={() => toggleAdStatus(unit.id)}
                          className={`px-3 py-1 rounded text-xs font-medium ${
                            unit.status === 'active'
                              ? 'bg-red-50 text-red-700 hover:bg-red-100 border border-red-200'
                              : 'bg-green-50 text-green-700 hover:bg-green-100 border border-green-200'
                          }`}
                        >
                          {unit.status === 'active' ? 'Duraklat' : 'Aktif Et'}
                        </button>
                        <button
                          onClick={() => deleteAdUnit(unit.id)}
                          className="px-3 py-1 bg-gray-100 text-gray-700 hover:bg-gray-200 rounded text-xs font-medium border border-gray-300"
                        >
                          Sil
                        </button>
                      </div>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>

          {/* Ä°statistikler */}
          <div className="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
            <div className="bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200">
              <p className="text-sm font-medium text-blue-700">Toplam Reklam</p>
              <p className="text-2xl font-bold text-blue-900">{adUnits.length}</p>
              <p className="text-xs text-blue-600 mt-1">
                {adUnits.filter(u => u.status === 'active').length} aktif
              </p>
            </div>
            <div className="bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg border border-green-200">
              <p className="text-sm font-medium text-green-700">Toplam Gelir</p>
              <p className="text-2xl font-bold text-green-900">
                {adUnits.reduce((sum, unit) => sum + unit.revenue, 0).toFixed(2)} â‚º
              </p>
              <p className="text-xs text-green-600 mt-1">
                Ortalama: {(adUnits.reduce((sum, unit) => sum + unit.revenue, 0) / adUnits.length || 0).toFixed(2)} â‚º
              </p>
            </div>
            <div className="bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200">
              <p className="text-sm font-medium text-purple-700">Tahmini AylÄ±k</p>
              <p className="text-2xl font-bold text-purple-900">
                {(adUnits.reduce((sum, unit) => sum + unit.revenue, 0) * 30).toFixed(2)} â‚º
              </p>
              <p className="text-xs text-purple-600 mt-1">
                TÃ¼m reklamlar aktifse
              </p>
            </div>
          </div>
        </>
      )}
    </div>
  )
}

ğŸ“„ components/admin/DashboardStats.tsx
ğŸ“Š 92 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/DashboardStats.tsx
interface DashboardStatsProps {
  stats: {
    totalUsers: number
    totalSpots: number
    totalShops: number
    revenue: number
    activeAds: number
  }
  loading: boolean
}

export default function DashboardStats({ stats, loading }: DashboardStatsProps) {
  const statCards = [
    {
      title: 'Toplam KullanÄ±cÄ±',
      value: stats.totalUsers,
      icon: 'ğŸ‘¥',
      color: 'bg-blue-500',
      change: '+12%'
    },
    {
      title: 'Aktif Spot',
      value: stats.totalSpots,
      icon: 'ğŸ“',
      color: 'bg-green-500',
      change: '+8%'
    },
    {
      title: 'KayÄ±tlÄ± MaÄŸaza',
      value: stats.totalShops,
      icon: 'ğŸª',
      color: 'bg-purple-500',
      change: '+5%'
    },
    {
      title: 'Toplam Gelir',
      value: `${stats.revenue.toFixed(2)} â‚º`,
      icon: 'ğŸ’°',
      color: 'bg-yellow-500',
      change: '+23%'
    },
    {
      title: 'Aktif Reklam',
      value: stats.activeAds,
      icon: 'ğŸ“¢',
      color: 'bg-red-500',
      change: '+3'
    },
    {
      title: 'BugÃ¼nkÃ¼ Ziyaret',
      value: '1,234',
      icon: 'ğŸ‘ï¸',
      color: 'bg-indigo-500',
      change: '+15%'
    }
  ]

  if (loading) {
    return (
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {[1, 2, 3, 4, 5, 6].map((i) => (
          <div key={i} className="bg-white rounded-xl shadow p-6">
            <div className="animate-pulse">
              <div className="h-4 bg-gray-200 rounded w-1/2 mb-4"></div>
              <div className="h-8 bg-gray-200 rounded w-1/4"></div>
            </div>
          </div>
        ))}
      </div>
    )
  }

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {statCards.map((stat, index) => (
        <div key={index} className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
          <div className="flex items-start justify-between">
            <div>
              <p className="text-sm text-gray-600">{stat.title}</p>
              <p className="text-2xl font-bold text-gray-900 mt-2">{stat.value}</p>
              <p className="text-sm text-green-600 mt-1">{stat.change} geÃ§en aya gÃ¶re</p>
            </div>
            <div className={`${stat.color} w-12 h-12 rounded-lg flex items-center justify-center`}>
              <span className="text-2xl">{stat.icon}</span>
            </div>
          </div>
        </div>
      ))}
    </div>
  )
}

ğŸ“„ components/admin/RecentSpots.tsx
ğŸ“Š 136 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/RecentSpots.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import Link from 'next/link'

interface Spot {
  id: string
  title: string
  user_id: string
  status: string
  created_at: string
  user?: {
    id: string
    name: string
  }
}

interface UserProfile {
  id: string
  name: string
}

export default function RecentSpots() {
  const [spots, setSpots] = useState<Spot[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchRecentSpots()
  }, [])

  const fetchRecentSpots = async () => {
    try {
      const { data } = await supabase
        .from('spots')
        .select('id, title, user_id, status, created_at')
        .order('created_at', { ascending: false })
        .limit(10)

      // KullanÄ±cÄ± isimlerini getir
      if (data) {
        const userIds = data.map((spot: Spot) => spot.user_id)
        const { data: users } = await supabase
          .from('user_profiles')
          .select('id, name')
          .in('id', userIds)

        const spotsWithUsers = data.map((spot: Spot) => ({
          ...spot,
          user: (users as UserProfile[] | null)?.find((u: UserProfile) => u.id === spot.user_id)
        }))

        setSpots(spotsWithUsers)
      }
    } catch (error) {
      console.error('Spotlar yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'active': return 'bg-green-100 text-green-800'
      case 'found': return 'bg-blue-100 text-blue-800'
      case 'expired': return 'bg-gray-100 text-gray-800'
      default: return 'bg-yellow-100 text-yellow-800'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <h3 className="text-lg font-bold text-gray-900 mb-4">Son Spot'lar</h3>
        <div className="space-y-4">
          {[1, 2, 3, 4, 5].map((i: number) => (
            <div key={i} className="animate-pulse">
              <div className="h-4 bg-gray-200 rounded w-3/4 mb-2"></div>
              <div className="h-3 bg-gray-200 rounded w-1/2"></div>
            </div>
          ))}
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-4">
        <h3 className="text-lg font-bold text-gray-900">Son Spot'lar</h3>
        <Link
          href="/admin/spots"
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </Link>
      </div>

      <div className="space-y-4">
        {spots.map((spot: Spot) => (
          <div key={spot.id} className="border-b border-gray-100 pb-4 last:border-0">
            <div className="flex justify-between items-start">
              <div className="flex-1">
                <Link
                  href={`/spots/${spot.id}`}
                  className="font-medium text-gray-900 hover:text-blue-600"
                >
                  {spot.title.length > 50 ? spot.title.substring(0, 50) + '...' : spot.title}
                </Link>
                <div className="flex items-center space-x-3 mt-1">
                  <span className="text-sm text-gray-600">
                    {spot.user?.name || 'Anonim'}
                  </span>
                  <span className="text-xs text-gray-500">
                    {new Date(spot.created_at).toLocaleDateString('tr-TR')}
                  </span>
                </div>
              </div>
              <span className={`px-2 py-1 text-xs rounded-full ${getStatusColor(spot.status)}`}>
                {spot.status === 'active' ? 'Aktif' : 
                 spot.status === 'found' ? 'Bulundu' : spot.status}
              </span>
            </div>
          </div>
        ))}
      </div>

      {spots.length === 0 && (
        <div className="text-center py-8 text-gray-500">
          HenÃ¼z spot oluÅŸturulmamÄ±ÅŸ
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/admin/RevenueChart.tsx
ğŸ“Š 82 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/RevenueChart.tsx
'use client'

import { useState } from 'react'

export default function RevenueChart() {
  const [timeRange, setTimeRange] = useState<'7gÃ¼n' | '30gÃ¼n' | '90gÃ¼n'>('30gÃ¼n')
  
  // Ã–rnek veri
  const chartData = {
    '7gÃ¼n': [120, 190, 300, 500, 200, 300, 450],
    '30gÃ¼n': Array.from({ length: 30 }, (_, i) => Math.floor(Math.random() * 500) + 100),
    '90gÃ¼n': Array.from({ length: 90 }, (_, i) => Math.floor(Math.random() * 500) + 100)
  }

  const data = chartData[timeRange]
  const maxValue = Math.max(...data)
  const total = data.reduce((sum, value) => sum + value, 0)

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">Gelir GrafiÄŸi</h3>
          <p className="text-gray-600">Toplam: <span className="font-bold">{total.toFixed(2)} â‚º</span></p>
        </div>
        <div className="flex space-x-2">
          {(['7gÃ¼n', '30gÃ¼n', '90gÃ¼n'] as const).map((range) => (
            <button
              key={range}
              onClick={() => setTimeRange(range)}
              className={`px-3 py-1 rounded-lg text-sm font-medium ${
                timeRange === range
                  ? 'bg-blue-600 text-white'
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              {range}
            </button>
          ))}
        </div>
      </div>

      {/* Basit Chart */}
      <div className="h-64 flex items-end space-x-1">
        {data.map((value, index) => (
          <div
            key={index}
            className="flex-1 flex flex-col items-center"
            title={`${value} â‚º`}
          >
            <div
              className="w-full bg-gradient-to-t from-blue-500 to-blue-600 rounded-t-lg hover:opacity-80 transition-opacity"
              style={{ height: `${(value / maxValue) * 100}%` }}
            />
            <span className="text-xs text-gray-500 mt-1">
              {timeRange === '7gÃ¼n' ? ['Pzt', 'Sal', 'Ã‡ar', 'Per', 'Cum', 'Cmt', 'Paz'][index] : index + 1}
            </span>
          </div>
        ))}
      </div>

      {/* Legend */}
      <div className="mt-6 pt-6 border-t border-gray-100">
        <div className="grid grid-cols-3 gap-4">
          <div className="text-center">
            <p className="text-sm text-gray-600">Ortalama GÃ¼nlÃ¼k</p>
            <p className="text-lg font-bold">{(total / data.length).toFixed(2)} â‚º</p>
          </div>
          <div className="text-center">
            <p className="text-sm text-gray-600">En YÃ¼ksek GÃ¼n</p>
            <p className="text-lg font-bold">{maxValue.toFixed(2)} â‚º</p>
          </div>
          <div className="text-center">
            <p className="text-sm text-gray-600">Tahmini AylÄ±k</p>
            <p className="text-lg font-bold">{(total * 1.15).toFixed(2)} â‚º</p>
          </div>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/AuthModal.tsx
ğŸ“Š 374 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/AuthModal.tsx - DEBUG VERSÄ°YON
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'
import { sendWelcomeEmail } from '@/lib/email-server'

interface AuthModalProps {
  isOpen: boolean
  onClose: () => void
  onSuccess?: () => void
}

export default function AuthModal({ isOpen, onClose, onSuccess }: AuthModalProps) {
  const [isLogin, setIsLogin] = useState(true)
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [name, setName] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')
  const [successMessage, setSuccessMessage] = useState('')
  const [debugLog, setDebugLog] = useState<string[]>([])

  const addDebugLog = (message: string) => {
    console.log(`ğŸ” DEBUG: ${message}`)
    setDebugLog(prev => [...prev, `${new Date().toISOString().split('T')[1].split('.')[0]}: ${message}`])
  }

  if (!isOpen) return null

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')
    setSuccessMessage('')
    setDebugLog([])

    addDebugLog('Form submit baÅŸladÄ±')
    addDebugLog(`Mode: ${isLogin ? 'Login' : 'Register'}`)
    addDebugLog(`Email: ${email}, Name: ${name}`)

    try {
      if (isLogin) {
        // GÄ°RÄ°Å YAP
        addDebugLog('Supabase signInWithPassword Ã§aÄŸrÄ±lÄ±yor...')
        
        const { data, error } = await supabase.auth.signInWithPassword({
          email,
          password,
        })
        
        addDebugLog(`SignIn response: ${error ? 'Error: ' + error.message : 'Success'}`)
        console.log('SignIn full response:', { data, error })
        
        if (error) throw error
        
        setSuccessMessage('BaÅŸarÄ±yla giriÅŸ yaptÄ±nÄ±z!')
        addDebugLog('GiriÅŸ baÅŸarÄ±lÄ±, yÃ¶nlendirme bekleniyor...')
        
        setTimeout(() => {
          onClose()
          if (onSuccess) {
            onSuccess()
          } else {
            window.location.reload()
          }
        }, 1500)
        
      } else {
        // KAYIT OL
        addDebugLog('KayÄ±t iÅŸlemi baÅŸlatÄ±lÄ±yor...')
        
        // 1. Ã–nce auth kaydÄ±
        addDebugLog('Supabase signUp Ã§aÄŸrÄ±lÄ±yor...')
        const { data: authData, error: authError } = await supabase.auth.signUp({
          email,
          password,
          options: {
            data: { name },
            emailRedirectTo: `${window.location.origin}/auth/callback`,
          },
        })
        
        addDebugLog(`Auth signUp response: ${authError ? 'Error: ' + authError.message : 'Success'}`)
        console.log('Auth signUp full response:', { authData, authError })
        
        if (authError) {
          addDebugLog(`Auth error details: ${JSON.stringify(authError, null, 2)}`)
          throw authError
        }
        
        if (authData?.user) {
          addDebugLog(`Auth baÅŸarÄ±lÄ±! User ID: ${authData.user.id}`)
          addDebugLog(`User confirmed: ${authData.user.confirmed_at ? 'Evet' : 'HayÄ±r'}`)
          
          // 2. user_profiles tablosuna kayÄ±t
          try {
            addDebugLog('user_profiles tablosuna kayÄ±t yapÄ±lÄ±yor...')
            const { data: profileData, error: profileError } = await supabase
              .from('user_profiles')
              .insert({
                id: authData.user.id,
                name: name,
                created_at: new Date().toISOString(),
                updated_at: new Date().toISOString()
              })
              .select()
            
            addDebugLog(`Profile insert response: ${profileError ? 'Error: ' + profileError.message : 'Success'}`)
            console.log('Profile insert full response:', { profileData, profileError })
            
            if (profileError) {
              addDebugLog(`Profile error (devam ediliyor): ${profileError.message}`)
              // Profile kaydÄ± baÅŸarÄ±sÄ±z olsa bile devam et
            } else {
              addDebugLog('Profile kaydÄ± baÅŸarÄ±lÄ±!')
            }
          } catch (profileErr: any) {
            addDebugLog(`Profile exception: ${profileErr.message}`)
            console.warn('Profile kaydÄ± exception:', profileErr)
          }
          
          // 3. Email gÃ¶nder
          try {
            addDebugLog('Welcome email gÃ¶nderiliyor...')
            const result = await sendWelcomeEmail(email, name)
            addDebugLog(`Email gÃ¶nderim sonucu: ${result.success ? 'BaÅŸarÄ±lÄ±' : 'BaÅŸarÄ±sÄ±z'}`)
            
            if (result.success) {
              setSuccessMessage(`ğŸ‰ HoÅŸ geldiniz ${name}! KaydÄ±nÄ±z baÅŸarÄ±yla oluÅŸturuldu.`)
            } else {
              setSuccessMessage(`âœ… KaydÄ±nÄ±z baÅŸarÄ±yla oluÅŸturuldu ${name}! (Email gÃ¶nderilemedi)`)
            }
          } catch (emailError: any) {
            addDebugLog(`Email error: ${emailError.message}`)
            console.warn('Email gÃ¶nderilemedi:', emailError)
            setSuccessMessage(`âœ… KaydÄ±nÄ±z baÅŸarÄ±yla oluÅŸturuldu ${name}!`)
          }
          
          addDebugLog('KayÄ±t tamamlandÄ±, yÃ¶nlendirme bekleniyor...')
          setTimeout(() => {
            onClose()
            if (onSuccess) {
              onSuccess()
            } else {
              window.location.href = '/profile'
            }
          }, 2000)
        } else {
          addDebugLog('Auth data var ama user yok!')
          throw new Error('KullanÄ±cÄ± oluÅŸturulamadÄ±')
        }
      }

    } catch (err: any) {
      console.error('Auth error details:', err)
      addDebugLog(`Catch error: ${err.message}`)
      addDebugLog(`Error stack: ${err.stack}`)
      
      let errorMessage = err.message || 'Bir hata oluÅŸtu'
      
      // DetaylÄ± hata mesajlarÄ±
      if (errorMessage.includes('Invalid login credentials')) {
        errorMessage = 'GeÃ§ersiz email veya ÅŸifre'
      } else if (errorMessage.includes('Email not confirmed')) {
        errorMessage = 'LÃ¼tfen email adresinizi doÄŸrulayÄ±n (spam klasÃ¶rÃ¼nÃ¼zÃ¼ kontrol edin)'
      } else if (errorMessage.includes('User already registered')) {
        errorMessage = 'Bu email adresi zaten kayÄ±tlÄ±. LÃ¼tfen giriÅŸ yapÄ±n veya ÅŸifrenizi sÄ±fÄ±rlayÄ±n.'
      } else if (errorMessage.includes('Password should be at least')) {
        errorMessage = 'Åifre en az 6 karakter olmalÄ±dÄ±r'
      } else if (errorMessage.includes('Invalid email')) {
        errorMessage = 'GeÃ§ersiz email adresi formatÄ±'
      } else if (errorMessage.includes('rate limit')) {
        errorMessage = 'Ã‡ok fazla deneme yaptÄ±nÄ±z. LÃ¼tfen bir sÃ¼re sonra tekrar deneyin.'
      } else if (errorMessage.includes('network')) {
        errorMessage = 'AÄŸ hatasÄ±. LÃ¼tfen internet baÄŸlantÄ±nÄ±zÄ± kontrol edin.'
      } else if (errorMessage.includes('duplicate key')) {
        errorMessage = 'Bu kullanÄ±cÄ± zaten kayÄ±tlÄ±'
      } else if (errorMessage.includes('JWT')) {
        errorMessage = 'Kimlik doÄŸrulama hatasÄ±. LÃ¼tfen sayfayÄ± yenileyin.'
      }
      
      setError(`${errorMessage} (LÃ¼tfen browser konsolunu kontrol edin)`)
      
    } finally {
      setLoading(false)
      addDebugLog('Ä°ÅŸlem tamamlandÄ± (finally)')
    }
  }

  const handleClose = () => {
    setEmail('')
    setPassword('')
    setName('')
    setError('')
    setSuccessMessage('')
    setDebugLog([])
    onClose()
  }

  const switchMode = () => {
    setIsLogin(!isLogin)
    setError('')
    setSuccessMessage('')
    setDebugLog([])
  }

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-xl shadow-2xl w-full max-w-md">
        {/* Header */}
        <div className="border-b p-6">
          <div className="flex justify-between items-center">
            <h2 className="text-2xl font-bold text-gray-900">
              {isLogin ? 'GiriÅŸ Yap' : 'Hesap OluÅŸtur'}
            </h2>
            <button
              onClick={handleClose}
              className="text-gray-500 hover:text-gray-700 text-2xl"
              disabled={loading}
            >
              Ã—
            </button>
          </div>
          <p className="text-gray-600 mt-2">
            {isLogin 
              ? 'Spot oluÅŸturmak ve yardÄ±m etmek iÃ§in giriÅŸ yapÄ±n' 
              : 'TopluluÄŸumuza katÄ±lÄ±n, kayÄ±p Ã¼rÃ¼nleri birlikte bulalÄ±m'}
          </p>
        </div>

        {/* Form */}
        <form onSubmit={handleSubmit} className="p-6 space-y-4">
          {!isLogin && (
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Ad Soyad *
              </label>
              <input
                type="text"
                value={name}
                onChange={(e) => setName(e.target.value)}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                placeholder="Ahmet YÄ±lmaz"
                required={!isLogin}
                disabled={loading}
              />
            </div>
          )}

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              E-posta *
            </label>
            <input
              type="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="ornek@email.com"
              required
              disabled={loading}
            />
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Åifre *
            </label>
            <input
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              minLength={6}
              required
              disabled={loading}
            />
            {!isLogin && (
              <p className="text-xs text-gray-500 mt-1">
                Åifreniz en az 6 karakter olmalÄ±dÄ±r
              </p>
            )}
          </div>

          {/* Debug Log (sadece development'da) */}
          {process.env.NODE_ENV === 'development' && debugLog.length > 0 && (
            <div className="bg-gray-900 text-green-400 p-3 rounded-lg border border-gray-700 max-h-40 overflow-y-auto">
              <div className="text-xs font-mono">
                <div className="font-bold mb-1">ğŸ” DEBUG LOG:</div>
                {debugLog.map((log, index) => (
                  <div key={index} className="mb-1 border-b border-gray-800 pb-1 last:border-0">
                    {log}
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* BaÅŸarÄ± MesajÄ± */}
          {successMessage && (
            <div className="bg-green-50 border border-green-200 text-green-700 p-4 rounded-lg">
              {successMessage}
            </div>
          )}

          {/* Hata MesajÄ± */}
          {error && (
            <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg">
              <div className="font-medium mb-1">Hata:</div>
              <div>{error}</div>
              <div className="mt-2 text-sm">
                <button
                  type="button"
                  onClick={() => {
                    console.log('DEBUG LOG:', debugLog)
                    alert(`Debug log konsolda gÃ¶rÃ¼ntÃ¼lendi. LÃ¼tfen F12 ile konsolu aÃ§Ä±n.`)
                  }}
                  className="text-red-600 hover:text-red-800 underline mr-4"
                >
                  Debug Log'u GÃ¶r
                </button>
                <button
                  type="button"
                  onClick={() => {
                    const testData = { email, name, isLogin }
                    console.log('TEST DATA:', testData)
                    alert(`Test data: ${JSON.stringify(testData)}`)
                  }}
                  className="text-blue-600 hover:text-blue-800 underline"
                >
                  Test Data'yÄ± GÃ¶r
                </button>
              </div>
            </div>
          )}

          <button
            type="submit"
            disabled={loading}
            className="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
          >
            {loading ? (
              <>
                <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                  <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Ä°ÅŸleniyor...
              </>
            ) : (
              isLogin ? 'GiriÅŸ Yap' : 'Hesap OluÅŸtur'
            )}
          </button>
        </form>

        {/* Footer */}
        <div className="border-t p-6 text-center">
          <p className="text-gray-600">
            {isLogin ? 'HesabÄ±nÄ±z yok mu?' : 'Zaten hesabÄ±nÄ±z var mÄ±?'}
            <button
              onClick={switchMode}
              disabled={loading}
              className="text-blue-600 hover:text-blue-800 font-medium ml-2 disabled:opacity-50"
            >
              {isLogin ? 'KayÄ±t Olun' : 'GiriÅŸ YapÄ±n'}
            </button>
          </p>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/Categories.tsx
ğŸ“Š 70 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

interface Category {
  id: number
  name: string
  count: number
  icon: string
  color: string
}

export default function Categories() {
  const categories: Category[] = [
    { id: 1, name: 'Elektronik', count: 156, icon: 'ğŸ“±', color: 'bg-blue-100 text-blue-800' },
    { id: 2, name: 'Giyim & Aksesuar', count: 89, icon: 'ğŸ‘•', color: 'bg-green-100 text-green-800' },
    { id: 3, name: 'Ev & BahÃ§e', count: 123, icon: 'ğŸ ', color: 'bg-yellow-100 text-yellow-800' },
    { id: 4, name: 'Koleksiyon', count: 67, icon: 'ğŸ¨', color: 'bg-purple-100 text-purple-800' },
    { id: 5, name: 'Kitap & MÃ¼zik', count: 45, icon: 'ğŸ“š', color: 'bg-red-100 text-red-800' },
    { id: 6, name: 'Oyuncak & Oyun', count: 78, icon: 'ğŸ®', color: 'bg-indigo-100 text-indigo-800' },
    { id: 7, name: 'Spor & Outdoor', count: 34, icon: 'âš½', color: 'bg-pink-100 text-pink-800' },
    { id: 8, name: 'AraÃ§ & ParÃ§a', count: 56, icon: 'ğŸš—', color: 'bg-gray-100 text-gray-800' },
  ]

  return (
    <section className="py-16 bg-white">
      <div className="container-custom">
        <div className="text-center mb-12">
          <h2 className="text-3xl font-bold text-gray-900 mb-4">
            PopÃ¼ler Kategoriler
          </h2>
          <p className="text-gray-600 max-w-2xl mx-auto">
            Ä°htiyacÄ±nÄ±z olan Ã¼rÃ¼nÃ¼ kategorilere gÃ¶re arayÄ±n veya yeni bir spot oluÅŸturun
          </p>
        </div>

        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          {categories.map((category) => (
            <div
              key={category.id}
              className="border border-gray-200 rounded-xl p-6 text-center hover:border-blue-300 hover:shadow-md transition duration-200 cursor-pointer"
            >
              <div className={`w-16 h-16 ${category.color.split(' ')[0]} rounded-full flex items-center justify-center text-2xl mx-auto mb-4`}>
                {category.icon}
              </div>
              <h3 className="font-bold text-gray-900 mb-1">{category.name}</h3>
              <p className="text-gray-500 text-sm">{category.count} aktif spot</p>
            </div>
          ))}
        </div>

        {/* Search by city */}
        <div className="mt-16">
          <h3 className="text-2xl font-bold text-center mb-8">
            Åehirlere GÃ¶re Ara
          </h3>
          <div className="flex flex-wrap justify-center gap-3">
            {['Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya', 'Adana', 'Konya', 'Trabzon'].map((city) => (
              <button
                key={city}
                className="px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-full font-medium transition duration-200"
              >
                {city}
              </button>
            ))}
            <button className="px-6 py-3 text-blue-600 hover:text-blue-800 font-medium">
              + TÃ¼m Åehirler
            </button>
          </div>
        </div>
      </div>
    </section>
  )
}

ğŸ“„ components/CTA.tsx
ğŸ“Š 75 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useRouter } from 'next/navigation'

export default function CTA() {
  const router = useRouter()

  return (
    <section className="py-20 bg-gradient-to-r from-blue-900 to-purple-900">
      <div className="container-custom">
        <div className="max-w-4xl mx-auto text-center">
          <div className="inline-block px-4 py-2 bg-white bg-opacity-20 text-white rounded-full text-sm font-medium mb-6">
            ğŸ¯ HEMEN BAÅLAYIN
          </div>
          
          <h2 className="text-3xl md:text-5xl font-bold text-white mb-6">
            AradÄ±ÄŸÄ±nÄ±z ÃœrÃ¼nÃ¼ Hemen Bulun
          </h2>
          
          <p className="text-xl text-blue-200 mb-10 max-w-2xl mx-auto">
            Binlerce gÃ¶z sizin iÃ§in arasÄ±n. Ãœcretsiz kaydolun, spot oluÅŸturun ve 
            kayÄ±p Ã¼rÃ¼nlerinizi topluluÄŸumuzla bulun.
          </p>

          <div className="flex flex-col sm:flex-row gap-4 justify-center mb-12">
            <button
              onClick={() => router.push('/create-spot')}
              className="group bg-white hover:bg-gray-100 text-blue-900 font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-2xl flex items-center justify-center"
            >
              <span className="mr-3">ğŸš€</span>
              Ãœcretsiz Spot OluÅŸtur
              <span className="ml-3 group-hover:translate-x-2 transition-transform">â†’</span>
            </button>
            
            <button
              onClick={() => router.push('/spots')}
              className="group bg-transparent hover:bg-white hover:bg-opacity-10 text-white font-semibold py-4 px-8 rounded-xl border-2 border-white border-opacity-30 transition-all duration-300 transform hover:scale-105 flex items-center justify-center"
            >
              <span className="mr-3">ğŸ”</span>
              Spot'larÄ± Ä°ncele
              <span className="ml-3 group-hover:translate-x-2 transition-transform">â†’</span>
            </button>
          </div>

          {/* Ã–zellikler */}
          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div className="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-20">
              <div className="text-3xl mb-4">ğŸ</div>
              <h4 className="text-white font-bold mb-2">Tamamen Ãœcretsiz</h4>
              <p className="text-blue-200 text-sm">
                Spot oluÅŸturmak, yardÄ±m etmek, topluluÄŸa katÄ±lmak tamamen Ã¼cretsiz
              </p>
            </div>
            
            <div className="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-20">
              <div className="text-3xl mb-4">âš¡</div>
              <h4 className="text-white font-bold mb-2">HÄ±zlÄ± YardÄ±m</h4>
              <p className="text-blue-200 text-sm">
                Ortalama 24 saat iÃ§inde ilk yardÄ±m cevabÄ±nÄ± alÄ±rsÄ±nÄ±z
              </p>
            </div>
            
            <div className="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-20">
              <div className="text-3xl mb-4">ğŸ”’</div>
              <h4 className="text-white font-bold mb-2">GÃ¼venli & Gizli</h4>
              <p className="text-blue-200 text-sm">
                KiÅŸisel bilgileriniz gÃ¼vende, sadece gerekli bilgiler paylaÅŸÄ±lÄ±r
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

ğŸ“„ components/DailyChallenges.tsx
ğŸ“Š 181 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/DailyChallenges.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'

// Type definitions
interface Challenge {
  id: string
  title: string
  description: string
  challenge_type: string
  reward_points: number
  target_count: number
  is_active: boolean
  start_date: string
  end_date: string
}

interface Progress {
  id: string
  user_id: string
  challenge_id: string
  progress_count: number
  is_completed: boolean
  completed_at: string | null
}

export default function DailyChallenges() {
  const [challenges, setChallenges] = useState<Challenge[]>([])
  const [userProgress, setUserProgress] = useState<Record<string, number>>({})
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchChallenges()
  }, [])

  const fetchChallenges = async () => {
    try {
      const [{ data: challengesData }, { data: user }] = await Promise.all([
        supabase
          .from('daily_challenges')
          .select('*')
          .eq('is_active', true)
          .order('reward_points', { ascending: false }),
        supabase.auth.getUser()
      ])

      if (user.user) {
        const { data: progressData } = await supabase
          .from('user_challenge_progress')
          .select('*')
          .eq('user_id', user.user.id)

        const progressMap: Record<string, number> = {}
        
        // DÃœZELTÄ°LMÄ°Å KISIM - Tip tanÄ±mlandÄ±
        progressData?.forEach((p: Progress) => {
          progressMap[p.challenge_id] = p.progress_count
        })

        setUserProgress(progressMap)
      }

      setChallenges(challengesData || [])
    } catch (error) {
      console.error('Challenges yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getChallengeIcon = (type: string) => {
    switch(type) {
      case 'sighting': return 'ğŸ‘ï¸'
      case 'social': return 'ğŸ‘¥'
      case 'completion': return 'âœ…'
      case 'streak': return 'ğŸ”¥'
      default: return 'ğŸ¯'
    }
  }

  return (
    <div className="bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl shadow-lg p-6 border border-blue-100">
      <div className="flex items-center justify-between mb-6">
        <div>
          <h2 className="text-xl font-bold text-gray-900">ğŸ¯ GÃ¼nlÃ¼k Hedefler</h2>
          <p className="text-gray-600">Tamamla, puan kazan!</p>
        </div>
        <div className="text-3xl">ğŸ†</div>
      </div>

      {loading ? (
        <div className="space-y-4">
          {[...Array(3)].map((_, i) => (
            <div key={i} className="animate-pulse bg-white bg-opacity-50 rounded-lg p-4">
              <div className="h-4 bg-gray-200 rounded w-3/4"></div>
              <div className="h-3 bg-gray-200 rounded w-1/2 mt-2"></div>
            </div>
          ))}
        </div>
      ) : (
        <div className="space-y-4">
          {challenges.map((challenge) => {
            const progress = userProgress[challenge.id] || 0
            const percentage = Math.min(100, (progress / challenge.target_count) * 100)
            const isCompleted = progress >= challenge.target_count

            return (
              <div 
                key={challenge.id}
                className={`bg-white rounded-lg p-4 border-2 ${
                  isCompleted ? 'border-green-500 bg-green-50' : 'border-gray-200'
                }`}
              >
                <div className="flex items-start justify-between">
                  <div className="flex items-start space-x-3">
                    <div className="text-2xl">
                      {getChallengeIcon(challenge.challenge_type)}
                    </div>
                    <div>
                      <h4 className="font-bold text-gray-900">{challenge.title}</h4>
                      <p className="text-sm text-gray-600">{challenge.description}</p>
                      
                      {/* Progress */}
                      <div className="mt-2">
                        <div className="flex justify-between text-sm mb-1">
                          <span className="text-gray-600">
                            {progress} / {challenge.target_count}
                          </span>
                          <span className="font-medium text-green-600">
                            +{challenge.reward_points} puan
                          </span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2">
                          <div 
                            className={`h-2 rounded-full ${
                              isCompleted 
                                ? 'bg-green-500' 
                                : 'bg-gradient-to-r from-blue-500 to-purple-500'
                            }`}
                            style={{ width: `${percentage}%` }}
                          ></div>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Durum */}
                  <div className="text-right">
                    {isCompleted ? (
                      <span className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                        âœ… TamamlandÄ±
                      </span>
                    ) : (
                      <button className="px-3 py-1 bg-blue-100 text-blue-800 hover:bg-blue-200 rounded-full text-sm font-medium">
                        BaÅŸla
                      </button>
                    )}
                  </div>
                </div>
              </div>
            )
          })}
        </div>
      )}

      {/* TÃ¼m hedefler tamamlandÄ±ysa */}
      {challenges.length > 0 && 
       challenges.every(c => (userProgress[c.id] || 0) >= c.target_count) && (
        <div className="mt-6 p-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg text-center">
          <div className="text-3xl mb-2">ğŸ‰</div>
          <h3 className="font-bold text-lg">TÃ¼m Hedefler TamamlandÄ±!</h3>
          <p className="text-green-100">
            HarikasÄ±n! YarÄ±n yeni hedeflerle devam et.
          </p>
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/Footer.tsx
ğŸ“Š 179 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/Footer.tsx - GÃœNCELLENMÄ°Å
import Link from 'next/link'

export default function Footer() {
  const currentYear = new Date().getFullYear()

  return (
    <footer className="bg-gray-900 text-white pt-12 pb-8 mt-16">
      <div className="container-custom">
        <div className="grid md:grid-cols-5 gap-8 mb-8">
          {/* Logo & Description */}
          <div className="md:col-span-2">
            <div className="flex items-center mb-4">
              <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center mr-3">
                <span className="text-white font-bold text-xl">S</span>
              </div>
              <h2 className="text-2xl font-bold">SpotItForMe</h2>
            </div>
            <p className="text-gray-400 mb-6">
              Topluluk gÃ¼cÃ¼yle kayÄ±p Ã¼rÃ¼nleri bulma platformu. 
              KeÅŸfet, bul, paylaÅŸ, kazan!
            </p>
            <div className="flex space-x-4">
              <button className="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-700">
                ğŸ“˜
              </button>
              <button className="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-700">
                ğŸ“·
              </button>
              <button className="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-700">
                ğŸ¦
              </button>
            </div>
          </div>

          {/* Spot & KeÅŸfet */}
          <div>
            <h3 className="text-lg font-bold mb-4">Spot & KeÅŸfet</h3>
            <ul className="space-y-3">
              <li>
                <Link href="/spots" className="text-gray-400 hover:text-white">
                  TÃ¼m Spot'lar
                </Link>
              </li>
              <li>
                <Link href="/create-spot" className="text-gray-400 hover:text-white">
                  Spot OluÅŸtur
                </Link>
              </li>
              <li>
                <Link href="/discovery" className="text-gray-400 hover:text-white">
                  KeÅŸfet
                </Link>
              </li>
              <li>
                <Link href="/leaderboard" className="text-gray-400 hover:text-white">
                  Lider Tablosu
                </Link>
              </li>
              <li>
                <Link href="/challenges" className="text-gray-400 hover:text-white">
                  GÃ¼nlÃ¼k Hedefler
                </Link>
              </li>
            </ul>
          </div>

          {/* MaÄŸazalar */}
          <div>
            <h3 className="text-lg font-bold mb-4">MaÄŸazalar</h3>
            <ul className="space-y-3">
              <li>
                <Link href="/shops" className="text-gray-400 hover:text-white">
                  MaÄŸazalarÄ± KeÅŸfet
                </Link>
              </li>
              <li>
                <Link href="/for-business" className="text-gray-400 hover:text-white">
                  Ä°ÅŸletme KaydÄ±
                </Link>
              </li>
              <li>
                <Link href="/shop-dashboard" className="text-gray-400 hover:text-white">
                  MaÄŸaza Paneli
                </Link>
              </li>
              <li>
                <Link href="/premium" className="text-gray-400 hover:text-white">
                  Premium Paketler
                </Link>
              </li>
            </ul>
          </div>

          {/* YardÄ±m & Destek */}
          <div>
            <h3 className="text-lg font-bold mb-4">YardÄ±m & Destek</h3>
            <ul className="space-y-3">
              <li>
                <Link href="/how-it-works" className="text-gray-400 hover:text-white">
                  NasÄ±l Ã‡alÄ±ÅŸÄ±r?
                </Link>
              </li>
              <li>
                <Link href="/faq" className="text-gray-400 hover:text-white">
                  SÄ±kÃ§a Sorulan Sorular
                </Link>
              </li>
              <li>
                <Link href="/contact" className="text-gray-400 hover:text-white">
                  Ä°letiÅŸim
                </Link>
              </li>
              <li>
                <Link href="/privacy" className="text-gray-400 hover:text-white">
                  Gizlilik PolitikasÄ±
                </Link>
              </li>
              <li>
                <Link href="/terms" className="text-gray-400 hover:text-white">
                  KullanÄ±m KoÅŸullarÄ±
                </Link>
              </li>
            </ul>
          </div>
        </div>

        {/* Newsletter - YENÄ° */}
        <div className="border-t border-gray-800 pt-8 mb-8">
          <div className="max-w-xl mx-auto text-center">
            <h3 className="text-xl font-bold mb-4">ğŸ“¬ BÃ¼ltenimize Abone Olun</h3>
            <p className="text-gray-400 mb-6">
              Yeni Ã¶zellikler, baÅŸarÄ± hikayeleri ve Ã¶zel fÄ±rsatlardan haberdar olun.
            </p>
            <form className="flex">
              <input
                type="email"
                placeholder="E-posta adresiniz"
                className="flex-grow px-6 py-3 rounded-l-lg bg-gray-800 text-white border-0 focus:ring-2 focus:ring-blue-500 focus:outline-none"
              />
              <button 
                type="submit"
                className="bg-blue-600 hover:bg-blue-700 text-white font-medium px-8 py-3 rounded-r-lg"
              >
                Abone Ol
              </button>
            </form>
          </div>
        </div>

        {/* Copyright */}
        <div className="border-t border-gray-800 pt-8 text-center">
          <p className="text-gray-400">
            Â© {currentYear} SpotItForMe. TÃ¼m haklarÄ± saklÄ±dÄ±r.
          </p>
          <p className="text-gray-500 text-sm mt-2">
            Made with â¤ï¸ for people who search | v2.0
          </p>
          
          {/* Yeni Ã–zellikler Badge */}
          <div className="mt-4 flex flex-wrap justify-center gap-2">
            <span className="px-3 py-1 bg-blue-900 text-blue-200 rounded-full text-xs">
              ğŸ”¥ Yeni: KeÅŸfet
            </span>
            <span className="px-3 py-1 bg-green-900 text-green-200 rounded-full text-xs">
              ğŸ† Puan Sistemi
            </span>
            <span className="px-3 py-1 bg-purple-900 text-purple-200 rounded-full text-xs">
              ğŸª MaÄŸaza 2.0
            </span>
            <span className="px-3 py-1 bg-yellow-900 text-yellow-200 rounded-full text-xs">
              ğŸ‘ï¸ Nadir GÃ¶rdÃ¼m
            </span>
          </div>
        </div>
      </div>
    </footer>
  )
}

ğŸ“„ components/Header.tsx
ğŸ“Š 78 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/Header.tsx - Z-INDEX EKLENDÄ°
import Link from 'next/link'
import UserMenu from './UserMenu'

export default function Header() {
  return (
    <header className="bg-white shadow relative z-50"> {/* Z-INDEX EKLENDÄ° */}
      <div className="container-custom py-4">
        <div className="flex justify-between items-center">
          {/* Logo */}
          <div className="flex items-center space-x-2">
            <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
              <span className="text-white font-bold text-xl">S</span>
            </div>
            <div>
              <h1 className="text-2xl font-bold text-gray-900">SpotItForMe</h1>
              <p className="text-sm text-gray-600 hidden md:block">Toplulukla bulma platformu</p>
            </div>
          </div>

          {/* Navigation */}
          <nav className="hidden md:flex space-x-8">
            <Link href="/" className="text-gray-700 hover:text-blue-600 font-medium">
              Ana Sayfa
            </Link>
            <Link href="/spots" className="text-gray-700 hover:text-blue-600 font-medium">
              Spot'lar
            </Link>
            <Link href="/how-it-works" className="text-gray-700 hover:text-blue-600 font-medium">
              NasÄ±l Ã‡alÄ±ÅŸÄ±r?
            </Link>
            <Link href="/for-business" className="text-gray-700 hover:text-blue-600 font-medium">
              Ä°ÅŸletmeler Ä°Ã§in
            </Link>
            
            <Link href="/products" className="text-gray-700 hover:text-blue-600 font-medium">
              ÃœrÃ¼nler
            </Link>
          </nav>

          {/* Buttons */}
          <div className="flex items-center space-x-4">
            <UserMenu />
            <Link 
              href="/create-spot"
              className="btn-primary hidden md:inline-block"
            >
              Spot OluÅŸtur
            </Link>
          </div>
        </div>

        {/* Mobile Navigation */}
        <div className="md:hidden mt-4 flex justify-center space-x-6">
          <Link href="/spots" className="text-gray-700 hover:text-blue-600 text-sm">
            Spot'lar
          </Link>
          <Link href="/how-it-works" className="text-gray-700 hover:text-blue-600 text-sm">
            NasÄ±l Ã‡alÄ±ÅŸÄ±r?
          </Link>
          <Link href="/for-business" className="text-gray-700 hover:text-blue-600 text-sm">
            Ä°ÅŸletmeler
          </Link>
        </div>

        {/* Mobile Spot OluÅŸtur Butonu */}
        <div className="md:hidden mt-4">
          <Link 
            href="/create-spot"
            className="btn-primary w-full block text-center"
          >
            Ãœcretsiz Spot OluÅŸtur
          </Link>
        </div>
      </div>
    </header>
  )
}

ğŸ“„ components/Hero.tsx
ğŸ“Š 157 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'

export default function Hero() {
  const router = useRouter()
  const [searchQuery, setSearchQuery] = useState('')

  const handleSearch = (e: React.FormEvent) => {
    e.preventDefault()
    if (searchQuery.trim()) {
      router.push(`/spots?search=${encodeURIComponent(searchQuery)}`)
    }
  }

  const popularSearches = [
    'vintage kamera lensi',
    'eski Ã§ay makinesi parÃ§asÄ±',
    'retro oyun konsolu',
    'antika saat',
    'yedek parÃ§a'
  ]

  return (
    <section className="relative overflow-hidden">
      {/* Arka plan gradient */}
      <div className="absolute inset-0 bg-gradient-to-br from-blue-50 via-white to-purple-50" />
      
      {/* Dekoratif Ã¶ÄŸeler */}
      <div className="absolute top-20 left-10 w-72 h-72 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse" />
      <div className="absolute bottom-20 right-10 w-72 h-72 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse delay-1000" />
      
      <div className="relative container-custom py-20 md:py-32">
        <div className="max-w-4xl mx-auto text-center">
          {/* Ana baÅŸlÄ±k */}
          <div className="mb-8">
            <h1 className="text-4xl md:text-6xl lg:text-7xl font-bold text-gray-900 mb-6 leading-tight">
              BulunmasÄ± zor Ã¼rÃ¼nleri{' '}
              <span className="relative">
                <span className="relative z-10 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                  toplulukla bulun
                </span>
                <span className="absolute bottom-2 left-0 w-full h-3 bg-blue-100 -z-10 rounded-full"></span>
              </span>
            </h1>
            
            <p className="text-xl text-gray-600 mb-10 max-w-3xl mx-auto leading-relaxed">
              AradÄ±ÄŸÄ±nÄ±z nadir, vintage veya Ã¼retimi durmuÅŸ Ã¼rÃ¼nleri binlerce gÃ¶z sizin iÃ§in arasÄ±n. 
              TopluluÄŸumuzun gÃ¼cÃ¼yle imkansÄ±zÄ± mÃ¼mkÃ¼n kÄ±lÄ±n.
            </p>
          </div>

          {/* ARAMA Ã‡UBUÄU - YENÄ° ve MODERN */}
          <div className="max-w-3xl mx-auto mb-12">
            <form onSubmit={handleSearch} className="relative">
              <div className="relative bg-white rounded-2xl shadow-2xl p-2 border border-gray-200">
                <div className="flex items-center">
                  <div className="flex-grow relative">
                    <div className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                      ğŸ”
                    </div>
                    <input
                      type="text"
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                      placeholder="Ne aramÄ±ÅŸtÄ±nÄ±z? Ã–rnek: 'vintage Nikon kamera lensi', 'eski ArÃ§elik Ã§ay makinesi parÃ§asÄ±'"
                      className="w-full pl-12 pr-4 py-4 text-lg border-0 focus:ring-0 focus:outline-none rounded-l-2xl"
                    />
                  </div>
                  <button
                    type="submit"
                    className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                  >
                    Ara
                  </button>
                </div>
              </div>
              
              {/* PopÃ¼ler aramalar */}
              <div className="mt-6">
                <p className="text-sm text-gray-500 mb-3">PopÃ¼ler aramalar:</p>
                <div className="flex flex-wrap justify-center gap-3">
                  {popularSearches.map((search, index) => (
                    <button
                      key={index}
                      type="button"
                      onClick={() => setSearchQuery(search)}
                      className="px-4 py-2 bg-white hover:bg-gray-50 text-gray-700 rounded-full text-sm font-medium border border-gray-200 transition-all duration-200 hover:border-blue-300 hover:text-blue-600 hover:shadow-sm"
                    >
                      {search}
                    </button>
                  ))}
                </div>
              </div>
            </form>
          </div>

          {/* CTA ButonlarÄ± */}
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <button
              onClick={() => router.push('/create-spot')}
              className="group bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center"
            >
              <span className="mr-3">âœ¨</span>
              Ãœcretsiz Spot OluÅŸtur
              <span className="ml-3 group-hover:translate-x-1 transition-transform">â†’</span>
            </button>
            
            <button
              onClick={() => router.push('/spots')}
              className="group bg-white hover:bg-gray-50 text-gray-800 font-semibold py-4 px-8 rounded-xl border-2 border-gray-200 transition-all duration-300 transform hover:scale-105 flex items-center justify-center"
            >
              <span className="mr-3">ğŸ”</span>
              Spot'larÄ± KeÅŸfet
              <span className="ml-3 group-hover:translate-x-1 transition-transform">â†’</span>
            </button>
          </div>

          {/* GÃ¼ven iÅŸaretleri */}
          <div className="mt-16 pt-8 border-t border-gray-200">
            <p className="text-sm text-gray-500 mb-6">Milyonlarca kullanÄ±cÄ±ya gÃ¼venilen platform</p>
            <div className="flex flex-wrap justify-center items-center gap-8 opacity-70">
              <div className="flex items-center space-x-2">
                <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                  <span className="text-green-600 font-bold">âœ“</span>
                </div>
                <span className="text-sm font-medium">%100 Ãœcretsiz</span>
              </div>
              
              <div className="flex items-center space-x-2">
                <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                  <span className="text-blue-600">ğŸ”’</span>
                </div>
                <span className="text-sm font-medium">GÃ¼venli & Gizli</span>
              </div>
              
              <div className="flex items-center space-x-2">
                <div className="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                  <span className="text-purple-600">ğŸ¤</span>
                </div>
                <span className="text-sm font-medium">Topluluk DesteÄŸi</span>
              </div>
              
              <div className="flex items-center space-x-2">
                <div className="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center">
                  <span className="text-orange-600">âš¡</span>
                </div>
                <span className="text-sm font-medium">HÄ±zlÄ± YardÄ±m</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

ğŸ“„ components/HowItWorks.tsx
ğŸ“Š 147 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

export default function HowItWorks() {
  const steps = [
    {
      number: '01',
      title: 'Spot OluÅŸtur',
      description: 'AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼n fotoÄŸrafÄ±nÄ± ekleyin, detaylarÄ± yazÄ±n',
      icon: 'ğŸ“',
      color: 'bg-blue-100 text-blue-600',
      features: ['Ãœcretsiz', '2 dakika', 'Resim yÃ¼kle']
    },
    {
      number: '02',
      title: 'Topluluk GÃ¶rsÃ¼n',
      description: 'Binlerce kullanÄ±cÄ± ÅŸehirlerinde gezerken gÃ¶z kulak olur',
      icon: 'ğŸ‘ï¸',
      color: 'bg-purple-100 text-purple-600',
      features: ['AnlÄ±k bildirim', 'Konum bazlÄ±', 'Uzman topluluk']
    },
    {
      number: '03',
      title: 'Bildirim Al',
      description: 'Biri Ã¼rÃ¼nÃ¼ gÃ¶rÃ¼nce anÄ±nda fotoÄŸraf ve konum bilgisi gelir',
      icon: 'ğŸ””',
      color: 'bg-green-100 text-green-600',
      features: ['GerÃ§ek zamanlÄ±', 'FotoÄŸraflÄ±', 'DetaylÄ± bilgi']
    },
    {
      number: '04',
      title: 'Bul ve Mutlu Ol',
      description: 'ÃœrÃ¼nÃ¼ bulun, alÄ±n ve baÅŸarÄ± hikayenizi paylaÅŸÄ±n!',
      icon: 'ğŸ¯',
      color: 'bg-orange-100 text-orange-600',
      features: ['%94 baÅŸarÄ±', 'TeÅŸekkÃ¼r puanÄ±', 'Topluluk rozeti']
    },
  ]

  return (
    <section className="py-20 bg-white">
      <div className="container-custom">
        <div className="text-center mb-16">
          <div className="inline-block px-4 py-2 bg-blue-100 text-blue-700 rounded-full text-sm font-medium mb-4">
            ğŸš€ 4 ADIMDA Ã‡Ã–ZÃœM
          </div>
          <h2 className="text-3xl md:text-5xl font-bold text-gray-900 mb-6">
            SpotItForMe NasÄ±l Ã‡alÄ±ÅŸÄ±r?
          </h2>
          <p className="text-xl text-gray-600 max-w-3xl mx-auto">
            KayÄ±p Ã¼rÃ¼nlerinizi bulmak artÄ±k Ã§ok kolay. 4 basit adÄ±mda binlerce gÃ¶z sizin iÃ§in arasÄ±n.
          </p>
        </div>

        <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
          {steps.map((step) => (
            <div key={step.number} className="relative group">
              {/* Ã‡izgi (masaÃ¼stÃ¼ iÃ§in) */}
              {step.number !== '04' && (
                <div className="hidden lg:block absolute top-12 right-0 w-full h-0.5 bg-gradient-to-r from-blue-200 to-transparent translate-x-1/2 z-0" />
              )}
              
              <div className="relative bg-white rounded-2xl p-8 shadow-lg border border-gray-100 hover:shadow-2xl transition-all duration-300 transform group-hover:-translate-y-2 z-10">
                {/* Ãœst kÄ±sÄ±m */}
                <div className="flex items-start justify-between mb-6">
                  <div className={`w-16 h-16 rounded-xl ${step.color} flex items-center justify-center text-2xl`}>
                    {step.icon}
                  </div>
                  <div className="w-10 h-10 bg-gradient-to-br from-gray-900 to-gray-700 text-white rounded-full flex items-center justify-center font-bold text-sm">
                    {step.number}
                  </div>
                </div>
                
                {/* Ä°Ã§erik */}
                <h3 className="text-2xl font-bold text-gray-900 mb-3">
                  {step.title}
                </h3>
                <p className="text-gray-600 mb-6">
                  {step.description}
                </p>
                
                {/* Ã–zellikler */}
                <div className="space-y-2">
                  {step.features.map((feature, idx) => (
                    <div key={idx} className="flex items-center text-sm">
                      <span className="w-1.5 h-1.5 bg-blue-500 rounded-full mr-3"></span>
                      <span className="text-gray-700">{feature}</span>
                    </div>
                  ))}
                </div>
                
                {/* Alt Ã§izgi */}
                <div className="mt-6 pt-6 border-t border-gray-100">
                  <div className="text-xs text-gray-500 font-medium">
                    {step.number === '01' && 'ÃœCRETSÄ°Z baÅŸlayÄ±n'}
                    {step.number === '02' && '24/7 aktif topluluk'}
                    {step.number === '03' && 'AnÄ±nda bildirim'}
                    {step.number === '04' && 'Garantili memnuniyet'}
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>

        {/* Video aÃ§Ä±klama */}
        <div className="mt-20 bg-gradient-to-r from-blue-50 to-purple-50 rounded-3xl p-8 md:p-12">
          <div className="flex flex-col lg:flex-row items-center gap-8">
            <div className="lg:w-2/3">
              <h3 className="text-2xl md:text-3xl font-bold text-gray-900 mb-4">
                ğŸ¥ 90 Saniyede SpotItForMe
              </h3>
              <p className="text-gray-600 mb-6">
                NasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±mÄ±zÄ± 90 saniyede Ã¶ÄŸrenin. Binlerce kullanÄ±cÄ±nÄ±n kayÄ±p Ã¼rÃ¼nlerini 
                nasÄ±l bulduÄŸunu gÃ¶rÃ¼n ve siz de hemen baÅŸlayÄ±n.
              </p>
              <div className="flex flex-wrap gap-4">
                <button className="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl flex items-center">
                  <span className="mr-2">â–¶ï¸</span>
                  TanÄ±tÄ±m Filmini Ä°zle
                </button>
                <button className="px-6 py-3 bg-white hover:bg-gray-50 text-gray-800 font-medium rounded-xl border border-gray-300">
                  BaÅŸarÄ± Hikayeleri
                </button>
              </div>
            </div>
            
            <div className="lg:w-1/3">
              <div className="bg-gradient-to-br from-blue-400 to-purple-500 rounded-2xl p-1">
                <div className="bg-white rounded-xl p-6 text-center">
                  <div className="text-5xl mb-4">ğŸ“±</div>
                  <h4 className="font-bold text-gray-900 mb-2">Mobil Uygulama</h4>
                  <p className="text-sm text-gray-600 mb-4">Yoldayken bile spot oluÅŸturun</p>
                  <div className="flex justify-center space-x-3">
                    <button className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm">
                      App Store
                    </button>
                    <button className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm">
                      Google Play
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

ğŸ“„ components/ImageUpload.tsx
ğŸ“Š 77 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ImageUpload.tsx
'use client'

import { useRef, useState } from 'react'

interface ImageUploadProps {
  onImagesSelected: (files: File[]) => void
  maxImages?: number
}

export default function ImageUpload({ 
  onImagesSelected, 
  maxImages = 10 
}: ImageUploadProps) {
  const fileInputRef = useRef<HTMLInputElement>(null)
  const [previews, setPreviews] = useState<string[]>([])

  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    const files = Array.from(e.target.files || [])
    const validFiles = files.slice(0, maxImages - previews.length)
    
    if (validFiles.length === 0) return
    
    // Preview oluÅŸtur
    const newPreviews = validFiles.map(file => URL.createObjectURL(file))
    setPreviews(prev => [...prev, ...newPreviews])
    
    onImagesSelected(validFiles)
  }

  const removeImage = (index: number) => {
    setPreviews(prev => prev.filter((_, i) => i !== index))
  }

  return (
    <div>
      <input
        type="file"
        ref={fileInputRef}
        multiple
        accept="image/*"
        onChange={handleFileSelect}
        className="hidden"
      />
      
      <div className="grid grid-cols-3 gap-4">
        {previews.map((preview, index) => (
          <div key={index} className="relative">
            <img
              src={preview}
              alt={`Preview ${index + 1}`}
              className="w-full h-32 object-cover rounded-lg"
            />
            <button
              type="button"
              onClick={() => removeImage(index)}
              className="absolute top-1 right-1 bg-red-500 text-white w-6 h-6 rounded-full text-sm"
            >
              Ã—
            </button>
          </div>
        ))}
        
        {previews.length < maxImages && (
          <button
            type="button"
            onClick={() => fileInputRef.current?.click()}
            className="w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-blue-400 transition"
          >
            <div className="text-2xl mb-2">+</div>
            <div className="text-sm text-gray-600">Resim Ekle</div>
          </button>
        )}
      </div>
    </div>
  )
}

ğŸ“„ components/Leaderboard.tsx
ğŸ“Š 169 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/Leaderboard.tsx
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import { GamificationEngine } from '@/lib/gamification/game-engine'

export default function Leaderboard() {
  const [leaderboard, setLeaderboard] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [timeRange, setTimeRange] = useState<'daily' | 'weekly' | 'all'>('weekly')

  useEffect(() => {
    fetchLeaderboard()
  }, [timeRange])

  const fetchLeaderboard = async () => {
    setLoading(true)
    try {
      let query = supabase
        .from('leaderboard_view')
        .select('*')
        .limit(20)

      if (timeRange === 'daily') {
        query = query.order('total_points', { ascending: false })
      } else if (timeRange === 'weekly') {
        // Bu haftanÄ±n puanlarÄ± iÃ§in farklÄ± bir view gerekebilir
        query = query.order('total_points', { ascending: false })
      }

      const { data, error } = await query

      if (error) throw error
      setLeaderboard(data || [])
    } catch (error) {
      console.error('Leaderboard yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getRankIcon = (rank: number) => {
    switch(rank) {
      case 1: return 'ğŸ¥‡'
      case 2: return 'ğŸ¥ˆ'
      case 3: return 'ğŸ¥‰'
      default: return `#${rank}`
    }
  }

  return (
    <div className="bg-white rounded-xl shadow-lg p-6">
      <div className="flex items-center justify-between mb-6">
        <div>
          <h2 className="text-xl font-bold text-gray-900">ğŸ† Lider Tablosu</h2>
          <p className="text-gray-600">En aktif bulucular</p>
        </div>
        
        <div className="flex space-x-2">
          {['daily', 'weekly', 'all'].map((range) => (
            <button
              key={range}
              onClick={() => setTimeRange(range as any)}
              className={`px-4 py-2 rounded-lg text-sm font-medium ${
                timeRange === range
                  ? 'bg-blue-600 text-white'
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              {range === 'daily' ? 'GÃ¼nlÃ¼k' : range === 'weekly' ? 'HaftalÄ±k' : 'TÃ¼m Zamanlar'}
            </button>
          ))}
        </div>
      </div>

      {loading ? (
        <div className="space-y-4">
          {[...Array(5)].map((_, i) => (
            <div key={i} className="animate-pulse flex items-center space-x-4">
              <div className="w-10 h-10 bg-gray-200 rounded-full"></div>
              <div className="flex-1">
                <div className="h-4 bg-gray-200 rounded w-1/4"></div>
                <div className="h-3 bg-gray-200 rounded w-1/2 mt-2"></div>
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div className="space-y-3">
          {leaderboard.map((user, index) => {
            const userLevel = GamificationEngine.LEVELS.find(l => l.level === user.current_level)
            
            return (
              <div 
                key={user.user_id}
                className={`flex items-center space-x-4 p-3 rounded-lg ${
                  index < 3 ? 'bg-gradient-to-r from-yellow-50 to-yellow-100 border border-yellow-200' : 'hover:bg-gray-50'
                }`}
              >
                {/* SÄ±ra */}
                <div className="flex-shrink-0">
                  <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold ${
                    index === 0 ? 'bg-yellow-500 text-white' :
                    index === 1 ? 'bg-gray-400 text-white' :
                    index === 2 ? 'bg-amber-700 text-white' :
                    'bg-gray-200 text-gray-700'
                  }`}>
                    {getRankIcon(index + 1)}
                  </div>
                </div>

                {/* Avatar ve Ä°sim */}
                <div className="flex-1 flex items-center space-x-3">
                  <div className="w-12 h-12 rounded-full overflow-hidden bg-gray-200">
                    {user.avatar_url ? (
                      <img src={user.avatar_url} alt={user.name} className="w-full h-full object-cover" />
                    ) : (
                      <div className="w-full h-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-bold">
                        {user.name?.[0] || 'K'}
                      </div>
                    )}
                  </div>
                  
                  <div className="flex-1">
                    <div className="flex items-center justify-between">
                      <div>
                        <h4 className="font-bold text-gray-900">{user.name}</h4>
                        <p className="text-sm" style={{ color: userLevel?.color }}>
                          {userLevel?.name}
                        </p>
                      </div>
                      <div className="text-right">
                        <div className="font-bold text-gray-900">{user.total_points} puan</div>
                        <div className="text-xs text-gray-500">
                          {user.total_sightings} yardÄ±m
                        </div>
                      </div>
                    </div>
                    
                    {/* Progress bar (mini) */}
                    <div className="mt-2">
                      <div className="w-full bg-gray-200 rounded-full h-1">
                        <div 
                          className="h-1 rounded-full bg-gradient-to-r from-blue-500 to-purple-600"
                          style={{ width: `${Math.min(100, (user.total_points / 5000) * 100)}%` }}
                        ></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            )
          })}
        </div>
      )}

      {/* Kendi Pozisyonun (alt kÄ±sÄ±m) */}
      <div className="mt-6 pt-6 border-t">
        <button 
          onClick={() => fetchLeaderboard()}
          className="w-full text-center text-blue-600 hover:text-blue-800 font-medium py-2"
        >
          Tam Listeyi GÃ¶r
        </button>
      </div>
    </div>
  )
}

ğŸ“„ components/LocationSelector.tsx
ğŸ“Š 291 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useState, useEffect, useRef } from 'react'
import { MapPin, Navigation } from 'lucide-react'
import { supabase } from '@/lib/supabase'

// Tip tanÄ±mlarÄ±
interface LocationSuggestion {
  type: 'database' | 'osm'
  name: string
  address: string
  latitude: number | null
  longitude: number | null
  city: string
  district: string
}

interface SelectedLocation {
  name: string
  address: string
  latitude: number | null
  longitude: number | null
  city: string
  district: string
}

interface LocationSelectorProps {
  onLocationSelect: (location: SelectedLocation) => void
  initialLocation?: string
  required?: boolean
}

interface DatabaseLocation {
  name: string
  full_address: string
  latitude: number | null
  longitude: number | null
  city: string
  district: string
}

interface OSMResult {
  display_name: string
  lat: string
  lon: string
  address?: {
    city?: string
    town?: string
    suburb?: string
    county?: string
    [key: string]: any
  }
}

export default function LocationSelector({ 
  onLocationSelect, 
  initialLocation = '',
  required = true
}: LocationSelectorProps) {
  const [location, setLocation] = useState(initialLocation)
  const [suggestions, setSuggestions] = useState<LocationSuggestion[]>([])
  const [isLoading, setIsLoading] = useState(false)
  
  const searchTimeout = useRef<NodeJS.Timeout>()

  useEffect(() => {
    // Ä°lk konum varsa trigger et
    if (initialLocation) {
      handleLocationSelect({ 
        name: initialLocation, 
        address: initialLocation,
        latitude: null,
        longitude: null,
        city: '',
        district: ''
      })
    }
  }, [initialLocation])

  const searchLocation = async (query: string) => {
    if (!query || query.length < 2) {
      setSuggestions([])
      return
    }

    setIsLoading(true)
    try {
      // 1. VeritabanÄ±ndan ara
      const { data: dbResults } = await supabase
        .from('locations')
        .select('*')
        .or(`name.ilike.%${query}%,city.ilike.%${query}%,district.ilike.%${query}%`)
        .limit(5)

      // 2. OpenStreetMap API
      const osmResponse = await fetch(
        `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(query + ' TÃ¼rkiye')}&format=json&addressdetails=1&limit=5`
      )
      const osmResults: OSMResult[] = await osmResponse.json()

      const dbSuggestions: LocationSuggestion[] = (dbResults as DatabaseLocation[] || []).map(loc => ({
        type: 'database' as const,
        name: loc.name,
        address: loc.full_address,
        latitude: loc.latitude,
        longitude: loc.longitude,
        city: loc.city,
        district: loc.district
      }))

      const osmSuggestions: LocationSuggestion[] = osmResults.map((place: OSMResult) => ({
        type: 'osm' as const,
        name: place.display_name.split(',')[0],
        address: place.display_name,
        latitude: place.lat ? parseFloat(place.lat) : null,
        longitude: place.lon ? parseFloat(place.lon) : null,
        city: place.address?.city || place.address?.town || '',
        district: place.address?.suburb || place.address?.county || ''
      }))

      const allSuggestions = [...dbSuggestions, ...osmSuggestions]
      setSuggestions(allSuggestions.slice(0, 8))
    } catch (error) {
      console.error('Konum arama hatasÄ±:', error)
    } finally {
      setIsLoading(false)
    }
  }

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const value = e.target.value
    setLocation(value)
    
    if (searchTimeout.current) {
      clearTimeout(searchTimeout.current)
    }
    
    searchTimeout.current = setTimeout(() => {
      searchLocation(value)
    }, 300)
  }

  const handleSuggestionClick = (suggestion: LocationSuggestion) => {
    setLocation(suggestion.address || suggestion.name)
    setSuggestions([])
    handleLocationSelect(suggestion)
  }

  const handleLocationSelect = (locationData: SelectedLocation) => {
    onLocationSelect({
      name: locationData.name,
      address: locationData.address || locationData.name,
      latitude: locationData.latitude,
      longitude: locationData.longitude,
      city: locationData.city || '',
      district: locationData.district || ''
    })
  }

  const useCurrentLocation = () => {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        async (position) => {
          const { latitude, longitude } = position.coords
          
          try {
            const response = await fetch(
              `https://nominatim.openstreetmap.org/reverse?lat=${latitude}&lon=${longitude}&format=json`
            )
            const data: OSMResult = await response.json()
            
            const locationObj: SelectedLocation = {
              name: 'Mevcut Konumum',
              address: data.display_name,
              latitude,
              longitude,
              city: data.address?.city || data.address?.town || '',
              district: data.address?.suburb || data.address?.county || ''
            }
            
            setLocation(data.display_name)
            handleLocationSelect(locationObj)
          } catch (error) {
            console.error('Reverse geocoding hatasÄ±:', error)
          }
        },
        (error) => {
          console.error('Konum alÄ±namadÄ±:', error)
          alert('Konum izni vermeniz gerekiyor')
        }
      )
    }
  }

  const quickLocations = [
    'Ä°stiklal Caddesi, BeyoÄŸlu',
    'KadÄ±kÃ¶y Ã‡arÅŸÄ±, KadÄ±kÃ¶y',
    'BaÄŸdat Caddesi, KadÄ±kÃ¶y',
    'NiÅŸantaÅŸÄ±, ÅiÅŸli',
    'Akmerkez, BeÅŸiktaÅŸ',
    'Kanyon, ÅiÅŸli',
    'Ä°zmir Alsancak',
    'Ankara KÄ±zÄ±lay'
  ]

  return (
    <div className="space-y-3">
      <label className="block text-sm font-medium text-gray-700">
        ğŸ“ Konum {required && '*'}
      </label>
      
      <div className="relative">
        <div className="flex items-center">
          <div className="flex-1 relative">
            <MapPin className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
            <input
              type="text"
              value={location}
              onChange={handleInputChange}
              placeholder="Ã–rn: Ä°stiklal Caddesi, KadÄ±kÃ¶y Ã‡arÅŸÄ±..."
              className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              required={required}
            />
          </div>
          
          <button
            type="button"
            onClick={useCurrentLocation}
            className="ml-2 p-3 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition"
            title="Mevcut konumumu kullan"
          >
            <Navigation className="w-5 h-5" />
          </button>
        </div>

        {/* Ã–neriler */}
        {suggestions.length > 0 && (
          <div className="absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto">
            {suggestions.map((suggestion, index) => (
              <button
                key={index}
                type="button"
                onClick={() => handleSuggestionClick(suggestion)}
                className="w-full text-left px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-0"
              >
                <div className="font-medium">{suggestion.name}</div>
                <div className="text-sm text-gray-600 truncate">
                  {suggestion.address}
                </div>
                {suggestion.city && (
                  <div className="text-xs text-gray-500 mt-1">
                    {suggestion.district ? `${suggestion.district}, ` : ''}
                    {suggestion.city}
                  </div>
                )}
              </button>
            ))}
          </div>
        )}

        {isLoading && (
          <div className="absolute right-3 top-1/2 transform -translate-y-1/2">
            <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"></div>
          </div>
        )}
      </div>

      {/* HÄ±zlÄ± konum butonlarÄ± */}
      <div className="flex flex-wrap gap-2">
        {quickLocations.map((quickLocation) => (
          <button
            key={quickLocation}
            type="button"
            onClick={() => {
              setLocation(quickLocation)
              searchLocation(quickLocation)
            }}
            className="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full text-sm transition"
          >
            {quickLocation}
          </button>
        ))}
      </div>

      <p className="text-xs text-gray-500">
        âœ“ Konum bilgisi Ã¼rÃ¼nÃ¼n daha hÄ±zlÄ± bulunmasÄ±nÄ± saÄŸlar<br />
        âœ“ DetaylÄ± adres (sokak, bina no) daha iyi sonuÃ§ verir
      </p>
    </div>
  )
}

ğŸ“„ components/NativeAd.tsx
ğŸ“Š 259 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/NativeAd.tsx - TAMAMI
'use client';

import { useState, useEffect } from 'react';
import { ExternalLink, TrendingUp, Star, Smartphone, Monitor } from 'lucide-react';

interface NativeAdProps {
  index?: number;
  className?: string;
  title?: string;
  description?: string;
  ctaText?: string;
  advertiserName?: string;
}

export default function NativeAd({ 
  index = 3, 
  className = '',
  title,
  description,
  ctaText,
  advertiserName
}: NativeAdProps) {
  const [isMobile, setIsMobile] = useState(false);
  const [mounted, setMounted] = useState(false);
  const [hover, setHover] = useState(false);

  useEffect(() => {
    setMounted(true);
    const checkMobile = () => {
      setIsMobile(window.innerWidth < 768);
    };
    
    checkMobile();
    window.addEventListener('resize', checkMobile);
    
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  // VarsayÄ±lan reklam iÃ§erikleri
  const defaultAds = {
    mobile: {
      title: 'Mobil AlÄ±ÅŸveriÅŸte Ã–zel FÄ±rsat!',
      description: 'Nadir bulunan Ã¼rÃ¼nler iÃ§in mobil uygulamamÄ±zÄ± deneyin. %20 indirim kodu: SPOT20',
      ctaText: 'Hemen KeÅŸfet',
      advertiserName: 'Mobil Partner',
      icon: 'ğŸ“±'
    },
    desktop: {
      title: 'Desktop Ã–zel Teklif',
      description: 'GeniÅŸ ekranda daha iyi deneyim iÃ§in premium Ã¼yelik avantajlarÄ±.',
      ctaText: 'DetaylarÄ± GÃ¶r',
      advertiserName: 'Desktop Sponsor',
      icon: 'ğŸ’»'
    },
    generic: {
      title: 'SpotItForMe Premium',
      description: 'Spot\'larÄ±nÄ±zÄ± Ã¶ne Ã§Ä±karÄ±n, daha hÄ±zlÄ± bulun. Premium Ã¼yelik avantajlarÄ±.',
      ctaText: 'Premium Ol',
      advertiserName: 'SpotItForMe',
      icon: 'â­'
    }
  };

  // Reklam verisini seÃ§
  const getAdData = () => {
    if (title || description || ctaText || advertiserName) {
      return {
        title: title || defaultAds.generic.title,
        description: description || defaultAds.generic.description,
        ctaText: ctaText || defaultAds.generic.ctaText,
        advertiserName: advertiserName || defaultAds.generic.advertiserName,
        icon: defaultAds.generic.icon
      };
    }
    
    return isMobile ? defaultAds.mobile : defaultAds.desktop;
  };

  const adData = getAdData();

  if (!mounted) {
    return (
      <div className={`bg-gray-100 animate-pulse rounded-xl ${className}`}>
        <div className={`p-${isMobile ? '4' : '6'}`}>
          <div className={`h-4 bg-gray-200 rounded ${isMobile ? 'w-1/2' : 'w-1/3'} mb-4`}></div>
          <div className={`h-${isMobile ? '16' : '20'} bg-gray-200 rounded mb-4`}></div>
          <div className={`h-8 bg-gray-200 rounded ${isMobile ? 'w-full' : 'w-1/2'}`}></div>
        </div>
      </div>
    );
  }

  return (
    <div 
      className={`relative z-0 ${className}`}
      onMouseEnter={() => setHover(true)}
      onMouseLeave={() => setHover(false)}
    >
      <div className={`
        ${isMobile ? 'p-4' : 'p-6'}
        ${hover 
          ? 'bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-300 shadow-md' 
          : 'bg-gradient-to-br from-white to-gray-50 border-gray-200'
        }
        border ${isMobile ? 'rounded-lg' : 'rounded-xl'}
        shadow-sm
        transition-all duration-300
        overflow-hidden
        relative
      `}>
        
        {/* Sponsor badge - sol Ã¼st */}
        <div className="absolute top-3 left-3">
          <div className={`
            ${isMobile ? 'text-[10px] px-2 py-1' : 'text-xs px-3 py-1.5'} 
            ${hover ? 'bg-blue-600 text-white' : 'bg-blue-100 text-blue-700'}
            font-semibold rounded-full
            flex items-center
            transition-colors duration-300
          `}>
            <Star size={isMobile ? 10 : 12} className="mr-1" />
            SPONSOR
          </div>
        </div>

        {/* Platform icon - saÄŸ Ã¼st */}
        <div className="absolute top-3 right-3">
          <div className={`
            ${isMobile ? 'w-8 h-8' : 'w-10 h-10'}
            ${hover ? 'bg-blue-100' : 'bg-gray-100'}
            rounded-full flex items-center justify-center
            transition-colors duration-300
          `}>
            {isMobile ? (
              <Smartphone size={isMobile ? 14 : 16} className={hover ? 'text-blue-600' : 'text-gray-600'} />
            ) : (
              <Monitor size={isMobile ? 14 : 16} className={hover ? 'text-blue-600' : 'text-gray-600'} />
            )}
          </div>
        </div>

        {/* Ana iÃ§erik */}
        <div className={isMobile ? 'pt-10' : 'pt-12'}>
          
          {/* BaÅŸlÄ±k */}
          <h3 className={`
            font-bold text-gray-900 
            ${isMobile ? 'text-base mb-2' : 'text-lg mb-3'}
            ${hover ? 'text-blue-800' : ''}
            transition-colors duration-300
          `}>
            {adData.title}
          </h3>

          {/* AÃ§Ä±klama */}
          <p className={`
            text-gray-600 
            ${isMobile ? 'text-sm mb-3' : 'text-base mb-4'}
            ${hover ? 'text-gray-700' : ''}
            transition-colors duration-300
          `}>
            {adData.description}
          </p>

          {/* Reklamveren bilgisi */}
          <div className="flex items-center mb-4">
            <div className={`
              ${isMobile ? 'w-8 h-8' : 'w-10 h-10'}
              ${hover ? 'bg-blue-100' : 'bg-gray-100'}
              rounded-full flex items-center justify-center mr-3
              transition-colors duration-300
            `}>
              <span className={`${isMobile ? 'text-lg' : 'text-xl'}`}>
                {adData.icon}
              </span>
            </div>
            <div>
              <p className={`
                font-medium 
                ${isMobile ? 'text-sm' : 'text-base'}
                ${hover ? 'text-blue-700' : 'text-gray-700'}
                transition-colors duration-300
              `}>
                {adData.advertiserName}
              </p>
              <p className={`${isMobile ? 'text-xs' : 'text-sm'} text-gray-500`}>
                {isMobile ? 'Mobil Sponsor' : 'Desktop Sponsor'}
              </p>
            </div>
          </div>

          {/* CTA Butonu */}
          <a
            href="#"
            onClick={(e) => {
              e.preventDefault();
              console.log('Native ad clicked:', adData.title);
              // Buraya tÄ±klama takibi eklenebilir
            }}
            className={`
              block w-full 
              ${hover 
                ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white' 
                : 'bg-gradient-to-r from-blue-500 to-blue-600 text-white'
              }
              text-center font-semibold 
              ${isMobile ? 'py-2.5 px-4 text-sm' : 'py-3 px-6 text-base'}
              rounded-lg
              transition-all duration-300
              transform ${hover ? 'scale-[1.02]' : 'scale-100'}
              shadow-sm ${hover ? 'shadow-md' : ''}
              flex items-center justify-center
            `}
          >
            <span>{adData.ctaText}</span>
            <ExternalLink size={isMobile ? 14 : 16} className="ml-2" />
          </a>

          {/* Ä°statistikler (sadece desktop) */}
          {!isMobile && (
            <div className="mt-4 pt-4 border-t border-gray-100">
              <div className="flex justify-between text-xs text-gray-500">
                <div className="text-center">
                  <div className="font-semibold text-gray-700">1.2K</div>
                  <div>GÃ¶sterim</div>
                </div>
                <div className="text-center">
                  <div className="font-semibold text-gray-700">48</div>
                  <div>TÄ±klama</div>
                </div>
                <div className="text-center">
                  <div className="font-semibold text-gray-700">4%</div>
                  <div>CTR</div>
                </div>
              </div>
            </div>
          )}

          {/* KÃ¼Ã§Ã¼k disclaimer */}
          <div className={`mt-${isMobile ? '3' : '4'} pt-${isMobile ? '3' : '4'} border-t border-gray-100`}>
            <p className={`
              text-gray-400 text-center 
              ${isMobile ? 'text-[10px]' : 'text-xs'}
              ${hover ? 'text-gray-500' : ''}
              transition-colors duration-300
            `}>
              Bu bir reklamdÄ±r. TÄ±klamalar dÄ±ÅŸ sitelere yÃ¶nlendirebilir.
            </p>
          </div>
        </div>

        {/* Dekoratif elementler */}
        <div className="absolute top-0 right-0 w-20 h-20 -mt-10 -mr-10 bg-blue-100 rounded-full opacity-20"></div>
        <div className="absolute bottom-0 left-0 w-16 h-16 -mb-8 -ml-8 bg-indigo-100 rounded-full opacity-20"></div>
      </div>
    </div>
  );
}

ğŸ“„ components/QuickSightingButton.tsx
ğŸ“Š 40 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useState } from 'react'
import QuickSightingModal from './QuickSightingModal'

export default function QuickSightingButton() {
  const [showModal, setShowModal] = useState(false)

  return (
    <>
      {/* Floating Button */}
      <button
        onClick={() => setShowModal(true)}
        className="fixed bottom-6 right-6 z-50 bg-gradient-to-r from-green-500 to-emerald-600 text-white p-4 rounded-full shadow-2xl hover:shadow-3xl transition-all duration-300 hover:scale-110 group"
      >
        <div className="flex items-center space-x-2">
          <span className="text-2xl">ğŸ‘ï¸</span>
          <span className="font-bold hidden md:inline-block group-hover:inline-block transition-all">
            Nadir GÃ¶rdÃ¼m!
          </span>
        </div>
        
        {/* Puan gÃ¶sterimi */}
        <div className="absolute -top-2 -right-2 bg-yellow-500 text-white text-xs font-bold px-2 py-1 rounded-full">
          +5-25
        </div>
      </button>

      {/* Modal */}
      <QuickSightingModal
        isOpen={showModal}
        onClose={() => setShowModal(false)}
        onSuccess={() => {
          // Bildirim baÅŸarÄ±lÄ± olduÄŸunda sayfayÄ± yenile
          window.location.reload()
        }}
      />
    </>
  )
}

ğŸ“„ components/QuickSightingModal.tsx
ğŸ“Š 391 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useState, useRef } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Image from 'next/image'
import LocationSelector from './LocationSelector'

interface QuickSightingModalProps {
  isOpen: boolean
  onClose: () => void
  onSuccess?: () => void
}

export default function QuickSightingModal({ 
  isOpen, 
  onClose, 
  onSuccess 
}: QuickSightingModalProps) {
  const router = useRouter()
  const fileInputRef = useRef<HTMLInputElement>(null)
  
  const [loading, setLoading] = useState(false)
  const [locationData, setLocationData] = useState<any>(null)
  const [photoFile, setPhotoFile] = useState<File | null>(null)
  const [photoPreview, setPhotoPreview] = useState<string | null>(null)
  
  const [formData, setFormData] = useState({
    description: '',
    category: '',
    hasPhoto: false
  })

  const handleLocationSelect = (location: any) => {
    setLocationData(location)
  }

  const handlePhotoToggle = (checked: boolean) => {
    setFormData({...formData, hasPhoto: checked})
    if (!checked) {
      setPhotoFile(null)
      setPhotoPreview(null)
    } else {
      fileInputRef.current?.click()
    }
  }

  const handlePhotoUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (file) {
      // Max 5MB kontrolÃ¼
      if (file.size > 5 * 1024 * 1024) {
        alert('Resim boyutu 5MB\'dan kÃ¼Ã§Ã¼k olmalÄ±dÄ±r')
        return
      }
      
      setPhotoFile(file)
      const reader = new FileReader()
      reader.onloadend = () => {
        setPhotoPreview(reader.result as string)
      }
      reader.readAsDataURL(file)
    }
  }

  const calculatePoints = () => {
    let points = 5 // Temel puan
    
    if (formData.hasPhoto) points += 10
    if (locationData) points += 5
    if (formData.category) points += 3
    
    return points
  }

  const handleSubmit = async () => {
    if (!locationData) {
      alert('LÃ¼tfen konum seÃ§in')
      return
    }

    if (!formData.description.trim()) {
      alert('LÃ¼tfen ne gÃ¶rdÃ¼ÄŸÃ¼nÃ¼zÃ¼ yazÄ±n')
      return
    }

    setLoading(true)

    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) {
        router.push('/login?redirect=/')
        return
      }

      let photoUrl = null
      
      // 1. FotoÄŸraf yÃ¼kle
      if (photoFile) {
        const fileExt = photoFile.name.split('.').pop()
        const fileName = `${user.id}/sightings/${Date.now()}.${fileExt}`
        
        const { error: uploadError } = await supabase.storage
          .from('spot-images')
          .upload(fileName, photoFile)
        
        if (uploadError) throw uploadError
        
        const { data: { publicUrl } } = supabase.storage
          .from('spot-images')
          .getPublicUrl(fileName)
        
        photoUrl = publicUrl
      }

      // 2. Quick sighting oluÅŸtur
      const { data: sighting, error: sightingError } = await supabase
        .from('quick_sightings')
        .insert({
          user_id: user.id,
          description: formData.description,
          category: formData.category,
          has_photo: formData.hasPhoto,
          photo_url: photoUrl,
          location_name: locationData.name,
          address: locationData.address,
          latitude: locationData.latitude,
          longitude: locationData.longitude,
          city: locationData.city,
          district: locationData.district,
          points_earned: calculatePoints(),
          status: 'active'
        })
        .select()
        .single()

      if (sightingError) throw sightingError

      // 3. Puan ekle (gamification)
      await supabase.rpc('add_user_points', {
        user_id: user.id,
        points_to_add: calculatePoints(),
        activity_type: 'quick_sighting'
      })

      // 4. Badge kontrolÃ¼ (ilk sighting)
      const { data: reputation } = await supabase
        .from('user_reputation')
        .select('total_sightings')
        .eq('user_id', user.id)
        .single()

      if (reputation?.total_sightings === 1) {
        await supabase.rpc('award_badge', {
          user_id: user.id,
          badge_id: 'first_sighting'
        })
      }

      // 5. Ana sayfada gÃ¶sterilmek Ã¼zere global state'e ekle
      // (Real-time iÃ§in Supabase Realtime kullanÄ±labilir)
      
      // 6. Social feed'e ekle (opsiyonel)
      if (process.env.NEXT_PUBLIC_ENABLE_SOCIAL === 'true') {
        await supabase.from('social_posts').insert({
          user_id: user.id,
          type: 'sighting',
          caption: `"${formData.description}" gÃ¶rdÃ¼m!`,
          location: locationData.name,
          image_urls: photoUrl ? [photoUrl] : [],
          hashtags: ['#nadirgÃ¶rdÃ¼m', '#spotitforme']
        })
      }

      // BaÅŸarÄ± mesajÄ±
      alert(`ğŸ‰ Bildiriminiz kaydedildi! ${calculatePoints()} puan kazandÄ±nÄ±z.`)
      
      // Formu sÄ±fÄ±rla
      setFormData({ description: '', category: '', hasPhoto: false })
      setLocationData(null)
      setPhotoFile(null)
      setPhotoPreview(null)
      
      onClose()
      if (onSuccess) onSuccess()
      
      // SayfayÄ± yenile
      router.refresh()

    } catch (error: any) {
      console.error('Bildirim hatasÄ±:', error)
      alert(`Hata: ${error.message}`)
    } finally {
      setLoading(false)
    }
  }

  if (!isOpen) return null

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto">
        {/* Header */}
        <div className="sticky top-0 bg-white border-b p-6 z-10">
          <div className="flex items-center justify-between">
            <div>
              <h2 className="text-2xl font-bold text-gray-900">ğŸ‘ï¸ Nadir GÃ¶rdÃ¼m!</h2>
              <p className="text-gray-600">HÄ±zlÄ±ca bildirim gÃ¶nder, puan kazan</p>
            </div>
            <button
              onClick={onClose}
              className="text-gray-500 hover:text-gray-700 text-2xl"
            >
              Ã—
            </button>
          </div>
        </div>

        {/* Form */}
        <div className="p-6 space-y-6">
          {/* AÃ§Ä±klama */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Ne gÃ¶rdÃ¼nÃ¼z? *
            </label>
            <textarea
              value={formData.description}
              onChange={(e) => setFormData({...formData, description: e.target.value})}
              placeholder="Ã–rn: Vintage Nikon F2 kamera, eski Rolex saat, antika Hereke halÄ±sÄ±..."
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              rows={3}
              required
            />
          </div>

          {/* KONUM SEÃ‡Ä°CÄ° */}
          <LocationSelector 
            onLocationSelect={handleLocationSelect}
            initialLocation=""
          />

          {/* Kategori */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Kategori
            </label>
            <select
              value={formData.category}
              onChange={(e) => setFormData({...formData, category: e.target.value})}
              className="w-full px-4 py-3 border border-gray-300 rounded-lg"
            >
              <option value="">Kategori seÃ§in (opsiyonel)</option>
              <option value="electronics">Elektronik</option>
              <option value="fashion">Giyim & Aksesuar</option>
              <option value="home">Ev & BahÃ§e</option>
              <option value="collectible">Koleksiyon</option>
              <option value="vehicle">AraÃ§ & ParÃ§a</option>
              <option value="other">DiÄŸer</option>
            </select>
          </div>

          {/* FOTOÄRAF BÃ–LÃœMÃœ */}
          <div className="space-y-3">
            <div className="flex items-center space-x-3">
              <input
                type="checkbox"
                checked={formData.hasPhoto}
                onChange={(e) => handlePhotoToggle(e.target.checked)}
                className="w-4 h-4 text-green-600"
                id="hasPhoto"
              />
              <label htmlFor="hasPhoto" className="text-sm font-medium text-gray-700">
                ğŸ“¸ FotoÄŸrafÄ±m var (+10 ekstra puan!)
              </label>
            </div>

            {formData.hasPhoto && (
              <div className="mt-3">
                {photoPreview ? (
                  <div className="relative">
                    <img
                      src={photoPreview}
                      alt="Preview"
                      className="w-full h-48 object-cover rounded-lg border-2 border-green-200"
                    />
                    <button
                      type="button"
                      onClick={() => {
                        setPhotoFile(null)
                        setPhotoPreview(null)
                      }}
                      className="absolute top-2 right-2 bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center"
                    >
                      Ã—
                    </button>
                  </div>
                ) : (
                  <div
                    onClick={() => fileInputRef.current?.click()}
                    className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-green-400 transition"
                  >
                    <div className="text-4xl mb-2">ğŸ“¸</div>
                    <p className="font-medium">FotoÄŸraf yÃ¼klemek iÃ§in tÄ±kla</p>
                    <p className="text-sm text-gray-500 mt-1">
                      ÃœrÃ¼nÃ¼n net fotoÄŸrafÄ±nÄ± Ã§ek, daha hÄ±zlÄ± bulunsun
                    </p>
                  </div>
                )}
                
                <input
                  type="file"
                  ref={fileInputRef}
                  accept="image/*"
                  onChange={handlePhotoUpload}
                  className="hidden"
                  capture="environment"
                />

                <p className="text-xs text-gray-500 mt-2">
                  âœ“ FotoÄŸraflÄ± bildirimler 2x daha hÄ±zlÄ± bulunuyor<br />
                  âœ“ Max 5MB â€¢ PNG, JPG, JPEG, WebP
                </p>
              </div>
            )}
          </div>

          {/* PUAN HESAPLA */}
          <div className="bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg">
            <div className="flex items-center justify-between">
              <div>
                <p className="font-medium text-green-800">ğŸ¯ Toplam KazanacaÄŸÄ±nÄ±z Puan:</p>
                <div className="text-2xl font-bold text-green-600 mt-1">
                  {calculatePoints()} PUAN
                </div>
              </div>
              <div className="text-3xl">ğŸ†</div>
            </div>
            <div className="text-sm text-green-700 mt-2 space-y-1">
              <div className="flex justify-between">
                <span>Temel bildirim:</span>
                <span className="font-medium">5 puan</span>
              </div>
              {formData.hasPhoto && (
                <div className="flex justify-between">
                  <span>FotoÄŸraf:</span>
                  <span className="font-medium">+10 puan</span>
                </div>
              )}
              {locationData && (
                <div className="flex justify-between">
                  <span>DetaylÄ± konum:</span>
                  <span className="font-medium">+5 puan</span>
                </div>
              )}
              {formData.category && (
                <div className="flex justify-between">
                  <span>Kategori:</span>
                  <span className="font-medium">+3 puan</span>
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Footer */}
        <div className="sticky bottom-0 bg-white border-t p-6">
          <button
            onClick={handleSubmit}
            disabled={loading || !locationData || !formData.description.trim()}
            className="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition"
          >
            {loading ? (
              <span className="flex items-center justify-center">
                <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>
                GÃ¶nderiliyor...
              </span>
            ) : !locationData ? (
              'ğŸ“ Konum SeÃ§in'
            ) : (
              `Bildir ve ${calculatePoints()} Puan Kazan!`
            )}
          </button>
          
          <p className="text-center text-gray-500 text-sm mt-3">
            Bildiriminiz profil sayfanÄ±zda ve ana sayfada gÃ¶rÃ¼necek
          </p>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/RecentSightings.tsx
ğŸ“Š 189 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/RecentSightings.tsx - GÃœNCELLENMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase' // ESKÄ° VERSÄ°YONU KULLAN
import { MapPin, Camera, Award } from 'lucide-react'

interface RecentSightingsProps {
  initialSightings?: any[] // Opsiyonel: Server'dan gelebilir
}

export default function RecentSightings({ initialSightings = [] }: RecentSightingsProps) {
  const router = useRouter()
  const [sightings, setSightings] = useState<any[]>(initialSightings)
  const [loading, setLoading] = useState(!initialSightings.length)
  const [showAll, setShowAll] = useState(false)

  useEffect(() => {
    if (!initialSightings.length) {
      fetchSightings()
    }
  }, [])

  const fetchSightings = async () => {
    try {
      const { data } = await supabase
        .from('quick_sightings')
        .select(`
          *,
          user:user_profiles(name, avatar_url)
        `)
        .eq('status', 'active')
        .order('created_at', { ascending: false })
        .limit(6)
      
      setSightings(data || [])
    } catch (error) {
      console.error('Sightings yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const displaySightings = showAll ? sightings : sightings.slice(0, 4)

  if (loading) {
    return (
      <section className="py-12 bg-white">
        <div className="container-custom">
          <h2 className="text-3xl font-bold text-gray-900 mb-8">ğŸ‘ï¸ Son GÃ¶rÃ¼lenler</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            {[...Array(4)].map((_, i) => (
              <div key={i} className="animate-pulse bg-gray-100 rounded-xl h-64"></div>
            ))}
          </div>
        </div>
      </section>
    )
  }

  if (sightings.length === 0) {
    return null // HiÃ§ sighting yoksa gÃ¶zÃ¼kmesin
  }

  return (
    <section className="py-12 bg-white">
      <div className="container-custom">
        <div className="flex items-center justify-between mb-8">
          <div>
            <h2 className="text-3xl font-bold text-gray-900 mb-2">
              ğŸ‘ï¸ Son GÃ¶rÃ¼lenler
            </h2>
            <p className="text-gray-600">
              TopluluÄŸumuzun en son gÃ¶rdÃ¼ÄŸÃ¼ nadir Ã¼rÃ¼nler
            </p>
          </div>
          
          {sightings.length > 4 && (
            <button
              onClick={() => setShowAll(!showAll)}
              className="text-blue-600 hover:text-blue-800 font-medium"
            >
              {showAll ? 'Daha Az GÃ¶ster' : `TÃ¼mÃ¼nÃ¼ GÃ¶r (${sightings.length})`}
            </button>
          )}
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {displaySightings.map((sighting) => (
            <div
              key={sighting.id}
              className="bg-gray-50 rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow duration-300 cursor-pointer"
              onClick={() => router.push(`/sightings/${sighting.id}`)}
            >
              {/* FotoÄŸraf */}
              <div className="h-48 relative bg-gray-100">
                {sighting.photo_url ? (
                  <img
                    src={sighting.photo_url}
                    alt={sighting.description}
                    className="w-full h-full object-cover"
                  />
                ) : (
                  <div className="w-full h-full flex items-center justify-center">
                    <div className="text-center">
                      <Camera className="w-12 h-12 text-gray-400 mx-auto mb-2" />
                      <p className="text-sm text-gray-500">FotoÄŸraf Yok</p>
                    </div>
                  </div>
                )}
                
                {/* Puan badge */}
                <div className="absolute top-3 right-3">
                  <div className="bg-green-600 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center">
                    <Award className="w-3 h-3 mr-1" />
                    +{sighting.points_earned}
                  </div>
                </div>
              </div>

              {/* Ä°Ã§erik */}
              <div className="p-4">
                <p className="font-medium text-gray-900 line-clamp-2 mb-3">
                  {sighting.description}
                </p>
                
                {/* Konum */}
                <div className="flex items-center text-sm text-gray-600 mb-3">
                  <MapPin className="w-4 h-4 mr-1 flex-shrink-0" />
                  <span className="truncate">{sighting.location_name}</span>
                </div>
                
                {/* KullanÄ±cÄ± */}
                <div className="flex items-center justify-between">
                  <div className="flex items-center">
                    <div className="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold mr-2">
                      {sighting.user?.name?.[0] || 'K'}
                    </div>
                    <span className="text-sm text-gray-700">
                      {sighting.user?.name || 'KullanÄ±cÄ±'}
                    </span>
                  </div>
                  
                  <span className="text-blue-600 text-sm font-medium">
                    Detay â†’
                  </span>
                </div>
                
                {/* Kategori */}
                {sighting.category && (
                  <div className="mt-3">
                    <span className="inline-block bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded">
                      {sighting.category}
                    </span>
                  </div>
                )}
              </div>
            </div>
          ))}
        </div>

        {/* Ben de arÄ±yorum CTA */}
        <div className="mt-10 bg-gradient-to-r from-blue-50 to-blue-100 rounded-2xl p-8 text-center">
          <h3 className="text-xl font-bold text-gray-900 mb-3">
            Bu Ã¼rÃ¼nlerden birini siz de mi arÄ±yorsunuz?
          </h3>
          <p className="text-gray-700 mb-6">
            "Ben de arÄ±yorum" deyin, spot oluÅŸturalÄ±m ve bulalÄ±m!
          </p>
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <button
              onClick={() => router.push('/create-spot')}
              className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg"
            >
              Spot OluÅŸtur
            </button>
            <button
              onClick={() => router.push('/recent-sightings')}
              className="bg-white hover:bg-gray-100 text-gray-800 font-bold py-3 px-8 rounded-lg border"
            >
              TÃ¼m GÃ¶rÃ¼lenleri Ä°ncele
            </button>
          </div>
        </div>
      </div>
    </section>
  )
}

ğŸ“„ components/RecentSpots.tsx
ğŸ“Š 119 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/RecentSpots.tsx - GÃœNCELLENMÄ°Å
'use client';

import { useEffect, useState } from 'react';
import { supabase } from '@/lib/supabase';
import SpotCard from './SpotCard';
import NativeAd from './NativeAd';

export default function RecentSpots() {
  const [spots, setSpots] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadSpots();
  }, []);

  const loadSpots = async () => {
    const { data, error } = await supabase
      .from('spots')
      .select('*')
      .eq('status', 'active')
      .order('created_at', { ascending: false })
      .limit(9); // 9 spot + reklamlar

    if (error) {
      console.error('Error loading recent spots:', error);
      return;
    }

    setSpots(data || []);
    setLoading(false);
  };

  // Spotlar ve reklamlarÄ± karÄ±ÅŸtÄ±r
  const getMixedItems = () => {
    const items: any[] = [];
    
    // Ä°lk 3 spot
    items.push(...spots.slice(0, 3).map(spot => ({
      type: 'spot',
      data: spot,
      key: `spot-${spot.id}`
    })));
    
    // Ä°lk reklam
    items.push({
      type: 'ad',
      key: 'ad-1',
      index: 3
    });
    
    // Sonraki 3 spot
    items.push(...spots.slice(3, 6).map(spot => ({
      type: 'spot',
      data: spot,
      key: `spot-${spot.id}`
    })));
    
    // Ä°kinci reklam
    items.push({
      type: 'ad',
      key: 'ad-2',
      index: 6
    });
    
    // Son 3 spot
    items.push(...spots.slice(6, 9).map(spot => ({
      type: 'spot',
      data: spot,
      key: `spot-${spot.id}`
    })));
    
    return items;
  };

  const mixedItems = getMixedItems();

  if (loading) {
    return (
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {[...Array(6)].map((_, i) => (
          <div key={i} className="bg-gray-100 animate-pulse rounded-xl h-64"></div>
        ))}
      </div>
    );
  }

  return (
    <section className="py-12">
      <div className="flex justify-between items-center mb-8">
        <h2 className="text-2xl md:text-3xl font-bold text-gray-900">
          Yeni Eklenen Spot'lar
        </h2>
        <a
          href="/spots"
          className="text-blue-600 hover:text-blue-800 font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </a>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {mixedItems.map((item) => {
          if (item.type === 'spot') {
            return (
              <SpotCard key={item.key} spot={item.data} />
            );
          } else {
            return (
              <div key={item.key} className="col-span-full md:col-span-2 lg:col-span-3">
                <NativeAd index={item.index} />
              </div>
            );
          }
        })}
      </div>
    </section>
  );
}

ğŸ“„ components/ResponsiveAd.tsx
ğŸ“Š 117 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ResponsiveAd.tsx - SABÄ°T Ã–LÃ‡ÃœLER
'use client';

import { useState, useEffect } from 'react';

interface ResponsiveAdProps {
  placement: 'inline' | 'banner' | 'native';
  className?: string;
}

export default function ResponsiveAd({ 
  placement, 
  className = ''
}: ResponsiveAdProps) {
  const [isMobile, setIsMobile] = useState(false);
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
    const checkMobile = () => {
      setIsMobile(window.innerWidth < 768);
    };
    
    checkMobile();
    window.addEventListener('resize', checkMobile);
    
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  if (!mounted) {
    return (
      <div className={`${className} bg-gray-100 animate-pulse rounded`}>
        <div className="h-full flex items-center justify-center">
          <span className="text-gray-400 text-sm">Reklam yÃ¼kleniyor...</span>
        </div>
      </div>
    );
  }

  // Sabit Ã¶lÃ§Ã¼ler belirle
  const getAdConfig = () => {
    if (isMobile) {
      return {
        height: placement === 'banner' ? 'h-16' : 'h-48',
        width: 'w-full',
        textSize: 'text-sm',
        label: placement === 'banner' ? 'MOBÄ°L BANNER' : 'MOBÄ°L REKLAM',
        dimensions: placement === 'banner' ? '320Ã—50' : '300Ã—250',
        bgColor: placement === 'banner' ? 'bg-gradient-to-r from-blue-50 to-cyan-50' : 'bg-gradient-to-br from-blue-50 to-purple-50'
      };
    } else {
      return {
        height: placement === 'banner' ? 'h-20' : 'h-40',
        width: 'w-full',
        textSize: 'text-base',
        label: placement === 'banner' ? 'DESKTOP BANNER' : 'DESKTOP REKLAM',
        dimensions: placement === 'banner' ? '728Ã—90' : '728Ã—90',
        bgColor: placement === 'banner' ? 'bg-gradient-to-r from-blue-100 to-indigo-100' : 'bg-gradient-to-br from-blue-100 to-purple-100'
      };
    }
  };

  const config = getAdConfig();

  return (
    <div className={`${className} ${config.width}`}>
      <div className={`
        text-center
        ${config.bgColor}
        border-2 border-dashed ${isMobile ? 'border-blue-200' : 'border-blue-300'}
        rounded-lg
        overflow-hidden
        relative
      `}>
        {/* Reklam etiketi - kÃ¶ÅŸede */}
        <div className={`absolute top-2 left-2 ${isMobile ? 'text-[10px]' : 'text-xs'} bg-blue-600 text-white px-2 py-1 rounded`}>
          REKLAM
        </div>
        
        {/* Platform etiketi - diÄŸer kÃ¶ÅŸede */}
        <div className={`absolute top-2 right-2 ${isMobile ? 'text-[10px]' : 'text-xs'} bg-gray-700 text-white px-2 py-1 rounded`}>
          {isMobile ? 'ğŸ“±' : 'ğŸ’»'}
        </div>
        
        {/* Ana reklam alanÄ± */}
        <div className={`
          ${config.height}
          flex flex-col items-center justify-center
          px-4
        `}>
          <div className={`font-bold ${isMobile ? 'text-lg' : 'text-xl'} text-blue-700 mb-1`}>
            {config.label}
          </div>
          <div className={`${isMobile ? 'text-xs' : 'text-sm'} text-blue-600 mb-2`}>
            {config.dimensions}
          </div>
          <div className={`${isMobile ? 'text-xs' : 'text-sm'} text-gray-600`}>
            {isMobile 
              ? 'Mobil uyumlu reklam alanÄ±' 
              : 'Desktop uyumlu reklam alanÄ±'}
          </div>
        </div>
        
        {/* Alt bilgi */}
        <div className={`
          ${isMobile ? 'py-1' : 'py-2'}
          bg-white/50
          border-t ${isMobile ? 'border-blue-100' : 'border-blue-200'}
        `}>
          <div className={`${isMobile ? 'text-[10px]' : 'text-xs'} text-gray-500`}>
            SpotItForMe - Reklam AlanÄ±
          </div>
        </div>
      </div>
    </div>
  );
}

ğŸ“„ components/SearchFilters.tsx
ğŸ“Š 264 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SearchFilters.tsx
'use client'

import { useState, useEffect } from 'react'
import { useRouter, useSearchParams } from 'next/navigation'

interface FilterState {
  category: string
  location: string
  status: string
  sortBy: string
  minPrice: string
  maxPrice: string
  dateRange: string
}

export default function SearchFilters() {
  const router = useRouter()
  const searchParams = useSearchParams()
  
  const [filters, setFilters] = useState<FilterState>({
    category: searchParams.get('category') || 'all',
    location: searchParams.get('location') || 'all',
    status: searchParams.get('status') || 'all',
    sortBy: searchParams.get('sort') || 'newest',
    minPrice: searchParams.get('minPrice') || '',
    maxPrice: searchParams.get('maxPrice') || '',
    dateRange: searchParams.get('dateRange') || 'all'
  })

  const [showAdvanced, setShowAdvanced] = useState(false)

  // URL deÄŸiÅŸtiÄŸinde state'i gÃ¼ncelle
  useEffect(() => {
    setFilters({
      category: searchParams.get('category') || 'all',
      location: searchParams.get('location') || 'all',
      status: searchParams.get('status') || 'all',
      sortBy: searchParams.get('sort') || 'newest',
      minPrice: searchParams.get('minPrice') || '',
      maxPrice: searchParams.get('maxPrice') || '',
      dateRange: searchParams.get('dateRange') || 'all'
    })
  }, [searchParams])

  const categories = [
    'Elektronik', 'Giyim & Aksesuar', 'Ev & BahÃ§e',
    'Koleksiyon', 'Kitap & MÃ¼zik', 'Oyuncak & Oyun',
    'Spor & Outdoor', 'AraÃ§ & ParÃ§a', 'DiÄŸer'
  ]

  const locations = [
    'Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya',
    'Adana', 'Konya', 'Trabzon', 'TÃ¼rkiye Geneli', 'Yurt DÄ±ÅŸÄ±'
  ]

  const applyFilters = () => {
    const params = new URLSearchParams()
    
    if (filters.category !== 'all') params.set('category', filters.category)
    if (filters.location !== 'all') params.set('location', filters.location)
    if (filters.status !== 'all') params.set('status', filters.status)
    if (filters.sortBy !== 'newest') params.set('sort', filters.sortBy)
    if (filters.minPrice) params.set('minPrice', filters.minPrice)
    if (filters.maxPrice) params.set('maxPrice', filters.maxPrice)
    if (filters.dateRange !== 'all') params.set('dateRange', filters.dateRange)

    // URL'i gÃ¼ncelle (sayfa yenileme olmadan)
    router.push(`/spots?${params.toString()}`)
  }

  const handleInputChange = (key: keyof FilterState, value: string) => {
    setFilters(prev => ({
      ...prev,
      [key]: value
    }))
    
    // AnÄ±nda filtreleme (debounce eklenebilir)
    const params = new URLSearchParams(searchParams.toString())
    if (value && value !== 'all' && value !== '') {
      params.set(key, value)
    } else {
      params.delete(key)
    }
    
    // BazÄ± filtreler iÃ§in anÄ±nda uygula
    if (['category', 'location', 'status'].includes(key)) {
      router.push(`/spots?${params.toString()}`)
    }
  }

  const resetFilters = () => {
    setFilters({
      category: 'all',
      location: 'all',
      status: 'all',
      sortBy: 'newest',
      minPrice: '',
      maxPrice: '',
      dateRange: 'all'
    })
    router.push('/spots')
  }

  return (
    <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
      <div className="flex items-center justify-between mb-6">
        <h3 className="text-lg font-bold text-gray-900">Filtrele</h3>
        <button
          onClick={() => setShowAdvanced(!showAdvanced)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          {showAdvanced ? 'Basit GÃ¶rÃ¼nÃ¼m' : 'GeliÅŸmiÅŸ Filtreler'}
        </button>
      </div>

      {/* Temel Filtreler */}
      <div className="grid md:grid-cols-3 gap-6 mb-6">
        {/* Kategori */}
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-2">
            Kategori
          </label>
          <select
            value={filters.category}
            onChange={(e) => handleInputChange('category', e.target.value)}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          >
            <option value="all">TÃ¼m Kategoriler</option>
            {categories.map((cat) => (
              <option key={cat} value={cat}>
                {cat}
              </option>
            ))}
          </select>
        </div>

        {/* Konum */}
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-2">
            Konum
          </label>
          <select
            value={filters.location}
            onChange={(e) => handleInputChange('location', e.target.value)}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          >
            <option value="all">TÃ¼m Konumlar</option>
            {locations.map((loc) => (
              <option key={loc} value={loc}>
                {loc}
              </option>
            ))}
          </select>
        </div>

        {/* Durum */}
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-2">
            Durum
          </label>
          <select
            value={filters.status}
            onChange={(e) => handleInputChange('status', e.target.value)}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          >
            <option value="all">TÃ¼m Durumlar</option>
            <option value="active">Aktif</option>
            <option value="found">Bulundu</option>
            <option value="urgent">Acil</option>
          </select>
        </div>
      </div>

      {/* GeliÅŸmiÅŸ Filtreler */}
      {showAdvanced && (
        <div className="border-t pt-6 mb-6">
          <div className="grid md:grid-cols-4 gap-6">
            {/* SÄ±ralama */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                SÄ±rala
              </label>
              <select
                value={filters.sortBy}
                onChange={(e) => setFilters({...filters, sortBy: e.target.value})}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg"
              >
                <option value="newest">En Yeni</option>
                <option value="oldest">En Eski</option>
                <option value="most_viewed">En Ã‡ok GÃ¶rÃ¼ntÃ¼lenen</option>
                <option value="most_helped">En Ã‡ok YardÄ±m Alan</option>
              </select>
            </div>

            {/* Fiyat AralÄ±ÄŸÄ± */}
            <div className="md:col-span-2">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Fiyat AralÄ±ÄŸÄ± (TL)
              </label>
              <div className="flex space-x-4">
                <input
                  type="number"
                  placeholder="Min"
                  value={filters.minPrice}
                  onChange={(e) => setFilters({...filters, minPrice: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                />
                <input
                  type="number"
                  placeholder="Max"
                  value={filters.maxPrice}
                  onChange={(e) => setFilters({...filters, maxPrice: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                />
              </div>
            </div>

            {/* Tarih AralÄ±ÄŸÄ± */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Zaman AralÄ±ÄŸÄ±
              </label>
              <select
                value={filters.dateRange}
                onChange={(e) => setFilters({...filters, dateRange: e.target.value})}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg"
              >
                <option value="all">TÃ¼m Zamanlar</option>
                <option value="today">BugÃ¼n</option>
                <option value="week">Bu Hafta</option>
                <option value="month">Bu Ay</option>
                <option value="3months">Son 3 Ay</option>
              </select>
            </div>
          </div>
        </div>
      )}

      {/* Butonlar */}
      <div className="flex justify-between items-center pt-6 border-t">
        <button
          onClick={resetFilters}
          className="text-gray-600 hover:text-gray-800 font-medium flex items-center"
        >
          <span className="mr-2">ğŸ—‘ï¸</span>
          TÃ¼m Filtreleri Temizle
        </button>
        
        <div className="flex space-x-4">
          {(showAdvanced || filters.minPrice || filters.maxPrice || filters.dateRange !== 'all' || filters.sortBy !== 'newest') && (
            <button
              onClick={applyFilters}
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-lg flex items-center"
            >
              <span className="mr-2">ğŸ”</span>
              Filtrele
            </button>
          )}
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/shop/ActiveSearches.tsx
ğŸ“Š 210 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ActiveSearches.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import Link from 'next/link'

interface ActiveSearchesProps {
  shopId: string
  showCreateButton?: boolean
  limit?: number
}

export default function ActiveSearches({ 
  shopId, 
  showCreateButton = true,
  limit = 6 
}: ActiveSearchesProps) {
  const [searches, setSearches] = useState<any[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchActiveSearches()
  }, [shopId])

  const fetchActiveSearches = async () => {
    try {
      const { data, error } = await supabase
        .from('shop_searches')
        .select('*')
        .eq('shop_id', shopId)
        .eq('status', 'active')
        .order('priority_level', { ascending: false })
        .order('created_at', { ascending: false })
        .limit(limit)

      if (error) throw error
      setSearches(data || [])
    } catch (error) {
      console.error('Aramalar yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getPriorityColor = (level: number) => {
    switch(level) {
      case 1: return 'bg-gray-100 text-gray-800'
      case 2: return 'bg-blue-100 text-blue-800'
      case 3: return 'bg-green-100 text-green-800'
      case 4: return 'bg-orange-100 text-orange-800'
      case 5: return 'bg-red-100 text-red-800'
      default: return 'bg-gray-100 text-gray-800'
    }
  }

  const getPriorityText = (level: number) => {
    switch(level) {
      case 1: return 'Ã‡ok DÃ¼ÅŸÃ¼k'
      case 2: return 'DÃ¼ÅŸÃ¼k'
      case 3: return 'Normal'
      case 4: return 'YÃ¼ksek'
      case 5: return 'Ã‡ok YÃ¼ksek'
      default: return 'BelirtilmemiÅŸ'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse space-y-4">
          <div className="h-6 bg-gray-200 rounded w-1/4"></div>
          {[...Array(3)].map((_, i) => (
            <div key={i} className="h-20 bg-gray-200 rounded-lg"></div>
          ))}
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow-lg">
      <div className="p-6 border-b">
        <div className="flex items-center justify-between">
          <div>
            <h3 className="text-lg font-bold text-gray-900">ğŸ” Aktif Aramalar</h3>
            <p className="text-sm text-gray-600">{searches.length} aktif arama</p>
          </div>
          {showCreateButton && (
            <Link
              href={`/shop/${shopId}/searches/new`}
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg text-sm"
            >
              + Yeni Arama
            </Link>
          )}
        </div>
      </div>

      {searches.length === 0 ? (
        <div className="p-8 text-center">
          <div className="text-4xl mb-4">ğŸ”</div>
          <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z aktif aramanÄ±z yok</h4>
          <p className="text-gray-600 mb-6">AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nleri listeleyin, otomatik eÅŸleÅŸmeleri bulalÄ±m</p>
          {showCreateButton && (
            <Link
              href={`/shop/${shopId}/searches/new`}
              className="btn-primary inline-block"
            >
              Ä°lk AramayÄ± OluÅŸturun
            </Link>
          )}
        </div>
      ) : (
        <div className="divide-y divide-gray-100">
          {searches.map((search) => (
            <div key={search.id} className="p-6 hover:bg-gray-50">
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <div className="flex items-center space-x-3 mb-2">
                    <span className={`px-3 py-1 rounded-full text-xs font-medium ${getPriorityColor(search.priority_level)}`}>
                      {getPriorityText(search.priority_level)}
                    </span>
                    <span className="text-sm text-gray-500">
                      {search.match_count || 0} eÅŸleÅŸme
                    </span>
                  </div>
                  
                  <h4 className="font-bold text-gray-900 mb-1">{search.title}</h4>
                  
                  {search.description && (
                    <p className="text-gray-600 text-sm line-clamp-2 mb-3">
                      {search.description}
                    </p>
                  )}

                  <div className="flex flex-wrap items-center gap-3 text-sm text-gray-500">
                    {search.category && (
                      <span className="bg-gray-100 px-2 py-1 rounded">
                        {search.category}
                      </span>
                    )}
                    {search.brand && (
                      <span className="flex items-center">
                        <span className="mr-1">ğŸ·ï¸</span>
                        {search.brand}
                      </span>
                    )}
                    {(search.min_price || search.max_price) && (
                      <span className="flex items-center">
                        <span className="mr-1">ğŸ’°</span>
                        {search.min_price || 0} - {search.max_price || 'âˆ'} TL
                      </span>
                    )}
                    {search.location && (
                      <span className="flex items-center">
                        <span className="mr-1">ğŸ“</span>
                        {search.location}
                      </span>
                    )}
                  </div>
                </div>

                <Link
                  href={`/shop/${shopId}/searches/${search.id}`}
                  className="ml-4 text-blue-600 hover:text-blue-800 text-sm font-medium whitespace-nowrap"
                >
                  Detay â†’
                </Link>
              </div>

              {/* Progress bar for days left */}
              {search.expire_date && (
                <div className="mt-4">
                  <div className="flex justify-between text-xs mb-1">
                    <span className="text-gray-600">
                      {Math.ceil((new Date(search.expire_date).getTime() - Date.now()) / (1000 * 60 * 60 * 24))} gÃ¼n kaldÄ±
                    </span>
                    <span className="font-medium">Sona eriyor: {new Date(search.expire_date).toLocaleDateString('tr-TR')}</span>
                  </div>
                  <div className="w-full bg-gray-200 rounded-full h-2">
                    <div 
                      className="h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-600"
                      style={{ 
                        width: `${Math.min(100, 
                          (1 - (new Date(search.expire_date).getTime() - Date.now()) / (30 * 24 * 60 * 60 * 1000)) * 100
                        )}%` 
                      }}
                    ></div>
                  </div>
                </div>
              )}
            </div>
          ))}
        </div>
      )}

      {searches.length > 0 && showCreateButton && (
        <div className="p-6 border-t text-center">
          <Link
            href={`/shop/${shopId}/searches`}
            className="text-blue-600 hover:text-blue-800 font-medium"
          >
            TÃ¼m AramalarÄ± GÃ¶r â†’
          </Link>
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/shop/InventoryOverview.tsx
ğŸ“Š 188 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/InventoryOverview.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

interface InventoryOverviewProps {
  shopId: string
}

export default function InventoryOverview({ shopId }: InventoryOverviewProps) {
  const router = useRouter()
  const [inventory, setInventory] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [stats, setStats] = useState({
    active: 0,
    draft: 0,
    outOfStock: 0,
    total: 0
  })

  useEffect(() => {
    fetchInventory()
  }, [shopId])

  const fetchInventory = async () => {
    try {
      const { data } = await supabase
        .from('shop_inventory')
        .select('*')
        .eq('shop_id', shopId)
        .order('created_at', { ascending: false })
        .limit(5)

      const { count: activeCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'active')

      const { count: draftCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'draft')

      const { count: outOfStockCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'out_of_stock')

      const { count: totalCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)

      setInventory(data || [])
      setStats({
        active: activeCount || 0,
        draft: draftCount || 0,
        outOfStock: outOfStockCount || 0,
        total: totalCount || 0
      })
    } catch (error) {
      console.error('Inventory yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getStatusColor = (status: string) => {
    switch(status) {
      case 'active': return 'bg-green-100 text-green-800'
      case 'draft': return 'bg-gray-100 text-gray-800'
      case 'out_of_stock': return 'bg-red-100 text-red-800'
      default: return 'bg-gray-100 text-gray-800'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="space-y-3">
            {[...Array(3)].map((_, i) => (
              <div key={i} className="h-16 bg-gray-200 rounded"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex items-center justify-between mb-6">
        <h3 className="font-bold text-gray-900">ğŸ“¦ Envanter Ã–zeti</h3>
        <button
          onClick={() => router.push(`/shop/${shopId}/inventory`)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </button>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        <div className="text-center p-3 bg-blue-50 rounded-lg">
          <div className="text-xl font-bold text-blue-600">{stats.active}</div>
          <div className="text-sm text-gray-600">Aktif</div>
        </div>
        <div className="text-center p-3 bg-gray-50 rounded-lg">
          <div className="text-xl font-bold text-gray-600">{stats.draft}</div>
          <div className="text-sm text-gray-600">Taslak</div>
        </div>
        <div className="text-center p-3 bg-red-50 rounded-lg">
          <div className="text-xl font-bold text-red-600">{stats.outOfStock}</div>
          <div className="text-sm text-gray-600">Stok Yok</div>
        </div>
        <div className="text-center p-3 bg-green-50 rounded-lg">
          <div className="text-xl font-bold text-green-600">{stats.total}</div>
          <div className="text-sm text-gray-600">Toplam</div>
        </div>
      </div>

      {/* Recent Items */}
      <div className="space-y-3">
        {inventory.length === 0 ? (
          <div className="text-center py-8">
            <div className="text-4xl mb-4">ğŸ“­</div>
            <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z Ã¼rÃ¼n eklenmemiÅŸ</h4>
            <p className="text-gray-600 mb-4">Ä°lk Ã¼rÃ¼nÃ¼nÃ¼zÃ¼ ekleyerek baÅŸlayÄ±n</p>
            <button
              onClick={() => router.push(`/shop/${shopId}/inventory/new`)}
              className="btn-primary"
            >
              Ä°lk ÃœrÃ¼nÃ¼ Ekle
            </button>
          </div>
        ) : (
          <>
            {inventory.map((item) => (
              <div 
                key={item.id}
                className="flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg cursor-pointer"
                onClick={() => router.push(`/shop/${shopId}/inventory/${item.id}`)}
              >
                <div className="flex items-center space-x-3">
                  {item.images && item.images.length > 0 ? (
                    <div className="w-12 h-12 bg-gray-100 rounded-lg overflow-hidden">
                      <img
                        src={item.images[0]}
                        alt={item.title}
                        className="w-full h-full object-cover"
                      />
                    </div>
                  ) : (
                    <div className="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center">
                      <span className="text-gray-400">ğŸ“¦</span>
                    </div>
                  )}
                  
                  <div>
                    <h4 className="font-medium text-gray-900 line-clamp-1">
                      {item.title}
                    </h4>
                    <p className="text-sm text-gray-600">
                      {item.price.toLocaleString('tr-TR')} {item.currency}
                    </p>
                  </div>
                </div>
                
                <span className={`px-2 py-1 rounded text-xs font-medium ${getStatusColor(item.status)}`}>
                  {item.status === 'active' ? 'Aktif' : 
                   item.status === 'draft' ? 'Taslak' : 
                   item.status === 'out_of_stock' ? 'Stok Yok' : item.status}
                </span>
              </div>
            ))}
          </>
        )}
      </div>
    </div>
  )
}

ğŸ“„ components/shop/QuickActions.tsx
ğŸ“Š 109 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/QuickActions.tsx
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { supabase } from '@/lib/supabase';
import { Plus, Search, Share2, BarChart, Loader2 } from 'lucide-react';

interface QuickActionsProps {
  shopId: string;
  onActionComplete?: () => void;
}

export default function QuickActions({ shopId, onActionComplete }: QuickActionsProps) {
  const router = useRouter();
  const [loading, setLoading] = useState<string | null>(null);

  const actions = [
    {
      id: 'add-product',
      title: 'ÃœrÃ¼n Ekle',
      description: 'SatÄ±ÅŸa sunacaÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼ envantere ekleyin',
      icon: <Plus size={24} />,
      color: 'bg-green-100 text-green-700 hover:bg-green-200',
      path: `/shop/${shopId}/inventory/add`
    },
    {
      id: 'create-search',
      title: 'Arama OluÅŸtur',
      description: 'AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nleri belirleyin',
      icon: <Search size={24} />,
      color: 'bg-blue-100 text-blue-700 hover:bg-blue-200',
      path: `/shop/${shopId}/searches/add`
    },
    {
      id: 'create-post',
      title: 'PaylaÅŸÄ±m Yap',
      description: 'MaÄŸazanÄ±zÄ± tanÄ±tan iÃ§erik paylaÅŸÄ±n',
      icon: <Share2 size={24} />,
      color: 'bg-purple-100 text-purple-700 hover:bg-purple-200',
      path: `/shop/${shopId}/social/create`
    },
    {
      id: 'get-report',
      title: 'Rapor Al',
      description: 'Performans raporlarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin',
      icon: <BarChart size={24} />,
      color: 'bg-orange-100 text-orange-700 hover:bg-orange-200',
      path: `/shop/${shopId}/analytics`
    }
  ];

  const handleAction = async (action: typeof actions[0]) => {
    setLoading(action.id);
    
    try {
      // EÄŸer yol varsa yÃ¶nlendir
      if (action.path) {
        router.push(action.path);
      }
      
      // Callback Ã§aÄŸÄ±r
      if (onActionComplete) {
        setTimeout(() => {
          onActionComplete();
        }, 500);
      }
    } catch (error) {
      console.error(`${action.title} iÅŸlemi baÅŸarÄ±sÄ±z:`, error);
      alert(`${action.title} iÅŸlemi sÄ±rasÄ±nda bir hata oluÅŸtu.`);
    } finally {
      setLoading(null);
    }
  };

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">âš¡ HÄ±zlÄ± Eylemler</h3>
          <p className="text-gray-600 text-sm">MaÄŸazanÄ±zÄ± hÄ±zlÄ±ca yÃ¶netin</p>
        </div>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {actions.map((action) => (
          <button
            key={action.id}
            onClick={() => handleAction(action)}
            disabled={loading === action.id}
            className={`p-4 rounded-xl border ${action.color} transition-all duration-200 flex flex-col items-center justify-center h-full min-h-[140px] disabled:opacity-50`}
          >
            <div className="mb-3">
              {loading === action.id ? (
                <Loader2 size={24} className="animate-spin" />
              ) : (
                action.icon
              )}
            </div>
            <div className="text-center">
              <h4 className="font-bold mb-1">{action.title}</h4>
              <p className="text-xs opacity-90">{action.description}</p>
            </div>
          </button>
        ))}
      </div>
    </div>
  );
}

ğŸ“„ components/shop/RecentMatches.tsx
ğŸ“Š 167 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/RecentMatches.tsx - DÃœZELTÄ°LMÄ°Å VERSÄ°YON
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

interface RecentMatchesProps {
  shopId: string
  limit?: number
}

export default function RecentMatches({ shopId, limit = 5 }: RecentMatchesProps) {
  const router = useRouter()
  const [matches, setMatches] = useState<any[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchRecentMatches()
  }, [shopId])

  const fetchRecentMatches = async () => {
    try {
      const { data } = await supabase
        .from('shop_search_matches')
        .select(`
          *,
          search:shop_searches(*),
          inventory:shop_inventory(*),
          spot:spots(*)
        `)
        .eq('search_id', shopId)
        .order('created_at', { ascending: false })
        .limit(limit)

      setMatches(data || [])
    } catch (error) {
      console.error('Recent matches yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getMatchType = (match: any) => {
    if (match.inventory_id) return 'inventory'
    if (match.spot_id) return 'spot'
    return 'unknown'
  }

  const getMatchSource = (match: any) => {
    if (match.inventory) return 'BaÅŸka MaÄŸaza'
    if (match.spot) return 'KullanÄ±cÄ± Spot\'u'
    return 'Bilinmeyen'
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="space-y-3">
            {[...Array(limit)].map((_, i) => (
              <div key={i} className="h-16 bg-gray-200 rounded"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  if (matches.length === 0) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <h3 className="font-bold text-gray-900 mb-6">âœ… Son EÅŸleÅŸmeler</h3>
        <div className="text-center py-8">
          <div className="text-4xl mb-4">ğŸ¤</div>
          <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z eÅŸleÅŸme yok</h4>
          <p className="text-gray-600">
            Arama oluÅŸturduÄŸunuzda eÅŸleÅŸmeler burada gÃ¶rÃ¼necek
          </p>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex items-center justify-between mb-6">
        <h3 className="font-bold text-gray-900">âœ… Son EÅŸleÅŸmeler</h3>
        <button
          onClick={() => router.push(`/shop/${shopId}/matches`)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </button>
      </div>

      <div className="space-y-4">
        {matches.map((match) => (
          <div 
            key={match.id}
            className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"
            onClick={() => {
              if (match.inventory_id) {
                router.push(`/shop/${shopId}/matches/inventory/${match.inventory_id}`)
              } else if (match.spot_id) {
                router.push(`/spots/${match.spot_id}`)
              }
            }}
          >
            <div className="flex-1">
              <div className="flex items-center space-x-3 mb-2">
                <div className={`w-10 h-10 rounded-full flex items-center justify-center ${
                  match.match_score >= 80 ? 'bg-green-100 text-green-600' :
                  match.match_score >= 60 ? 'bg-yellow-100 text-yellow-600' :
                  'bg-blue-100 text-blue-600'
                }`}>
                  {match.match_score >= 80 ? 'ğŸ”¥' :
                   match.match_score >= 60 ? 'âœ…' : 'ğŸ”'}
                </div>
                <div>
                  <h4 className="font-medium text-gray-900">
                    {match.search?.title || 'Arama'}
                  </h4>
                  <p className="text-sm text-gray-600">
                    {getMatchSource(match)} â€¢ %{match.match_score} eÅŸleÅŸme
                  </p>
                </div>
              </div>

              {match.match_reasons && match.match_reasons.length > 0 && (
                <div className="flex flex-wrap gap-2 mt-2">
                  {match.match_reasons.slice(0, 3).map((reason: string, idx: number) => (
                    <span key={idx} className="px-2 py-1 bg-white text-gray-700 text-xs rounded-full border">
                      {reason}
                    </span>
                  ))}
                  {match.match_reasons.length > 3 && (
                    <span className="px-2 py-1 bg-white text-gray-500 text-xs rounded-full border">
                      +{match.match_reasons.length - 3}
                    </span>
                  )}
                </div>
              )}
            </div>

            <div className="text-right">
              <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                match.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :
                match.status === 'notified' ? 'bg-blue-100 text-blue-800' :
                match.status === 'contacted' ? 'bg-green-100 text-green-800' :
                'bg-gray-100 text-gray-800'
              }`}>
                {match.status === 'pending' ? 'Bekliyor' :
                 match.status === 'notified' ? 'Bildirildi' :
                 match.status === 'contacted' ? 'Ä°letiÅŸimde' : match.status}
              </span>
              <div className="text-xs text-gray-500 mt-1">
                {new Date(match.created_at).toLocaleDateString('tr-TR')}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  )
}

ğŸ“„ components/shop/SearchOverview.tsx
ğŸ“Š 242 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/SearchOverview.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

interface SearchOverviewProps {
  shopId: string
}

// Arama verisi tipini tanÄ±mla
interface SearchItem {
  id: string
  title: string
  category?: string
  brand?: string
  min_price?: number
  max_price?: number
  priority_level: number
  status: string
  created_at: string
  matches?: Array<{ count: number }>
}

export default function SearchOverview({ shopId }: SearchOverviewProps) {
  const router = useRouter()
  const [searches, setSearches] = useState<SearchItem[]>([])
  const [stats, setStats] = useState({
    active: 0,
    totalMatches: 0,
    highPriority: 0,
    recentMatches: 0
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchSearchesData()
  }, [shopId])

  const fetchSearchesData = async () => {
    try {
      // Aktif aramalarÄ± getir
      const { data: searchesData, error } = await supabase
        .from('shop_searches')
        .select('*, matches:shop_search_matches(count)')
        .eq('shop_id', shopId)
        .eq('status', 'active')
        .order('priority_level', { ascending: false })
        .order('created_at', { ascending: false })
        .limit(5)

      if (error) throw error

      // Ä°statistikleri hesapla - DÃœZELTÄ°LDÄ°: 's' parametresine tip eklendi
      const activeSearches = searchesData?.length || 0
      const highPriority = searchesData?.filter((s: SearchItem) => s.priority_level >= 4).length || 0
      
      // Toplam eÅŸleÅŸme sayÄ±sÄ±nÄ± hesapla - DÃœZELTÄ°LDÄ°: search_id yerine shop_id kontrol et
      const { count: totalMatchesCount } = await supabase
        .from('shop_search_matches')
        .select('*', { count: 'exact', head: true })
        .eq('search.shop_id', shopId) // DÃ¼zeltildi: search.shop_id kontrolÃ¼

      // Son 7 gÃ¼ndeki eÅŸleÅŸmeler
      const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()
      const { count: recentMatchesCount } = await supabase
        .from('shop_search_matches')
        .select('*', { count: 'exact', head: true })
        .eq('search.shop_id', shopId) // DÃ¼zeltildi: search.shop_id kontrolÃ¼
        .gte('created_at', weekAgo)

      setSearches(searchesData || [])
      setStats({
        active: activeSearches,
        totalMatches: totalMatchesCount || 0,
        highPriority,
        recentMatches: recentMatchesCount || 0
      })
    } catch (error) {
      console.error('Arama verileri yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getPriorityColor = (level: number) => {
    switch(level) {
      case 5: return 'bg-red-100 text-red-800'
      case 4: return 'bg-orange-100 text-orange-800'
      case 3: return 'bg-green-100 text-green-800'
      case 2: return 'bg-blue-100 text-blue-800'
      case 1: return 'bg-gray-100 text-gray-800'
      default: return 'bg-gray-100 text-gray-800'
    }
  }

  const getPriorityText = (level: number) => {
    switch(level) {
      case 5: return 'Ã‡OK ACÄ°L'
      case 4: return 'ACÄ°L'
      case 3: return 'NORMAL'
      case 2: return 'DÃœÅÃœK'
      case 1: return 'Ã‡OK DÃœÅÃœK'
      default: return 'BELÄ°RSÄ°Z'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="h-4 bg-gray-200 rounded w-1/2 mb-6"></div>
          <div className="space-y-4">
            {[...Array(3)].map((_, i) => (
              <div key={i} className="h-16 bg-gray-200 rounded-lg"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      {/* Header */}
      <div className="flex items-center justify-between mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">ğŸ” Aktif Aramalar</h3>
          <p className="text-sm text-gray-600">{stats.active} aktif arama</p>
        </div>
        <button
          onClick={() => router.push(`/shop/${shopId}/searches`)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </button>
      </div>

      {/* Ä°statistikler */}
      <div className="grid grid-cols-2 gap-4 mb-6">
        <div className="bg-blue-50 rounded-lg p-4 text-center">
          <div className="text-2xl font-bold text-blue-700">{stats.active}</div>
          <div className="text-sm text-blue-600">Aktif Arama</div>
        </div>
        <div className="bg-green-50 rounded-lg p-4 text-center">
          <div className="text-2xl font-bold text-green-700">{stats.totalMatches}</div>
          <div className="text-sm text-green-600">Toplam EÅŸleÅŸme</div>
        </div>
        <div className="bg-orange-50 rounded-lg p-4 text-center">
          <div className="text-2xl font-bold text-orange-700">{stats.highPriority}</div>
          <div className="text-sm text-orange-600">Acil Arama</div>
        </div>
        <div className="bg-purple-50 rounded-lg p-4 text-center">
          <div className="text-2xl font-bold text-purple-700">{stats.recentMatches}</div>
          <div className="text-sm text-purple-600">Son 7 GÃ¼n</div>
        </div>
      </div>

      {/* Aramalar Listesi */}
      <div className="space-y-4">
        {searches.length === 0 ? (
          <div className="text-center py-8">
            <div className="text-4xl mb-4">ğŸ”</div>
            <p className="text-gray-600 mb-4">HenÃ¼z aktif aramanÄ±z yok</p>
            <button
              onClick={() => router.push(`/shop/${shopId}/searches/new`)}
              className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
            >
              Ä°lk Arama OluÅŸtur
            </button>
          </div>
        ) : (
          searches.map((search) => (
            <div 
              key={search.id}
              className="border border-gray-200 rounded-lg p-4 hover:border-blue-300 cursor-pointer"
              onClick={() => router.push(`/shop/${shopId}/searches/${search.id}`)}
            >
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <h4 className="font-medium text-gray-900 mb-1 line-clamp-1">
                    {search.title}
                  </h4>
                  <div className="flex items-center space-x-3 text-sm text-gray-600">
                    <span>{search.category}</span>
                    {search.brand && <span>â€¢ {search.brand}</span>}
                    {search.min_price && search.max_price && (
                      <span>â€¢ {search.min_price} - {search.max_price} â‚º</span>
                    )}
                  </div>
                </div>
                
                <div className="flex items-center space-x-3">
                  <div className="text-right">
                    <div className="font-bold text-gray-900">
                      {search.matches?.[0]?.count || 0}
                    </div>
                    <div className="text-xs text-gray-500">eÅŸleÅŸme</div>
                  </div>
                  
                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${getPriorityColor(search.priority_level)}`}>
                    {getPriorityText(search.priority_level)}
                  </span>
                </div>
              </div>
              
              {/* Match progress bar */}
              <div className="mt-3">
                <div className="flex justify-between text-xs mb-1">
                  <span className="text-gray-600">EÅŸleÅŸme oranÄ±</span>
                  <span className="font-medium">
                    {Math.round(((search.matches?.[0]?.count || 0) / 10) * 100)}%
                  </span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div 
                    className="bg-green-500 h-2 rounded-full"
                    style={{ 
                      width: `${Math.min(100, ((search.matches?.[0]?.count || 0) / 10) * 100)}%` 
                    }}
                  ></div>
                </div>
              </div>
            </div>
          ))
        )}
      </div>

      {/* Yeni arama butonu */}
      <div className="mt-6 pt-6 border-t">
        <button
          onClick={() => router.push(`/shop/${shopId}/searches/new`)}
          className="w-full py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-400 hover:text-blue-600"
        >
          + Yeni Arama OluÅŸtur
        </button>
      </div>
    </div>
  )
}

ğŸ“„ components/shop/ShopHeader.tsx
ğŸ“Š 113 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopHeader.tsx
'use client'

interface ShopHeaderProps {
  shop: any
  followersCount: number
  isFollowing: boolean
  onFollowToggle: () => void
  onContact: () => void
  onShare: () => void
}

export default function ShopHeader({
  shop,
  followersCount,
  isFollowing,
  onFollowToggle,
  onContact,
  onShare
}: ShopHeaderProps) {
  return (
    <div className="bg-white rounded-xl shadow-lg overflow-hidden mb-8">
      {/* Cover Image */}
      <div className="h-48 bg-gradient-to-r from-blue-500 to-purple-600 relative">
        {shop.cover_image ? (
          <img 
            src={shop.cover_image} 
            alt="Cover" 
            className="w-full h-full object-cover"
          />
        ) : (
          <div className="w-full h-full flex items-center justify-center">
            <span className="text-white text-4xl opacity-50">ğŸª</span>
          </div>
        )}
        
        {/* Verified Badge */}
        {shop.is_verified && (
          <div className="absolute top-4 right-4 bg-white text-green-600 px-3 py-1 rounded-full text-sm font-medium flex items-center">
            <span className="mr-1">âœ…</span>
            DoÄŸrulanmÄ±ÅŸ MaÄŸaza
          </div>
        )}
      </div>

      {/* Shop Info */}
      <div className="p-6">
        <div className="flex items-start justify-between">
          <div className="flex items-start space-x-6">
            {/* Avatar */}
            <div className="relative -mt-16">
              <div className="w-32 h-32 rounded-2xl border-4 border-white bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-4xl font-bold shadow-lg">
                {shop.shop_name?.[0] || 'M'}
              </div>
            </div>

            {/* Details */}
            <div className="pt-4">
              <h1 className="text-3xl font-bold text-gray-900">{shop.shop_name}</h1>
              <p className="text-gray-600 mt-2">{shop.description || 'AÃ§Ä±klama yok'}</p>
              
              <div className="flex items-center space-x-6 mt-4">
                <div className="flex items-center space-x-2">
                  <span className="text-gray-500">ğŸ“</span>
                  <span>{shop.city || 'Konum belirtilmemiÅŸ'}</span>
                </div>
                <div className="flex items-center space-x-2">
                  <span className="text-gray-500">ğŸ‘¥</span>
                  <span>{followersCount} takipÃ§i</span>
                </div>
                {shop.owner && (
                  <div className="flex items-center space-x-2">
                    <span className="text-gray-500">ğŸ‘¤</span>
                    <span>{shop.owner.name || 'MaÄŸaza sahibi'}</span>
                  </div>
                )}
              </div>
            </div>
          </div>

          {/* Actions */}
          <div className="flex items-center space-x-3">
            <button
              onClick={onFollowToggle}
              className={`px-6 py-3 rounded-lg font-medium ${
                isFollowing
                  ? 'bg-gray-100 text-gray-800 hover:bg-gray-200'
                  : 'bg-blue-600 text-white hover:bg-blue-700'
              }`}
            >
              {isFollowing ? 'âœ“ Takip Ediliyor' : 'ğŸ‘¥ Takip Et'}
            </button>
            
            <button
              onClick={onContact}
              className="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium"
            >
              ğŸ“ Ä°letiÅŸim
            </button>
            
            <button
              onClick={onShare}
              className="p-3 bg-gray-100 hover:bg-gray-200 rounded-lg"
              title="PaylaÅŸ"
            >
              ğŸ“¤
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/shop/ShopSocialFeed.tsx
ğŸ“Š 265 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopSocialFeed.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import Link from 'next/link'

interface ShopSocialFeedProps {
  shopId: string
  limit?: number
  compact?: boolean
}

export default function ShopSocialFeed({ 
  shopId, 
  limit = 9,
  compact = false 
}: ShopSocialFeedProps) {
  const [posts, setPosts] = useState<any[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchSocialPosts()
  }, [shopId])

  const fetchSocialPosts = async () => {
    try {
      const { data, error } = await supabase
        .from('shop_social_posts')
        .select('*')
        .eq('shop_id', shopId)
        .eq('status', 'published')
        .order('publish_at', { ascending: false })
        .limit(limit)

      if (error) throw error
      setPosts(data || [])
    } catch (error) {
      console.error('Sosyal paylaÅŸÄ±mlar yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getPostIcon = (type: string) => {
    switch(type) {
      case 'product_showcase': return 'ğŸ“¦'
      case 'new_arrival': return 'ğŸ†•'
      case 'sale': return 'ğŸ·ï¸'
      case 'behind_scenes': return 'ğŸ¬'
      case 'customer_review': return 'â­'
      case 'looking_for': return 'ğŸ”'
      default: return 'ğŸ“¢'
    }
  }

  const formatDate = (dateString: string) => {
    const date = new Date(dateString)
    const now = new Date()
    const diffDays = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24))
    
    if (diffDays === 0) return 'BugÃ¼n'
    if (diffDays === 1) return 'DÃ¼n'
    if (diffDays < 7) return `${diffDays} gÃ¼n Ã¶nce`
    
    return date.toLocaleDateString('tr-TR', { 
      day: 'numeric', 
      month: 'short' 
    })
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="grid grid-cols-3 gap-3">
            {[...Array(limit)].map((_, i) => (
              <div key={i} className="aspect-square bg-gray-200 rounded-lg"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  if (compact) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="flex items-center justify-between mb-4">
          <h3 className="font-bold text-gray-900">ğŸ“± Son PaylaÅŸÄ±mlar</h3>
          <Link
            href={`/shop/${shopId}/social`}
            className="text-blue-600 hover:text-blue-800 text-sm font-medium"
          >
            TÃ¼mÃ¼ â†’
          </Link>
        </div>

        {posts.length === 0 ? (
          <div className="text-center py-4">
            <p className="text-gray-600">HenÃ¼z paylaÅŸÄ±m yapÄ±lmamÄ±ÅŸ</p>
          </div>
        ) : (
          <div className="grid grid-cols-3 gap-3">
            {posts.slice(0, 6).map((post) => (
              <Link
                key={post.id}
                href={`/shop/${shopId}/social/${post.id}`}
                className="group relative aspect-square rounded-lg overflow-hidden bg-gray-100"
              >
                {post.images && post.images.length > 0 ? (
                  <img
                    src={post.images[0]}
                    alt={post.title || 'Post image'}
                    className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                  />
                ) : (
                  <div className="w-full h-full flex items-center justify-center text-3xl">
                    {getPostIcon(post.type)}
                  </div>
                )}
                
                {/* Overlay */}
                <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-2">
                  <span className="text-white text-xs truncate">
                    {post.title || 'PaylaÅŸÄ±m'}
                  </span>
                </div>
              </Link>
            ))}
          </div>
        )}
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow-lg">
      <div className="p-6 border-b">
        <div className="flex items-center justify-between">
          <div>
            <h3 className="text-lg font-bold text-gray-900">ğŸ“± Sosyal PaylaÅŸÄ±mlar</h3>
            <p className="text-sm text-gray-600">MaÄŸazanÄ±n son aktiviteleri</p>
          </div>
          <Link
            href={`/shop/${shopId}/social/new`}
            className="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-medium py-2 px-4 rounded-lg text-sm"
          >
            + PaylaÅŸÄ±m Yap
          </Link>
        </div>
      </div>

      {posts.length === 0 ? (
        <div className="p-8 text-center">
          <div className="text-4xl mb-4">ğŸ“±</div>
          <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z paylaÅŸÄ±m yok</h4>
          <p className="text-gray-600 mb-6">MaÄŸazanÄ±zÄ±n hikayesini paylaÅŸÄ±n, takipÃ§ilerinizle baÄŸlantÄ± kurun</p>
          <Link
            href={`/shop/${shopId}/social/new`}
            className="btn-primary inline-block"
          >
            Ä°lk PaylaÅŸÄ±mÄ± YapÄ±n
          </Link>
        </div>
      ) : (
        <div className="divide-y divide-gray-100">
          {posts.map((post) => (
            <div key={post.id} className="p-6 hover:bg-gray-50">
              <div className="flex items-start space-x-4">
                {/* Post icon */}
                <div className="w-12 h-12 rounded-xl bg-gradient-to-br from-purple-100 to-pink-100 flex items-center justify-center text-xl">
                  {getPostIcon(post.type)}
                </div>

                {/* Content */}
                <div className="flex-1">
                  <div className="flex items-center justify-between mb-2">
                    <div>
                      <h4 className="font-bold text-gray-900">{post.title}</h4>
                      <div className="flex items-center space-x-3 text-sm text-gray-500">
                        <span>{formatDate(post.publish_at || post.created_at)}</span>
                        {post.like_count > 0 && (
                          <span className="flex items-center">
                            â¤ï¸ {post.like_count}
                          </span>
                        )}
                        {post.comment_count > 0 && (
                          <span className="flex items-center">
                            ğŸ’¬ {post.comment_count}
                          </span>
                        )}
                      </div>
                    </div>
                    <Link
                      href={`/shop/${shopId}/social/${post.id}`}
                      className="text-blue-600 hover:text-blue-800 text-sm font-medium"
                    >
                      GÃ¶rÃ¼ntÃ¼le â†’
                    </Link>
                  </div>

                  {post.content && (
                    <p className="text-gray-700 mb-4 line-clamp-3">
                      {post.content}
                    </p>
                  )}

                  {/* Images */}
                  {post.images && post.images.length > 0 && (
                    <div className="grid grid-cols-3 gap-3 mb-4">
                      {post.images.slice(0, 3).map((image: string, index: number) => (
                        <div
                          key={index}
                          className="aspect-square rounded-lg overflow-hidden bg-gray-100"
                        >
                          <img
                            src={image}
                            alt={`Post image ${index + 1}`}
                            className="w-full h-full object-cover"
                          />
                        </div>
                      ))}
                      {post.images.length > 3 && (
                        <div className="aspect-square rounded-lg bg-gray-800 text-white flex items-center justify-center text-lg font-bold">
                          +{post.images.length - 3}
                        </div>
                      )}
                    </div>
                  )}

                  {/* Hashtags */}
                  {post.hashtags && post.hashtags.length > 0 && (
                    <div className="flex flex-wrap gap-2">
                      {post.hashtags.map((tag: string, index: number) => (
                        <span
                          key={index}
                          className="text-blue-600 hover:text-blue-800 text-sm"
                        >
                          {tag}
                        </span>
                      ))}
                    </div>
                  )}
                </div>
              </div>
            </div>
          ))}
        </div>
      )}

      {posts.length > 0 && (
        <div className="p-6 border-t text-center">
          <Link
            href={`/shop/${shopId}/social`}
            className="text-blue-600 hover:text-blue-800 font-medium"
          >
            TÃ¼m PaylaÅŸÄ±mlarÄ± GÃ¶r â†’
          </Link>
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/shop/ShopStats.tsx
ğŸ“Š 167 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopStats.tsx
'use client'

interface ShopStatsProps {
  stats: {
    totalProducts: number
    activeSearches: number
    totalMatches: number
    pendingMatches: number
    totalFollowers: number
    revenue: number
  }
  shopId: string
}

export default function ShopStats({ stats, shopId }: ShopStatsProps) {
  const formatCurrency = (amount: number) => {
    return new Intl.NumberFormat('tr-TR', {
      style: 'currency',
      currency: 'TRY',
      minimumFractionDigits: 0
    }).format(amount)
  }

  const getGrowthColor = (current: number, previous: number) => {
    if (previous === 0) return 'text-green-600'
    const growth = ((current - previous) / previous) * 100
    if (growth > 20) return 'text-green-600'
    if (growth > 0) return 'text-yellow-600'
    return 'text-red-600'
  }

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {/* ÃœrÃ¼nler */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ“¦</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.totalProducts, stats.totalProducts * 0.9)}`}>
            +12%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.totalProducts}
        </div>
        <div className="text-sm text-gray-600">Aktif ÃœrÃ¼n</div>
        <div className="mt-4 h-2 bg-gray-200 rounded-full">
          <div 
            className="h-2 rounded-full bg-gradient-to-r from-blue-500 to-blue-600"
            style={{ width: `${Math.min(100, (stats.totalProducts / 100) * 100)}%` }}
          ></div>
        </div>
      </div>

      {/* Aramalar */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ”</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.activeSearches, stats.activeSearches * 0.8)}`}>
            +8%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.activeSearches}
        </div>
        <div className="text-sm text-gray-600">Aktif Arama</div>
        <div className="mt-4 h-2 bg-gray-200 rounded-full">
          <div 
            className="h-2 rounded-full bg-gradient-to-r from-green-500 to-green-600"
            style={{ width: `${Math.min(100, (stats.activeSearches / 20) * 100)}%` }}
          ></div>
        </div>
      </div>

      {/* EÅŸleÅŸmeler */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ¤</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.totalMatches, stats.totalMatches * 0.7)}`}>
            +24%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.totalMatches}
        </div>
        <div className="text-sm text-gray-600">Toplam EÅŸleÅŸme</div>
        <div className="mt-4 flex items-center text-sm">
          <span className="text-green-600 font-medium">
            {stats.pendingMatches} yeni
          </span>
          <span className="mx-2 text-gray-400">â€¢</span>
          <span className="text-gray-600">
            {(stats.totalMatches > 0 ? (stats.pendingMatches / stats.totalMatches * 100).toFixed(0) : 0)}% bekliyor
          </span>
        </div>
      </div>

      {/* TakipÃ§iler */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ‘¥</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.totalFollowers, stats.totalFollowers * 0.85)}`}>
            +15%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.totalFollowers}
        </div>
        <div className="text-sm text-gray-600">TakipÃ§i</div>
        <div className="mt-4">
          <div className="flex -space-x-2">
            {[...Array(Math.min(5, stats.totalFollowers))].map((_, i) => (
              <div 
                key={i}
                className="w-8 h-8 rounded-full border-2 border-white bg-gradient-to-br from-purple-400 to-pink-500"
              ></div>
            ))}
            {stats.totalFollowers > 5 && (
              <div className="w-8 h-8 rounded-full border-2 border-white bg-gray-300 flex items-center justify-center text-xs font-medium">
                +{stats.totalFollowers - 5}
              </div>
            )}
          </div>
        </div>
      </div>

      {/* Gelir */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ’°</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.revenue, stats.revenue * 0.6)}`}>
            +42%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {formatCurrency(stats.revenue)}
        </div>
        <div className="text-sm text-gray-600">Toplam Gelir</div>
        <div className="mt-4">
          <div className="text-xs text-gray-500">
            Bu ay: {formatCurrency(stats.revenue * 0.3)}
          </div>
        </div>
      </div>

      {/* DÃ¶nÃ¼ÅŸÃ¼m OranÄ± */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ“Š</div>
          <div className="text-sm font-medium text-green-600">
            +5%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.totalProducts > 0 ? ((stats.totalMatches / stats.totalProducts) * 100).toFixed(1) : '0'}%
        </div>
        <div className="text-sm text-gray-600">DÃ¶nÃ¼ÅŸÃ¼m OranÄ±</div>
        <div className="mt-4">
          <div className="flex items-center text-sm">
            <span className="text-gray-600 mr-2">Hedef:</span>
            <span className="font-medium text-green-600">%25</span>
          </div>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/shop/ShopStatsPublic.tsx
ğŸ“Š 178 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopStatsPublic.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

interface ShopStatsPublicProps {
  shopId: string
}

// Review interface'ini tanÄ±mlayalÄ±m
interface ShopReview {
  rating: number | null
  response_time: number | null
  [key: string]: any // DiÄŸer alanlar iÃ§in
}

interface ShopStats {
  productCount: number
  searchCount: number
  followerCount: number
  matchCount: number
  rating: number
  responseTime: number
}

export default function ShopStatsPublic({ shopId }: ShopStatsPublicProps) {
  const [stats, setStats] = useState<ShopStats>({
    productCount: 0,
    searchCount: 0,
    followerCount: 0,
    matchCount: 0,
    rating: 0,
    responseTime: 0
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchStats()
  }, [shopId])

  const fetchStats = async () => {
    try {
      const [
        { count: productCount },
        { count: searchCount },
        { count: followerCount },
        { count: matchCount },
        { data: reviewsData }
      ] = await Promise.all([
        supabase
          .from('shop_inventory')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('status', 'active'),
        supabase
          .from('shop_searches')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('status', 'active'),
        supabase
          .from('shop_customer_relationships')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('relationship_type', 'follower'),
        supabase
          .from('shop_search_matches')
          .select('count', { count: 'exact', head: true })
          .eq('search_id', shopId)
          .eq('status', 'pending'),
        supabase
          .from('shop_reviews')
          .select('rating, response_time')
          .eq('shop_id', shopId)
          .limit(50)
      ])

      // Calculate average rating and response time with proper typing
      const reviews: ShopReview[] = reviewsData || []
      
      // DÃœZELTÄ°LMÄ°Å KISIM - TypeScript hatalarÄ± giderildi
      const avgRating = reviews.length > 0 
        ? reviews.reduce((sum: number, r: ShopReview) => {
            const rating = r.rating || 0
            return sum + rating
          }, 0) / reviews.length 
        : 0
      
      const avgResponseTime = reviews.length > 0
        ? reviews.reduce((sum: number, r: ShopReview) => {
            const responseTime = r.response_time || 0
            return sum + responseTime
          }, 0) / reviews.length
        : 0

      setStats({
        productCount: productCount || 0,
        searchCount: searchCount || 0,
        followerCount: followerCount || 0,
        matchCount: matchCount || 0,
        rating: avgRating,
        responseTime: avgResponseTime
      })
    } catch (error) {
      console.error('MaÄŸaza istatistikleri yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const formatResponseTime = (minutes: number) => {
    if (minutes < 60) return `${Math.round(minutes)} dk`
    if (minutes < 1440) return `${Math.round(minutes / 60)} saat`
    return `${Math.round(minutes / 1440)} gÃ¼n`
  }

  if (loading) {
    return (
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        {[...Array(4)].map((_, i) => (
          <div key={i} className="animate-pulse bg-gray-200 rounded-xl h-24"></div>
        ))}
      </div>
    )
  }

  return (
    <div className="grid grid-cols-2 md:grid-cols-6 gap-4 mb-8">
      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-blue-600 mb-1">
          {stats.productCount}
        </div>
        <div className="text-sm text-gray-600">ÃœrÃ¼n</div>
        <div className="text-xs text-gray-400 mt-1">Stokta</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-green-600 mb-1">
          {stats.searchCount}
        </div>
        <div className="text-sm text-gray-600">Arama</div>
        <div className="text-xs text-gray-400 mt-1">Aktif</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-purple-600 mb-1">
          {stats.followerCount}
        </div>
        <div className="text-sm text-gray-600">TakipÃ§i</div>
        <div className="text-xs text-gray-400 mt-1">Toplam</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-orange-600 mb-1">
          {stats.matchCount}
        </div>
        <div className="text-sm text-gray-600">EÅŸleÅŸme</div>
        <div className="text-xs text-gray-400 mt-1">Bekleyen</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-yellow-600 mb-1">
          {stats.rating.toFixed(1)}
        </div>
        <div className="text-sm text-gray-600">Puan</div>
        <div className="text-xs text-gray-400 mt-1">Ortalama</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-teal-600 mb-1">
          {formatResponseTime(stats.responseTime)}
        </div>
        <div className="text-sm text-gray-600">YanÄ±t</div>
        <div className="text-xs text-gray-400 mt-1">Ortalama</div>
      </div>
    </div>
  )
}

ğŸ“„ components/ShopProductCard.tsx
ğŸ“Š 63 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ShopProductCard.tsx - ÃœRÃœN KARTI
'use client';

import Link from 'next/link';
import { Heart, Eye } from 'lucide-react';

interface ShopProductCardProps {
  product: any;
}

export default function ShopProductCard({ product }: ShopProductCardProps) {
  return (
    <Link 
      href={`/product/${product.id}`} // BURASI DEÄÄ°ÅTÄ°
      className="bg-white rounded-xl shadow hover:shadow-md transition-shadow overflow-hidden block"
    >
      {/* Resim */}
      {product.images && product.images.length > 0 ? (
        <div className="h-48 overflow-hidden">
          <img
            src={product.images[0]}
            alt={product.title}
            className="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
          />
        </div>
      ) : (
        <div className="h-48 bg-gray-100 flex items-center justify-center">
          <div className="text-gray-400">Resim Yok</div>
        </div>
      )}
      
      {/* Ä°Ã§erik */}
      <div className="p-4">
        <h3 className="font-medium text-gray-900 line-clamp-2 mb-2">
          {product.title}
        </h3>
        
        <div className="flex items-center justify-between mb-3">
          <span className="font-bold text-blue-600">
            {product.price.toLocaleString('tr-TR')} {product.price_currency}
          </span>
          {product.discount_percent && (
            <span className="text-sm bg-red-100 text-red-700 px-2 py-1 rounded">
              %{product.discount_percent} indirim
            </span>
          )}
        </div>
        
        {/* Alt Bilgi */}
        <div className="flex items-center justify-between text-sm text-gray-500">
          <div className="flex items-center">
            <Eye size={14} className="mr-1" />
            {product.view_count || 0}
          </div>
          <div className="flex items-center">
            <Heart size={14} className="mr-1" />
            {product.wishlist_count || 0}
          </div>
        </div>
      </div>
    </Link>
  );
}

ğŸ“„ components/SimpleMap.tsx
ğŸ“Š 106 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleMap.tsx
'use client'

import { useState } from 'react'

interface SimpleMapProps {
  location: string
  height?: string
}

export default function SimpleMap({ location, height = '400px' }: SimpleMapProps) {
  const [showMap, setShowMap] = useState(false)

  // TÃ¼rkiye ÅŸehir koordinatlarÄ±
  const cityCoordinates: Record<string, { lat: number; lng: number }> = {
    'Ä°stanbul': { lat: 41.0082, lng: 28.9784 },
    'Ankara': { lat: 39.9334, lng: 32.8597 },
    'Ä°zmir': { lat: 38.4237, lng: 27.1428 },
    'Bursa': { lat: 40.1885, lng: 29.0610 },
    'Antalya': { lat: 36.8969, lng: 30.7133 },
    'Adana': { lat: 37.0000, lng: 35.3213 },
    'Konya': { lat: 37.8667, lng: 32.4833 },
    'Trabzon': { lat: 41.0015, lng: 39.7178 },
    'Gaziantep': { lat: 37.0662, lng: 37.3833 },
    'Kayseri': { lat: 38.7312, lng: 35.4787 },
    'TÃ¼rkiye Geneli': { lat: 39.9334, lng: 32.8597 }, // Ankara
    'Yurt DÄ±ÅŸÄ±': { lat: 48.8566, lng: 2.3522 } // Paris
  }

  const getCoordinates = () => {
    for (const city in cityCoordinates) {
      if (location.includes(city)) {
        return cityCoordinates[city]
      }
    }
    return cityCoordinates['Ä°stanbul'] // VarsayÄ±lan
  }

  const coordinates = getCoordinates()

  return (
    <div className="bg-white rounded-xl shadow-lg overflow-hidden">
      <div className="p-4 border-b">
        <div className="flex items-center justify-between">
          <div className="flex items-center">
            <span className="text-2xl mr-3">ğŸ“</span>
            <div>
              <h3 className="font-bold text-gray-900">{location}</h3>
              <p className="text-sm text-gray-600">Spot konumu</p>
            </div>
          </div>
          <button
            onClick={() => setShowMap(!showMap)}
            className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm"
          >
            {showMap ? 'HaritayÄ± Kapat' : 'HaritayÄ± AÃ§'}
          </button>
        </div>
      </div>

      {showMap && (
        <div className="p-4">
          <div className="rounded-lg overflow-hidden border border-gray-300" style={{ height }}>
            <iframe
              src={`https://maps.google.com/maps?q=${coordinates.lat},${coordinates.lng}&z=12&output=embed`}
              className="w-full h-full border-0"
              loading="lazy"
              title={`${location} haritasÄ±`}
              allowFullScreen
            />
          </div>
          <div className="mt-4 flex items-center justify-between text-sm text-gray-600">
            <div className="flex items-center">
              <span className="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>
              <span>Spot konumu: {location}</span>
            </div>
            <a
              href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`}
              target="_blank"
              rel="noopener noreferrer"
              className="text-blue-600 hover:text-blue-800"
            >
              Google Maps'te aÃ§ â†’
            </a>
          </div>
        </div>
      )}

      {!showMap && (
        <div className="p-6 text-center bg-gradient-to-br from-blue-50 to-purple-50">
          <div className="text-4xl mb-4">ğŸ—ºï¸</div>
          <h4 className="text-lg font-bold text-gray-900 mb-2">Bu spot {location} konumunda aranÄ±yor</h4>
          <p className="text-gray-600 mb-4">
            {location.includes('TÃ¼rkiye Geneli') 
              ? 'TÃ¼m TÃ¼rkiye\'de bu Ã¼rÃ¼nÃ¼ arayanlar size yardÄ±m edebilir'
              : `${location} bÃ¶lgesindeki kullanÄ±cÄ±lar size yardÄ±m edecek`
            }
          </p>
          <p className="text-sm text-gray-500">
            HaritayÄ± aÃ§arak konumu tam olarak gÃ¶rebilirsiniz
          </p>
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/SimpleShareButtons.tsx
ğŸ“Š 85 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleShareButtons.tsx
'use client'

import { useState } from 'react'

export default function SimpleShareButtons({ 
  url, 
  title 
}: { 
  url: string 
  title: string 
}) {
  const [copied, setCopied] = useState(false)
  const currentUrl = typeof window !== 'undefined' ? window.location.origin + url : url

  const shareLinks = {
    facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentUrl)}`,
    whatsapp: `https://api.whatsapp.com/send?text=${encodeURIComponent(title + ' ' + currentUrl)}`,
    twitter: `https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(currentUrl)}`
  }

  const copyToClipboard = async () => {
    try {
      await navigator.clipboard.writeText(currentUrl)
      setCopied(true)
      setTimeout(() => setCopied(false), 2000)
    } catch (err) {
      console.error('Kopyalama hatasÄ±:', err)
    }
  }

  return (
    <div className="bg-white rounded-xl shadow-lg p-6">
      <h3 className="text-lg font-bold text-gray-900 mb-4">PaylaÅŸ</h3>
      
      <div className="grid grid-cols-3 gap-3 mb-6">
        <a
          href={shareLinks.facebook}
          target="_blank"
          rel="noopener noreferrer"
          className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">ğŸ“˜</span>
          <span className="hidden sm:inline">Facebook</span>
        </a>
        
        <a
          href={shareLinks.whatsapp}
          target="_blank"
          rel="noopener noreferrer"
          className="bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">ğŸ’š</span>
          <span className="hidden sm:inline">WhatsApp</span>
        </a>
        
        <button
          onClick={copyToClipboard}
          className="bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">{copied ? 'âœ…' : 'ğŸ“‹'}</span>
          <span className="hidden sm:inline">{copied ? 'Kopya' : 'Kopya'}</span>
        </button>
      </div>
      
      <div>
        <p className="text-sm text-gray-600 mb-2">Link:</p>
        <div className="relative">
          <input
            type="text"
            value={currentUrl}
            readOnly
            className="w-full px-4 py-3 pr-24 bg-gray-50 border border-gray-300 rounded-lg text-sm"
          />
          <button
            onClick={copyToClipboard}
            className="absolute right-2 top-1/2 transform -translate-y-1/2 px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded"
          >
            {copied ? 'KopyalandÄ±!' : 'Kopyala'}
          </button>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/SimpleTabs.tsx
ğŸ“Š 33 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleTabs.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

interface Tab {
  id: string
  label: string
}

interface SimpleTabsProps {
  tabs: Tab[]
  activeTab: string
  onTabChange: (tabId: string) => void
}

export default function SimpleTabs({ tabs, activeTab, onTabChange }: SimpleTabsProps) {
  return (
    <div className="flex border-b">
      {tabs.map((tab) => (
        <button
          key={tab.id}
          onClick={() => onTabChange(tab.id)}
          className={`flex-1 py-4 text-center font-medium transition-colors ${
            activeTab === tab.id
              ? 'text-blue-600 border-b-2 border-blue-600'
              : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
          }`}
        >
          {tab.label}
        </button>
      ))}
    </div>
  )
}

ğŸ“„ components/social/CommentsSection.tsx
ğŸ“Š 378 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/CommentsSection.tsx
'use client'

import { useState, useEffect, useRef } from 'react'
import { supabase } from '@/lib/supabase'
import { Send, Heart, MoreVertical, Smile } from 'lucide-react'

interface CommentsSectionProps {
  postId: string
  initialComments?: any[]
  onClose?: () => void
  autoFocus?: boolean
}

export default function CommentsSection({ 
  postId, 
  initialComments = [], 
  onClose,
  autoFocus = false 
}: CommentsSectionProps) {
  const [comments, setComments] = useState<any[]>(initialComments)
  const [newComment, setNewComment] = useState('')
  const [loading, setLoading] = useState(false)
  const [replyingTo, setReplyingTo] = useState<string | null>(null)
  const [showEmojiPicker, setShowEmojiPicker] = useState(false)
  
  const commentsEndRef = useRef<HTMLDivElement>(null)
  const inputRef = useRef<HTMLTextAreaElement>(null)

  useEffect(() => {
    if (initialComments.length === 0) {
      fetchComments()
    }
  }, [postId])

  useEffect(() => {
    scrollToBottom()
  }, [comments])

  const fetchComments = async () => {
    try {
      const { data } = await supabase
        .from('social_comments')
        .select(`
          *,
          user:user_profiles(*)
        `)
        .eq('post_id', postId)
        .order('created_at', { ascending: true })

      setComments(data || [])
    } catch (error) {
      console.error('Yorumlar yÃ¼klenemedi:', error)
    }
  }

  const scrollToBottom = () => {
    commentsEndRef.current?.scrollIntoView({ behavior: 'smooth' })
  }

  const handleSubmitComment = async () => {
    if (!newComment.trim()) return

    setLoading(true)
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) {
        alert('Yorum yapmak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z')
        return
      }

      const { data: comment, error } = await supabase
        .from('social_comments')
        .insert({
          post_id: postId,
          user_id: user.id,
          content: newComment,
          parent_id: replyingTo || null
        })
        .select(`
          *,
          user:user_profiles(*)
        `)
        .single()

      if (error) throw error

      // Yeni yorumu listeye ekle
      setComments(prev => [...prev, comment])
      setNewComment('')
      setReplyingTo(null)

      // Bildirim gÃ¶nder (post sahibine)
      const postOwnerId = comments[0]?.post?.user_id || postId
      if (postOwnerId !== user.id) {
        await supabase.from('social_notifications').insert({
          user_id: postOwnerId,
          type: 'comment',
          actor_id: user.id,
          post_id: postId,
          message: 'paylaÅŸÄ±mÄ±na yorum yaptÄ±'
        })
      }

      // Emoji picker'Ä± kapat
      setShowEmojiPicker(false)

    } catch (error) {
      console.error('Yorum gÃ¶nderme hatasÄ±:', error)
      alert('Yorum gÃ¶nderilemedi')
    } finally {
      setLoading(false)
    }
  }

  const handleLikeComment = async (commentId: string) => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      // BeÄŸeni iÅŸlemi (like/unlike)
      const existingLike = comments.find(c => c.id === commentId)?.liked_by_user
      
      if (existingLike) {
        // BeÄŸeniyi kaldÄ±r
        await supabase
          .from('comment_likes')
          .delete()
          .eq('comment_id', commentId)
          .eq('user_id', user.id)
      } else {
        // BeÄŸen
        await supabase
          .from('comment_likes')
          .insert({
            comment_id: commentId,
            user_id: user.id
          })
      }

      // UI gÃ¼ncelle
      setComments(prev => prev.map(comment => {
        if (comment.id === commentId) {
          return {
            ...comment,
            like_count: existingLike ? comment.like_count - 1 : comment.like_count + 1,
            liked_by_user: !existingLike
          }
        }
        return comment
      }))

    } catch (error) {
      console.error('Yorum beÄŸenme hatasÄ±:', error)
    }
  }

  const handleReply = (commentId: string, username: string) => {
    setReplyingTo(commentId)
    setNewComment(`@${username} `)
    inputRef.current?.focus()
  }

  const addEmoji = (emoji: string) => {
    setNewComment(prev => prev + emoji)
    setShowEmojiPicker(false)
  }

  const emojis = ['ğŸ˜Š', 'ğŸ˜', 'ğŸ˜‚', 'ğŸ˜®', 'ğŸ˜¢', 'ğŸ‘', 'â¤ï¸', 'ğŸ”¥', 'ğŸ‰', 'ğŸ‘']

  const renderComment = (comment: any, isChild = false) => {
    const childComments = comments.filter(c => c.parent_id === comment.id)
    
    return (
      <div key={comment.id} className={`${isChild ? 'ml-8' : ''}`}>
        <div className={`flex space-x-3 ${isChild ? 'mt-3' : 'mt-4'}`}>
          {/* Avatar */}
          <div className="flex-shrink-0">
            <div className="w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 overflow-hidden">
              {comment.user?.avatar_url ? (
                <img
                  src={comment.user.avatar_url}
                  alt={comment.user?.name}
                  className="w-full h-full object-cover"
                />
              ) : (
                <div className="w-full h-full flex items-center justify-center text-white text-sm font-bold">
                  {comment.user?.name?.[0] || 'K'}
                </div>
              )}
            </div>
          </div>

          {/* Ä°Ã§erik */}
          <div className="flex-1">
            <div className="bg-gray-100 rounded-2xl rounded-tl-none p-3">
              <div className="flex items-center justify-between mb-1">
                <div className="flex items-center space-x-2">
                  <span className="font-bold text-sm">{comment.user?.name || 'KullanÄ±cÄ±'}</span>
                  <span className="text-xs text-gray-500">
                    {new Date(comment.created_at).toLocaleTimeString('tr-TR', {
                      hour: '2-digit',
                      minute: '2-digit'
                    })}
                  </span>
                </div>
                
                <div className="relative">
                  <button
                    onClick={() => console.log('comment menu')}
                    className="p-1 hover:bg-gray-200 rounded-full"
                  >
                    <MoreVertical className="w-3 h-3 text-gray-500" />
                  </button>
                </div>
              </div>

              <p className="text-gray-800 text-sm whitespace-pre-line">
                {comment.content}
              </p>
            </div>

            {/* Aksiyonlar */}
            <div className="flex items-center space-x-4 mt-2 ml-3">
              <button
                onClick={() => handleLikeComment(comment.id)}
                className={`text-xs flex items-center space-x-1 ${
                  comment.liked_by_user ? 'text-red-600' : 'text-gray-500'
                }`}
              >
                <Heart className="w-3 h-3" />
                <span>{comment.like_count || 0}</span>
              </button>
              
              <button
                onClick={() => handleReply(comment.id, comment.user?.name)}
                className="text-xs text-gray-500 hover:text-gray-700"
              >
                YanÄ±tla
              </button>
              
              {!isChild && childComments.length > 0 && (
                <button className="text-xs text-blue-600">
                  {childComments.length} yanÄ±t
                </button>
              )}
            </div>

            {/* Alt yorumlar */}
            {childComments.length > 0 && (
              <div className="mt-3">
                {childComments.map(child => renderComment(child, true))}
              </div>
            )}
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="border-t border-gray-100">
      {/* Yorumlar listesi */}
      <div className="max-h-80 overflow-y-auto px-6 py-4">
        {comments.length === 0 ? (
          <div className="text-center py-8">
            <div className="text-3xl mb-3">ğŸ’¬</div>
            <p className="text-gray-600">HenÃ¼z yorum yok</p>
            <p className="text-sm text-gray-500 mt-1">Ä°lk yorumu sen yap!</p>
          </div>
        ) : (
          <div>
            {comments
              .filter(comment => !comment.parent_id) // Sadece parent yorumlar
              .map(comment => renderComment(comment, false))}
          </div>
        )}
        
        <div ref={commentsEndRef} />
      </div>

      {/* YanÄ±tlama durumu */}
      {replyingTo && (
        <div className="px-6 py-2 bg-blue-50 flex items-center justify-between">
          <div className="text-sm text-blue-700">
            YanÄ±tlanÄ±yor: @{comments.find(c => c.id === replyingTo)?.user?.name}
          </div>
          <button
            onClick={() => setReplyingTo(null)}
            className="text-sm text-gray-500 hover:text-gray-700"
          >
            Ã— Ä°ptal
          </button>
        </div>
      )}

      {/* Yorum input */}
      <div className="px-6 py-4 border-t border-gray-100">
        <div className="flex space-x-3">
          {/* Emoji picker */}
          <div className="relative">
            <button
              onClick={() => setShowEmojiPicker(!showEmojiPicker)}
              className="p-2 hover:bg-gray-100 rounded-full"
            >
              <Smile className="w-5 h-5 text-gray-500" />
            </button>

            {showEmojiPicker && (
              <div className="absolute bottom-full left-0 mb-2 bg-white rounded-xl shadow-lg border p-2 grid grid-cols-5 gap-1 z-50">
                {emojis.map(emoji => (
                  <button
                    key={emoji}
                    onClick={() => addEmoji(emoji)}
                    className="w-8 h-8 hover:bg-gray-100 rounded flex items-center justify-center text-lg"
                  >
                    {emoji}
                  </button>
                ))}
              </div>
            )}
          </div>

          {/* Textarea */}
          <div className="flex-1">
            <textarea
              ref={inputRef}
              value={newComment}
              onChange={(e) => setNewComment(e.target.value)}
              placeholder="Yorum ekle..."
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"
              rows={2}
              autoFocus={autoFocus}
              onKeyDown={(e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                  e.preventDefault()
                  handleSubmitComment()
                }
              }}
            />
          </div>

          {/* GÃ¶nder butonu */}
          <button
            onClick={handleSubmitComment}
            disabled={loading || !newComment.trim()}
            className="self-end bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full disabled:opacity-50 disabled:cursor-not-allowed"
          >
            {loading ? (
              <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
            ) : (
              <Send className="w-5 h-5" />
            )}
          </button>
        </div>

        {/* Yorum ipuÃ§larÄ± */}
        <div className="mt-3 text-xs text-gray-500">
          â€¢ Enter ile gÃ¶nder, Shift+Enter ile yeni satÄ±r<br />
          â€¢ @kullanÄ±cÄ± ile etiketleyebilirsin<br />
          â€¢ Nazik ve yardÄ±msever olalÄ±m
        </div>
      </div>

      {/* Kapatma butonu (mobile iÃ§in) */}
      {onClose && (
        <div className="px-6 py-3 border-t border-gray-100 text-center">
          <button
            onClick={onClose}
            className="text-blue-600 hover:text-blue-800 text-sm font-medium"
          >
            YorumlarÄ± Kapat
          </button>
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/social/CreatePostButton.tsx
ğŸ“Š 48 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/CreatePostButton.tsx
'use client'

import { useState } from 'react'
import CreatePostModal from './CreatePostModal'

export default function CreatePostButton({ variant = 'default' }: { variant?: 'default' | 'primary' }) {
  const [showModal, setShowModal] = useState(false)

  if (variant === 'primary') {
    return (
      <>
        <button
          onClick={() => setShowModal(true)}
          className="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:from-blue-600 hover:to-purple-700 transition"
        >
          ğŸ“ Yeni PaylaÅŸÄ±m
        </button>
        
        <CreatePostModal
                isOpen={showModal}
                onClose={() => setShowModal(false)} onPostCreated={function (): void {
                    throw new Error('Function not implemented.')
                } }        />
      </>
    )
  }

  return (
    <>
      <button
        onClick={() => setShowModal(true)}
        className="fixed bottom-6 right-6 z-40 bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-full shadow-2xl hover:shadow-3xl transition-all hover:scale-110"
      >
        <div className="flex items-center space-x-2">
          <span className="text-2xl">âœï¸</span>
          <span className="font-bold hidden md:inline">PaylaÅŸ</span>
        </div>
      </button>
      
      <CreatePostModal
              isOpen={showModal}
              onClose={() => setShowModal(false)} onPostCreated={function (): void {
                  throw new Error('Function not implemented.')
              } }      />
    </>
  )
}

ğŸ“„ components/social/CreatePostModal.tsx
ğŸ“Š 453 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/CreatePostModal.tsx
'use client'

import { useState, useRef } from 'react'
import { supabase } from '@/lib/supabase'
import ImageUpload from '../ImageUpload'
import HashtagInput from './HashtagInput'
import LocationPicker from './LocationPicker'

interface CreatePostModalProps {
  isOpen: boolean
  onClose: () => void
  onPostCreated: () => void
}

export default function CreatePostModal({ 
  isOpen, 
  onClose, 
  onPostCreated 
}: CreatePostModalProps) {
  const [step, setStep] = useState(1)
  const [loading, setLoading] = useState(false)
  const [postData, setPostData] = useState({
    type: 'sighting',
    caption: '',
    location: '',
    category: '',
    hashtags: [] as string[],
    isPublic: true,
    images: [] as File[]
  })

  const fileInputRef = useRef<HTMLInputElement>(null)

  const handleImageUpload = (files: File[]) => {
    setPostData({ ...postData, images: [...postData.images, ...files] })
  }

  const removeImage = (index: number) => {
    setPostData({
      ...postData,
      images: postData.images.filter((_, i) => i !== index)
    })
  }

  const handleHashtagAdd = (hashtag: string) => {
    if (!postData.hashtags.includes(hashtag)) {
      setPostData({
        ...postData,
        hashtags: [...postData.hashtags, hashtag]
      })
    }
  }

  const handleHashtagRemove = (hashtag: string) => {
    setPostData({
      ...postData,
      hashtags: postData.hashtags.filter(h => h !== hashtag)
    })
  }

  const handleSubmit = async () => {
    setLoading(true)
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) throw new Error('KullanÄ±cÄ± giriÅŸi gerekli')

      // 1. Resimleri yÃ¼kle
      const imageUrls: string[] = []
      for (const file of postData.images) {
        const fileExt = file.name.split('.').pop()
        const fileName = `${user.id}/social/${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`
        
        const { error: uploadError } = await supabase.storage
          .from('spot-images')
          .upload(fileName, file)

        if (uploadError) throw uploadError

        const { data: { publicUrl } } = supabase.storage
          .from('spot-images')
          .getPublicUrl(fileName)

        imageUrls.push(publicUrl)
      }

      // 2. Post'u oluÅŸtur
      const { error: postError } = await supabase
        .from('social_posts')
        .insert({
          user_id: user.id,
          type: postData.type,
          caption: postData.caption,
          location: postData.location,
          category: postData.category,
          image_urls: imageUrls,
          hashtags: postData.hashtags.map(tag => `#${tag.replace('#', '')}`),
          is_public: postData.isPublic
        })

      if (postError) throw postError

      // 3. Puan ver (gamification)
      await supabase.rpc('add_user_points', {
        user_id: user.id,
        points_to_add: 10 + (postData.images.length * 5), // 10 puan + resim baÅŸÄ±na 5 puan
        activity_type: 'social_post'
      })

      // 4. BaÅŸarÄ±lÄ±
      alert('ğŸ‰ PaylaÅŸÄ±mÄ±nÄ±z yayÄ±nlandÄ±! Puan kazandÄ±nÄ±z.')
      onPostCreated()
      onClose()
      
      // Formu temizle
      setPostData({
        type: 'sighting',
        caption: '',
        location: '',
        category: '',
        hashtags: [],
        isPublic: true,
        images: []
      })
      setStep(1)

    } catch (error) {
      console.error('Post oluÅŸturma hatasÄ±:', error)
      alert('Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.')
    } finally {
      setLoading(false)
    }
  }

  if (!isOpen) return null

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden">
        {/* Header */}
        <div className="border-b p-6">
          <div className="flex items-center justify-between">
            <h2 className="text-2xl font-bold text-gray-900">Yeni PaylaÅŸÄ±m</h2>
            <button
              onClick={onClose}
              className="text-gray-500 hover:text-gray-700 text-2xl"
            >
              Ã—
            </button>
          </div>
          
          {/* Step indicator */}
          <div className="flex mt-4">
            {[1, 2, 3].map((stepNum) => (
              <div key={stepNum} className="flex-1">
                <div className={`h-1 rounded-full ${
                  step >= stepNum ? 'bg-blue-600' : 'bg-gray-200'
                }`}></div>
                <p className="text-xs text-center mt-2">
                  {stepNum === 1 ? 'Medya' : stepNum === 2 ? 'Detaylar' : 'PaylaÅŸ'}
                </p>
              </div>
            ))}
          </div>
        </div>

        {/* Content */}
        <div className="p-6 overflow-y-auto max-h-[60vh]">
          {step === 1 && (
            <div>
              <h3 className="text-lg font-bold mb-4">Medya Ekle</h3>
              
              {/* Image upload area */}
              <div 
                className="border-2 border-dashed border-gray-300 rounded-2xl p-8 text-center cursor-pointer hover:border-blue-400 transition"
                onClick={() => fileInputRef.current?.click()}
              >
                {postData.images.length === 0 ? (
                  <>
                    <div className="text-4xl mb-4">ğŸ“¸</div>
                    <p className="font-medium text-gray-700">FotoÄŸraf veya video yÃ¼kleyin</p>
                    <p className="text-sm text-gray-500 mt-2">
                      SÃ¼rÃ¼kle bÄ±rak veya tÄ±kla
                    </p>
                  </>
                ) : (
                  <div className="grid grid-cols-3 gap-4">
                    {postData.images.map((image, index) => (
                      <div key={index} className="relative">
                        <img
                          src={URL.createObjectURL(image)}
                          alt={`Preview ${index}`}
                          className="w-full h-32 object-cover rounded-lg"
                        />
                        <button
                          onClick={(e) => {
                            e.stopPropagation()
                            removeImage(index)
                          }}
                          className="absolute -top-2 -right-2 bg-red-500 text-white w-6 h-6 rounded-full"
                        >
                          Ã—
                        </button>
                      </div>
                    ))}
                    <div 
                      className="border-2 border-dashed border-gray-300 rounded-lg h-32 flex items-center justify-center"
                      onClick={() => fileInputRef.current?.click()}
                    >
                      <span className="text-2xl">+</span>
                    </div>
                  </div>
                )}
              </div>

              <input
                type="file"
                ref={fileInputRef}
                multiple
                accept="image/*,video/*"
                onChange={(e) => {
                  if (e.target.files) {
                    handleImageUpload(Array.from(e.target.files))
                  }
                }}
                className="hidden"
              />

              <div className="mt-6">
                <h4 className="font-medium mb-3">PaylaÅŸÄ±m TÃ¼rÃ¼</h4>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                  {[
                    { value: 'sighting', label: 'ğŸ‘ï¸ GÃ¶rdÃ¼m', desc: 'Nadir Ã¼rÃ¼n gÃ¶rdÃ¼m' },
                    { value: 'collection', label: 'ğŸ† Koleksiyon', desc: 'Koleksiyonumu paylaÅŸÄ±yorum' },
                    { value: 'question', label: 'â“ Soru', desc: 'Bu nedir?' },
                    { value: 'showcase', label: 'âœ¨ Vitrin', desc: 'ÃœrÃ¼nÃ¼mÃ¼ sergiliyorum' }
                  ].map((type) => (
                    <button
                      key={type.value}
                      onClick={() => setPostData({...postData, type: type.value})}
                      className={`p-4 rounded-xl border-2 text-center ${
                        postData.type === type.value
                          ? 'border-blue-500 bg-blue-50'
                          : 'border-gray-200 hover:border-gray-300'
                      }`}
                    >
                      <div className="text-2xl mb-2">{type.label.split(' ')[0]}</div>
                      <div className="font-medium">{type.label.split(' ')[1]}</div>
                      <div className="text-xs text-gray-500 mt-1">{type.desc}</div>
                    </button>
                  ))}
                </div>
              </div>
            </div>
          )}

          {step === 2 && (
            <div>
              <h3 className="text-lg font-bold mb-4">DetaylarÄ± Ekle</h3>
              
              {/* Caption */}
              <div className="mb-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  AÃ§Ä±klama
                </label>
                <textarea
                  value={postData.caption}
                  onChange={(e) => setPostData({...postData, caption: e.target.value})}
                  placeholder="PaylaÅŸÄ±mÄ±nÄ±zÄ± anlatÄ±n..."
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-32"
                  maxLength={2000}
                />
                <div className="text-right text-sm text-gray-500 mt-1">
                  {postData.caption.length}/2000
                </div>
              </div>

              {/* Hashtags */}
              <div className="mb-6">
                <HashtagInput
                  hashtags={postData.hashtags}
                  onAdd={handleHashtagAdd}
                  onRemove={handleHashtagRemove}
                />
              </div>

              {/* Location */}
              <div className="mb-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Konum (opsiyonel)
                </label>
                <LocationPicker
                  value={postData.location}
                  onChange={(location) => setPostData({...postData, location})}
                />
              </div>

              {/* Category */}
              <div className="mb-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Kategori
                </label>
                <select
                  value={postData.category}
                  onChange={(e) => setPostData({...postData, category: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                >
                  <option value="">Kategori seÃ§in</option>
                  <option value="electronics">Elektronik</option>
                  <option value="fashion">Giyim & Aksesuar</option>
                  <option value="home">Ev & BahÃ§e</option>
                  <option value="collectible">Koleksiyon</option>
                  <option value="vehicle">AraÃ§ & ParÃ§a</option>
                  <option value="other">DiÄŸer</option>
                </select>
              </div>

              {/* Privacy */}
              <div className="flex items-center space-x-3">
                <input
                  type="checkbox"
                  checked={postData.isPublic}
                  onChange={(e) => setPostData({...postData, isPublic: e.target.checked})}
                  className="w-4 h-4 text-blue-600"
                  id="isPublic"
                />
                <label htmlFor="isPublic" className="text-sm font-medium text-gray-700">
                  Herkese aÃ§Ä±k paylaÅŸ
                </label>
                <span className="text-xs text-gray-500">
                  (KapalÄ±ysa sadece takipÃ§ilerin gÃ¶rebilir)
                </span>
              </div>
            </div>
          )}

          {step === 3 && (
            <div>
              <h3 className="text-lg font-bold mb-4">Ã–nizleme</h3>
              
              {/* Post preview */}
              <div className="bg-gray-50 rounded-xl p-4">
                {/* Header preview */}
                <div className="flex items-center space-x-3 mb-4">
                  <div className="w-12 h-12 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full"></div>
                  <div>
                    <div className="font-bold">Sen</div>
                    <div className="text-sm text-gray-500">
                      {postData.location || 'Konum belirtilmemiÅŸ'}
                    </div>
                  </div>
                </div>

                {/* Caption preview */}
                {postData.caption && (
                  <p className="text-gray-800 mb-4 whitespace-pre-line">
                    {postData.caption}
                    {postData.hashtags.length > 0 && (
                      <div className="mt-2">
                        {postData.hashtags.map(tag => (
                          <span key={tag} className="text-blue-600 mr-2">
                            #{tag}
                          </span>
                        ))}
                      </div>
                    )}
                  </p>
                )}

                {/* Images preview */}
                {postData.images.length > 0 && (
                  <div className="grid grid-cols-2 gap-2 mb-4">
                    {postData.images.slice(0, 4).map((image, index) => (
                      <div key={index} className="relative h-32 bg-gray-200 rounded-lg overflow-hidden">
                        <img
                          src={URL.createObjectURL(image)}
                          alt={`Preview ${index}`}
                          className="w-full h-full object-cover"
                        />
                        {postData.images.length > 4 && index === 3 && (
                          <div className="absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center text-white font-bold text-lg">
                            +{postData.images.length - 4}
                          </div>
                        )}
                      </div>
                    ))}
                  </div>
                )}

                {/* Stats preview */}
                <div className="text-sm text-gray-500">
                  {postData.type === 'sighting' && 'ğŸ‘ï¸ GÃ¶rdÃ¼m paylaÅŸÄ±mÄ± â€¢ '}
                  {postData.type === 'collection' && 'ğŸ† Koleksiyon paylaÅŸÄ±mÄ± â€¢ '}
                  {postData.images.length} fotoÄŸraf â€¢ Herkese aÃ§Ä±k
                </div>
              </div>

              {/* Bonus points info */}
              <div className="mt-6 bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="font-medium text-green-800">ğŸ‰ Puan KazanacaksÄ±nÄ±z!</p>
                    <p className="text-sm text-green-600">
                      â€¢ PaylaÅŸÄ±m: <strong>10 puan</strong><br />
                      â€¢ FotoÄŸraf baÅŸÄ±na: <strong>+5 puan</strong><br />
                      â€¢ Hashtag baÅŸÄ±na: <strong>+2 puan</strong>
                    </p>
                  </div>
                  <div className="text-2xl">ğŸ†</div>
                </div>
              </div>
            </div>
          )}
        </div>

        {/* Footer */}
        <div className="border-t p-6">
          <div className="flex justify-between">
            <button
              onClick={() => step > 1 ? setStep(step - 1) : onClose()}
              className="px-6 py-3 text-gray-700 hover:text-gray-900 font-medium"
            >
              {step === 1 ? 'Ä°ptal' : 'Geri'}
            </button>
            
            <button
              onClick={() => {
                if (step < 3) {
                  setStep(step + 1)
                } else {
                  handleSubmit()
                }
              }}
              disabled={loading || (step === 1 && postData.images.length === 0)}
              className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-lg disabled:opacity-50"
            >
              {loading ? (
                <span className="flex items-center">
                  <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>
                  PaylaÅŸÄ±lÄ±yor...
                </span>
              ) : step === 3 ? (
                `PaylaÅŸ (${10 + (postData.images.length * 5)} puan kazan)`
              ) : (
                'Devam Et'
              )}
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/social/Feed.tsx
ğŸ“Š 285 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/Feed.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect, useCallback } from 'react'
import { supabase } from '@/lib/supabase'
import FeedPost from './FeedPost'
import FeedFilters, { FilterType } from './FeedFilters'
import CreatePostButton from './CreatePostButton'
import StoriesBar from './StoriesBar'
import { useInView } from 'react-intersection-observer'

interface FeedProps {
  initialUserId?: string
  type?: FilterType
}

// FOLLOWING Ä°Ã‡Ä°N TÄ°P TANIMI
interface FollowingData {
  following_id: string
}

export default function Feed({ initialUserId, type = 'for-you' }: FeedProps) {
  const [posts, setPosts] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [hasMore, setHasMore] = useState(true)
  const [page, setPage] = useState(0)
  const [activeFilter, setActiveFilter] = useState<FilterType>(type)
  
  const { ref, inView } = useInView()
  const PAGE_SIZE = 10

  const fetchPosts = useCallback(async (pageNum: number, refresh = false) => {
    try {
      setLoading(true)
      
      let query = supabase
        .from('social_posts')
        .select(`
          *,
          user:user_profiles(*),
          shop:shops(*),
          likes:social_likes(count),
          comments:social_comments(count),
          saves:social_saves(count)
        `)
        .eq('status', 'active')
        .eq('is_public', true)
        .order('created_at', { ascending: false })

      // Filtreler
      switch (activeFilter) {
        case 'following':
          if (initialUserId) {
            const { data: following } = await supabase
              .from('social_follows')
              .select('following_id')
              .eq('follower_id', initialUserId)

            if (following && following.length > 0) {
              // DÃœZELTME: 'f' parametresine tip ekle
              const followingIds = following.map((f: FollowingData) => f.following_id)
              query = query.in('user_id', followingIds)
            } else {
              setPosts([])
              setHasMore(false)
              return
            }
          }
          break
        
        case 'popular':
          query = query.order('like_count', { ascending: false })
          break
        
        case 'category':
          // Kategori filtresi
          break
      }

      // Sayfalama
      const from = pageNum * PAGE_SIZE
      const to = from + PAGE_SIZE - 1
      
      query = query.range(from, to)

      const { data, error } = await query

      if (error) throw error

      if (data) {
        if (refresh) {
          setPosts(data)
        } else {
          setPosts(prev => [...prev, ...data])
        }
        
        setHasMore(data.length === PAGE_SIZE)
      }
    } catch (error) {
      console.error('Feed yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }, [activeFilter, initialUserId])

  // Infinite scroll
  useEffect(() => {
    if (inView && hasMore && !loading) {
      const nextPage = page + 1
      setPage(nextPage)
      fetchPosts(nextPage)
    }
  }, [inView, hasMore, loading, fetchPosts, page])

  // Filtre deÄŸiÅŸince yenile
  useEffect(() => {
    setPage(0)
    setPosts([])
    fetchPosts(0, true)
  }, [activeFilter, fetchPosts])

  // Ä°lk yÃ¼kleme
  useEffect(() => {
    fetchPosts(0, true)
  }, [])

  const handleLike = async (postId: string, liked: boolean): Promise<void> => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      if (liked) {
        await supabase
          .from('social_likes')
          .delete()
          .eq('post_id', postId)
          .eq('user_id', user.id)
      } else {
        await supabase
          .from('social_likes')
          .insert({
            post_id: postId,
            user_id: user.id
          })

        // Bildirim gÃ¶nder
        const post = posts.find(p => p.id === postId)
        if (post && post.user_id !== user.id) {
          await supabase.from('social_notifications').insert({
            user_id: post.user_id,
            type: 'like',
            actor_id: user.id,
            post_id: postId,
            message: 'paylaÅŸÄ±mÄ±nÄ± beÄŸendi'
          })
        }
      }

      // UI gÃ¼ncelle
      setPosts(prev => prev.map(post => {
        if (post.id === postId) {
          return {
            ...post,
            like_count: liked ? post.like_count - 1 : post.like_count + 1,
            is_liked: !liked
          }
        }
        return post
      }))

    } catch (error) {
      console.error('Like hatasÄ±:', error)
    }
  }

  const handleSave = async (postId: string, saved: boolean): Promise<void> => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      if (saved) {
        await supabase
          .from('social_saves')
          .delete()
          .eq('post_id', postId)
          .eq('user_id', user.id)
      } else {
        await supabase
          .from('social_saves')
          .insert({
            post_id: postId,
            user_id: user.id
          })
      }

      // UI gÃ¼ncelle
      setPosts(prev => prev.map(post => {
        if (post.id === postId) {
          return {
            ...post,
            save_count: saved ? post.save_count - 1 : post.save_count + 1,
            is_saved: !saved
          }
        }
        return post
      }))

    } catch (error) {
      console.error('Save hatasÄ±:', error)
    }
  }

  return (
    <div className="max-w-2xl mx-auto">
      {/* Stories Bar */}
      <StoriesBar />

      {/* Create Post Button */}
      <CreatePostButton />

      {/* Filters */}
      <FeedFilters 
        activeFilter={activeFilter}
        onFilterChange={setActiveFilter}
      />

      {/* Feed Posts */}
      <div className="space-y-6 mt-6">
        {posts.map((post) => (
          <FeedPost
            key={post.id}
            post={post}
            onLike={handleLike}
            onSave={handleSave}
            onComment={() => console.log('comment')}
            onShare={() => console.log('share')}
          />
        ))}
      </div>

      {/* Loading & Infinite Scroll */}
      {loading && (
        <div className="mt-8 space-y-6">
          {[...Array(3)].map((_, i) => (
            <div key={i} className="animate-pulse bg-white rounded-xl shadow p-6">
              <div className="flex items-center space-x-3">
                <div className="w-12 h-12 bg-gray-200 rounded-full"></div>
                <div className="flex-1">
                  <div className="h-4 bg-gray-200 rounded w-1/4"></div>
                  <div className="h-3 bg-gray-200 rounded w-1/2 mt-2"></div>
                </div>
              </div>
              <div className="mt-4">
                <div className="h-4 bg-gray-200 rounded w-full"></div>
                <div className="h-4 bg-gray-200 rounded w-3/4 mt-2"></div>
              </div>
              <div className="mt-4 h-64 bg-gray-200 rounded-lg"></div>
            </div>
          ))}
        </div>
      )}

      {/* Infinite Scroll Trigger */}
      {hasMore && !loading && (
        <div ref={ref} className="py-8 text-center">
          <div className="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
        </div>
      )}

      {/* No Posts */}
      {!loading && posts.length === 0 && (
        <div className="text-center py-12">
          <div className="text-4xl mb-4">ğŸ“­</div>
          <h3 className="text-xl font-bold text-gray-900 mb-2">HenÃ¼z paylaÅŸÄ±m yok</h3>
          <p className="text-gray-600 mb-6">
            {activeFilter === 'following' 
              ? 'Takip ettiÄŸin kiÅŸiler henÃ¼z paylaÅŸÄ±m yapmamÄ±ÅŸ'
              : 'Ä°lk paylaÅŸÄ±mÄ± sen yap!'}
          </p>
          <CreatePostButton variant="primary" />
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/social/FeedFilters.tsx
ğŸ“Š 40 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/FeedFilters.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

export type FilterType = 'for-you' | 'following' | 'popular' | 'category'

interface FeedFiltersProps {
  activeFilter: FilterType
  onFilterChange: (filter: FilterType) => void // TÄ°P DÃœZELTMESÄ°
}

export default function FeedFilters({ 
  activeFilter, 
  onFilterChange 
}: FeedFiltersProps) {
  const filters: Array<{ id: FilterType; label: string; icon: string }> = [
    { id: 'for-you', label: 'Sana Ã–zel', icon: 'ğŸ¯' },
    { id: 'following', label: 'Takip Edilenler', icon: 'ğŸ‘¥' },
    { id: 'popular', label: 'PopÃ¼ler', icon: 'ğŸ”¥' },
    { id: 'category', label: 'Kategoriler', icon: 'ğŸ·ï¸' }
  ]

  return (
    <div className="flex overflow-x-auto space-x-2 pb-4">
      {filters.map((filter) => (
        <button
          key={filter.id}
          onClick={() => onFilterChange(filter.id)}
          className={`flex items-center space-x-2 px-4 py-2 rounded-full whitespace-nowrap transition ${
            activeFilter === filter.id
              ? 'bg-blue-600 text-white'
              : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
          }`}
        >
          <span>{filter.icon}</span>
          <span>{filter.label}</span>
        </button>
      ))}
    </div>
  )
}

ğŸ“„ components/social/FeedPost.tsx
ğŸ“Š 249 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/FeedPost.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import Image from 'next/image'
import Link from 'next/link'
import PostActions from './PostActions'
import CommentsSection from './CommentsSection' // âœ… DÃœZELTÄ°LDÄ°
import PostHeader from './PostHeader' // âœ… DÃœZELTÄ°LDÄ°

interface FeedPostProps {
  post: any
  onLike: (postId: string, liked: boolean) => void
  onSave: (postId: string, saved: boolean) => void
  onComment: () => void
  onShare: () => void
  showFull?: boolean
}

export default function FeedPost({ 
  post, 
  onLike, 
  onSave, 
  onComment, 
  onShare,
  showFull = false 
}: FeedPostProps) {
  const [isLiked, setIsLiked] = useState(false)
  const [isSaved, setIsSaved] = useState(false)
  const [showComments, setShowComments] = useState(false)
  const [imageIndex, setImageIndex] = useState(0)
  const [user, setUser] = useState<any>(null)

  useEffect(() => {
    checkUserInteractions()
    fetchUser()
  }, [post.id])

  const checkUserInteractions = async () => {
    try {
      const { data: { user: authUser } } = await supabase.auth.getUser()
      if (!authUser) return

      // BeÄŸeni kontrolÃ¼
      const { data: like } = await supabase
        .from('social_likes')
        .select('id')
        .eq('post_id', post.id)
        .eq('user_id', authUser.id)
        .single()

      // Kaydetme kontrolÃ¼
      const { data: save } = await supabase
        .from('social_saves')
        .select('id')
        .eq('post_id', post.id)
        .eq('user_id', authUser.id)
        .single()

      setIsLiked(!!like)
      setIsSaved(!!save)
    } catch (error) {
      // Hata durumunda silent fail
    }
  }

  const fetchUser = async () => {
    if (!post.user_id) return
    const { data } = await supabase
      .from('user_profiles')
      .select('*')
      .eq('id', post.user_id)
      .single()
    setUser(data)
  }

  // TÄ°P DÃœZELTMESÄ° - async/await eklendi
  const handleLikeClick = async () => {
    const newLikedState = !isLiked
    setIsLiked(newLikedState)
    await onLike(post.id, isLiked)
  }

  // TÄ°P DÃœZELTMESÄ° - async/await eklendi
  const handleSaveClick = async () => {
    const newSavedState = !isSaved
    setIsSaved(newSavedState)
    await onSave(post.id, isSaved)
  }

  const hasMultipleImages = post.image_urls && post.image_urls.length > 1

  return (
    <div className="bg-white rounded-xl shadow-lg overflow-hidden">
      {/* Header - KullanÄ±cÄ± bilgileri */}
      <PostHeader 
        user={user || post.user}
        post={post}
        onFollow={() => console.log('follow')}
      />

      {/* Caption */}
      {post.caption && (
        <div className="px-6 pt-4">
          <p className="text-gray-800 whitespace-pre-line">
            {post.caption}
            
            {/* Hashtag'ler */}
            {post.hashtags && post.hashtags.length > 0 && (
              <div className="mt-2">
                {post.hashtags.map((tag: string) => (
                  <Link
                    key={tag}
                    href={`/discover/tags/${tag.replace('#', '')}`}
                    className="inline-block text-blue-600 hover:text-blue-800 mr-2 text-sm"
                  >
                    {tag}
                  </Link>
                ))}
              </div>
            )}
          </p>
          
          {/* Konum */}
          {post.location && (
            <div className="mt-2 flex items-center text-gray-600 text-sm">
              <span className="mr-1">ğŸ“</span>
              {post.location}
            </div>
          )}
        </div>
      )}

      {/* Medya - Image/Video */}
      {post.image_urls && post.image_urls.length > 0 && (
        <div className="relative mt-4">
          {/* Ana resim */}
          <div className="relative h-[500px] bg-gray-100">
            <img
              src={post.image_urls[imageIndex]}
              alt={post.caption || 'Post image'}
              className="w-full h-full object-contain"
            />

            {/* Ã‡oklu resim navigasyonu */}
            {hasMultipleImages && (
              <>
                {/* Dots indicator */}
                <div className="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
                  {post.image_urls.map((_: any, index: number) => (
                    <button
                      key={index}
                      onClick={() => setImageIndex(index)}
                      className={`w-2 h-2 rounded-full ${
                        index === imageIndex ? 'bg-white' : 'bg-white bg-opacity-50'
                      }`}
                    />
                  ))}
                </div>

                {/* Navigation buttons */}
                {imageIndex > 0 && (
                  <button
                    onClick={() => setImageIndex(prev => prev - 1)}
                    className="absolute left-4 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-white bg-opacity-80 rounded-full flex items-center justify-center hover:bg-opacity-100"
                  >
                    â†
                  </button>
                )}
                {imageIndex < post.image_urls.length - 1 && (
                  <button
                    onClick={() => setImageIndex(prev => prev + 1)}
                    className="absolute right-4 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-white bg-opacity-80 rounded-full flex items-center justify-center hover:bg-opacity-100"
                  >
                    â†’
                  </button>
                )}
              </>
            )}
          </div>

          {/* Image counter */}
          {hasMultipleImages && (
            <div className="absolute top-4 right-4 bg-black bg-opacity-60 text-white px-3 py-1 rounded-full text-sm">
              {imageIndex + 1} / {post.image_urls.length}
            </div>
          )}
        </div>
      )}

      {/* Ä°statistikler */}
      <div className="px-6 py-3 border-t border-gray-100">
        <div className="flex items-center justify-between text-sm text-gray-600">
          <div className="flex items-center space-x-4">
            <div className="flex items-center">
              <span className="mr-1">â¤ï¸</span>
              <span className="font-medium">{post.like_count || 0}</span>
            </div>
            <div className="flex items-center">
              <span className="mr-1">ğŸ’¬</span>
              <span className="font-medium">{post.comment_count || 0}</span>
            </div>
            <div className="flex items-center">
              <span className="mr-1">ğŸ“¤</span>
              <span className="font-medium">{post.share_count || 0}</span>
            </div>
          </div>
          <div className="flex items-center">
            <span className="mr-1">ğŸ‘ï¸</span>
            <span className="font-medium">{post.view_count || 0}</span>
          </div>
        </div>
      </div>

      {/* Aksiyon ButonlarÄ± */}
      <PostActions
        isLiked={isLiked}
        isSaved={isSaved}
        onLike={handleLikeClick} // async fonksiyon
        onSave={handleSaveClick} // async fonksiyon
        onComment={() => {
          setShowComments(!showComments)
          onComment()
        }}
        onShare={onShare}
      />

      {/* Yorumlar BÃ¶lÃ¼mÃ¼ */}
      {showComments && (
        <CommentsSection 
          postId={post.id}
          initialComments={post.comments || []}
          onClose={() => setShowComments(false)}
        />
      )}

      {/* Zamansal bilgi */}
      <div className="px-6 py-3 border-t border-gray-100">
        <p className="text-xs text-gray-500">
          {new Date(post.created_at).toLocaleDateString('tr-TR', {
            hour: '2-digit',
            minute: '2-digit'
          })}
        </p>
      </div>
    </div>
  )
}

ğŸ“„ components/social/HashtagInput.tsx
ğŸ“Š 78 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/HashtagInput.tsx
'use client'

import { useState } from 'react'

interface HashtagInputProps {
  hashtags: string[]
  onAdd: (hashtag: string) => void
  onRemove: (hashtag: string) => void
}

export default function HashtagInput({ hashtags, onAdd, onRemove }: HashtagInputProps) {
  const [input, setInput] = useState('')

  const handleAdd = () => {
    const cleanTag = input.trim().replace(/#/g, '')
    if (cleanTag && !hashtags.includes(cleanTag)) {
      onAdd(cleanTag)
      setInput('')
    }
  }

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' || e.key === ',') {
      e.preventDefault()
      handleAdd()
    }
  }

  return (
    <div className="space-y-3">
      <label className="block text-sm font-medium text-gray-700">
        Hashtag'ler (opsiyonel)
      </label>
      
      <div className="flex">
        <input
          type="text"
          value={input}
          onChange={(e) => setInput(e.target.value)}
          onKeyDown={handleKeyDown}
          placeholder="#vintage #kamera #antika"
          className="flex-1 px-4 py-2 border border-gray-300 rounded-l-lg"
        />
        <button
          type="button"
          onClick={handleAdd}
          className="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-r-lg"
        >
          Ekle
        </button>
      </div>

      {/* Hashtag listesi */}
      <div className="flex flex-wrap gap-2">
        {hashtags.map((tag) => (
          <div
            key={tag}
            className="flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm"
          >
            #{tag}
            <button
              type="button"
              onClick={() => onRemove(tag)}
              className="ml-2 text-blue-600 hover:text-blue-900"
            >
              Ã—
            </button>
          </div>
        ))}
      </div>

      <p className="text-xs text-gray-500">
        Hashtag baÅŸÄ±na +2 puan kazanÄ±rsÄ±nÄ±z. Max 5 hashtag.
      </p>
    </div>
  )
}

ğŸ“„ components/social/LocationPicker.tsx
ğŸ“Š 45 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/LocationPicker.tsx
'use client'

import { useState } from 'react'
import { MapPin } from 'lucide-react'

interface LocationPickerProps {
  value: string
  onChange: (value: string) => void
}

export default function LocationPicker({ value, onChange }: LocationPickerProps) {
  const popularLocations = [
    'Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya',
    'Evim', 'Ä°ÅŸyeri', 'Sahil', 'AlÄ±ÅŸveriÅŸ Merkezi'
  ]

  return (
    <div className="space-y-3">
      <div className="relative">
        <MapPin className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
        <input
          type="text"
          value={value}
          onChange={(e) => onChange(e.target.value)}
          placeholder="Nerede Ã§ektiniz? (opsiyonel)"
          className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"
        />
      </div>

      <div className="flex flex-wrap gap-2">
        {popularLocations.map((location) => (
          <button
            key={location}
            type="button"
            onClick={() => onChange(location)}
            className="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full text-sm"
          >
            {location}
          </button>
        ))}
      </div>
    </div>
  )
}

ğŸ“„ components/social/PostActions.tsx
ğŸ“Š 154 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/PostActions.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState } from 'react'

interface PostActionsProps {
  isLiked: boolean
  isSaved: boolean
  onLike: () => void | Promise<void> // TÄ°P DÃœZELTMESÄ°
  onSave: () => void | Promise<void> // TÄ°P DÃœZELTMESÄ°
  onComment: () => void
  onShare: () => void
}

export default function PostActions({
  isLiked,
  isSaved,
  onLike,
  onSave,
  onComment,
  onShare
}: PostActionsProps) {
  const [showReactions, setShowReactions] = useState(false)
  const [showShareMenu, setShowShareMenu] = useState(false)

  const reactions = [
    { emoji: 'â¤ï¸', label: 'Like', value: 'like' },
    { emoji: 'ğŸ˜', label: 'Love', value: 'love' },
    { emoji: 'ğŸ˜®', label: 'Wow', value: 'wow' },
    { emoji: 'ğŸ˜‚', label: 'Haha', value: 'laugh' },
    { emoji: 'ğŸ˜¢', label: 'Sad', value: 'sad' },
    { emoji: 'ğŸ˜ ', label: 'Angry', value: 'angry' }
  ]

  const shareOptions = [
    { icon: 'ğŸ“±', label: 'Mesaj', action: 'message' },
    { icon: 'ğŸ“§', label: 'Email', action: 'email' },
    { icon: 'ğŸ”—', label: 'Kopyala', action: 'copy' },
    { icon: 'ğŸ“˜', label: 'Facebook', action: 'facebook' },
    { icon: 'ğŸ¦', label: 'Twitter', action: 'twitter' }
  ]

  const handleReaction = (reaction: string) => {
    console.log('Reaction:', reaction)
    setShowReactions(false)
  }

  const handleShare = (action: string) => {
    console.log('Share action:', action)
    setShowShareMenu(false)
  }

  return (
    <div className="px-6 py-3 border-t border-gray-100">
      <div className="flex items-center justify-between">
        {/* Sol taraf - BeÄŸeni ve yorum */}
        <div className="flex items-center space-x-4">
          {/* BeÄŸeni butonu ve reactions */}
          <div className="relative">
            <button
              onClick={onLike}
              onMouseEnter={() => setShowReactions(true)}
              onMouseLeave={() => setTimeout(() => setShowReactions(false), 500)}
              className={`flex items-center space-x-2 px-3 py-2 rounded-lg transition ${
                isLiked 
                  ? 'bg-red-50 text-red-600' 
                  : 'hover:bg-gray-100 text-gray-700'
              }`}
            >
              <span className="text-xl">{isLiked ? 'â¤ï¸' : 'ğŸ¤'}</span>
              <span className="font-medium">BeÄŸen</span>
            </button>

            {/* Reactions popup */}
            {showReactions && (
              <div 
                className="absolute bottom-full left-0 mb-2 bg-white rounded-xl shadow-2xl border p-2 flex space-x-1 z-50"
                onMouseEnter={() => setShowReactions(true)}
                onMouseLeave={() => setShowReactions(false)}
              >
                {reactions.map((reaction) => (
                  <button
                    key={reaction.value}
                    onClick={() => handleReaction(reaction.value)}
                    className="w-10 h-10 hover:scale-125 transform transition duration-200 text-2xl"
                    title={reaction.label}
                  >
                    {reaction.emoji}
                  </button>
                ))}
              </div>
            )}
          </div>

          {/* Yorum butonu */}
          <button
            onClick={onComment}
            className="flex items-center space-x-2 px-3 py-2 rounded-lg hover:bg-gray-100 text-gray-700"
          >
            <span className="text-xl">ğŸ’¬</span>
            <span className="font-medium">Yorum</span>
          </button>
        </div>

        {/* SaÄŸ taraf - PaylaÅŸ ve kaydet */}
        <div className="flex items-center space-x-2">
          {/* Kaydet butonu */}
          <button
            onClick={onSave}
            className={`p-2 rounded-full ${
              isSaved 
                ? 'bg-yellow-50 text-yellow-600' 
                : 'hover:bg-gray-100 text-gray-700'
            }`}
            title={isSaved ? 'Kaydedildi' : 'Kaydet'}
          >
            <span className="text-xl">
              {isSaved ? 'â­' : 'âœ°'}
            </span>
          </button>

          {/* PaylaÅŸ butonu ve menu */}
          <div className="relative">
            <button
              onClick={() => setShowShareMenu(!showShareMenu)}
              className="p-2 rounded-full hover:bg-gray-100 text-gray-700"
              title="PaylaÅŸ"
            >
              <span className="text-xl">ğŸ“¤</span>
            </button>

            {/* Share menu */}
            {showShareMenu && (
              <div className="absolute right-0 bottom-full mb-2 bg-white rounded-xl shadow-2xl border p-3 w-48 z-50">
                <div className="space-y-2">
                  {shareOptions.map((option) => (
                    <button
                      key={option.action}
                      onClick={() => handleShare(option.action)}
                      className="w-full flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-gray-100 text-gray-700"
                    >
                      <span className="text-xl">{option.icon}</span>
                      <span>{option.label}</span>
                    </button>
                  ))}
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  )
}

ğŸ“„ components/social/PostHeader.tsx
ğŸ“Š 180 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/PostHeader.tsx
'use client'

import { useState } from 'react'
import { MoreVertical, MapPin, Calendar } from 'lucide-react'

interface PostHeaderProps {
  user: any
  post: any
  onFollow?: () => void
  onReport?: () => void
}

export default function PostHeader({ user, post, onFollow, onReport }: PostHeaderProps) {
  const [showMenu, setShowMenu] = useState(false)
  const [isFollowing, setIsFollowing] = useState(false)

  const handleFollow = () => {
    setIsFollowing(!isFollowing)
    if (onFollow) onFollow()
  }

  const handleReport = () => {
    setShowMenu(false)
    if (onReport) onReport()
  }

  const formatDate = (dateString: string) => {
    const date = new Date(dateString)
    const now = new Date()
    const diffMs = now.getTime() - date.getTime()
    const diffHours = Math.floor(diffMs / (1000 * 60 * 60))
    
    if (diffHours < 1) {
      return 'Az Ã¶nce'
    } else if (diffHours < 24) {
      return `${diffHours} saat Ã¶nce`
    } else {
      return date.toLocaleDateString('tr-TR')
    }
  }

  return (
    <div className="px-6 py-4">
      <div className="flex items-start justify-between">
        {/* Sol taraf - KullanÄ±cÄ± bilgileri */}
        <div className="flex items-center space-x-3">
          {/* Avatar */}
          <div className="relative">
            <div className="w-12 h-12 rounded-full overflow-hidden bg-gradient-to-br from-blue-400 to-purple-500">
              {user?.avatar_url ? (
                <img
                  src={user.avatar_url}
                  alt={user?.name || 'KullanÄ±cÄ±'}
                  className="w-full h-full object-cover"
                />
              ) : (
                <div className="w-full h-full flex items-center justify-center text-white font-bold text-lg">
                  {user?.name?.[0]?.toUpperCase() || 'K'}
                </div>
              )}
            </div>
            
            {/* Online status indicator */}
            <div className="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full"></div>
          </div>

          {/* KullanÄ±cÄ± bilgileri */}
          <div className="flex-1">
            <div className="flex items-center space-x-2">
              <h4 className="font-bold text-gray-900">
                {user?.name || 'KullanÄ±cÄ±'}
              </h4>
              
              {/* Verified badge (maÄŸaza veya premium kullanÄ±cÄ±) */}
              {post?.shop_id && (
                <span className="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">
                  ğŸª MaÄŸaza
                </span>
              )}
              
              {/* Seviye badge */}
              {user?.reputation?.level && user.reputation.level > 2 && (
                <span className="bg-yellow-100 text-yellow-800 text-xs px-2 py-0.5 rounded-full">
                  â­ Lv.{user.reputation.level}
                </span>
              )}
            </div>
            
            <div className="flex items-center text-sm text-gray-500 space-x-3 mt-1">
              {post?.location && (
                <div className="flex items-center">
                  <MapPin className="w-3 h-3 mr-1" />
                  <span>{post.location}</span>
                </div>
              )}
              
              <div className="flex items-center">
                <Calendar className="w-3 h-3 mr-1" />
                <span>{formatDate(post.created_at)}</span>
              </div>
            </div>
          </div>
        </div>

        {/* SaÄŸ taraf - MenÃ¼ ve takip butonu */}
        <div className="flex items-center space-x-2">
          {/* Takip butonu */}
          <button
            onClick={handleFollow}
            className={`px-4 py-2 rounded-full text-sm font-medium ${
              isFollowing
                ? 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                : 'bg-blue-600 text-white hover:bg-blue-700'
            }`}
          >
            {isFollowing ? 'Takip Ediliyor' : 'Takip Et'}
          </button>

          {/* Daha fazla menÃ¼sÃ¼ */}
          <div className="relative">
            <button
              onClick={() => setShowMenu(!showMenu)}
              className="p-2 hover:bg-gray-100 rounded-full"
            >
              <MoreVertical className="w-5 h-5 text-gray-500" />
            </button>

            {showMenu && (
              <div className="absolute right-0 top-full mt-1 bg-white rounded-lg shadow-lg border w-48 z-50">
                <button
                  onClick={() => {
                    setShowMenu(false)
                    // PaylaÅŸÄ±mÄ± kaydet
                  }}
                  className="w-full text-left px-4 py-3 hover:bg-gray-50 text-gray-700"
                >
                  ğŸ“Œ Kaydet
                </button>
                <button
                  onClick={() => {
                    setShowMenu(false)
                    // BaÄŸlantÄ±yÄ± kopyala
                  }}
                  className="w-full text-left px-4 py-3 hover:bg-gray-50 text-gray-700"
                >
                  ğŸ”— BaÄŸlantÄ±yÄ± Kopyala
                </button>
                <button
                  onClick={handleReport}
                  className="w-full text-left px-4 py-3 hover:bg-gray-50 text-red-600 border-t"
                >
                  âš ï¸ Bildir
                </button>
              </div>
            )}
          </div>
        </div>
      </div>

      {/* Post tipi indicator */}
      {post?.type && (
        <div className="mt-3">
          <span className={`inline-block px-3 py-1 rounded-full text-xs font-medium ${
            post.type === 'sighting' 
              ? 'bg-green-100 text-green-800' 
              : post.type === 'collection'
              ? 'bg-purple-100 text-purple-800'
              : 'bg-blue-100 text-blue-800'
          }`}>
            {post.type === 'sighting' && 'ğŸ‘ï¸ GÃ¶rÃ¼ldÃ¼'}
            {post.type === 'collection' && 'ğŸ† Koleksiyon'}
            {post.type === 'question' && 'â“ Soru'}
            {post.type === 'showcase' && 'âœ¨ Vitrin'}
          </span>
        </div>
      )}
    </div>
  )
}

ğŸ“„ components/social/StoriesBar.tsx
ğŸ“Š 36 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/StoriesBar.tsx - BASÄ°T
'use client'

export default function StoriesBar() {
  const stories = [
    { id: 1, user: 'Ahmet', hasNew: true },
    { id: 2, user: 'Zeynep', hasNew: false },
    { id: 3, user: 'Mehmet', hasNew: true },
    { id: 4, user: 'AyÅŸe', hasNew: false },
    { id: 5, user: 'Can', hasNew: true },
  ]

  return (
    <div className="bg-white rounded-xl shadow p-4 mb-6">
      <div className="flex space-x-4 overflow-x-auto pb-2">
        {/* Kendi story */}
        <button className="flex-shrink-0 text-center">
          <div className="w-20 h-20 rounded-full border-4 border-blue-500 flex items-center justify-center text-2xl bg-gradient-to-br from-blue-400 to-purple-500 text-white">
            +
          </div>
          <div className="text-xs mt-2">Sen</div>
        </button>

        {/* DiÄŸer story'ler */}
        {stories.map((story) => (
          <button key={story.id} className="flex-shrink-0 text-center">
            <div className={`w-20 h-20 rounded-full ${story.hasNew ? 'border-4 border-green-500' : 'border-2 border-gray-300'}`}>
              <div className="w-full h-full rounded-full bg-gradient-to-br from-pink-400 to-orange-500"></div>
            </div>
            <div className="text-xs mt-2 truncate w-20">{story.user}</div>
          </button>
        ))}
      </div>
    </div>
  )
}

ğŸ“„ components/SpotCard.tsx
ğŸ“Š 250 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import Link from 'next/link'

interface SpotCardProps {
  spot: {
    id: string
    title: string
    description: string
    category: string | null
    location: string | null
    image_url: string | null
    status: string
    created_at: string
    views: number
    helps: number
    user?: {
      name: string | null
    }
  }
}

export default function SpotCard({ spot }: SpotCardProps) {
  // ZAMAN FORMATI
  const getTimeAgo = (dateString: string) => {
    try {
      const date = new Date(dateString)
      const now = new Date()
      const diffMs = now.getTime() - date.getTime()
      const diffMins = Math.floor(diffMs / 60000)
      const diffHours = Math.floor(diffMs / 3600000)
      const diffDays = Math.floor(diffMs / 86400000)

      if (diffMins < 1) return 'ÅŸimdi'
      if (diffMins < 60) return `${diffMins} dakika Ã¶nce`
      if (diffHours < 24) return `${diffHours} saat Ã¶nce`
      if (diffDays < 7) return `${diffDays} gÃ¼n Ã¶nce`
      return date.toLocaleDateString('tr-TR')
    } catch {
      return 'tarih belirsiz'
    }
  }

  // RESÄ°M URL'SÄ°NÄ° HAZIRLA
  const getImageUrl = (): string | null => {
    if (!spot.image_url) return null
    
    let url = spot.image_url
    
    // 1. NULL veya boÅŸ mu?
    if (!url || url.trim() === '') return null
    
    // 2. String mi?
    if (typeof url !== 'string') {
      console.error('image_url string deÄŸil:', typeof url, url)
      return null
    }
    
    // 3. Trim yap
    url = url.trim()
    
    // 4. TÄ±rnak iÅŸaretlerini temizle
    url = url.replace(/["']/g, '')
    
    // 5. BaÅŸÄ±na https:// ekle (gerekirse)
    if (url.startsWith('//')) {
      url = 'https:' + url
    }
    
    // 6. http:// ile baÅŸlÄ±yorsa https:// yap
    if (url.startsWith('http://')) {
      url = url.replace('http://', 'https://')
    }
    
    // 7. Supabase URL kontrolÃ¼
    if (url.includes('supabase.co')) {
      // /object/public/ kontrolÃ¼
      if (url.includes('/storage/v1/object/') && !url.includes('/public/')) {
        url = url.replace('/object/', '/object/public/')
      }
    }
    
    // 8. GeÃ§erli URL mi?
    try {
      new URL(url)
      return url
    } catch {
      console.error('GeÃ§ersiz URL:', url)
      return null
    }
  }

  const imageUrl = getImageUrl()
  const hasImage = !!imageUrl

  // KATEGORÄ° RENGÄ°
  const getCategoryColor = (category: string | null) => {
    if (!category) return 'bg-gray-100 text-gray-800'
    
    const colors: Record<string, string> = {
      'Elektronik': 'bg-blue-100 text-blue-800',
      'FotoÄŸraf Makineleri': 'bg-blue-100 text-blue-800',
      'Giyim & Aksesuar': 'bg-green-100 text-green-800',
      'Ev & BahÃ§e': 'bg-yellow-100 text-yellow-800',
      'Ev EÅŸyalarÄ±': 'bg-yellow-100 text-yellow-800',
      'Koleksiyon': 'bg-purple-100 text-purple-800',
      'Kitap & MÃ¼zik': 'bg-red-100 text-red-800',
      'Oyunlar': 'bg-indigo-100 text-indigo-800',
      'Spor & Outdoor': 'bg-pink-100 text-pink-800',
      'AraÃ§ & ParÃ§a': 'bg-gray-100 text-gray-800',
      'DiÄŸer': 'bg-gray-100 text-gray-800'
    }
    
    return colors[category] || 'bg-gray-100 text-gray-800'
  }

  return (
    <div className="bg-white rounded-xl shadow-md hover:shadow-lg transition duration-300 overflow-hidden border border-gray-100">
      {/* RESÄ°M BÃ–LÃœMÃœ - KESÄ°N Ã‡ALIÅACAK */}
      <div className="h-48 bg-gray-100 relative">
        {hasImage ? (
          <>
            {/* RESÄ°M */}
            <img
              src={imageUrl}
              alt={spot.title}
              className="w-full h-full object-cover"
              onLoad={() => console.log(`âœ… Resim yÃ¼klendi: ${spot.id}`)}
              onError={(e) => {
                console.error(`âŒ Resim yÃ¼klenemedi: ${imageUrl}`)
                const img = e.target as HTMLImageElement
                img.style.display = 'none'
                
                // FALLBACK gÃ¶ster
                const fallback = document.createElement('div')
                fallback.className = 'absolute inset-0 flex items-center justify-center bg-gray-200'
                fallback.innerHTML = `
                  <div class="text-center">
                    <span class="text-3xl block mb-2">ğŸ“·</span>
                    <p class="text-sm text-gray-600">Resim yÃ¼klenemedi</p>
                  </div>
                `
                img.parentNode?.appendChild(fallback)
              }}
            />
            
            {/* Yedek gÃ¶rÃ¼nÃ¼m (resim yÃ¼klenene kadar) */}
            <div className="absolute inset-0 flex items-center justify-center bg-gray-100" style={{ display: 'none' }}>
              <div className="text-center">
                <span className="text-3xl block mb-2">ğŸ“·</span>
                <p className="text-sm text-gray-600">Resim yÃ¼kleniyor...</p>
              </div>
            </div>
          </>
        ) : (
          // RESÄ°M YOKSA
          <div className="w-full h-full flex items-center justify-center bg-gray-50">
            <div className="text-center">
              <span className="text-4xl block mb-3 text-gray-400">ğŸ“·</span>
              <p className="text-sm text-gray-500">Resim Yok</p>
            </div>
          </div>
        )}
        
        {/* DURUM BADGE */}
        <div className="absolute top-3 right-3">
          <span className={`px-3 py-1 rounded-full text-xs font-medium ${
            spot.status === 'active' 
              ? 'bg-green-100 text-green-800 border border-green-200' 
              : 'bg-blue-100 text-blue-800 border border-blue-200'
          }`}>
            {spot.status === 'active' ? 'Aktif' : 'Bulundu'}
          </span>
        </div>
      </div>

      {/* Ä°Ã‡ERÄ°K BÃ–LÃœMÃœ */}
      <div className="p-5">
        {/* KULLANICI */}
        <div className="flex items-center mb-4">
          <div className="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
            {spot.user?.name?.[0]?.toUpperCase() || 'K'}
          </div>
          <div className="ml-3">
            <p className="font-medium text-sm">
              {spot.user?.name || 'KullanÄ±cÄ±'}
            </p>
            <p className="text-xs text-gray-500">
              {getTimeAgo(spot.created_at)}
            </p>
          </div>
        </div>

        {/* BAÅLIK */}
        <Link href={`/spots/${spot.id}`}>
          <h3 className="font-bold text-lg mb-2 hover:text-blue-600 line-clamp-1">
            {spot.title}
          </h3>
        </Link>
        
        {/* AÃ‡IKLAMA */}
        <p className="text-gray-600 text-sm mb-4 line-clamp-2">
          {spot.description}
        </p>

        {/* KATEGORÄ° & KONUM */}
        <div className="flex flex-wrap gap-2 mb-4">
          {spot.category && (
            <span className={`text-xs font-medium px-3 py-1 rounded-full ${getCategoryColor(spot.category)}`}>
              {spot.category}
            </span>
          )}
          
          {spot.location && (
            <span className="text-sm text-gray-500 flex items-center">
              <span className="mr-1">ğŸ“</span>
              {spot.location}
            </span>
          )}
        </div>

        {/* Ä°STATÄ°STÄ°KLER */}
        <div className="flex items-center justify-between text-sm text-gray-500 border-t border-gray-100 pt-4">
          <div className="flex items-center space-x-4">
            <span className="flex items-center">
              ğŸ‘ï¸ {spot.views || 0}
            </span>
            <span className="flex items-center">
              ğŸ¤ {spot.helps || 0}
            </span>
          </div>
          
          <Link 
            href={`/spots/${spot.id}`}
            className="text-blue-600 hover:text-blue-800 font-medium"
          >
            Detay â†’
          </Link>
        </div>

        {/* DEBUG: RESÄ°M BÄ°LGÄ°SÄ° */}
        {hasImage && process.env.NODE_ENV === 'development' && (
          <div className="mt-3 pt-3 border-t border-dashed border-gray-200">
            <p className="text-xs text-gray-400 truncate" title={imageUrl}>
              ğŸ”— {imageUrl.substring(0, 40)}...
            </p>
          </div>
        )}
      </div>
    </div>
  )
}

ğŸ“„ components/SpotList.tsx
ğŸ“Š 162 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SpotList.tsx - GÃœNCELLENMÄ°Å
'use client';

import { useEffect, useState } from 'react';
import { supabase } from '@/lib/supabase';
import SpotCard from './SpotCard';
import NativeAd from './NativeAd';

interface SpotListProps {
  searchQuery?: string;
  category?: string;
  location?: string;
  status?: string;
}

export default function SpotList({ 
  searchQuery, 
  category, 
  location, 
  status 
}: SpotListProps) {
  const [spots, setSpots] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [page, setPage] = useState(1);
  const [hasMore, setHasMore] = useState(true);

  const loadSpots = async (pageNum = 1) => {
    setLoading(true);
    
    let query = supabase
      .from('spots')
      .select('*')
      .eq('status', 'active')
      .order('created_at', { ascending: false });

    // Filtreler
    if (searchQuery) {
      query = query.or(`title.ilike.%${searchQuery}%,description.ilike.%${searchQuery}%`);
    }
    if (category && category !== 'all') {
      query = query.eq('category', category);
    }
    if (location && location !== 'all') {
      query = query.eq('location', location);
    }

    const { data, error } = await query
      .range((pageNum - 1) * 12, pageNum * 12 - 1);

    if (error) {
      console.error('Error loading spots:', error);
      return;
    }

    if (pageNum === 1) {
      setSpots(data || []);
    } else {
      setSpots(prev => [...prev, ...(data || [])]);
    }

    setHasMore((data?.length || 0) === 12);
    setLoading(false);
  };

  useEffect(() => {
    loadSpots(1);
    setPage(1);
  }, [searchQuery, category, location, status]);

  const loadMore = () => {
    const nextPage = page + 1;
    setPage(nextPage);
    loadSpots(nextPage);
  };

  // ReklamlarÄ± spotlar arasÄ±na serpiÅŸtir
  const getItemsWithAds = () => {
    const items: any[] = [];
    const adFrequency = 4; // Her 4 spot'ta bir reklam
    
    spots.forEach((spot, index) => {
      items.push({
        type: 'spot',
        data: spot,
        key: `spot-${spot.id}`
      });
      
      // Belirli aralÄ±klarla reklam ekle
      if ((index + 1) % adFrequency === 0) {
        items.push({
          type: 'ad',
          key: `ad-${index}`,
          index: index
        });
      }
    });
    
    return items;
  };

  const items = getItemsWithAds();

  return (
    <div>
      {/* Spot Grid */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {items.map((item) => {
          if (item.type === 'spot') {
            return (
              <SpotCard key={item.key} spot={item.data} />
            );
          } else {
            return (
              <div key={item.key} className="col-span-full md:col-span-2 lg:col-span-3">
                <NativeAd index={item.index} />
              </div>
            );
          }
        })}
      </div>

      {/* Loading */}
      {loading && (
        <div className="text-center py-8">
          <div className="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
          <p className="mt-2 text-gray-600">Spot'lar yÃ¼kleniyor...</p>
        </div>
      )}

      {/* Load More */}
      {!loading && hasMore && spots.length > 0 && (
        <div className="text-center mt-8">
          <button
            onClick={loadMore}
            className="bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-3 px-8 rounded-lg transition-colors"
          >
            Daha Fazla Spot GÃ¶ster
          </button>
        </div>
      )}

      {/* No Results */}
      {!loading && spots.length === 0 && (
        <div className="text-center py-12">
          <div className="text-4xl mb-4">ğŸ”</div>
          <h3 className="text-xl font-semibold text-gray-800 mb-2">
            Spot bulunamadÄ±
          </h3>
          <p className="text-gray-600 mb-6">
            Arama kriterlerinize uygun spot bulunamadÄ±.
          </p>
          <a
            href="/create-spot"
            className="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg"
          >
            Ä°lk Spot'u Siz OluÅŸturun
          </a>
        </div>
      )}
    </div>
  );
}

ğŸ“„ components/Stats.tsx
ğŸ“Š 72 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

export default function Stats() {
  const stats = [
    { value: '10,000+', label: 'Aktif Spot', icon: 'ğŸ“', color: 'from-blue-500 to-blue-600' },
    { value: '50,000+', label: 'Topluluk Ãœyesi', icon: 'ğŸ‘¥', color: 'from-purple-500 to-purple-600' },
    { value: '5,000+', label: 'BaÅŸarÄ± Hikayesi', icon: 'ğŸ‰', color: 'from-green-500 to-green-600' },
    { value: '100+', label: 'Åehir', icon: 'ğŸ“', color: 'from-orange-500 to-orange-600' },
    { value: '24s', label: 'Ort. YanÄ±t SÃ¼resi', icon: 'âš¡', color: 'from-pink-500 to-pink-600' },
    { value: '94%', label: 'Memnuniyet OranÄ±', icon: 'â­', color: 'from-indigo-500 to-indigo-600' },
  ]

  return (
    <section className="py-16 bg-gradient-to-b from-white to-gray-50">
      <div className="container-custom">
        <div className="text-center mb-12">
          <h2 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            SpotItForMe Ä°statistikleri
          </h2>
          <p className="text-gray-600 max-w-2xl mx-auto">
            TÃ¼rkiye'nin en bÃ¼yÃ¼k kayÄ±p Ã¼rÃ¼n bulma topluluÄŸu olarak her gÃ¼n binlerce kiÅŸiye yardÄ±m ediyoruz
          </p>
        </div>

        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6">
          {stats.map((stat, index) => (
            <div 
              key={index}
              className="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 border border-gray-100"
            >
              <div className={`w-16 h-16 rounded-xl bg-gradient-to-br ${stat.color} flex items-center justify-center text-2xl text-white mx-auto mb-4`}>
                {stat.icon}
              </div>
              
              <div className="text-center">
                <div className="text-2xl md:text-3xl font-bold text-gray-900 mb-1">
                  {stat.value}
                </div>
                <div className="text-sm text-gray-600 font-medium">
                  {stat.label}
                </div>
              </div>
            </div>
          ))}
        </div>

        {/* CanlÄ± aktivite */}
        <div className="mt-12 bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-8 border border-blue-100">
          <div className="flex flex-col md:flex-row items-center justify-between">
            <div>
              <h3 className="text-xl font-bold text-gray-900 mb-2">ğŸ¯ Åu Anda Aktif Aramalar</h3>
              <p className="text-gray-600">
                <span className="font-bold text-blue-600">127 kiÅŸi</span> ÅŸu anda topluluÄŸumuzdan yardÄ±m bekliyor
              </p>
            </div>
            <div className="mt-4 md:mt-0">
              <div className="flex items-center space-x-4">
                <div className="flex -space-x-2">
                  {[1, 2, 3, 4, 5].map((i) => (
                    <div 
                      key={i}
                      className="w-10 h-10 rounded-full border-2 border-white bg-gradient-to-br from-blue-400 to-purple-400"
                    />
                  ))}
                </div>
                <span className="text-sm text-gray-600">+ daha fazlasÄ± yardÄ±m ediyor</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

ğŸ“„ components/UserMenu.tsx
ğŸ“Š 147 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import AuthModal from './AuthModal'

interface User {
  id: string
  email: string
  name?: string
}

export default function UserMenu() {
  const [user, setUser] = useState<User | null>(null)
  const [showAuthModal, setShowAuthModal] = useState(false)
  const [showDropdown, setShowDropdown] = useState(false)

  useEffect(() => {
    // Mevcut kullanÄ±cÄ±yÄ± kontrol et
    checkUser()
    
    // Auth state deÄŸiÅŸikliklerini dinle
    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {
      if (session?.user) {
        setUser({
          id: session.user.id,
          email: session.user.email!,
          name: session.user.user_metadata?.name,
        })
      } else {
        setUser(null)
      }
    })

    return () => subscription.unsubscribe()
  }, [])

  const checkUser = async () => {
    const { data: { user } } = await supabase.auth.getUser()
    if (user) {
      setUser({
        id: user.id,
        email: user.email!,
        name: user.user_metadata?.name,
      })
    }
  }

  const handleLogout = async () => {
    await supabase.auth.signOut()
    setUser(null)
    setShowDropdown(false)
  }

  if (!user) {
    return (
      <>
        <button
          onClick={() => setShowAuthModal(true)}
          className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition duration-200"
        >
          GiriÅŸ Yap / KayÄ±t Ol
        </button>
        
        <AuthModal
          isOpen={showAuthModal}
          onClose={() => setShowAuthModal(false)}
        />
      </>
    )
  }

  return (
    <div className="relative">
      <button
        onClick={() => setShowDropdown(!showDropdown)}
        className="flex items-center space-x-3 bg-gray-100 hover:bg-gray-200 rounded-full pl-3 pr-4 py-2 transition duration-200"
      >
        <div className="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
          {user.name?.[0]?.toUpperCase() || user.email[0].toUpperCase()}
        </div>
        <div className="text-left hidden md:block">
          <p className="font-medium text-sm">{user.name || 'KullanÄ±cÄ±'}</p>
          <p className="text-xs text-gray-500 truncate max-w-[120px]">{user.email}</p>
        </div>
      </button>

      {showDropdown && (
        <div className="absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-lg border z-50">
          <div className="p-4 border-b">
            <p className="font-medium">{user.name || 'KullanÄ±cÄ±'}</p>
            <p className="text-sm text-gray-500 truncate">{user.email}</p>
          </div>
          
          <div className="p-2">
            <a
              href="/profile"
              className="flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 rounded-lg"
            >
              <span>ğŸ‘¤</span>
              <span>Profilim</span>
            </a>
            <a
              href="/my-spots"
              className="flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 rounded-lg"
            >
              <span>ğŸ“</span>
              <span>Spot'larÄ±m</span>
            </a>
            <a
              href="/help-given"
              className="flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 rounded-lg"
            >
              <span>ğŸ¤</span>
              <span>YardÄ±mlarÄ±m</span>
            </a>
            <a
              href="/settings"
              className="flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 rounded-lg"
            >
              <span>âš™ï¸</span>
              <span>Ayarlar</span>
            </a>
          </div>
          
          <div className="border-t p-2">
            <button
              onClick={handleLogout}
              className="flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 w-full rounded-lg"
            >
              <span>ğŸšª</span>
              <span>Ã‡Ä±kÄ±ÅŸ Yap</span>
            </button>
          </div>
        </div>
      )}

      {/* Dropdown dÄ±ÅŸÄ±na tÄ±klayÄ±nca kapat */}
      {showDropdown && (
        <div
          className="fixed inset-0 z-40"
          onClick={() => setShowDropdown(false)}
        />
      )}
    </div>
  )
}

ğŸ“„ components/UserProfileCard.tsx
ğŸ“Š 164 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/UserProfileCard.tsx
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import { GamificationEngine } from '@/lib/gamification/game-engine'

interface UserProfileCardProps {
  userId: string
  compact?: boolean
}

export default function UserProfileCard({ userId, compact = false }: UserProfileCardProps) {
  const [profile, setProfile] = useState<any>(null)
  const [reputation, setReputation] = useState<any>(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchUserData()
  }, [userId])

  const fetchUserData = async () => {
    try {
      const [{ data: profileData }, { data: repData }] = await Promise.all([
        supabase.from('user_profiles').select('*').eq('id', userId).single(),
        supabase.from('user_reputation').select('*').eq('user_id', userId).single()
      ])

      setProfile(profileData)
      setReputation(repData)
    } catch (error) {
      console.error('Profil yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  if (loading) {
    return <div className="animate-pulse bg-gray-200 rounded-lg h-32"></div>
  }

  const userLevel = GamificationEngine.LEVELS.find(l => l.level === reputation?.current_level) || GamificationEngine.LEVELS[0]
  const nextLevel = GamificationEngine.LEVELS.find(l => l.level === (reputation?.current_level || 0) + 1)

  return (
    <div className={`bg-white rounded-xl shadow-lg ${compact ? 'p-4' : 'p-6'}`}>
      {/* Ãœst KÄ±sÄ±m - Avatar ve Temel Bilgiler */}
      <div className="flex items-start space-x-4">
        <div className="relative">
          <div className={`w-${compact ? '12' : '16'} h-${compact ? '12' : '16'} rounded-full border-4`} 
               style={{ borderColor: userLevel.color }}>
            {profile?.avatar_url ? (
              <img src={profile.avatar_url} alt={profile.name} className="w-full h-full rounded-full" />
            ) : (
              <div className={`w-full h-full rounded-full bg-gradient-to-br from-${userLevel.color}-400 to-${userLevel.color}-600 flex items-center justify-center text-white font-bold text-${compact ? 'lg' : 'xl'}`}>
                {profile?.name?.[0] || 'K'}
              </div>
            )}
          </div>
          
          {/* Seviye GÃ¶stergesi */}
          {!compact && (
            <div className="absolute -bottom-2 -right-2 bg-white rounded-full p-1 shadow-lg">
              <div className={`w-8 h-8 rounded-full bg-gradient-to-br from-${userLevel.color}-400 to-${userLevel.color}-600 flex items-center justify-center text-white text-xs font-bold`}>
                {userLevel.level}
              </div>
            </div>
          )}
        </div>

        <div className="flex-1">
          <div className="flex items-center justify-between">
            <div>
              <h3 className={`font-bold ${compact ? 'text-lg' : 'text-xl'}`}>
                {profile?.name || 'KullanÄ±cÄ±'}
              </h3>
              <p className={`text-${userLevel.color}-600 font-medium ${compact ? 'text-sm' : ''}`}>
                {userLevel.name}
              </p>
            </div>
            
            {!compact && (
              <div className="text-right">
                <div className="text-2xl font-bold text-gray-900">
                  {reputation?.total_points || 0}
                </div>
                <div className="text-sm text-gray-500">Toplam Puan</div>
              </div>
            )}
          </div>

          {/* Progress Bar */}
          {!compact && nextLevel && (
            <div className="mt-4">
              <div className="flex justify-between text-sm mb-1">
                <span className="text-gray-600">Seviye {userLevel.level}</span>
                <span className="font-medium">
                  {reputation?.total_points || 0} / {nextLevel.minPoints} puan
                </span>
              </div>
              <div className="w-full bg-gray-200 rounded-full h-2">
                <div 
                  className="h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-600"
                  style={{ 
                    width: `${Math.min(100, ((reputation?.total_points || 0) / nextLevel.minPoints) * 100)}%` 
                  }}
                ></div>
              </div>
              <p className="text-xs text-gray-500 mt-1">
                {nextLevel.minPoints - (reputation?.total_points || 0)} puan kaldÄ±: <strong>{nextLevel.name}</strong>
              </p>
            </div>
          )}
        </div>
      </div>

      {/* Rozetler */}
      {!compact && reputation?.badges && reputation.badges.length > 0 && (
        <div className="mt-6">
          <h4 className="font-medium text-gray-700 mb-3">KazanÄ±lan Rozetler</h4>
          <div className="flex flex-wrap gap-2">
            {reputation.badges.slice(0, 6).map((badgeId: string) => {
              const badge = Object.values(GamificationEngine.BADGES).find(b => b.id === badgeId)
              return badge ? (
                <div key={badge.id} className="tooltip" data-tip={badge.name}>
                  <div className="w-10 h-10 rounded-full bg-gradient-to-br from-yellow-100 to-yellow-300 flex items-center justify-center text-lg">
                    {badge.icon}
                  </div>
                </div>
              ) : null
            })}
            {reputation.badges.length > 6 && (
              <div className="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 font-medium">
                +{reputation.badges.length - 6}
              </div>
            )}
          </div>
        </div>
      )}

      {/* Ä°statistikler (Compact modda gizle) */}
      {!compact && (
        <div className="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4">
          <div className="text-center">
            <div className="text-2xl font-bold text-blue-600">{reputation?.total_sightings || 0}</div>
            <div className="text-sm text-gray-600">YardÄ±m</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-green-600">{reputation?.total_photos || 0}</div>
            <div className="text-sm text-gray-600">FotoÄŸraf</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-purple-600">{reputation?.total_rare_finds || 0}</div>
            <div className="text-sm text-gray-600">Nadir BuluÅŸ</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-orange-600">{reputation?.daily_streak || 0}</div>
            <div className="text-sm text-gray-600">GÃ¼n Streak</div>
          </div>
        </div>
      )}
    </div>
  )
}

====================================================================================================
ğŸ”§ UTILITY DOSYALARI
====================================================================================================

ğŸ“„ lib/email-server.ts
ğŸ“Š 332 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// lib/email-server.ts
'use server'

import nodemailer from 'nodemailer'

// Email transporter oluÅŸtur
const transporter = nodemailer.createTransport({
  service: 'gmail',
  auth: {
    user: process.env.GMAIL_USER,
    pass: process.env.GMAIL_APP_PASS
  }
})

// Server Action: HoÅŸgeldin emaili gÃ¶nder
export async function sendWelcomeEmail(to: string, name: string): Promise<{ success: boolean; message: string }> {
  try {
    const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://spotitforme.vercel.app'
    
    await transporter.sendMail({
      from: `"SpotItForMe" <${process.env.GMAIL_USER}>`,
      to,
      subject: `ğŸ‰ SpotItForMe TopluluÄŸuna HoÅŸ Geldin ${name}!`,
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; background: #f5f7fa; padding: 20px;">
          <div style="background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;">
            <h1 style="color: white; margin: 0; font-size: 24px;">ğŸ¤ HoÅŸ Geldiniz!</h1>
          </div>
          
          <div style="background: white; padding: 30px; border: 1px solid #e5e7eb; border-top: none; border-radius: 0 0 10px 10px;">
            <p>Merhaba <strong>${name}</strong>,</p>
            <p>SpotItForMe topluluÄŸuna katÄ±ldÄ±ÄŸÄ±nÄ±z iÃ§in Ã§ok mutluyuz! ğŸ‰</p>
            
            <div style="background: #faf5ff; padding: 20px; border-radius: 8px; margin: 20px 0;">
              <p><strong>ğŸš€ Hemen BaÅŸlayÄ±n:</strong></p>
              <div style="display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 15px;">
                <a href="${siteUrl}/create-spot" style="background: #8b5cf6; color: white; padding: 12px; text-align: center; border-radius: 8px; text-decoration: none; font-weight: bold;">
                  Ä°lk Spot'unu OluÅŸtur
                </a>
                <a href="${siteUrl}/spots" style="background: #f1f5f9; color: #475569; padding: 12px; text-align: center; border-radius: 8px; text-decoration: none;">
                  Spot'larÄ± KeÅŸfet
                </a>
                <a href="${siteUrl}/how-it-works" style="background: #f1f5f9; color: #475569; padding: 12px; text-align: center; border-radius: 8px; text-decoration: none;">
                  NasÄ±l Ã‡alÄ±ÅŸÄ±r?
                </a>
              </div>
            </div>

            <p><strong>âœ¨ Platform Ã–zellikleri:</strong></p>
            <ul style="padding-left: 20px;">
              <li>âœ… Ãœcretsiz spot oluÅŸturma</li>
              <li>âœ… Binlerce aktif topluluk Ã¼yesi</li>
              <li>âœ… AnlÄ±k yardÄ±m bildirimleri</li>
              <li>âœ… Mobil uyumlu tasarÄ±m</li>
              <li>âœ… GÃ¼venli ve gizli</li>
            </ul>

            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 30px 0;" />

            <p style="font-size: 12px; color: #6b7280; text-align: center;">
              SorularÄ±nÄ±z iÃ§in: <a href="mailto:${process.env.GMAIL_USER}" style="color: #6b7280;">${process.env.GMAIL_USER}</a><br/>
              <a href="${siteUrl}" style="color: #6b7280;">${siteUrl}</a>
            </p>
          </div>
        </div>
      `,
      text: `SpotItForMe'ye HoÅŸ Geldiniz!\n\nMerhaba ${name},\n\nSpotItForMe topluluÄŸuna katÄ±ldÄ±ÄŸÄ±nÄ±z iÃ§in teÅŸekkÃ¼r ederiz.\n\nHemen baÅŸlayÄ±n: ${siteUrl}/create-spot\n\nÄ°yi kullanÄ±mlar!`
    })

    console.log('âœ… HoÅŸgeldin emaili gÃ¶nderildi:', to)
    return { success: true, message: 'Email gÃ¶nderildi' }
  } catch (error) {
    console.error('âŒ HoÅŸgeldin emaili gÃ¶nderilemedi:', error)
    return { success: false, message: 'Email gÃ¶nderilemedi' }
  }
}

// Server Action: MaÄŸaza kayÄ±t emaili gÃ¶nder
export async function sendBusinessRegistrationEmail(to: string, shopName: string, ownerId: string): Promise<{ success: boolean; message: string }> {
  try {
    const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://spotitforme.vercel.app'
    
    await transporter.sendMail({
      from: `"SpotItForme Ä°ÅŸletme" <${process.env.GMAIL_USER}>`,
      to,
      cc: process.env.ADMIN_EMAIL,
      subject: `ğŸª MaÄŸaza KaydÄ±nÄ±z AlÄ±ndÄ±: ${shopName}`,
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; background: #f5f7fa; padding: 20px;">
          <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;">
            <h1 style="color: white; margin: 0; font-size: 24px;">ğŸª MaÄŸaza KaydÄ±nÄ±z AlÄ±ndÄ±!</h1>
          </div>
          
          <div style="background: white; padding: 30px; border: 1px solid #e5e7eb; border-top: none; border-radius: 0 0 10px 10px;">
            <p>Merhaba,</p>
            <p><strong>${shopName}</strong> maÄŸazanÄ±z iÃ§in kaydÄ±nÄ±z baÅŸarÄ±yla alÄ±ndÄ±! ğŸ‰</p>
            
            <div style="background: #f0fdf4; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #10b981;">
              <p><strong>ğŸ¯ Sonraki AdÄ±mlar:</strong></p>
              <ol style="margin-left: 20px;">
                <li>MaÄŸaza profilinizi tamamlayÄ±n</li>
                <li>Ä°lk Ã¼rÃ¼nlerinizi ekleyin</li>
                <li>Spot'lara cevap verin</li>
                <li>Premium paketlere geÃ§erek limitlerinizi artÄ±rÄ±n</li>
              </ol>
            </div>

            <div style="text-align: center; margin: 30px 0;">
              <a href="${siteUrl}/shop/dashboard" style="background: #10b981; color: white; padding: 12px 30px; text-decoration: none; border-radius: 8px; display: inline-block; font-weight: bold; margin: 5px;">
                MaÄŸaza Paneline Git
              </a>
              <a href="${siteUrl}/create-spot" style="background: #3b82f6; color: white; padding: 12px 30px; text-decoration: none; border-radius: 8px; display: inline-block; font-weight: bold; margin: 5px;">
                Ä°lk Spot'u OluÅŸtur
              </a>
            </div>

            <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">
              <p><strong>ğŸ“Š MaÄŸaza Ä°statistikleriniz:</strong></p>
              <p>âœ… <strong>Paket:</strong> Ãœcretsiz BaÅŸlangÄ±Ã§</p>
              <p>âœ… <strong>Resim Limiti:</strong> 20 adet Ã¼cretsiz</p>
              <p>âœ… <strong>Spot Limiti:</strong> SÄ±nÄ±rsÄ±z</p>
              <p>âœ… <strong>Destek:</strong> Email ile 7/24</p>
            </div>

            <p><strong>ğŸ“ Ä°letiÅŸim:</strong></p>
            <p>Herhangi bir sorunuz iÃ§in: <a href="mailto:${process.env.GMAIL_USER}" style="color: #3b82f6;">${process.env.GMAIL_USER}</a></p>

            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 30px 0;" />

            <p style="font-size: 12px; color: #6b7280; text-align: center;">
              SpotItForme Ä°ÅŸletme Ekibi<br/>
              <a href="${siteUrl}" style="color: #6b7280;">${siteUrl}</a>
            </p>
          </div>
        </div>
      `,
      text: `MaÄŸaza KaydÄ±\n\n${shopName} maÄŸazanÄ±z iÃ§in kaydÄ±nÄ±z alÄ±ndÄ±.\n\nMaÄŸaza Paneliniz: ${siteUrl}/shop/dashboard\n\nTeÅŸekkÃ¼r ederiz!`
    })

    console.log('âœ… MaÄŸaza kayÄ±t emaili gÃ¶nderildi:', to)
    return { success: true, message: 'Email gÃ¶nderildi' }
  } catch (error) {
    console.error('âŒ MaÄŸaza kayÄ±t emaili gÃ¶nderilemedi:', error)
    return { success: false, message: 'Email gÃ¶nderilemedi' }
  }
}
// Server Action: Åifre sÄ±fÄ±rlama emaili gÃ¶nder
export async function sendPasswordResetEmail(to: string, resetLink: string): Promise<{ success: boolean; message: string }> {
  try {
    const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://spotitforme.vercel.app'
    
    await transporter.sendMail({
      from: `"SpotItForMe Åifre SÄ±fÄ±rlama" <${process.env.GMAIL_USER}>`,
      to,
      subject: 'ğŸ” SpotItForMe Åifre SÄ±fÄ±rlama Ä°steÄŸi',
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; background: #f5f7fa; padding: 20px;">
          <div style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;">
            <h1 style="color: white; margin: 0; font-size: 24px;">ğŸ” Åifre SÄ±fÄ±rlama</h1>
          </div>
          
          <div style="background: white; padding: 30px; border: 1px solid #e5e7eb; border-top: none; border-radius: 0 0 10px 10px;">
            <p>Merhaba,</p>
            <p>SpotItForMe hesabÄ±nÄ±z iÃ§in ÅŸifre sÄ±fÄ±rlama talebinde bulundunuz.</p>
            
            <div style="background: #fef2f2; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ef4444;">
              <p><strong>âš ï¸ GÃ¼venlik UyarÄ±sÄ±:</strong></p>
              <p>Bu isteÄŸi siz yapmadÄ±ysanÄ±z, bu email'i gÃ¶rmezden gelebilirsiniz.</p>
              <p>HesabÄ±nÄ±zla ilgili endiÅŸeleriniz varsa lÃ¼tfen bizimle iletiÅŸime geÃ§in.</p>
            </div>

            <div style="text-align: center; margin: 30px 0;">
              <a href="${resetLink}" style="background: #ef4444; color: white; padding: 12px 30px; text-decoration: none; border-radius: 8px; display: inline-block; font-weight: bold;">
                Åifremi SÄ±fÄ±rla
              </a>
            </div>

            <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">
              <p><strong>ğŸ”’ GÃ¼venlik Ä°puÃ§larÄ±:</strong></p>
              <ul style="margin-left: 20px; color: #4b5563;">
                <li>Åifrenizi kimseyle paylaÅŸmayÄ±n</li>
                <li>Link'e tÄ±kladÄ±ktan sonra yeni bir ÅŸifre belirleyin</li>
                <li>GÃ¼Ã§lÃ¼ bir ÅŸifre kullanÄ±n (harf, rakam, Ã¶zel karakter)</li>
                <li>Bu link 24 saat sonra geÃ§ersiz olacaktÄ±r</li>
              </ul>
            </div>

            <p><strong>ğŸ“ Link Ã§alÄ±ÅŸmÄ±yor mu?</strong></p>
            <p>EÄŸer buton Ã§alÄ±ÅŸmÄ±yorsa, aÅŸaÄŸÄ±daki linki tarayÄ±cÄ±nÄ±za kopyalayÄ±p yapÄ±ÅŸtÄ±rÄ±n:</p>
            <p style="word-break: break-all; background: #f3f4f6; padding: 10px; border-radius: 5px; font-size: 12px;">
              ${resetLink}
            </p>

            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 30px 0;" />

            <p style="font-size: 12px; color: #6b7280; text-align: center;">
              Bu email SpotItForMe platformundan otomatik olarak gÃ¶nderilmiÅŸtir.<br/>
              <a href="${siteUrl}" style="color: #6b7280;">${siteUrl}</a> | 
              <a href="mailto:${process.env.GMAIL_USER}" style="color: #6b7280;">YardÄ±m</a>
            </p>
          </div>
        </div>
      `,
      text: `SpotItForMe Åifre SÄ±fÄ±rlama\n\nÅifrenizi sÄ±fÄ±rlamak iÃ§in bu linke tÄ±klayÄ±n: ${resetLink}\n\nBu link 24 saat geÃ§erlidir.\n\nEÄŸer bu isteÄŸi siz yapmadÄ±ysanÄ±z, bu email'i gÃ¶rmezden gelebilirsiniz.\n\nTeÅŸekkÃ¼r ederiz!`
    })

    console.log('âœ… Åifre sÄ±fÄ±rlama emaili gÃ¶nderildi:', to)
    return { success: true, message: 'Åifre sÄ±fÄ±rlama emaili gÃ¶nderildi' }
  } catch (error) {
    console.error('âŒ Åifre sÄ±fÄ±rlama emaili gÃ¶nderilemedi:', error)
    return { success: false, message: 'Åifre sÄ±fÄ±rlama emaili gÃ¶nderilemedi' }
  }
}
// Server Action: Spot oluÅŸturma emaili
export async function sendSpotCreatedEmail(to: string, spotTitle: string, spotId: string): Promise<{ success: boolean; message: string }> {
  try {
    const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://spotitforme.vercel.app'
    
    await transporter.sendMail({
      from: `"SpotItForMe" <${process.env.GMAIL_USER}>`,
      to,
      subject: `ğŸ‰ Spot OluÅŸturuldu: ${spotTitle}`,
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; background: #f5f7fa; padding: 20px;">
          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;">
            <h1 style="color: white; margin: 0; font-size: 24px;">ğŸ‰ Spot'unuz OluÅŸturuldu!</h1>
          </div>
          <div style="background: white; padding: 30px; border: 1px solid #e5e7eb; border-top: none; border-radius: 0 0 10px 10px;">
            <p>Merhaba,</p>
            <p><strong>"${spotTitle}"</strong> baÅŸlÄ±klÄ± spot'unuz baÅŸarÄ±yla oluÅŸturuldu.</p>
            
            <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #3b82f6;">
              <p><strong>Spot DetaylarÄ±:</strong></p>
              <p>ğŸ“Œ <strong>BaÅŸlÄ±k:</strong> ${spotTitle}</p>
              <p>ğŸ”— <strong>Spot Linki:</strong> <a href="${siteUrl}/spots/${spotId}" style="color: #3b82f6;">${siteUrl}/spots/${spotId}</a></p>
              <p>â° <strong>Tarih:</strong> ${new Date().toLocaleDateString('tr-TR')}</p>
            </div>

            <p>Spot'unuz ÅŸu anda topluluÄŸumuzun yardÄ±mÄ±na sunuldu. Binlerce kullanÄ±cÄ± ÅŸehirlerinde gezerken sizin iÃ§in gÃ¶z kulak olacak.</p>
            
            <div style="text-align: center; margin: 30px 0;">
              <a href="${siteUrl}/spots/${spotId}" style="background: #3b82f6; color: white; padding: 12px 30px; text-decoration: none; border-radius: 8px; display: inline-block; font-weight: bold;">
                Spot'u GÃ¶rÃ¼ntÃ¼le
              </a>
            </div>

            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 30px 0;" />

            <p style="font-size: 12px; color: #6b7280; text-align: center;">
              Bu e-posta SpotItForMe platformundan otomatik olarak gÃ¶nderilmiÅŸtir.<br/>
              <a href="${siteUrl}/unsubscribe" style="color: #6b7280;">Bildirimleri devre dÄ±ÅŸÄ± bÄ±rak</a>
            </p>
          </div>
        </div>
      `,
      text: `SpotItForMe - Spot OluÅŸturuldu\n\n"${spotTitle}" baÅŸlÄ±klÄ± spot'unuz baÅŸarÄ±yla oluÅŸturuldu.\n\nSpot Linki: ${siteUrl}/spots/${spotId}\n\nTeÅŸekkÃ¼r ederiz!`
    })

    console.log('âœ… Spot oluÅŸturma emaili gÃ¶nderildi:', to)
    return { success: true, message: 'Email gÃ¶nderildi' }
  } catch (error) {
    console.error('âŒ Email gÃ¶nderilemedi:', error)
    return { success: false, message: 'Email gÃ¶nderilemedi' }
  }
}

// Server Action: YardÄ±m bildirimi emaili
export async function sendSightingNotificationEmail(
  to: string, 
  spotTitle: string, 
  spotterName: string,
  spotId: string
): Promise<{ success: boolean; message: string }> {
  try {
    const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://spotitforme.vercel.app'
    
    await transporter.sendMail({
      from: `"SpotItForMe" <${process.env.GMAIL_USER}>`,
      to,
      subject: `ğŸ¯ YENÄ° YARDIM: "${spotTitle}" iÃ§in bildirim!`,
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; background: #f5f7fa; padding: 20px;">
          <div style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;">
            <h1 style="color: white; margin: 0; font-size: 24px;">ğŸ¯ YENÄ° YARDIM BÄ°LDÄ°RÄ°MÄ°!</h1>
            <p style="color: white; opacity: 0.9; margin-top: 10px;">Birisi aradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼ gÃ¶rdÃ¼!</p>
          </div>
          
          <div style="background: white; padding: 30px; border: 1px solid #e5e7eb; border-top: none; border-radius: 0 0 10px 10px;">
            <p>Merhaba,</p>
            <p><strong>${spotterName}</strong> adlÄ± kullanÄ±cÄ±, <strong>"${spotTitle}"</strong> spot'unuz iÃ§in yardÄ±m bildirimi gÃ¶nderdi! ğŸ‰</p>
            
            <div style="background: #fffbeb; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #f59e0b;">
              <p><strong>ğŸ‰ MÃ¼jdeli Haber!</strong></p>
              <p>Bir topluluk Ã¼yemiz aradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼ gÃ¶rdÃ¼ÄŸÃ¼nÃ¼ bildirdi.</p>
              <p>Hemen spot sayfasÄ±na giderek detaylarÄ± gÃ¶rÃ¼ntÃ¼leyin!</p>
            </div>

            <div style="text-align: center; margin: 30px 0;">
              <a href="${siteUrl}/spots/${spotId}" style="background: #f59e0b; color: white; padding: 12px 30px; text-decoration: none; border-radius: 8px; display: inline-block; font-weight: bold;">
                YardÄ±m DetaylarÄ±nÄ± GÃ¶rÃ¼ntÃ¼le
              </a>
            </div>

            <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">
              <p><strong>ğŸ“‹ Sonraki AdÄ±mlar:</strong></p>
              <ol style="margin-left: 20px;">
                <li>YardÄ±m detaylarÄ±nÄ± inceleyin</li>
                <li>Gerekirse spotter ile iletiÅŸime geÃ§in</li>
                <li>ÃœrÃ¼nÃ¼ bulduysanÄ±z spot durumunu "Bulundu" olarak gÃ¼ncelleyin</li>
                <li>YardÄ±m eden kullanÄ±cÄ±ya teÅŸekkÃ¼r edin</li>
              </ol>
            </div>

            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 30px 0;" />

            <p style="font-size: 12px; color: #6b7280; text-align: center;">
              TopluluÄŸumuzun yardÄ±mÄ±yla kayÄ±p Ã¼rÃ¼nlerinizi bulmanÄ±zÄ± umuyoruz!<br/>
              <a href="${siteUrl}" style="color: #6b7280;">${siteUrl}</a>
            </p>
          </div>
        </div>
      `,
      text: `Yeni YardÄ±m Bildirimi!\n\n${spotterName}, "${spotTitle}" spot'unuz iÃ§in yardÄ±m bildirimi gÃ¶nderdi.\n\nDetaylar iÃ§in: ${siteUrl}/spots/${spotId}\n\nTeÅŸekkÃ¼r ederiz!`
    })

    console.log('âœ… YardÄ±m bildirimi emaili gÃ¶nderildi:', to)
    return { success: true, message: 'Email gÃ¶nderildi' }
  } catch (error) {
    console.error('âŒ YardÄ±m bildirimi emaili gÃ¶nderilemedi:', error)
    return { success: false, message: 'Email gÃ¶nderilemedi' }
  }
}

ğŸ“„ lib/email.ts
ğŸ“Š 111 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// lib/email.ts (GÃœNCELLENMÄ°Å - Ãœcretsiz versiyon)
export async function sendSpotCreatedEmail(to: string, spotTitle: string, spotId: string) {
  try {
    console.log('ğŸ“§ Spot oluÅŸturma emaili gÃ¶nderiliyor:', { to, spotTitle })
    
    const response = await fetch('/api/send-email', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        to,
        template: 'spot-created',
        data: { spotTitle, spotId }
      })
    })

    if (!response.ok) {
      throw new Error(`Email API hatasÄ±: ${response.status}`)
    }

    const result = await response.json()
    console.log('âœ… Email gÃ¶nderildi:', result)
    return true

  } catch (error) {
    console.error('Email gÃ¶nderilemedi:', error)
    
    // Production'da hatayÄ± log'la ama kullanÄ±cÄ±ya gÃ¶sterme
    if (process.env.NODE_ENV === 'production') {
      // Hata tracking servisine log'la (Sentry, LogRocket, vb.)
      console.error('Production email hatasÄ±:', error)
    }
    
    return false
  }
}

export async function sendSightingNotificationEmail(
  to: string, 
  spotTitle: string, 
  spotterName: string,
  spotId: string
) {
  try {
    console.log('ğŸ¯ YardÄ±m bildirimi emaili:', { to, spotTitle })
    
    const response = await fetch('/api/send-email', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        to,
        template: 'sighting-notification',
        data: { spotTitle, spotterName, spotId }
      })
    })

    if (!response.ok) {
      throw new Error(`Email API hatasÄ±: ${response.status}`)
    }

    const result = await response.json()
    console.log('âœ… YardÄ±m bildirimi gÃ¶nderildi:', result)
    return true

  } catch (error) {
    console.error('YardÄ±m bildirimi gÃ¶nderilemedi:', error)
    
    if (process.env.NODE_ENV === 'production') {
      console.error('Production yardÄ±m bildirimi hatasÄ±:', error)
    }
    
    return false
  }
}

export async function sendWelcomeEmail(to: string, name: string) {
  try {
    console.log('ğŸ‘‹ HoÅŸgeldin emaili:', { to, name })
    
    const response = await fetch('/api/send-email', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        to,
        template: 'welcome',
        data: { name }
      })
    })

    if (!response.ok) {
      throw new Error(`Email API hatasÄ±: ${response.status}`)
    }

    const result = await response.json()
    console.log('âœ… HoÅŸgeldin emaili gÃ¶nderildi:', result)
    return true

  } catch (error) {
    console.error('HoÅŸgeldin emaili gÃ¶nderilemedi:', error)
    
    if (process.env.NODE_ENV === 'production') {
      console.error('Production hoÅŸgeldin emaili hatasÄ±:', error)
    }
    
    return false
  }
}

// Test email gÃ¶nderme
export async function sendTestEmail(to: string) {
  return sendWelcomeEmail(to, 'Test KullanÄ±cÄ±')
}

ğŸ“„ lib/gamification/game-engine.ts
ğŸ“Š 32 satÄ±r
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// lib/gamification/game-engine.ts
export class GamificationEngine {
  // ROZET SÄ°STEMÄ°
  static BADGES = {
    FIRST_SIGHTING: { id: 'first-sighting', name: 'Ä°lk Ä°z', icon: 'ğŸ‘ï¸', points: 10 },
    HELPER_LEVEL_1: { id: 'helper-1', name: 'YardÄ±msever', icon: 'ğŸ¤', points: 50 },
    RARE_FINDER: { id: 'rare-finder', name: 'Nadir AvcÄ±sÄ±', icon: 'ğŸ”', points: 100 },
    QUICK_RESPONSE: { id: 'quick-response', name: 'HÄ±zlÄ± Tepki', icon: 'âš¡', points: 25 },
    SOCIAL_INFLUENCER: { id: 'social-influencer', name: 'Topluluk Lideri', icon: 'ğŸ‘‘', points: 500 }
  }

  // SEVÄ°YE SÄ°STEMÄ°
  static LEVELS = [
    { level: 1, name: 'Yeni GÃ¶zcÃ¼', minPoints: 0, color: 'gray' },
    { level: 2, name: 'Aktif AvcÄ±', minPoints: 100, color: 'blue' },
    { level: 3, name: 'Uzman Bulucu', minPoints: 500, color: 'green' },
    { level: 4, name: 'Master Dedektif', minPoints: 2000, color: 'purple' },
    { level: 5, name: 'Efsane AvcÄ±', minPoints: 5000, color: 'gold' }
  ]

  // PUAN SÄ°STEMÄ°
  static POINT_RULES = {
    SIGHTING_WITHOUT_PHOTO: 5,
    SIGHTING_WITH_PHOTO: 15,
    SIGHTING_WITH_PRICE: 10,
    RARE_ITEM_REPORT: 25,
    PURCHASE_FACILITATED: 50,
    DAILY_LOGIN_STREAK: [5, 10, 15, 20, 25], // 5 gÃ¼n Ã¼st Ã¼ste
    SOCIAL_SHARE: 10,
    PROFILE_COMPLETION: 30
  }
}

====================================================================================================
ğŸ“Š Ã–ZET
====================================================================================================
Toplam Dosya: 94
App SayfalarÄ±: 33
App Layout'larÄ±: 3
DiÄŸer App: 0
Component'ler: 55
Utility'ler: 3
DiÄŸer: 0
Toplam SatÄ±r: 23546

ğŸ“‹ BULUNAN SAYFA ROUTE'LARI:
  â€¢ /admin
  â€¢ /admin/ads
  â€¢ /admin/ads/create-manual
  â€¢ /admin/adsense
  â€¢ /admin/test
  â€¢ /admin/users
  â€¢ /create-spot
  â€¢ /discovery
  â€¢ /for-business
  â€¢ /forgot-password
  â€¢ /help/[id]
  â€¢ /page.tsx
  â€¢ /privacy
  â€¢ /product/[id]
  â€¢ /products
  â€¢ /products/[id]
  â€¢ /profile
  â€¢ /profile/[id]
  â€¢ /reset-password
  â€¢ /shop/[id]
  â€¢ /shop/[id]/inventory
  â€¢ /shop/[id]/inventory/[productId]
  â€¢ /shop/[id]/inventory/add
  â€¢ /shop/analytics
  â€¢ /shop/dashboard
  â€¢ /shop/spots
  â€¢ /spots
  â€¢ /spots/[id]
  â€¢ /terms
  â€¢ /test
  â€¢ /test-email
  â€¢ /test-geolocation
  â€¢ /test-panel
====================================================================================================