================================================================================
ğŸ“¦ COMPONENTS DÄ°ZÄ°NÄ° - TÃœM KOD DOSYALARI
ğŸ“… 15.02.2026 03:39:35
ğŸ“Š Toplam Dosya: 95
================================================================================


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ admin\AdminHeader.tsx
ğŸ“Š 46 satÄ±r | 1.45 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdminHeader.tsx
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

export default function AdminHeader() {
  const router = useRouter()
  const [user, setUser] = useState<any>(null)

  const handleLogout = async () => {
    await supabase.auth.signOut()
    router.push('/')
  }

  return (
    <header className="bg-white shadow">
      <div className="px-6 py-4 flex justify-between items-center">
        <div className="flex items-center space-x-3">
          <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
            <span className="text-white font-bold text-xl">A</span>
          </div>
          <div>
            <h1 className="text-lg font-bold text-gray-900">Admin Panel</h1>
            <p className="text-sm text-gray-600">spotitforme.com yÃ¶netimi</p>
          </div>
        </div>

        <div className="flex items-center space-x-4">
          <div className="text-right">
            <p className="font-medium text-gray-900">Admin</p>
            <p className="text-sm text-gray-600">YÃ¶netici</p>
          </div>
          
          <button
            onClick={handleLogout}
            className="bg-red-100 hover:bg-red-200 text-red-700 font-medium py-2 px-4 rounded-lg"
          >
            Ã‡Ä±kÄ±ÅŸ
          </button>
        </div>
      </div>
    </header>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ admin\AdminSidebar.tsx
ğŸ“Š 59 satÄ±r | 1.88 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdminSidebar.tsx
'use client'

import Link from 'next/link'
import { usePathname } from 'next/navigation'

export default function AdminSidebar() {
  const pathname = usePathname()
  
  const menuItems = [
    { name: 'Dashboard', href: '/admin', icon: 'ğŸ“Š' },
    { name: 'KullanÄ±cÄ±lar', href: '/admin/users', icon: 'ğŸ‘¥' },
    { name: 'Spot\'lar', href: '/admin/spots', icon: 'ğŸ“' },
    { name: 'MaÄŸazalar', href: '/admin/shops', icon: 'ğŸª' },
    { name: 'AdSense', href: '/admin/adsense', icon: 'ğŸ’°' },
    { name: 'Ã–demeler', href: '/admin/payments', icon: 'ğŸ’³' },
    { name: 'Ayarlar', href: '/admin/settings', icon: 'âš™ï¸' },
    { name: 'Loglar', href: '/admin/logs', icon: 'ğŸ“‹' },
  ]

  return (
    <aside className="w-64 bg-gray-900 text-white min-h-screen">
      <div className="p-6">
        <h2 className="text-xl font-bold">Admin Panel</h2>
        <p className="text-gray-400 text-sm mt-1">SpotItForMe YÃ¶netim</p>
      </div>

      <nav className="mt-6">
        {menuItems.map((item) => {
          const isActive = pathname === item.href
          
          return (
            <Link
              key={item.name}
              href={item.href}
              className={`flex items-center space-x-3 px-6 py-3 hover:bg-gray-800 ${
                isActive ? 'bg-blue-600 text-white' : 'text-gray-300'
              }`}
            >
              <span>{item.icon}</span>
              <span>{item.name}</span>
            </Link>
          )
        })}
      </nav>

      {/* Footer */}
      <div className="absolute bottom-0 w-full p-4 border-t border-gray-800">
        <Link
          href="/"
          className="flex items-center space-x-3 text-gray-400 hover:text-white"
        >
          <span>â†</span>
          <span>Siteye DÃ¶n</span>
        </Link>
      </div>
    </aside>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ admin\AdPerformance.tsx
ğŸ“Š 167 satÄ±r | 5.70 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdPerformance.tsx
'use client'

import { useState } from 'react'

interface AdPerformanceData {
  name: string
  impressions: number
  clicks: number
  revenue: number
  ctr: number
  rpm: number
}

export default function AdPerformance() {
  const [timeRange, setTimeRange] = useState<'today' | 'week' | 'month'>('week')

  const performanceData: AdPerformanceData[] = [
    {
      name: 'Header Reklam',
      impressions: 3245,
      clicks: 58,
      revenue: 24.50,
      ctr: 1.79,
      rpm: 7.55
    },
    {
      name: 'Sidebar Reklam',
      impressions: 2890,
      clicks: 42,
      revenue: 18.75,
      ctr: 1.45,
      rpm: 6.49
    },
    {
      name: 'In-Article Reklam',
      impressions: 1567,
      clicks: 31,
      revenue: 15.20,
      ctr: 1.98,
      rpm: 9.70
    },
    {
      name: 'Footer Reklam',
      impressions: 4321,
      clicks: 65,
      revenue: 28.90,
      ctr: 1.50,
      rpm: 6.69
    },
    {
      name: 'Mobile Banner',
      impressions: 2789,
      clicks: 49,
      revenue: 21.30,
      ctr: 1.76,
      rpm: 7.64
    }
  ]

  const totals = performanceData.reduce(
    (acc, item) => ({
      impressions: acc.impressions + item.impressions,
      clicks: acc.clicks + item.clicks,
      revenue: acc.revenue + item.revenue
    }),
    { impressions: 0, clicks: 0, revenue: 0 }
  )

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">Reklam PerformansÄ±</h3>
          <p className="text-gray-600">Reklam Ã¼nitelerinin performansÄ±</p>
        </div>
        <div className="flex space-x-2">
          {(['today', 'week', 'month'] as const).map((range) => (
            <button
              key={range}
              onClick={() => setTimeRange(range)}
              className={`px-3 py-1 rounded-lg text-sm font-medium ${
                timeRange === range
                  ? 'bg-blue-600 text-white'
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              {range === 'today' ? 'BugÃ¼n' : range === 'week' ? 'Bu Hafta' : 'Bu Ay'}
            </button>
          ))}
        </div>
      </div>

      {/* Performans Tablosu */}
      <div className="overflow-x-auto">
        <table className="w-full">
          <thead>
            <tr className="bg-gray-50">
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Reklam AdÄ±</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">GÃ¶sterim</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">TÄ±klama</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">CTR</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Gelir</th>
              <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">RPM</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-200">
            {performanceData.map((item, index) => (
              <tr key={index} className="hover:bg-gray-50">
                <td className="py-3 px-4 font-medium">{item.name}</td>
                <td className="py-3 px-4">{item.impressions.toLocaleString()}</td>
                <td className="py-3 px-4">{item.clicks}</td>
                <td className="py-3 px-4">
                  <span className="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">
                    {item.ctr}%
                  </span>
                </td>
                <td className="py-3 px-4 font-medium">{item.revenue.toFixed(2)} â‚º</td>
                <td className="py-3 px-4">{item.rpm.toFixed(2)} â‚º</td>
              </tr>
            ))}
          </tbody>
          <tfoot className="bg-gray-50 font-bold">
            <tr>
              <td className="py-3 px-4">TOPLAM</td>
              <td className="py-3 px-4">{totals.impressions.toLocaleString()}</td>
              <td className="py-3 px-4">{totals.clicks}</td>
              <td className="py-3 px-4">
                {((totals.clicks / totals.impressions) * 100).toFixed(2)}%
              </td>
              <td className="py-3 px-4">{totals.revenue.toFixed(2)} â‚º</td>
              <td className="py-3 px-4">
                {((totals.revenue / totals.impressions) * 1000).toFixed(2)} â‚º
              </td>
            </tr>
          </tfoot>
        </table>
      </div>

      {/* Ã–zet */}
      <div className="mt-6 grid grid-cols-3 gap-4">
        <div className="text-center p-4 bg-blue-50 rounded-lg">
          <p className="text-sm text-blue-600">Ortalama CTR</p>
          <p className="text-xl font-bold">
            {(
              performanceData.reduce((sum, item) => sum + item.ctr, 0) / performanceData.length
            ).toFixed(2)}%
          </p>
        </div>
        <div className="text-center p-4 bg-green-50 rounded-lg">
          <p className="text-sm text-green-600">Ortalama RPM</p>
          <p className="text-xl font-bold">
            {(
              performanceData.reduce((sum, item) => sum + item.rpm, 0) / performanceData.length
            ).toFixed(2)} â‚º
          </p>
        </div>
        <div className="text-center p-4 bg-purple-50 rounded-lg">
          <p className="text-sm text-purple-600">GÃ¼nlÃ¼k Ortalama</p>
          <p className="text-xl font-bold">
            {(totals.revenue / (timeRange === 'week' ? 7 : timeRange === 'month' ? 30 : 1)).toFixed(2)} â‚º
          </p>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ admin\AdSenseStatus.tsx
ğŸ“Š 179 satÄ±r | 5.39 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdSenseStatus.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

interface AdSenseStatus {
  isActive: boolean
  clientId: string
  revenue: number
  impressions: number
  ctr: number
  lastUpdate: string
}

export default function AdSenseStatus() {
  const [status, setStatus] = useState<AdSenseStatus>({
    isActive: false,
    clientId: '',
    revenue: 0,
    impressions: 0,
    ctr: 0,
    lastUpdate: new Date().toISOString()
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchAdSenseStatus()
  }, [])

  const fetchAdSenseStatus = async () => {
    try {
      // Database'den AdSense durumunu getir
      const { data } = await supabase
        .from('site_settings')
        .select('value')
        .eq('key', 'adsense_config')
        .single()

      if (data) {
        const config = JSON.parse(data.value)
        // Mock data - gerÃ§ek uygulamada Google AdSense API'sÄ±na baÄŸlanacak
        setStatus({
          isActive: config.isActive || false,
          clientId: config.clientId || '',
          revenue: 245.67,
          impressions: 12543,
          ctr: 1.8,
          lastUpdate: new Date().toISOString()
        })
      }
    } catch (error) {
      console.error('AdSense durumu yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const toggleAdSense = async () => {
    try {
      const newStatus = !status.isActive
      
      // Database'de gÃ¼ncelle
      const { data } = await supabase
        .from('site_settings')
        .select('value')
        .eq('key', 'adsense_config')
        .single()

      if (data) {
        const config = JSON.parse(data.value)
        config.isActive = newStatus

        await supabase
          .from('site_settings')
          .update({ value: JSON.stringify(config) })
          .eq('key', 'adsense_config')

        setStatus(prev => ({ ...prev, isActive: newStatus }))
        alert(`AdSense ${newStatus ? 'aktif' : 'devre dÄ±ÅŸÄ±'} edildi`)
      }
    } catch (error) {
      console.error('AdSense durumu gÃ¼ncellenemedi:', error)
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/3 mb-4"></div>
          <div className="space-y-3">
            <div className="h-4 bg-gray-200 rounded w-full"></div>
            <div className="h-4 bg-gray-200 rounded w-3/4"></div>
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">AdSense Durumu</h3>
          <p className="text-gray-600">
            Son gÃ¼ncelleme: {new Date(status.lastUpdate).toLocaleDateString('tr-TR')}
          </p>
        </div>
        
        <button
          onClick={toggleAdSense}
          className={`px-4 py-2 rounded-lg font-medium ${
            status.isActive
              ? 'bg-red-100 hover:bg-red-200 text-red-700'
              : 'bg-green-100 hover:bg-green-200 text-green-700'
          }`}
        >
          {status.isActive ? 'ReklamlarÄ± Durdur' : 'ReklamlarÄ± BaÅŸlat'}
        </button>
      </div>

      {/* Status Cards */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div className="bg-blue-50 p-4 rounded-lg">
          <p className="text-sm text-blue-600">Durum</p>
          <div className="flex items-center mt-2">
            <div className={`w-3 h-3 rounded-full mr-2 ${status.isActive ? 'bg-green-500' : 'bg-red-500'}`} />
            <p className="font-bold">
              {status.isActive ? 'Aktif' : 'Devre DÄ±ÅŸÄ±'}
            </p>
          </div>
        </div>

        <div className="bg-green-50 p-4 rounded-lg">
          <p className="text-sm text-green-600">Toplam Gelir</p>
          <p className="text-2xl font-bold text-gray-900 mt-2">
            {status.revenue.toFixed(2)} â‚º
          </p>
        </div>

        <div className="bg-purple-50 p-4 rounded-lg">
          <p className="text-sm text-purple-600">GÃ¶sterim</p>
          <p className="text-2xl font-bold text-gray-900 mt-2">
            {status.impressions.toLocaleString()}
          </p>
        </div>

        <div className="bg-yellow-50 p-4 rounded-lg">
          <p className="text-sm text-yellow-600">TÄ±klama OranÄ± (CTR)</p>
          <p className="text-2xl font-bold text-gray-900 mt-2">
            {status.ctr}%
          </p>
        </div>
      </div>

      {/* Client ID */}
      {status.clientId && (
        <div className="mt-6 p-4 bg-gray-50 rounded-lg">
          <p className="text-sm font-medium text-gray-700 mb-2">Client ID</p>
          <code className="text-sm bg-white px-3 py-2 rounded border">
            {status.clientId}
          </code>
        </div>
      )}

      {!status.clientId && (
        <div className="mt-6 p-4 bg-yellow-50 rounded-lg">
          <p className="text-yellow-800">
            âš ï¸ AdSense Client ID henÃ¼z ayarlanmamÄ±ÅŸ. 
            <a href="/admin/adsense" className="font-medium underline ml-1">
              Hemen ayarla
            </a>
          </p>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ admin\AdUnitManager.tsx
ğŸ“Š 351 satÄ±r | 14.26 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/AdUnitManager.tsx
'use client'

import { useState } from 'react'

// Tip tanÄ±mlarÄ± - export edelim
export interface AdUnit {
  id: string
  name: string
  type: 'display' | 'in-article' | 'in-feed'
  size: string
  position: string
  status: 'active' | 'paused'
  revenue: number
}

export interface AdUnitManagerProps {
  adUnits: AdUnit[]
  onUpdate: (units: AdUnit[]) => void
  clientId: string
}

export default function AdUnitManager({ adUnits, onUpdate, clientId }: AdUnitManagerProps) {
  const [showForm, setShowForm] = useState(false)
  const [newAdUnit, setNewAdUnit] = useState({
    name: '',
    type: 'display' as 'display' | 'in-article' | 'in-feed',
    size: '300x250',
    position: 'sidebar',
    status: 'active' as 'active' | 'paused'
  })

  const sizes = [
    '300x250', '336x280', '728x90', '970x250',
    '300x600', '320x100', '160x600'
  ]

  const positions = [
    'header', 'sidebar', 'footer',
    'content-top', 'content-middle', 'content-bottom',
    'in-article', 'in-feed'
  ]

  const addAdUnit = () => {
    if (!newAdUnit.name.trim()) {
      alert('LÃ¼tfen reklam adÄ± girin')
      return
    }

    const unit: AdUnit = {
      id: `ad-${Date.now()}`,
      name: newAdUnit.name,
      type: newAdUnit.type,
      size: newAdUnit.size,
      position: newAdUnit.position,
      status: newAdUnit.status,
      revenue: 0
    }

    // onUpdate'i Ã§aÄŸÄ±r - TÄ°P GÃœVENLÄ°
    onUpdate([...adUnits, unit])
    
    // Formu sÄ±fÄ±rla
    setNewAdUnit({
      name: '',
      type: 'display',
      size: '300x250',
      position: 'sidebar',
      status: 'active'
    })
    setShowForm(false)
  }

  const toggleAdStatus = (id: string) => {
    // updated deÄŸiÅŸkenine aÃ§Ä±k tip atamasÄ± yap
    const updated: AdUnit[] = adUnits.map(unit => {
      if (unit.id === id) {
        return {
          ...unit,
          status: unit.status === 'active' ? 'paused' : 'active'
        }
      }
      return unit
    })
    
    // onUpdate'i Ã§aÄŸÄ±r - artÄ±k tip gÃ¼venli
    onUpdate(updated)
  }

  const deleteAdUnit = (id: string) => {
    const updated = adUnits.filter(unit => unit.id !== id)
    onUpdate(updated)
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-lg font-bold text-gray-900">Reklam Ãœniteleri</h2>
        <button
          onClick={() => setShowForm(!showForm)}
          className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg"
        >
          {showForm ? 'Ä°ptal' : '+ Yeni Reklam'}
        </button>
      </div>

      {/* Yeni Reklam Formu */}
      {showForm && (
        <div className="bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200">
          <h3 className="font-bold text-gray-900 mb-4">Yeni Reklam Ãœnitesi</h3>
          
          <div className="grid md:grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Reklam AdÄ± *
              </label>
              <input
                type="text"
                value={newAdUnit.name}
                onChange={(e) => setNewAdUnit(prev => ({...prev, name: e.target.value}))}
                placeholder="Ã–rn: Ana Sayfa Sidebar"
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                required
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Reklam Tipi
              </label>
              <select
                value={newAdUnit.type}
                onChange={(e) => setNewAdUnit(prev => ({
                  ...prev, 
                  type: e.target.value as 'display' | 'in-article' | 'in-feed'
                }))}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              >
                <option value="display">Display Reklam</option>
                <option value="in-article">Makale Ä°Ã§i</option>
                <option value="in-feed">Feed Ä°Ã§i</option>
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Boyut
              </label>
              <select
                value={newAdUnit.size}
                onChange={(e) => setNewAdUnit(prev => ({...prev, size: e.target.value}))}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              >
                {sizes.map(size => (
                  <option key={size} value={size}>{size}</option>
                ))}
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Pozisyon
              </label>
              <select
                value={newAdUnit.position}
                onChange={(e) => setNewAdUnit(prev => ({...prev, position: e.target.value}))}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              >
                {positions.map(pos => (
                  <option key={pos} value={pos}>{pos}</option>
                ))}
              </select>
            </div>

            <div className="md:col-span-2">
              <label className="block text-sm font-medium text-gray-700 mb-3">
                BaÅŸlangÄ±Ã§ Durumu
              </label>
              <div className="flex space-x-6">
                <label className="flex items-center space-x-2 cursor-pointer">
                  <input
                    type="radio"
                    name="status"
                    value="active"
                    checked={newAdUnit.status === 'active'}
                    onChange={() => setNewAdUnit(prev => ({...prev, status: 'active'}))}
                    className="w-4 h-4 text-blue-600"
                  />
                  <span className="text-sm font-medium text-gray-700">Aktif</span>
                  <span className="text-xs text-gray-500">(Hemen yayÄ±nda)</span>
                </label>
                <label className="flex items-center space-x-2 cursor-pointer">
                  <input
                    type="radio"
                    name="status"
                    value="paused"
                    checked={newAdUnit.status === 'paused'}
                    onChange={() => setNewAdUnit(prev => ({...prev, status: 'paused'}))}
                    className="w-4 h-4 text-blue-600"
                  />
                  <span className="text-sm font-medium text-gray-700">DuraklatÄ±lmÄ±ÅŸ</span>
                  <span className="text-xs text-gray-500">(Daha sonra aktif edilecek)</span>
                </label>
              </div>
            </div>
          </div>

          <div className="mt-6 flex justify-end space-x-3">
            <button
              type="button"
              onClick={() => setShowForm(false)}
              className="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium"
            >
              Ä°ptal
            </button>
            <button
              onClick={addAdUnit}
              disabled={!newAdUnit.name.trim()}
              className="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
            >
              Reklam Ekle
            </button>
          </div>
        </div>
      )}

      {/* Reklam Listesi */}
      {adUnits.length === 0 ? (
        <div className="text-center py-12 text-gray-500 border-2 border-dashed border-gray-200 rounded-lg">
          <div className="text-4xl mb-4">ğŸ“º</div>
          <p className="text-lg font-medium">HenÃ¼z reklam Ã¼niteniz yok</p>
          <p className="text-sm mt-2">Yeni reklam eklemek iÃ§in "Yeni Reklam" butonuna tÄ±klayÄ±n</p>
        </div>
      ) : (
        <>
          <div className="overflow-x-auto">
            <table className="w-full min-w-full divide-y divide-gray-200">
              <thead className="bg-gray-50">
                <tr>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Ad
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Tip
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Boyut
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Pozisyon
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Durum
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Gelir
                  </th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Ä°ÅŸlemler
                  </th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {adUnits.map((unit) => (
                  <tr key={unit.id} className="hover:bg-gray-50">
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="font-medium text-gray-900">{unit.name}</div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <span className="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                        {unit.type === 'display' ? 'Display' : 
                         unit.type === 'in-article' ? 'Makale Ä°Ã§i' : 'Feed Ä°Ã§i'}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {unit.size}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {unit.position}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${
                        unit.status === 'active' 
                          ? 'bg-green-100 text-green-800' 
                          : 'bg-red-100 text-red-800'
                      }`}>
                        {unit.status === 'active' ? 'Aktif' : 'DuraklatÄ±ldÄ±'}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                      {unit.revenue.toFixed(2)} â‚º
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                      <div className="flex space-x-2">
                        <button
                          onClick={() => toggleAdStatus(unit.id)}
                          className={`px-3 py-1 rounded text-xs font-medium ${
                            unit.status === 'active'
                              ? 'bg-red-50 text-red-700 hover:bg-red-100 border border-red-200'
                              : 'bg-green-50 text-green-700 hover:bg-green-100 border border-green-200'
                          }`}
                        >
                          {unit.status === 'active' ? 'Duraklat' : 'Aktif Et'}
                        </button>
                        <button
                          onClick={() => deleteAdUnit(unit.id)}
                          className="px-3 py-1 bg-gray-100 text-gray-700 hover:bg-gray-200 rounded text-xs font-medium border border-gray-300"
                        >
                          Sil
                        </button>
                      </div>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>

          {/* Ä°statistikler */}
          <div className="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
            <div className="bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200">
              <p className="text-sm font-medium text-blue-700">Toplam Reklam</p>
              <p className="text-2xl font-bold text-blue-900">{adUnits.length}</p>
              <p className="text-xs text-blue-600 mt-1">
                {adUnits.filter(u => u.status === 'active').length} aktif
              </p>
            </div>
            <div className="bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg border border-green-200">
              <p className="text-sm font-medium text-green-700">Toplam Gelir</p>
              <p className="text-2xl font-bold text-green-900">
                {adUnits.reduce((sum, unit) => sum + unit.revenue, 0).toFixed(2)} â‚º
              </p>
              <p className="text-xs text-green-600 mt-1">
                Ortalama: {(adUnits.reduce((sum, unit) => sum + unit.revenue, 0) / adUnits.length || 0).toFixed(2)} â‚º
              </p>
            </div>
            <div className="bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200">
              <p className="text-sm font-medium text-purple-700">Tahmini AylÄ±k</p>
              <p className="text-2xl font-bold text-purple-900">
                {(adUnits.reduce((sum, unit) => sum + unit.revenue, 0) * 30).toFixed(2)} â‚º
              </p>
              <p className="text-xs text-purple-600 mt-1">
                TÃ¼m reklamlar aktifse
              </p>
            </div>
          </div>
        </>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ admin\DashboardStats.tsx
ğŸ“Š 92 satÄ±r | 2.52 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/DashboardStats.tsx
interface DashboardStatsProps {
  stats: {
    totalUsers: number
    totalSpots: number
    totalShops: number
    revenue: number
    activeAds: number
  }
  loading: boolean
}

export default function DashboardStats({ stats, loading }: DashboardStatsProps) {
  const statCards = [
    {
      title: 'Toplam KullanÄ±cÄ±',
      value: stats.totalUsers,
      icon: 'ğŸ‘¥',
      color: 'bg-blue-500',
      change: '+12%'
    },
    {
      title: 'Aktif Spot',
      value: stats.totalSpots,
      icon: 'ğŸ“',
      color: 'bg-green-500',
      change: '+8%'
    },
    {
      title: 'KayÄ±tlÄ± MaÄŸaza',
      value: stats.totalShops,
      icon: 'ğŸª',
      color: 'bg-purple-500',
      change: '+5%'
    },
    {
      title: 'Toplam Gelir',
      value: `${stats.revenue.toFixed(2)} â‚º`,
      icon: 'ğŸ’°',
      color: 'bg-yellow-500',
      change: '+23%'
    },
    {
      title: 'Aktif Reklam',
      value: stats.activeAds,
      icon: 'ğŸ“¢',
      color: 'bg-red-500',
      change: '+3'
    },
    {
      title: 'BugÃ¼nkÃ¼ Ziyaret',
      value: '1,234',
      icon: 'ğŸ‘ï¸',
      color: 'bg-indigo-500',
      change: '+15%'
    }
  ]

  if (loading) {
    return (
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {[1, 2, 3, 4, 5, 6].map((i) => (
          <div key={i} className="bg-white rounded-xl shadow p-6">
            <div className="animate-pulse">
              <div className="h-4 bg-gray-200 rounded w-1/2 mb-4"></div>
              <div className="h-8 bg-gray-200 rounded w-1/4"></div>
            </div>
          </div>
        ))}
      </div>
    )
  }

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {statCards.map((stat, index) => (
        <div key={index} className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
          <div className="flex items-start justify-between">
            <div>
              <p className="text-sm text-gray-600">{stat.title}</p>
              <p className="text-2xl font-bold text-gray-900 mt-2">{stat.value}</p>
              <p className="text-sm text-green-600 mt-1">{stat.change} geÃ§en aya gÃ¶re</p>
            </div>
            <div className={`${stat.color} w-12 h-12 rounded-lg flex items-center justify-center`}>
              <span className="text-2xl">{stat.icon}</span>
            </div>
          </div>
        </div>
      ))}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ admin\RecentSpots.tsx
ğŸ“Š 136 satÄ±r | 4.10 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/RecentSpots.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import Link from 'next/link'

interface Spot {
  id: string
  title: string
  user_id: string
  status: string
  created_at: string
  user?: {
    id: string
    name: string
  }
}

interface UserProfile {
  id: string
  name: string
}

export default function RecentSpots() {
  const [spots, setSpots] = useState<Spot[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchRecentSpots()
  }, [])

  const fetchRecentSpots = async () => {
    try {
      const { data } = await supabase
        .from('spots')
        .select('id, title, user_id, status, created_at')
        .order('created_at', { ascending: false })
        .limit(10)

      // KullanÄ±cÄ± isimlerini getir
      if (data) {
        const userIds = data.map((spot: Spot) => spot.user_id)
        const { data: users } = await supabase
          .from('user_profiles')
          .select('id, name')
          .in('id', userIds)

        const spotsWithUsers = data.map((spot: Spot) => ({
          ...spot,
          user: (users as UserProfile[] | null)?.find((u: UserProfile) => u.id === spot.user_id)
        }))

        setSpots(spotsWithUsers)
      }
    } catch (error) {
      console.error('Spotlar yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'active': return 'bg-green-100 text-green-800'
      case 'found': return 'bg-blue-100 text-blue-800'
      case 'expired': return 'bg-gray-100 text-gray-800'
      default: return 'bg-yellow-100 text-yellow-800'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <h3 className="text-lg font-bold text-gray-900 mb-4">Son Spot'lar</h3>
        <div className="space-y-4">
          {[1, 2, 3, 4, 5].map((i: number) => (
            <div key={i} className="animate-pulse">
              <div className="h-4 bg-gray-200 rounded w-3/4 mb-2"></div>
              <div className="h-3 bg-gray-200 rounded w-1/2"></div>
            </div>
          ))}
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-4">
        <h3 className="text-lg font-bold text-gray-900">Son Spot'lar</h3>
        <Link
          href="/admin/spots"
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </Link>
      </div>

      <div className="space-y-4">
        {spots.map((spot: Spot) => (
          <div key={spot.id} className="border-b border-gray-100 pb-4 last:border-0">
            <div className="flex justify-between items-start">
              <div className="flex-1">
                <Link
                  href={`/spots/${spot.id}`}
                  className="font-medium text-gray-900 hover:text-blue-600"
                >
                  {spot.title.length > 50 ? spot.title.substring(0, 50) + '...' : spot.title}
                </Link>
                <div className="flex items-center space-x-3 mt-1">
                  <span className="text-sm text-gray-600">
                    {spot.user?.name || 'Anonim'}
                  </span>
                  <span className="text-xs text-gray-500">
                    {new Date(spot.created_at).toLocaleDateString('tr-TR')}
                  </span>
                </div>
              </div>
              <span className={`px-2 py-1 text-xs rounded-full ${getStatusColor(spot.status)}`}>
                {spot.status === 'active' ? 'Aktif' : 
                 spot.status === 'found' ? 'Bulundu' : spot.status}
              </span>
            </div>
          </div>
        ))}
      </div>

      {spots.length === 0 && (
        <div className="text-center py-8 text-gray-500">
          HenÃ¼z spot oluÅŸturulmamÄ±ÅŸ
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ admin\RevenueChart.tsx
ğŸ“Š 82 satÄ±r | 3.03 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/admin/RevenueChart.tsx
'use client'

import { useState } from 'react'

export default function RevenueChart() {
  const [timeRange, setTimeRange] = useState<'7gÃ¼n' | '30gÃ¼n' | '90gÃ¼n'>('30gÃ¼n')
  
  // Ã–rnek veri
  const chartData = {
    '7gÃ¼n': [120, 190, 300, 500, 200, 300, 450],
    '30gÃ¼n': Array.from({ length: 30 }, (_, i) => Math.floor(Math.random() * 500) + 100),
    '90gÃ¼n': Array.from({ length: 90 }, (_, i) => Math.floor(Math.random() * 500) + 100)
  }

  const data = chartData[timeRange]
  const maxValue = Math.max(...data)
  const total = data.reduce((sum, value) => sum + value, 0)

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">Gelir GrafiÄŸi</h3>
          <p className="text-gray-600">Toplam: <span className="font-bold">{total.toFixed(2)} â‚º</span></p>
        </div>
        <div className="flex space-x-2">
          {(['7gÃ¼n', '30gÃ¼n', '90gÃ¼n'] as const).map((range) => (
            <button
              key={range}
              onClick={() => setTimeRange(range)}
              className={`px-3 py-1 rounded-lg text-sm font-medium ${
                timeRange === range
                  ? 'bg-blue-600 text-white'
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              {range}
            </button>
          ))}
        </div>
      </div>

      {/* Basit Chart */}
      <div className="h-64 flex items-end space-x-1">
        {data.map((value, index) => (
          <div
            key={index}
            className="flex-1 flex flex-col items-center"
            title={`${value} â‚º`}
          >
            <div
              className="w-full bg-gradient-to-t from-blue-500 to-blue-600 rounded-t-lg hover:opacity-80 transition-opacity"
              style={{ height: `${(value / maxValue) * 100}%` }}
            />
            <span className="text-xs text-gray-500 mt-1">
              {timeRange === '7gÃ¼n' ? ['Pzt', 'Sal', 'Ã‡ar', 'Per', 'Cum', 'Cmt', 'Paz'][index] : index + 1}
            </span>
          </div>
        ))}
      </div>

      {/* Legend */}
      <div className="mt-6 pt-6 border-t border-gray-100">
        <div className="grid grid-cols-3 gap-4">
          <div className="text-center">
            <p className="text-sm text-gray-600">Ortalama GÃ¼nlÃ¼k</p>
            <p className="text-lg font-bold">{(total / data.length).toFixed(2)} â‚º</p>
          </div>
          <div className="text-center">
            <p className="text-sm text-gray-600">En YÃ¼ksek GÃ¼n</p>
            <p className="text-lg font-bold">{maxValue.toFixed(2)} â‚º</p>
          </div>
          <div className="text-center">
            <p className="text-sm text-gray-600">Tahmini AylÄ±k</p>
            <p className="text-lg font-bold">{(total * 1.15).toFixed(2)} â‚º</p>
          </div>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ ads\AdPlacement.tsx
ğŸ“Š 37 satÄ±r | 1.06 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ads/AdPlacement.tsx
'use client'

import AdSenseAd from './AdSenseAd'

export default function AdPlacement() {
  // FarklÄ± pozisyonlar iÃ§in farklÄ± ad slot'larÄ±
  const adUnits = [
    { id: 'header-ad', position: 'header', slot: '1234567890' },
    { id: 'sidebar-ad', position: 'sidebar', slot: '0987654321' },
    { id: 'footer-ad', position: 'footer', slot: '1122334455' },
  ]

  return (
    <div className="ad-placement">
      {/* Header Ad - Sadece ana sayfada */}
      <div className="header-ad hidden md:block">
        <AdSenseAd slot="header-ad-slot" format="horizontal" />
      </div>

      {/* Sidebar Ad */}
      <div className="sidebar-ad">
        <AdSenseAd slot="sidebar-ad-slot" format="vertical" />
      </div>

      {/* In-article Ad */}
      <div className="article-ad">
        <AdSenseAd slot="article-ad-slot" format="auto" responsive />
      </div>

      {/* Footer Ad */}
      <div className="footer-ad">
        <AdSenseAd slot="footer-ad-slot" format="horizontal" />
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ ads\AdSenseAd.tsx
ğŸ“Š 53 satÄ±r | 1.25 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ads/AdSenseAd.tsx
'use client'

import { useEffect } from 'react'

interface AdSenseAdProps {
  clientId?: string
  slot: string
  format?: string
  responsive?: boolean
  className?: string
}

export default function AdSenseAd({ 
  clientId,
  slot, 
  format = 'auto',
  responsive = true,
  className = ''
}: AdSenseAdProps) {
  const adClient = clientId || process.env.NEXT_PUBLIC_ADSENSE_CLIENT_ID

  useEffect(() => {
    if (typeof window !== 'undefined' && (window as any).adsbygoogle) {
      try {
        ;(window as any).adsbygoogle.push({})
      } catch (error) {
        console.error('AdSense error:', error)
      }
    }
  }, [])

  if (!adClient) {
    return (
      <div className={`bg-gray-100 border border-gray-300 rounded-lg p-8 text-center ${className}`}>
        <p className="text-gray-600">AdSense reklamÄ± - Client ID gerekli</p>
      </div>
    )
  }

  return (
    <div className={`ad-container ${className}`}>
      <ins
        className="adsbygoogle"
        style={{ display: 'block' }}
        data-ad-client={adClient}
        data-ad-slot={slot}
        data-ad-format={format}
        data-full-width-responsive={responsive ? 'true' : 'false'}
      />
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ AdUnit.tsx
ğŸ“Š 160 satÄ±r | 4.60 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/AdUnit.tsx - Ã‡Ä°FT Ã–ZELLÄ°KLÄ°
'use client';

import { useEffect, useState } from 'react';
import { supabase } from '@/lib/supabase';

interface AdUnitProps {
  placement: string; // 'header', 'sidebar', 'inline', 'popup'
  className?: string;
}

export default function AdUnit({ placement, className = '' }: AdUnitProps) {
  const [adData, setAdData] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const [adType, setAdType] = useState<'adsense' | 'manual' | 'placeholder'>('placeholder');

  useEffect(() => {
    loadAd();
  }, [placement]);

  const loadAd = async () => {
    try {
      // 1. Ã–nce aktif reklamlarÄ± getir
      const { data: ads } = await supabase
        .from('ad_units')
        .select('*')
        .eq('position', placement)
        .eq('status', 'active')
        .lte('start_date', new Date().toISOString())
        .gte('end_date', new Date().toISOString())
        .order('rotation_order', { ascending: true })
        .limit(1);

      if (ads && ads.length > 0) {
        const ad = ads[0];
        setAdData(ad);
        setAdType(ad.ad_type);
      } else {
        setAdType('placeholder');
      }
    } catch (error) {
      console.error('Reklam yÃ¼kleme hatasÄ±:', error);
      setAdType('placeholder');
    } finally {
      setLoading(false);
    }
  };

  const trackImpression = async () => {
    if (!adData) return;
    
    await supabase
      .from('ad_units')
      .update({
        impressions: (adData.impressions || 0) + 1
      })
      .eq('id', adData.id);
  };

  const trackClick = async () => {
    if (!adData) return;
    
    await supabase
      .from('ad_units')
      .update({
        clicks: (adData.clicks || 0) + 1
      })
      .eq('id', adData.id);
  };

  if (loading) {
    return (
      <div className={`bg-gray-100 animate-pulse rounded-lg ${className}`}>
        <div className="w-full h-full flex items-center justify-center">
          <span className="text-gray-400">Reklam yÃ¼kleniyor...</span>
        </div>
      </div>
    );
  }

  // AdSense reklamÄ±
  if (adType === 'adsense' && adData?.client_id) {
    return (
      <div className={`relative ${className}`}>
        <ins
          className="adsbygoogle"
          style={{ display: 'block' }}
          data-ad-client={adData.client_id}
          data-ad-slot={adData.ad_slot}
          data-ad-format="auto"
          data-full-width-responsive="true"
        ></ins>
        <script
          dangerouslySetInnerHTML={{
            __html: `
              (adsbygoogle = window.adsbygoogle || []).push({});
            `,
          }}
        />
      </div>
    );
  }

  // Manuel reklam
  if (adType === 'manual' && adData) {
    return (
      <div 
        className={`relative ${className}`}
        onLoad={trackImpression}
        onClick={trackClick}
      >
        {adData.custom_html ? (
          <div dangerouslySetInnerHTML={{ __html: adData.custom_html }} />
        ) : (
          <a 
            href={adData.advertiser_url || '#'}
            target="_blank"
            rel="noopener noreferrer"
            className="block"
          >
            <div className="border-2 border-dashed border-blue-300 bg-blue-50 p-4 rounded-lg">
              <div className="text-center">
                <div className="font-semibold text-blue-700">{adData.advertiser_name}</div>
                <div className="text-sm text-blue-600">Reklam AlanÄ±</div>
                <div className="text-xs text-gray-500 mt-2">
                  Boyut: {adData.size} | GÃ¶sterim: {adData.impressions || 0}
                </div>
              </div>
            </div>
          </a>
        )}
      </div>
    );
  }

  // Placeholder - Reklam yoksa
  return (
    <div className={`border-2 border-dashed border-gray-300 bg-gray-50 p-4 rounded-lg ${className}`}>
      <div className="text-center">
        <div className="font-semibold text-gray-700">Reklam AlanÄ±</div>
        <div className="text-sm text-gray-600">{getPlaceholderSize(placement)}</div>
        <div className="text-xs text-gray-500 mt-2">Buraya reklamÄ±nÄ±zÄ± yerleÅŸtirin</div>
        <div className="text-xs text-gray-400 mt-1">
          GÃ¶sterim: 0 | TÄ±klama: 0 | CTR: 0%
        </div>
      </div>
    </div>
  );
}

function getPlaceholderSize(placement: string): string {
  const sizes: Record<string, string> = {
    'header': '728x90',
    'sidebar': '300x250',
    'inline': '728x90',
    'mobile': '320x50',
    'popup': '400x300'
  };
  return sizes[placement] || '300x250';
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ AdvancedMap.tsx
ğŸ“Š 136 satÄ±r | 4.74 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/AdvancedMap.tsx
'use client'

import { useState } from 'react'

interface AdvancedMapProps {
  latitude?: number | null
  longitude?: number | null
  location: string
  address?: string
  accuracy?: number
}

export default function AdvancedMap({ 
  latitude, 
  longitude, 
  location, 
  address,
  accuracy = 100 
}: AdvancedMapProps) {
  const [showMap, setShowMap] = useState(false)
  const [viewMode, setViewMode] = useState<'street' | 'satellite'>('street')

  // Koordinat varsa onu kullan, yoksa ÅŸehir adÄ±yla
  const mapQuery = latitude && longitude 
    ? `${latitude},${longitude}`
    : encodeURIComponent(location)

  const mapUrl = viewMode === 'street'
    ? `https://maps.google.com/maps?q=${mapQuery}&z=14&output=embed`
    : `https://maps.google.com/maps?q=${mapQuery}&z=14&t=k&output=embed`

  const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${mapQuery}`

  return (
    <div className="bg-white rounded-xl shadow-lg overflow-hidden">
      <div className="p-6">
        <div className="flex items-center justify-between mb-6">
          <div>
            <h3 className="text-xl font-bold text-gray-900">ğŸ“ Konum</h3>
            <p className="text-gray-600">{address || location}</p>
            {latitude && longitude && (
              <p className="text-sm text-gray-500 mt-1">
                Koordinat: {latitude.toFixed(6)}, {longitude.toFixed(6)}
              </p>
            )}
          </div>
          <button
            onClick={() => setShowMap(!showMap)}
            className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg"
          >
            {showMap ? 'HaritayÄ± Kapat' : 'HaritayÄ± AÃ§'}
          </button>
        </div>

        {showMap && (
          <div className="space-y-4">
            {/* Harita GÃ¶rÃ¼nÃ¼m SeÃ§ici */}
            <div className="flex space-x-2">
              <button
                onClick={() => setViewMode('street')}
                className={`px-4 py-2 rounded-lg ${viewMode === 'street' ? 'bg-gray-800 text-white' : 'bg-gray-100'}`}
              >
                Harita
              </button>
              <button
                onClick={() => setViewMode('satellite')}
                className={`px-4 py-2 rounded-lg ${viewMode === 'satellite' ? 'bg-gray-800 text-white' : 'bg-gray-100'}`}
              >
                Uydu
              </button>
            </div>

            {/* Harita */}
            <div className="h-96 rounded-lg overflow-hidden border border-gray-300">
              <iframe
                src={mapUrl}
                className="w-full h-full border-0"
                title="Spot konumu"
                loading="lazy"
                allowFullScreen
              />
            </div>

            {/* Konum Bilgileri */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div className="p-4 bg-blue-50 rounded-lg">
                <p className="text-sm text-blue-600 mb-1">Konum</p>
                <p className="font-medium">{location}</p>
              </div>
              {address && address !== location && (
                <div className="p-4 bg-green-50 rounded-lg">
                  <p className="text-sm text-green-600 mb-1">Adres</p>
                  <p className="font-medium">{address}</p>
                </div>
              )}
              {latitude && (
                <div className="p-4 bg-purple-50 rounded-lg">
                  <p className="text-sm text-purple-600 mb-1">DoÄŸruluk</p>
                  <p className="font-medium">Â±{accuracy} metre</p>
                </div>
              )}
            </div>

            {/* Google Maps Link */}
            <div className="flex justify-between items-center pt-4 border-t">
              <a
                href={googleMapsUrl}
                target="_blank"
                rel="noopener noreferrer"
                className="text-blue-600 hover:text-blue-800 flex items-center"
              >
                <span className="mr-2">ğŸ—ºï¸</span>
                Google Maps'te aÃ§
              </a>
              <button
                onClick={() => navigator.clipboard.writeText(googleMapsUrl)}
                className="text-gray-600 hover:text-gray-800 text-sm"
              >
                Linki kopyala
              </button>
            </div>
          </div>
        )}

        {!showMap && latitude && longitude && (
          <div className="mt-4 p-4 bg-gray-50 rounded-lg">
            <p className="text-sm text-gray-600">
              Bu spot tam konumuyla iÅŸaretlendi. HaritayÄ± aÃ§arak kesin konumu gÃ¶rebilirsiniz.
            </p>
          </div>
        )}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ AuthModal.tsx
ğŸ“Š 374 satÄ±r | 14.04 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/AuthModal.tsx - DEBUG VERSÄ°YON
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'
import { sendWelcomeEmail } from '@/lib/email-server'

interface AuthModalProps {
  isOpen: boolean
  onClose: () => void
  onSuccess?: () => void
}

export default function AuthModal({ isOpen, onClose, onSuccess }: AuthModalProps) {
  const [isLogin, setIsLogin] = useState(true)
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [name, setName] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')
  const [successMessage, setSuccessMessage] = useState('')
  const [debugLog, setDebugLog] = useState<string[]>([])

  const addDebugLog = (message: string) => {
    console.log(`ğŸ” DEBUG: ${message}`)
    setDebugLog(prev => [...prev, `${new Date().toISOString().split('T')[1].split('.')[0]}: ${message}`])
  }

  if (!isOpen) return null

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')
    setSuccessMessage('')
    setDebugLog([])

    addDebugLog('Form submit baÅŸladÄ±')
    addDebugLog(`Mode: ${isLogin ? 'Login' : 'Register'}`)
    addDebugLog(`Email: ${email}, Name: ${name}`)

    try {
      if (isLogin) {
        // GÄ°RÄ°Å YAP
        addDebugLog('Supabase signInWithPassword Ã§aÄŸrÄ±lÄ±yor...')
        
        const { data, error } = await supabase.auth.signInWithPassword({
          email,
          password,
        })
        
        addDebugLog(`SignIn response: ${error ? 'Error: ' + error.message : 'Success'}`)
        console.log('SignIn full response:', { data, error })
        
        if (error) throw error
        
        setSuccessMessage('BaÅŸarÄ±yla giriÅŸ yaptÄ±nÄ±z!')
        addDebugLog('GiriÅŸ baÅŸarÄ±lÄ±, yÃ¶nlendirme bekleniyor...')
        
        setTimeout(() => {
          onClose()
          if (onSuccess) {
            onSuccess()
          } else {
            window.location.reload()
          }
        }, 1500)
        
      } else {
        // KAYIT OL
        addDebugLog('KayÄ±t iÅŸlemi baÅŸlatÄ±lÄ±yor...')
        
        // 1. Ã–nce auth kaydÄ±
        addDebugLog('Supabase signUp Ã§aÄŸrÄ±lÄ±yor...')
        const { data: authData, error: authError } = await supabase.auth.signUp({
          email,
          password,
          options: {
            data: { name },
            emailRedirectTo: `${window.location.origin}/auth/callback`,
          },
        })
        
        addDebugLog(`Auth signUp response: ${authError ? 'Error: ' + authError.message : 'Success'}`)
        console.log('Auth signUp full response:', { authData, authError })
        
        if (authError) {
          addDebugLog(`Auth error details: ${JSON.stringify(authError, null, 2)}`)
          throw authError
        }
        
        if (authData?.user) {
          addDebugLog(`Auth baÅŸarÄ±lÄ±! User ID: ${authData.user.id}`)
          addDebugLog(`User confirmed: ${authData.user.confirmed_at ? 'Evet' : 'HayÄ±r'}`)
          
          // 2. user_profiles tablosuna kayÄ±t
          try {
            addDebugLog('user_profiles tablosuna kayÄ±t yapÄ±lÄ±yor...')
            const { data: profileData, error: profileError } = await supabase
              .from('user_profiles')
              .insert({
                id: authData.user.id,
                name: name,
                created_at: new Date().toISOString(),
                updated_at: new Date().toISOString()
              })
              .select()
            
            addDebugLog(`Profile insert response: ${profileError ? 'Error: ' + profileError.message : 'Success'}`)
            console.log('Profile insert full response:', { profileData, profileError })
            
            if (profileError) {
              addDebugLog(`Profile error (devam ediliyor): ${profileError.message}`)
              // Profile kaydÄ± baÅŸarÄ±sÄ±z olsa bile devam et
            } else {
              addDebugLog('Profile kaydÄ± baÅŸarÄ±lÄ±!')
            }
          } catch (profileErr: any) {
            addDebugLog(`Profile exception: ${profileErr.message}`)
            console.warn('Profile kaydÄ± exception:', profileErr)
          }
          
          // 3. Email gÃ¶nder
          try {
            addDebugLog('Welcome email gÃ¶nderiliyor...')
            const result = await sendWelcomeEmail(email, name)
            addDebugLog(`Email gÃ¶nderim sonucu: ${result.success ? 'BaÅŸarÄ±lÄ±' : 'BaÅŸarÄ±sÄ±z'}`)
            
            if (result.success) {
              setSuccessMessage(`ğŸ‰ HoÅŸ geldiniz ${name}! KaydÄ±nÄ±z baÅŸarÄ±yla oluÅŸturuldu.`)
            } else {
              setSuccessMessage(`âœ… KaydÄ±nÄ±z baÅŸarÄ±yla oluÅŸturuldu ${name}! (Email gÃ¶nderilemedi)`)
            }
          } catch (emailError: any) {
            addDebugLog(`Email error: ${emailError.message}`)
            console.warn('Email gÃ¶nderilemedi:', emailError)
            setSuccessMessage(`âœ… KaydÄ±nÄ±z baÅŸarÄ±yla oluÅŸturuldu ${name}!`)
          }
          
          addDebugLog('KayÄ±t tamamlandÄ±, yÃ¶nlendirme bekleniyor...')
          setTimeout(() => {
            onClose()
            if (onSuccess) {
              onSuccess()
            } else {
              window.location.href = '/profile'
            }
          }, 2000)
        } else {
          addDebugLog('Auth data var ama user yok!')
          throw new Error('KullanÄ±cÄ± oluÅŸturulamadÄ±')
        }
      }

    } catch (err: any) {
      console.error('Auth error details:', err)
      addDebugLog(`Catch error: ${err.message}`)
      addDebugLog(`Error stack: ${err.stack}`)
      
      let errorMessage = err.message || 'Bir hata oluÅŸtu'
      
      // DetaylÄ± hata mesajlarÄ±
      if (errorMessage.includes('Invalid login credentials')) {
        errorMessage = 'GeÃ§ersiz email veya ÅŸifre'
      } else if (errorMessage.includes('Email not confirmed')) {
        errorMessage = 'LÃ¼tfen email adresinizi doÄŸrulayÄ±n (spam klasÃ¶rÃ¼nÃ¼zÃ¼ kontrol edin)'
      } else if (errorMessage.includes('User already registered')) {
        errorMessage = 'Bu email adresi zaten kayÄ±tlÄ±. LÃ¼tfen giriÅŸ yapÄ±n veya ÅŸifrenizi sÄ±fÄ±rlayÄ±n.'
      } else if (errorMessage.includes('Password should be at least')) {
        errorMessage = 'Åifre en az 6 karakter olmalÄ±dÄ±r'
      } else if (errorMessage.includes('Invalid email')) {
        errorMessage = 'GeÃ§ersiz email adresi formatÄ±'
      } else if (errorMessage.includes('rate limit')) {
        errorMessage = 'Ã‡ok fazla deneme yaptÄ±nÄ±z. LÃ¼tfen bir sÃ¼re sonra tekrar deneyin.'
      } else if (errorMessage.includes('network')) {
        errorMessage = 'AÄŸ hatasÄ±. LÃ¼tfen internet baÄŸlantÄ±nÄ±zÄ± kontrol edin.'
      } else if (errorMessage.includes('duplicate key')) {
        errorMessage = 'Bu kullanÄ±cÄ± zaten kayÄ±tlÄ±'
      } else if (errorMessage.includes('JWT')) {
        errorMessage = 'Kimlik doÄŸrulama hatasÄ±. LÃ¼tfen sayfayÄ± yenileyin.'
      }
      
      setError(`${errorMessage} (LÃ¼tfen browser konsolunu kontrol edin)`)
      
    } finally {
      setLoading(false)
      addDebugLog('Ä°ÅŸlem tamamlandÄ± (finally)')
    }
  }

  const handleClose = () => {
    setEmail('')
    setPassword('')
    setName('')
    setError('')
    setSuccessMessage('')
    setDebugLog([])
    onClose()
  }

  const switchMode = () => {
    setIsLogin(!isLogin)
    setError('')
    setSuccessMessage('')
    setDebugLog([])
  }

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-xl shadow-2xl w-full max-w-md">
        {/* Header */}
        <div className="border-b p-6">
          <div className="flex justify-between items-center">
            <h2 className="text-2xl font-bold text-gray-900">
              {isLogin ? 'GiriÅŸ Yap' : 'Hesap OluÅŸtur'}
            </h2>
            <button
              onClick={handleClose}
              className="text-gray-500 hover:text-gray-700 text-2xl"
              disabled={loading}
            >
              Ã—
            </button>
          </div>
          <p className="text-gray-600 mt-2">
            {isLogin 
              ? 'Spot oluÅŸturmak ve yardÄ±m etmek iÃ§in giriÅŸ yapÄ±n' 
              : 'TopluluÄŸumuza katÄ±lÄ±n, kayÄ±p Ã¼rÃ¼nleri birlikte bulalÄ±m'}
          </p>
        </div>

        {/* Form */}
        <form onSubmit={handleSubmit} className="p-6 space-y-4">
          {!isLogin && (
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Ad Soyad *
              </label>
              <input
                type="text"
                value={name}
                onChange={(e) => setName(e.target.value)}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                placeholder="Ahmet YÄ±lmaz"
                required={!isLogin}
                disabled={loading}
              />
            </div>
          )}

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              E-posta *
            </label>
            <input
              type="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="ornek@email.com"
              required
              disabled={loading}
            />
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Åifre *
            </label>
            <input
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              minLength={6}
              required
              disabled={loading}
            />
            {!isLogin && (
              <p className="text-xs text-gray-500 mt-1">
                Åifreniz en az 6 karakter olmalÄ±dÄ±r
              </p>
            )}
          </div>

          {/* Debug Log (sadece development'da) */}
          {process.env.NODE_ENV === 'development' && debugLog.length > 0 && (
            <div className="bg-gray-900 text-green-400 p-3 rounded-lg border border-gray-700 max-h-40 overflow-y-auto">
              <div className="text-xs font-mono">
                <div className="font-bold mb-1">ğŸ” DEBUG LOG:</div>
                {debugLog.map((log, index) => (
                  <div key={index} className="mb-1 border-b border-gray-800 pb-1 last:border-0">
                    {log}
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* BaÅŸarÄ± MesajÄ± */}
          {successMessage && (
            <div className="bg-green-50 border border-green-200 text-green-700 p-4 rounded-lg">
              {successMessage}
            </div>
          )}

          {/* Hata MesajÄ± */}
          {error && (
            <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg">
              <div className="font-medium mb-1">Hata:</div>
              <div>{error}</div>
              <div className="mt-2 text-sm">
                <button
                  type="button"
                  onClick={() => {
                    console.log('DEBUG LOG:', debugLog)
                    alert(`Debug log konsolda gÃ¶rÃ¼ntÃ¼lendi. LÃ¼tfen F12 ile konsolu aÃ§Ä±n.`)
                  }}
                  className="text-red-600 hover:text-red-800 underline mr-4"
                >
                  Debug Log'u GÃ¶r
                </button>
                <button
                  type="button"
                  onClick={() => {
                    const testData = { email, name, isLogin }
                    console.log('TEST DATA:', testData)
                    alert(`Test data: ${JSON.stringify(testData)}`)
                  }}
                  className="text-blue-600 hover:text-blue-800 underline"
                >
                  Test Data'yÄ± GÃ¶r
                </button>
              </div>
            </div>
          )}

          <button
            type="submit"
            disabled={loading}
            className="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
          >
            {loading ? (
              <>
                <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                  <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Ä°ÅŸleniyor...
              </>
            ) : (
              isLogin ? 'GiriÅŸ Yap' : 'Hesap OluÅŸtur'
            )}
          </button>
        </form>

        {/* Footer */}
        <div className="border-t p-6 text-center">
          <p className="text-gray-600">
            {isLogin ? 'HesabÄ±nÄ±z yok mu?' : 'Zaten hesabÄ±nÄ±z var mÄ±?'}
            <button
              onClick={switchMode}
              disabled={loading}
              className="text-blue-600 hover:text-blue-800 font-medium ml-2 disabled:opacity-50"
            >
              {isLogin ? 'KayÄ±t Olun' : 'GiriÅŸ YapÄ±n'}
            </button>
          </p>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ Categories.tsx
ğŸ“Š 70 satÄ±r | 2.97 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

interface Category {
  id: number
  name: string
  count: number
  icon: string
  color: string
}

export default function Categories() {
  const categories: Category[] = [
    { id: 1, name: 'Elektronik', count: 156, icon: 'ğŸ“±', color: 'bg-blue-100 text-blue-800' },
    { id: 2, name: 'Giyim & Aksesuar', count: 89, icon: 'ğŸ‘•', color: 'bg-green-100 text-green-800' },
    { id: 3, name: 'Ev & BahÃ§e', count: 123, icon: 'ğŸ ', color: 'bg-yellow-100 text-yellow-800' },
    { id: 4, name: 'Koleksiyon', count: 67, icon: 'ğŸ¨', color: 'bg-purple-100 text-purple-800' },
    { id: 5, name: 'Kitap & MÃ¼zik', count: 45, icon: 'ğŸ“š', color: 'bg-red-100 text-red-800' },
    { id: 6, name: 'Oyuncak & Oyun', count: 78, icon: 'ğŸ®', color: 'bg-indigo-100 text-indigo-800' },
    { id: 7, name: 'Spor & Outdoor', count: 34, icon: 'âš½', color: 'bg-pink-100 text-pink-800' },
    { id: 8, name: 'AraÃ§ & ParÃ§a', count: 56, icon: 'ğŸš—', color: 'bg-gray-100 text-gray-800' },
  ]

  return (
    <section className="py-16 bg-white">
      <div className="container-custom">
        <div className="text-center mb-12">
          <h2 className="text-3xl font-bold text-gray-900 mb-4">
            PopÃ¼ler Kategoriler
          </h2>
          <p className="text-gray-600 max-w-2xl mx-auto">
            Ä°htiyacÄ±nÄ±z olan Ã¼rÃ¼nÃ¼ kategorilere gÃ¶re arayÄ±n veya yeni bir spot oluÅŸturun
          </p>
        </div>

        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          {categories.map((category) => (
            <div
              key={category.id}
              className="border border-gray-200 rounded-xl p-6 text-center hover:border-blue-300 hover:shadow-md transition duration-200 cursor-pointer"
            >
              <div className={`w-16 h-16 ${category.color.split(' ')[0]} rounded-full flex items-center justify-center text-2xl mx-auto mb-4`}>
                {category.icon}
              </div>
              <h3 className="font-bold text-gray-900 mb-1">{category.name}</h3>
              <p className="text-gray-500 text-sm">{category.count} aktif spot</p>
            </div>
          ))}
        </div>

        {/* Search by city */}
        <div className="mt-16">
          <h3 className="text-2xl font-bold text-center mb-8">
            Åehirlere GÃ¶re Ara
          </h3>
          <div className="flex flex-wrap justify-center gap-3">
            {['Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya', 'Adana', 'Konya', 'Trabzon'].map((city) => (
              <button
                key={city}
                className="px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-full font-medium transition duration-200"
              >
                {city}
              </button>
            ))}
            <button className="px-6 py-3 text-blue-600 hover:text-blue-800 font-medium">
              + TÃ¼m Åehirler
            </button>
          </div>
        </div>
      </div>
    </section>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ CTA.tsx
ğŸ“Š 75 satÄ±r | 3.49 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useRouter } from 'next/navigation'

export default function CTA() {
  const router = useRouter()

  return (
    <section className="py-20 bg-gradient-to-r from-blue-900 to-purple-900">
      <div className="container-custom">
        <div className="max-w-4xl mx-auto text-center">
          <div className="inline-block px-4 py-2 bg-white bg-opacity-20 text-white rounded-full text-sm font-medium mb-6">
            ğŸ¯ HEMEN BAÅLAYIN
          </div>
          
          <h2 className="text-3xl md:text-5xl font-bold text-white mb-6">
            AradÄ±ÄŸÄ±nÄ±z ÃœrÃ¼nÃ¼ Hemen Bulun
          </h2>
          
          <p className="text-xl text-blue-200 mb-10 max-w-2xl mx-auto">
            Binlerce gÃ¶z sizin iÃ§in arasÄ±n. Ãœcretsiz kaydolun, spot oluÅŸturun ve 
            kayÄ±p Ã¼rÃ¼nlerinizi topluluÄŸumuzla bulun.
          </p>

          <div className="flex flex-col sm:flex-row gap-4 justify-center mb-12">
            <button
              onClick={() => router.push('/create-spot')}
              className="group bg-white hover:bg-gray-100 text-blue-900 font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-2xl flex items-center justify-center"
            >
              <span className="mr-3">ğŸš€</span>
              Ãœcretsiz Spot OluÅŸtur
              <span className="ml-3 group-hover:translate-x-2 transition-transform">â†’</span>
            </button>
            
            <button
              onClick={() => router.push('/spots')}
              className="group bg-transparent hover:bg-white hover:bg-opacity-10 text-white font-semibold py-4 px-8 rounded-xl border-2 border-white border-opacity-30 transition-all duration-300 transform hover:scale-105 flex items-center justify-center"
            >
              <span className="mr-3">ğŸ”</span>
              Spot'larÄ± Ä°ncele
              <span className="ml-3 group-hover:translate-x-2 transition-transform">â†’</span>
            </button>
          </div>

          {/* Ã–zellikler */}
          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div className="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-20">
              <div className="text-3xl mb-4">ğŸ</div>
              <h4 className="text-white font-bold mb-2">Tamamen Ãœcretsiz</h4>
              <p className="text-blue-200 text-sm">
                Spot oluÅŸturmak, yardÄ±m etmek, topluluÄŸa katÄ±lmak tamamen Ã¼cretsiz
              </p>
            </div>
            
            <div className="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-20">
              <div className="text-3xl mb-4">âš¡</div>
              <h4 className="text-white font-bold mb-2">HÄ±zlÄ± YardÄ±m</h4>
              <p className="text-blue-200 text-sm">
                Ortalama 24 saat iÃ§inde ilk yardÄ±m cevabÄ±nÄ± alÄ±rsÄ±nÄ±z
              </p>
            </div>
            
            <div className="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-20">
              <div className="text-3xl mb-4">ğŸ”’</div>
              <h4 className="text-white font-bold mb-2">GÃ¼venli & Gizli</h4>
              <p className="text-blue-200 text-sm">
                KiÅŸisel bilgileriniz gÃ¼vende, sadece gerekli bilgiler paylaÅŸÄ±lÄ±r
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ DailyChallenges.tsx
ğŸ“Š 181 satÄ±r | 6.25 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/DailyChallenges.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'

// Type definitions
interface Challenge {
  id: string
  title: string
  description: string
  challenge_type: string
  reward_points: number
  target_count: number
  is_active: boolean
  start_date: string
  end_date: string
}

interface Progress {
  id: string
  user_id: string
  challenge_id: string
  progress_count: number
  is_completed: boolean
  completed_at: string | null
}

export default function DailyChallenges() {
  const [challenges, setChallenges] = useState<Challenge[]>([])
  const [userProgress, setUserProgress] = useState<Record<string, number>>({})
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchChallenges()
  }, [])

  const fetchChallenges = async () => {
    try {
      const [{ data: challengesData }, { data: user }] = await Promise.all([
        supabase
          .from('daily_challenges')
          .select('*')
          .eq('is_active', true)
          .order('reward_points', { ascending: false }),
        supabase.auth.getUser()
      ])

      if (user.user) {
        const { data: progressData } = await supabase
          .from('user_challenge_progress')
          .select('*')
          .eq('user_id', user.user.id)

        const progressMap: Record<string, number> = {}
        
        // DÃœZELTÄ°LMÄ°Å KISIM - Tip tanÄ±mlandÄ±
        progressData?.forEach((p: Progress) => {
          progressMap[p.challenge_id] = p.progress_count
        })

        setUserProgress(progressMap)
      }

      setChallenges(challengesData || [])
    } catch (error) {
      console.error('Challenges yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getChallengeIcon = (type: string) => {
    switch(type) {
      case 'sighting': return 'ğŸ‘ï¸'
      case 'social': return 'ğŸ‘¥'
      case 'completion': return 'âœ…'
      case 'streak': return 'ğŸ”¥'
      default: return 'ğŸ¯'
    }
  }

  return (
    <div className="bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl shadow-lg p-6 border border-blue-100">
      <div className="flex items-center justify-between mb-6">
        <div>
          <h2 className="text-xl font-bold text-gray-900">ğŸ¯ GÃ¼nlÃ¼k Hedefler</h2>
          <p className="text-gray-600">Tamamla, puan kazan!</p>
        </div>
        <div className="text-3xl">ğŸ†</div>
      </div>

      {loading ? (
        <div className="space-y-4">
          {[...Array(3)].map((_, i) => (
            <div key={i} className="animate-pulse bg-white bg-opacity-50 rounded-lg p-4">
              <div className="h-4 bg-gray-200 rounded w-3/4"></div>
              <div className="h-3 bg-gray-200 rounded w-1/2 mt-2"></div>
            </div>
          ))}
        </div>
      ) : (
        <div className="space-y-4">
          {challenges.map((challenge) => {
            const progress = userProgress[challenge.id] || 0
            const percentage = Math.min(100, (progress / challenge.target_count) * 100)
            const isCompleted = progress >= challenge.target_count

            return (
              <div 
                key={challenge.id}
                className={`bg-white rounded-lg p-4 border-2 ${
                  isCompleted ? 'border-green-500 bg-green-50' : 'border-gray-200'
                }`}
              >
                <div className="flex items-start justify-between">
                  <div className="flex items-start space-x-3">
                    <div className="text-2xl">
                      {getChallengeIcon(challenge.challenge_type)}
                    </div>
                    <div>
                      <h4 className="font-bold text-gray-900">{challenge.title}</h4>
                      <p className="text-sm text-gray-600">{challenge.description}</p>
                      
                      {/* Progress */}
                      <div className="mt-2">
                        <div className="flex justify-between text-sm mb-1">
                          <span className="text-gray-600">
                            {progress} / {challenge.target_count}
                          </span>
                          <span className="font-medium text-green-600">
                            +{challenge.reward_points} puan
                          </span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2">
                          <div 
                            className={`h-2 rounded-full ${
                              isCompleted 
                                ? 'bg-green-500' 
                                : 'bg-gradient-to-r from-blue-500 to-purple-500'
                            }`}
                            style={{ width: `${percentage}%` }}
                          ></div>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Durum */}
                  <div className="text-right">
                    {isCompleted ? (
                      <span className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                        âœ… TamamlandÄ±
                      </span>
                    ) : (
                      <button className="px-3 py-1 bg-blue-100 text-blue-800 hover:bg-blue-200 rounded-full text-sm font-medium">
                        BaÅŸla
                      </button>
                    )}
                  </div>
                </div>
              </div>
            )
          })}
        </div>
      )}

      {/* TÃ¼m hedefler tamamlandÄ±ysa */}
      {challenges.length > 0 && 
       challenges.every(c => (userProgress[c.id] || 0) >= c.target_count) && (
        <div className="mt-6 p-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg text-center">
          <div className="text-3xl mb-2">ğŸ‰</div>
          <h3 className="font-bold text-lg">TÃ¼m Hedefler TamamlandÄ±!</h3>
          <p className="text-green-100">
            HarikasÄ±n! YarÄ±n yeni hedeflerle devam et.
          </p>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ EmailNotificationDemo.tsx
ğŸ“Š 180 satÄ±r | 7.67 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/EmailNotificationDemo.tsx
'use client'

import { useState } from 'react'
import { emailService } from '@/lib/email-service'

export default function EmailNotificationDemo() {
  const [email, setEmail] = useState('')
  const [loading, setLoading] = useState(false)
  const [result, setResult] = useState<{success: boolean, message: string} | null>(null)

  const handleTestNotification = async () => {
    if (!email || !email.includes('@')) {
      setResult({ success: false, message: 'LÃ¼tfen geÃ§erli bir email adresi girin' })
      return
    }

    setLoading(true)
    setResult(null)

    try {
      const response = await emailService.sendSightingNotification(
        email,
        'Vintage Nikon Kamera Lens Test',
        'SpotItForMe Demo',
        'demo-spot-123',
        'Bu bir demo bildirimidir. SpotItForMe platformunda gerÃ§ek zamanlÄ± yardÄ±m bildirimleri alacaksÄ±nÄ±z!',
        '1500',
        'Ä°stanbul, KadÄ±kÃ¶y'
      )

      if (response.success) {
        setResult({ 
          success: true, 
          message: `ğŸ‰ Demo bildirimi gÃ¶nderildi! ${email} adresinizi kontrol edin. (Spam klasÃ¶rÃ¼ne bakmayÄ± unutmayÄ±n)` 
        })
      } else {
        setResult({ 
          success: false, 
          message: `âŒ GÃ¶nderilemedi: ${response.error || 'Bilinmeyen hata'}` 
        })
      }
    } catch (error) {
      setResult({ 
        success: false, 
        message: 'âŒ Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.' 
      })
    } finally {
      setLoading(false)
    }
  }

  return (
    <section className="py-20 bg-gradient-to-r from-blue-50 to-indigo-50">
      <div className="container-custom">
        <div className="max-w-4xl mx-auto">
          <div className="text-center mb-12">
            <div className="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full mb-6">
              <span className="text-2xl text-white">ğŸ“§</span>
            </div>
            <h2 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
              AnÄ±nda Email Bildirimleri
            </h2>
            <p className="text-xl text-gray-600">
              Birisi Ã¼rÃ¼nÃ¼nÃ¼zÃ¼ gÃ¶rÃ¼nce anÄ±nda haberiniz olsun. Spam'e dÃ¼ÅŸmez, %100 ulaÅŸÄ±r.
            </p>
          </div>

          <div className="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div className="md:flex">
              {/* Sol taraf - Demo */}
              <div className="md:w-1/2 p-8 md:p-12">
                <h3 className="text-2xl font-bold text-gray-900 mb-6">
                  CanlÄ± Bildirim Demo
                </h3>
                
                <div className="space-y-6">
                  <div className="bg-gray-50 p-6 rounded-xl">
                    <div className="flex items-start mb-4">
                      <div className="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4">
                        <span className="text-green-600 text-xl">ğŸ¯</span>
                      </div>
                      <div>
                        <h4 className="font-bold text-gray-900">GerÃ§ek ZamanlÄ±</h4>
                        <p className="text-sm text-gray-600">AnÄ±nda email ve push bildirim</p>
                      </div>
                    </div>
                  </div>

                  <div className="bg-gray-50 p-6 rounded-xl">
                    <div className="flex items-start mb-4">
                      <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                        <span className="text-blue-600 text-xl">âœ…</span>
                      </div>
                      <div>
                        <h4 className="font-bold text-gray-900">%100 UlaÅŸÄ±m Garantisi</h4>
                        <p className="text-sm text-gray-600">Spam'e dÃ¼ÅŸmez, direkt gelen kutusu</p>
                      </div>
                    </div>
                  </div>

                  <div className="bg-gray-50 p-6 rounded-xl">
                    <div className="flex items-start mb-4">
                      <div className="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mr-4">
                        <span className="text-purple-600 text-xl">ğŸ””</span>
                      </div>
                      <div>
                        <h4 className="font-bold text-gray-900">Ã–zelleÅŸtirilebilir</h4>
                        <p className="text-sm text-gray-600">Hangi bildirimleri alacaÄŸÄ±nÄ±zÄ± siz seÃ§in</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              {/* SaÄŸ taraf - Test Formu */}
              <div className="md:w-1/2 bg-gradient-to-br from-blue-500 to-indigo-600 p-8 md:p-12 text-white">
                <h3 className="text-2xl font-bold mb-2">Bildirim Sistemini Test Edin</h3>
                <p className="text-blue-100 mb-8">
                  Email adresinizi yazÄ±n, canlÄ± bir yardÄ±m bildirimi gÃ¶nderelim
                </p>

                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-blue-100 mb-2">
                      Email Adresiniz
                    </label>
                    <input
                      type="email"
                      value={email}
                      onChange={(e) => setEmail(e.target.value)}
                      placeholder="ornek@email.com"
                      className="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-white/50"
                    />
                  </div>

                  <button
                    onClick={handleTestNotification}
                    disabled={loading || !email}
                    className="w-full bg-white text-blue-600 hover:bg-gray-100 font-bold py-3 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition duration-200"
                  >
                    {loading ? 'GÃ¶nderiliyor...' : 'ğŸ“¬ Demo Bildirim GÃ¶nder'}
                  </button>

                  {result && (
                    <div className={`p-4 rounded-lg ${result.success ? 'bg-green-500/20' : 'bg-red-500/20'} border ${result.success ? 'border-green-500/30' : 'border-red-500/30'}`}>
                      <p className={result.success ? 'text-green-100' : 'text-red-100'}>
                        {result.message}
                      </p>
                    </div>
                  )}

                  <div className="pt-6 border-t border-white/20">
                    <p className="text-sm text-blue-200">
                      ğŸ’¡ GerÃ§ek bir spot oluÅŸturduÄŸunuzda, yardÄ±m geldiÄŸinde bÃ¶yle bir email alacaksÄ±nÄ±z.
                    </p>
                  </div>
                </div>
              </div>
            </div>

            {/* Alt bilgi */}
            <div className="bg-gray-900 text-gray-300 p-6 text-center">
              <div className="flex flex-col md:flex-row items-center justify-between">
                <div className="mb-4 md:mb-0">
                  <p className="text-sm">ğŸ“Š <strong>24.578</strong> baÅŸarÄ±lÄ± bildirim bu ay</p>
                </div>
                <div className="text-sm">
                  <span className="inline-block px-3 py-1 bg-green-500/20 text-green-300 rounded-full">
                    âš¡ Ort. 4.2 sn. bildirim sÃ¼resi
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ EmailNotificationSettings.tsx
ğŸ“Š 244 satÄ±r | 10.44 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/EmailNotificationSettings.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

export default function EmailNotificationSettings() {
  const [settings, setSettings] = useState({
    spotCreated: true,
    spotHelp: true,
    spotFound: true,
    weeklyDigest: false,
    marketing: false,
    pauseAll: false
  })
  const [loading, setLoading] = useState(false)
  const [saved, setSaved] = useState(false)

  useEffect(() => {
    // KullanÄ±cÄ±nÄ±n mevcut ayarlarÄ±nÄ± yÃ¼kle
    loadSettings()
  }, [])

  const loadSettings = async () => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      // Burada Supabase'den kullanÄ±cÄ± ayarlarÄ±nÄ± Ã§ekebilirsiniz
      // Åimdilik varsayÄ±lan deÄŸerler
    } catch (error) {
      console.error('Ayarlar yÃ¼klenemedi:', error)
    }
  }

  const handleSave = async () => {
    setLoading(true)
    
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      // Burada Supabase'e ayarlarÄ± kaydedebilirsiniz
      
      // SimÃ¼le ediyoruz
      await new Promise(resolve => setTimeout(resolve, 500))
      
      setSaved(true)
      setTimeout(() => setSaved(false), 3000)
      
    } catch (error) {
      console.error('Ayarlar kaydedilemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const handleToggle = (key: keyof typeof settings) => {
    setSettings(prev => ({ ...prev, [key]: !prev[key] }))
  }

  return (
    <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
      <div className="flex items-center justify-between mb-6">
        <div>
          <h3 className="text-xl font-bold text-gray-900">ğŸ“§ Email Bildirim AyarlarÄ±</h3>
          <p className="text-gray-600">Hangi email'leri almak istediÄŸinizi seÃ§in</p>
        </div>
        <div className={`px-3 py-1 rounded-full text-sm font-medium ${settings.pauseAll ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'}`}>
          {settings.pauseAll ? 'â¸ï¸ TÃ¼mÃ¼ Durduruldu' : 'âœ… Aktif'}
        </div>
      </div>

      <div className="space-y-6">
        {/* Spot Bildirimleri */}
        <div>
          <h4 className="font-bold text-gray-800 mb-3">Spot Bildirimleri</h4>
          <div className="space-y-4">
            <div className="flex items-center justify-between p-4 bg-blue-50 rounded-lg">
              <div className="flex items-center">
                <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                  <span className="text-blue-600">ğŸ“</span>
                </div>
                <div>
                  <p className="font-medium">Spot OluÅŸturuldu</p>
                  <p className="text-sm text-gray-600">Yeni spot oluÅŸturduÄŸunuzda onay email'i</p>
                </div>
              </div>
              <button
                onClick={() => handleToggle('spotCreated')}
                className={`relative inline-flex h-6 w-11 items-center rounded-full ${settings.spotCreated ? 'bg-blue-600' : 'bg-gray-300'}`}
              >
                <span className={`inline-block h-4 w-4 transform rounded-full bg-white transition ${settings.spotCreated ? 'translate-x-6' : 'translate-x-1'}`} />
              </button>
            </div>

            <div className="flex items-center justify-between p-4 bg-green-50 rounded-lg">
              <div className="flex items-center">
                <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-4">
                  <span className="text-green-600">ğŸ¯</span>
                </div>
                <div>
                  <p className="font-medium">YardÄ±m Geldi</p>
                  <p className="text-sm text-gray-600">Spot'unuza yardÄ±m bildirimi geldiÄŸinde</p>
                </div>
              </div>
              <button
                onClick={() => handleToggle('spotHelp')}
                className={`relative inline-flex h-6 w-11 items-center rounded-full ${settings.spotHelp ? 'bg-green-600' : 'bg-gray-300'}`}
              >
                <span className={`inline-block h-4 w-4 transform rounded-full bg-white transition ${settings.spotHelp ? 'translate-x-6' : 'translate-x-1'}`} />
              </button>
            </div>

            <div className="flex items-center justify-between p-4 bg-purple-50 rounded-lg">
              <div className="flex items-center">
                <div className="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mr-4">
                  <span className="text-purple-600">âœ…</span>
                </div>
                <div>
                  <p className="font-medium">Spot Bulundu</p>
                  <p className="text-sm text-gray-600">ÃœrÃ¼nÃ¼nÃ¼z bulunduÄŸunda tebrik email'i</p>
                </div>
              </div>
              <button
                onClick={() => handleToggle('spotFound')}
                className={`relative inline-flex h-6 w-11 items-center rounded-full ${settings.spotFound ? 'bg-purple-600' : 'bg-gray-300'}`}
              >
                <span className={`inline-block h-4 w-4 transform rounded-full bg-white transition ${settings.spotFound ? 'translate-x-6' : 'translate-x-1'}`} />
              </button>
            </div>
          </div>
        </div>

        {/* DiÄŸer Bildirimler */}
        <div>
          <h4 className="font-bold text-gray-800 mb-3">DiÄŸer Bildirimler</h4>
          <div className="space-y-4">
            <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
              <div className="flex items-center">
                <div className="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center mr-4">
                  <span className="text-gray-600">ğŸ“Š</span>
                </div>
                <div>
                  <p className="font-medium">HaftalÄ±k Ã–zet</p>
                  <p className="text-sm text-gray-600">HaftalÄ±k spot ve yardÄ±m Ã¶zeti</p>
                </div>
              </div>
              <button
                onClick={() => handleToggle('weeklyDigest')}
                className={`relative inline-flex h-6 w-11 items-center rounded-full ${settings.weeklyDigest ? 'bg-gray-600' : 'bg-gray-300'}`}
              >
                <span className={`inline-block h-4 w-4 transform rounded-full bg-white transition ${settings.weeklyDigest ? 'translate-x-6' : 'translate-x-1'}`} />
              </button>
            </div>

            <div className="flex items-center justify-between p-4 bg-yellow-50 rounded-lg">
              <div className="flex items-center">
                <div className="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center mr-4">
                  <span className="text-yellow-600">ğŸ</span>
                </div>
                <div>
                  <p className="font-medium">Kampanyalar</p>
                  <p className="text-sm text-gray-600">Ã–zel indirim ve kampanyalar</p>
                </div>
              </div>
              <button
                onClick={() => handleToggle('marketing')}
                className={`relative inline-flex h-6 w-11 items-center rounded-full ${settings.marketing ? 'bg-yellow-600' : 'bg-gray-300'}`}
              >
                <span className={`inline-block h-4 w-4 transform rounded-full bg-white transition ${settings.marketing ? 'translate-x-6' : 'translate-x-1'}`} />
              </button>
            </div>
          </div>
        </div>

        {/* TÃ¼mÃ¼nÃ¼ Durdur */}
        <div className="p-4 bg-red-50 rounded-lg border border-red-200">
          <div className="flex items-center justify-between">
            <div className="flex items-center">
              <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-4">
                <span className="text-red-600">â¸ï¸</span>
              </div>
              <div>
                <p className="font-medium text-red-800">TÃ¼m Bildirimleri Durdur</p>
                <p className="text-sm text-red-600">GeÃ§ici olarak tÃ¼m email'leri durdurur</p>
              </div>
            </div>
            <button
              onClick={() => handleToggle('pauseAll')}
              className={`relative inline-flex h-6 w-11 items-center rounded-full ${settings.pauseAll ? 'bg-red-600' : 'bg-gray-300'}`}
            >
              <span className={`inline-block h-4 w-4 transform rounded-full bg-white transition ${settings.pauseAll ? 'translate-x-6' : 'translate-x-1'}`} />
            </button>
          </div>
        </div>

        {/* Butonlar */}
        <div className="flex flex-col sm:flex-row gap-4 pt-6 border-t">
          <button
            onClick={handleSave}
            disabled={loading}
            className="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 rounded-lg disabled:opacity-50"
          >
            {loading ? 'Kaydediliyor...' : 'ğŸ’¾ AyarlarÄ± Kaydet'}
          </button>
          
          <button
            onClick={() => window.location.href = '/test-email'}
            className="flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 rounded-lg"
          >
            ğŸ§ª Email Test Et
          </button>
          
          <button
            onClick={() => setSettings({
              spotCreated: true,
              spotHelp: true,
              spotFound: true,
              weeklyDigest: false,
              marketing: false,
              pauseAll: false
            })}
            className="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 rounded-lg"
          >
            ğŸ”„ VarsayÄ±lana DÃ¶n
          </button>
        </div>

        {saved && (
          <div className="bg-green-50 text-green-800 p-4 rounded-lg text-center">
            âœ… Ayarlar baÅŸarÄ±yla kaydedildi!
          </div>
        )}

        {/* Bilgi */}
        <div className="text-center text-sm text-gray-500">
          <p>ğŸ“§ TÃ¼m email'ler spam'e dÃ¼ÅŸmez. DKIM imzalÄ±, %100 ulaÅŸÄ±m garantisi.</p>
          <p className="mt-1">Email deÄŸiÅŸikliÄŸi iÃ§in: <a href="/profile" className="text-blue-600 hover:underline">Profil AyarlarÄ±</a></p>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ EmailSuccessModal.tsx
ğŸ“Š 220 satÄ±r | 8.91 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/EmailSuccessModal.tsx (TAM VERSÄ°YON)
'use client'

import { useState } from 'react'

interface EmailSuccessModalProps {
  isOpen: boolean
  onClose: () => void
  spotId: string
  spotTitle: string
  isHelpNotification?: boolean  // âœ… OPTIONAL yaptÄ±k
}

export default function EmailSuccessModal({ 
  isOpen, 
  onClose, 
  spotId, 
  spotTitle,
  isHelpNotification = false  // âœ… Default deÄŸer
}: EmailSuccessModalProps) {
  const [copySuccess, setCopySuccess] = useState(false)

  if (!isOpen) return null

  const shareUrl = `${window.location.origin}/spots/${spotId}`
  
  const handleCopyLink = () => {
    navigator.clipboard.writeText(shareUrl)
    setCopySuccess(true)
    setTimeout(() => setCopySuccess(false), 2000)
  }

  const getTitle = () => {
    if (isHelpNotification) {
      return 'ğŸ¯ YardÄ±m Bildirimi GÃ¶nderildi!'
    }
    return 'ğŸ‰ Spot OluÅŸturuldu!'
  }

  const getDescription = () => {
    if (isHelpNotification) {
      return 'Spot sahibine anÄ±nda email bildirimi iletildi. TeÅŸekkÃ¼r ederiz!'
    }
    return 'Email bildirim sisteminiz aktif. YardÄ±m gelince anÄ±nda haberiniz olacak.'
  }

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden">
        {/* Header */}
        <div className={`p-8 text-center text-white ${
          isHelpNotification 
            ? 'bg-gradient-to-r from-green-500 to-emerald-600' 
            : 'bg-gradient-to-r from-blue-500 to-blue-600'
        }`}>
          <div className="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-6">
            <span className="text-4xl">{isHelpNotification ? 'ğŸ¯' : 'ğŸ‰'}</span>
          </div>
          <h2 className="text-3xl font-bold mb-2">{getTitle()}</h2>
          <p className="text-lg opacity-90">
            {getDescription()}
          </p>
        </div>

        {/* Content */}
        <div className="p-8">
          <div className="grid md:grid-cols-2 gap-8 mb-8">
            {/* Sol - Email Bilgileri */}
            <div className="space-y-6">
              <div className={`p-6 rounded-xl ${
                isHelpNotification ? 'bg-green-50' : 'bg-blue-50'
              }`}>
                <div className="flex items-start mb-4">
                  <div className={`w-12 h-12 rounded-full flex items-center justify-center mr-4 ${
                    isHelpNotification ? 'bg-green-100 text-green-600' : 'bg-blue-100 text-blue-600'
                  }`}>
                    <span className="text-xl">ğŸ“§</span>
                  </div>
                  <div>
                    <h4 className="font-bold text-gray-900 mb-1">
                      {isHelpNotification ? 'YardÄ±m Email\'i GÃ¶nderildi' : 'Onay Email\'i GÃ¶nderildi'}
                    </h4>
                    <p className="text-sm text-gray-600">
                      {isHelpNotification 
                        ? 'Spot sahibi email adresine iletildi' 
                        : 'Email adresinize spot oluÅŸturma onayÄ± iletildi'}
                    </p>
                  </div>
                </div>
              </div>

              <div className="bg-gray-50 p-6 rounded-xl">
                <div className="flex items-start mb-4">
                  <div className="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mr-4">
                    <span className="text-gray-600 text-xl">âš¡</span>
                  </div>
                  <div>
                    <h4 className="font-bold text-gray-900 mb-1">HÄ±zlÄ± Bildirim</h4>
                    <p className="text-sm text-gray-600">
                      {isHelpNotification 
                        ? 'Spot sahibi 5 saniye iÃ§inde haberdar olacak' 
                        : 'YardÄ±m geldiÄŸinde anÄ±nda haberdar olacaksÄ±nÄ±z'}
                    </p>
                  </div>
                </div>
              </div>
            </div>

            {/* SaÄŸ - Spot Bilgileri */}
            <div className="bg-gray-50 p-6 rounded-xl">
              <h4 className="font-bold text-gray-900 mb-4">Spot Bilgileri</h4>
              <div className="space-y-3">
                <div className="flex justify-between">
                  <span className="text-gray-600">BaÅŸlÄ±k:</span>
                  <span className="font-medium">{spotTitle}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Spot ID:</span>
                  <span className="font-mono text-sm">{spotId}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">Zaman:</span>
                  <span>{new Date().toLocaleTimeString('tr-TR')}</span>
                </div>
              </div>

              {/* Link PaylaÅŸÄ±mÄ± */}
              <div className="mt-6 pt-6 border-t">
                <p className="text-sm text-gray-600 mb-3">Spot linkini paylaÅŸ:</p>
                <div className="flex space-x-2">
                  <button
                    onClick={() => window.open(`https://wa.me/?text=${encodeURIComponent(`"${spotTitle}" Ã¼rÃ¼nÃ¼nÃ¼ SpotItForMe'de arÄ±yorum. YardÄ±m edebilir misiniz? ${shareUrl}`)}`)}
                    className="flex-1 bg-green-500 hover:bg-green-600 text-white p-2 rounded-lg"
                    title="WhatsApp'ta PaylaÅŸ"
                  >
                    ğŸ’š
                  </button>
                  <button
                    onClick={() => window.open(`https://t.me/share/url?url=${shareUrl}&text=${encodeURIComponent(`"${spotTitle}" Ã¼rÃ¼nÃ¼nÃ¼ arÄ±yorum`)}`)}
                    className="flex-1 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg"
                    title="Telegram'da PaylaÅŸ"
                  >
                    ğŸ“±
                  </button>
                  <button
                    onClick={() => window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(`"${spotTitle}" Ã¼rÃ¼nÃ¼nÃ¼ SpotItForMe'de arÄ±yorum. YardÄ±m edebilir misiniz?`)}&url=${shareUrl}`)}
                    className="flex-1 bg-sky-500 hover:bg-sky-600 text-white p-2 rounded-lg"
                    title="Twitter'da PaylaÅŸ"
                  >
                    ğŸ¦
                  </button>
                </div>
              </div>
            </div>
          </div>

          {/* Link Kopyalama */}
          <div className="mb-8">
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Spot Linki
            </label>
            <div className="flex">
              <input
                type="text"
                value={shareUrl}
                readOnly
                className="flex-grow px-4 py-3 border border-gray-300 rounded-l-lg bg-gray-50"
              />
              <button
                onClick={handleCopyLink}
                className={`px-6 py-3 rounded-r-lg font-medium ${
                  copySuccess 
                    ? 'bg-green-600 text-white' 
                    : 'bg-gray-800 hover:bg-gray-900 text-white'
                }`}
              >
                {copySuccess ? 'âœ… KopyalandÄ±!' : 'ğŸ“‹ Kopyala'}
              </button>
            </div>
          </div>

          {/* Butonlar */}
          <div className="flex flex-col sm:flex-row gap-4">
            <button
              onClick={() => window.location.href = `/spots/${spotId}`}
              className="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-4 rounded-lg"
            >
              ğŸ‘ï¸ Spot'u GÃ¶rÃ¼ntÃ¼le
            </button>
            
            <button
              onClick={onClose}
              className="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-4 rounded-lg"
            >
              {isHelpNotification ? 'Kapat' : 'DiÄŸer Spot\'larÄ± GÃ¶r'}
            </button>
            
            {!isHelpNotification && (
              <button
                onClick={() => window.location.href = '/create-spot'}
                className="flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-4 rounded-lg"
              >
                ğŸš€ Yeni Spot OluÅŸtur
              </button>
            )}
          </div>
        </div>

        {/* Footer */}
        <div className="bg-gray-50 p-6 text-center border-t">
          <p className="text-sm text-gray-600">
            {isHelpNotification 
              ? 'ğŸ¯ YardÄ±mÄ±nÄ±z sayesinde spot sahibi Ã¼rÃ¼nÃ¼nÃ¼ bulabilecek!' 
              : 'ğŸ’¡ Spot\'u ne kadar Ã§ok paylaÅŸÄ±rsanÄ±z, o kadar hÄ±zlÄ± yardÄ±m alÄ±rsÄ±nÄ±z!'}
          </p>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ Footer.tsx
ğŸ“Š 179 satÄ±r | 6.72 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/Footer.tsx - GÃœNCELLENMÄ°Å
import Link from 'next/link'

export default function Footer() {
  const currentYear = new Date().getFullYear()

  return (
    <footer className="bg-gray-900 text-white pt-12 pb-8 mt-16">
      <div className="container-custom">
        <div className="grid md:grid-cols-5 gap-8 mb-8">
          {/* Logo & Description */}
          <div className="md:col-span-2">
            <div className="flex items-center mb-4">
              <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center mr-3">
                <span className="text-white font-bold text-xl">S</span>
              </div>
              <h2 className="text-2xl font-bold">SpotItForMe</h2>
            </div>
            <p className="text-gray-400 mb-6">
              Topluluk gÃ¼cÃ¼yle kayÄ±p Ã¼rÃ¼nleri bulma platformu. 
              KeÅŸfet, bul, paylaÅŸ, kazan!
            </p>
            <div className="flex space-x-4">
              <button className="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-700">
                ğŸ“˜
              </button>
              <button className="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-700">
                ğŸ“·
              </button>
              <button className="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-700">
                ğŸ¦
              </button>
            </div>
          </div>

          {/* Spot & KeÅŸfet */}
          <div>
            <h3 className="text-lg font-bold mb-4">Spot & KeÅŸfet</h3>
            <ul className="space-y-3">
              <li>
                <Link href="/spots" className="text-gray-400 hover:text-white">
                  TÃ¼m Spot'lar
                </Link>
              </li>
              <li>
                <Link href="/create-spot" className="text-gray-400 hover:text-white">
                  Spot OluÅŸtur
                </Link>
              </li>
              <li>
                <Link href="/discovery" className="text-gray-400 hover:text-white">
                  KeÅŸfet
                </Link>
              </li>
              <li>
                <Link href="/leaderboard" className="text-gray-400 hover:text-white">
                  Lider Tablosu
                </Link>
              </li>
              <li>
                <Link href="/challenges" className="text-gray-400 hover:text-white">
                  GÃ¼nlÃ¼k Hedefler
                </Link>
              </li>
            </ul>
          </div>

          {/* MaÄŸazalar */}
          <div>
            <h3 className="text-lg font-bold mb-4">MaÄŸazalar</h3>
            <ul className="space-y-3">
              <li>
                <Link href="/shops" className="text-gray-400 hover:text-white">
                  MaÄŸazalarÄ± KeÅŸfet
                </Link>
              </li>
              <li>
                <Link href="/for-business" className="text-gray-400 hover:text-white">
                  Ä°ÅŸletme KaydÄ±
                </Link>
              </li>
              <li>
                <Link href="/shop-dashboard" className="text-gray-400 hover:text-white">
                  MaÄŸaza Paneli
                </Link>
              </li>
              <li>
                <Link href="/premium" className="text-gray-400 hover:text-white">
                  Premium Paketler
                </Link>
              </li>
            </ul>
          </div>

          {/* YardÄ±m & Destek */}
          <div>
            <h3 className="text-lg font-bold mb-4">YardÄ±m & Destek</h3>
            <ul className="space-y-3">
              <li>
                <Link href="/how-it-works" className="text-gray-400 hover:text-white">
                  NasÄ±l Ã‡alÄ±ÅŸÄ±r?
                </Link>
              </li>
              <li>
                <Link href="/faq" className="text-gray-400 hover:text-white">
                  SÄ±kÃ§a Sorulan Sorular
                </Link>
              </li>
              <li>
                <Link href="/contact" className="text-gray-400 hover:text-white">
                  Ä°letiÅŸim
                </Link>
              </li>
              <li>
                <Link href="/privacy" className="text-gray-400 hover:text-white">
                  Gizlilik PolitikasÄ±
                </Link>
              </li>
              <li>
                <Link href="/terms" className="text-gray-400 hover:text-white">
                  KullanÄ±m KoÅŸullarÄ±
                </Link>
              </li>
            </ul>
          </div>
        </div>

        {/* Newsletter - YENÄ° */}
        <div className="border-t border-gray-800 pt-8 mb-8">
          <div className="max-w-xl mx-auto text-center">
            <h3 className="text-xl font-bold mb-4">ğŸ“¬ BÃ¼ltenimize Abone Olun</h3>
            <p className="text-gray-400 mb-6">
              Yeni Ã¶zellikler, baÅŸarÄ± hikayeleri ve Ã¶zel fÄ±rsatlardan haberdar olun.
            </p>
            <form className="flex">
              <input
                type="email"
                placeholder="E-posta adresiniz"
                className="flex-grow px-6 py-3 rounded-l-lg bg-gray-800 text-white border-0 focus:ring-2 focus:ring-blue-500 focus:outline-none"
              />
              <button 
                type="submit"
                className="bg-blue-600 hover:bg-blue-700 text-white font-medium px-8 py-3 rounded-r-lg"
              >
                Abone Ol
              </button>
            </form>
          </div>
        </div>

        {/* Copyright */}
        <div className="border-t border-gray-800 pt-8 text-center">
          <p className="text-gray-400">
            Â© {currentYear} SpotItForMe. TÃ¼m haklarÄ± saklÄ±dÄ±r.
          </p>
          <p className="text-gray-500 text-sm mt-2">
            Made with â¤ï¸ for people who search | v2.0
          </p>
          
          {/* Yeni Ã–zellikler Badge */}
          <div className="mt-4 flex flex-wrap justify-center gap-2">
            <span className="px-3 py-1 bg-blue-900 text-blue-200 rounded-full text-xs">
              ğŸ”¥ Yeni: KeÅŸfet
            </span>
            <span className="px-3 py-1 bg-green-900 text-green-200 rounded-full text-xs">
              ğŸ† Puan Sistemi
            </span>
            <span className="px-3 py-1 bg-purple-900 text-purple-200 rounded-full text-xs">
              ğŸª MaÄŸaza 2.0
            </span>
            <span className="px-3 py-1 bg-yellow-900 text-yellow-200 rounded-full text-xs">
              ğŸ‘ï¸ Nadir GÃ¶rdÃ¼m
            </span>
          </div>
        </div>
      </div>
    </footer>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ Header.tsx
ğŸ“Š 78 satÄ±r | 2.81 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/Header.tsx - Z-INDEX EKLENDÄ°
import Link from 'next/link'
import UserMenu from './UserMenu'

export default function Header() {
  return (
    <header className="bg-white shadow relative z-50"> {/* Z-INDEX EKLENDÄ° */}
      <div className="container-custom py-4">
        <div className="flex justify-between items-center">
          {/* Logo */}
          <div className="flex items-center space-x-2">
            <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
              <span className="text-white font-bold text-xl">S</span>
            </div>
            <div>
              <h1 className="text-2xl font-bold text-gray-900">SpotItForMe</h1>
              <p className="text-sm text-gray-600 hidden md:block">Toplulukla bulma platformu</p>
            </div>
          </div>

          {/* Navigation */}
          <nav className="hidden md:flex space-x-8">
            <Link href="/" className="text-gray-700 hover:text-blue-600 font-medium">
              Ana Sayfa
            </Link>
            <Link href="/spots" className="text-gray-700 hover:text-blue-600 font-medium">
              Spot'lar
            </Link>
            <Link href="/how-it-works" className="text-gray-700 hover:text-blue-600 font-medium">
              NasÄ±l Ã‡alÄ±ÅŸÄ±r?
            </Link>
            <Link href="/for-business" className="text-gray-700 hover:text-blue-600 font-medium">
              Ä°ÅŸletmeler Ä°Ã§in
            </Link>
            
            <Link href="/products" className="text-gray-700 hover:text-blue-600 font-medium">
              ÃœrÃ¼nler
            </Link>
          </nav>

          {/* Buttons */}
          <div className="flex items-center space-x-4">
            <UserMenu />
            <Link 
              href="/create-spot"
              className="btn-primary hidden md:inline-block"
            >
              Spot OluÅŸtur
            </Link>
          </div>
        </div>

        {/* Mobile Navigation */}
        <div className="md:hidden mt-4 flex justify-center space-x-6">
          <Link href="/spots" className="text-gray-700 hover:text-blue-600 text-sm">
            Spot'lar
          </Link>
          <Link href="/how-it-works" className="text-gray-700 hover:text-blue-600 text-sm">
            NasÄ±l Ã‡alÄ±ÅŸÄ±r?
          </Link>
          <Link href="/for-business" className="text-gray-700 hover:text-blue-600 text-sm">
            Ä°ÅŸletmeler
          </Link>
        </div>

        {/* Mobile Spot OluÅŸtur Butonu */}
        <div className="md:hidden mt-4">
          <Link 
            href="/create-spot"
            className="btn-primary w-full block text-center"
          >
            Ãœcretsiz Spot OluÅŸtur
          </Link>
        </div>
      </div>
    </header>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ Hero.tsx
ğŸ“Š 157 satÄ±r | 7.41 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'

export default function Hero() {
  const router = useRouter()
  const [searchQuery, setSearchQuery] = useState('')

  const handleSearch = (e: React.FormEvent) => {
    e.preventDefault()
    if (searchQuery.trim()) {
      router.push(`/spots?search=${encodeURIComponent(searchQuery)}`)
    }
  }

  const popularSearches = [
    'vintage kamera lensi',
    'eski Ã§ay makinesi parÃ§asÄ±',
    'retro oyun konsolu',
    'antika saat',
    'yedek parÃ§a'
  ]

  return (
    <section className="relative overflow-hidden">
      {/* Arka plan gradient */}
      <div className="absolute inset-0 bg-gradient-to-br from-blue-50 via-white to-purple-50" />
      
      {/* Dekoratif Ã¶ÄŸeler */}
      <div className="absolute top-20 left-10 w-72 h-72 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse" />
      <div className="absolute bottom-20 right-10 w-72 h-72 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse delay-1000" />
      
      <div className="relative container-custom py-20 md:py-32">
        <div className="max-w-4xl mx-auto text-center">
          {/* Ana baÅŸlÄ±k */}
          <div className="mb-8">
            <h1 className="text-4xl md:text-6xl lg:text-7xl font-bold text-gray-900 mb-6 leading-tight">
              BulunmasÄ± zor Ã¼rÃ¼nleri{' '}
              <span className="relative">
                <span className="relative z-10 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                  toplulukla bulun
                </span>
                <span className="absolute bottom-2 left-0 w-full h-3 bg-blue-100 -z-10 rounded-full"></span>
              </span>
            </h1>
            
            <p className="text-xl text-gray-600 mb-10 max-w-3xl mx-auto leading-relaxed">
              AradÄ±ÄŸÄ±nÄ±z nadir, vintage veya Ã¼retimi durmuÅŸ Ã¼rÃ¼nleri binlerce gÃ¶z sizin iÃ§in arasÄ±n. 
              TopluluÄŸumuzun gÃ¼cÃ¼yle imkansÄ±zÄ± mÃ¼mkÃ¼n kÄ±lÄ±n.
            </p>
          </div>

          {/* ARAMA Ã‡UBUÄU - YENÄ° ve MODERN */}
          <div className="max-w-3xl mx-auto mb-12">
            <form onSubmit={handleSearch} className="relative">
              <div className="relative bg-white rounded-2xl shadow-2xl p-2 border border-gray-200">
                <div className="flex items-center">
                  <div className="flex-grow relative">
                    <div className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                      ğŸ”
                    </div>
                    <input
                      type="text"
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                      placeholder="Ne aramÄ±ÅŸtÄ±nÄ±z? Ã–rnek: 'vintage Nikon kamera lensi', 'eski ArÃ§elik Ã§ay makinesi parÃ§asÄ±'"
                      className="w-full pl-12 pr-4 py-4 text-lg border-0 focus:ring-0 focus:outline-none rounded-l-2xl"
                    />
                  </div>
                  <button
                    type="submit"
                    className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                  >
                    Ara
                  </button>
                </div>
              </div>
              
              {/* PopÃ¼ler aramalar */}
              <div className="mt-6">
                <p className="text-sm text-gray-500 mb-3">PopÃ¼ler aramalar:</p>
                <div className="flex flex-wrap justify-center gap-3">
                  {popularSearches.map((search, index) => (
                    <button
                      key={index}
                      type="button"
                      onClick={() => setSearchQuery(search)}
                      className="px-4 py-2 bg-white hover:bg-gray-50 text-gray-700 rounded-full text-sm font-medium border border-gray-200 transition-all duration-200 hover:border-blue-300 hover:text-blue-600 hover:shadow-sm"
                    >
                      {search}
                    </button>
                  ))}
                </div>
              </div>
            </form>
          </div>

          {/* CTA ButonlarÄ± */}
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <button
              onClick={() => router.push('/create-spot')}
              className="group bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center"
            >
              <span className="mr-3">âœ¨</span>
              Ãœcretsiz Spot OluÅŸtur
              <span className="ml-3 group-hover:translate-x-1 transition-transform">â†’</span>
            </button>
            
            <button
              onClick={() => router.push('/spots')}
              className="group bg-white hover:bg-gray-50 text-gray-800 font-semibold py-4 px-8 rounded-xl border-2 border-gray-200 transition-all duration-300 transform hover:scale-105 flex items-center justify-center"
            >
              <span className="mr-3">ğŸ”</span>
              Spot'larÄ± KeÅŸfet
              <span className="ml-3 group-hover:translate-x-1 transition-transform">â†’</span>
            </button>
          </div>

          {/* GÃ¼ven iÅŸaretleri */}
          <div className="mt-16 pt-8 border-t border-gray-200">
            <p className="text-sm text-gray-500 mb-6">Milyonlarca kullanÄ±cÄ±ya gÃ¼venilen platform</p>
            <div className="flex flex-wrap justify-center items-center gap-8 opacity-70">
              <div className="flex items-center space-x-2">
                <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                  <span className="text-green-600 font-bold">âœ“</span>
                </div>
                <span className="text-sm font-medium">%100 Ãœcretsiz</span>
              </div>
              
              <div className="flex items-center space-x-2">
                <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                  <span className="text-blue-600">ğŸ”’</span>
                </div>
                <span className="text-sm font-medium">GÃ¼venli & Gizli</span>
              </div>
              
              <div className="flex items-center space-x-2">
                <div className="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                  <span className="text-purple-600">ğŸ¤</span>
                </div>
                <span className="text-sm font-medium">Topluluk DesteÄŸi</span>
              </div>
              
              <div className="flex items-center space-x-2">
                <div className="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center">
                  <span className="text-orange-600">âš¡</span>
                </div>
                <span className="text-sm font-medium">HÄ±zlÄ± YardÄ±m</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ HowItWorks.tsx
ğŸ“Š 147 satÄ±r | 6.49 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

export default function HowItWorks() {
  const steps = [
    {
      number: '01',
      title: 'Spot OluÅŸtur',
      description: 'AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼n fotoÄŸrafÄ±nÄ± ekleyin, detaylarÄ± yazÄ±n',
      icon: 'ğŸ“',
      color: 'bg-blue-100 text-blue-600',
      features: ['Ãœcretsiz', '2 dakika', 'Resim yÃ¼kle']
    },
    {
      number: '02',
      title: 'Topluluk GÃ¶rsÃ¼n',
      description: 'Binlerce kullanÄ±cÄ± ÅŸehirlerinde gezerken gÃ¶z kulak olur',
      icon: 'ğŸ‘ï¸',
      color: 'bg-purple-100 text-purple-600',
      features: ['AnlÄ±k bildirim', 'Konum bazlÄ±', 'Uzman topluluk']
    },
    {
      number: '03',
      title: 'Bildirim Al',
      description: 'Biri Ã¼rÃ¼nÃ¼ gÃ¶rÃ¼nce anÄ±nda fotoÄŸraf ve konum bilgisi gelir',
      icon: 'ğŸ””',
      color: 'bg-green-100 text-green-600',
      features: ['GerÃ§ek zamanlÄ±', 'FotoÄŸraflÄ±', 'DetaylÄ± bilgi']
    },
    {
      number: '04',
      title: 'Bul ve Mutlu Ol',
      description: 'ÃœrÃ¼nÃ¼ bulun, alÄ±n ve baÅŸarÄ± hikayenizi paylaÅŸÄ±n!',
      icon: 'ğŸ¯',
      color: 'bg-orange-100 text-orange-600',
      features: ['%94 baÅŸarÄ±', 'TeÅŸekkÃ¼r puanÄ±', 'Topluluk rozeti']
    },
  ]

  return (
    <section className="py-20 bg-white">
      <div className="container-custom">
        <div className="text-center mb-16">
          <div className="inline-block px-4 py-2 bg-blue-100 text-blue-700 rounded-full text-sm font-medium mb-4">
            ğŸš€ 4 ADIMDA Ã‡Ã–ZÃœM
          </div>
          <h2 className="text-3xl md:text-5xl font-bold text-gray-900 mb-6">
            SpotItForMe NasÄ±l Ã‡alÄ±ÅŸÄ±r?
          </h2>
          <p className="text-xl text-gray-600 max-w-3xl mx-auto">
            KayÄ±p Ã¼rÃ¼nlerinizi bulmak artÄ±k Ã§ok kolay. 4 basit adÄ±mda binlerce gÃ¶z sizin iÃ§in arasÄ±n.
          </p>
        </div>

        <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
          {steps.map((step) => (
            <div key={step.number} className="relative group">
              {/* Ã‡izgi (masaÃ¼stÃ¼ iÃ§in) */}
              {step.number !== '04' && (
                <div className="hidden lg:block absolute top-12 right-0 w-full h-0.5 bg-gradient-to-r from-blue-200 to-transparent translate-x-1/2 z-0" />
              )}
              
              <div className="relative bg-white rounded-2xl p-8 shadow-lg border border-gray-100 hover:shadow-2xl transition-all duration-300 transform group-hover:-translate-y-2 z-10">
                {/* Ãœst kÄ±sÄ±m */}
                <div className="flex items-start justify-between mb-6">
                  <div className={`w-16 h-16 rounded-xl ${step.color} flex items-center justify-center text-2xl`}>
                    {step.icon}
                  </div>
                  <div className="w-10 h-10 bg-gradient-to-br from-gray-900 to-gray-700 text-white rounded-full flex items-center justify-center font-bold text-sm">
                    {step.number}
                  </div>
                </div>
                
                {/* Ä°Ã§erik */}
                <h3 className="text-2xl font-bold text-gray-900 mb-3">
                  {step.title}
                </h3>
                <p className="text-gray-600 mb-6">
                  {step.description}
                </p>
                
                {/* Ã–zellikler */}
                <div className="space-y-2">
                  {step.features.map((feature, idx) => (
                    <div key={idx} className="flex items-center text-sm">
                      <span className="w-1.5 h-1.5 bg-blue-500 rounded-full mr-3"></span>
                      <span className="text-gray-700">{feature}</span>
                    </div>
                  ))}
                </div>
                
                {/* Alt Ã§izgi */}
                <div className="mt-6 pt-6 border-t border-gray-100">
                  <div className="text-xs text-gray-500 font-medium">
                    {step.number === '01' && 'ÃœCRETSÄ°Z baÅŸlayÄ±n'}
                    {step.number === '02' && '24/7 aktif topluluk'}
                    {step.number === '03' && 'AnÄ±nda bildirim'}
                    {step.number === '04' && 'Garantili memnuniyet'}
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>

        {/* Video aÃ§Ä±klama */}
        <div className="mt-20 bg-gradient-to-r from-blue-50 to-purple-50 rounded-3xl p-8 md:p-12">
          <div className="flex flex-col lg:flex-row items-center gap-8">
            <div className="lg:w-2/3">
              <h3 className="text-2xl md:text-3xl font-bold text-gray-900 mb-4">
                ğŸ¥ 90 Saniyede SpotItForMe
              </h3>
              <p className="text-gray-600 mb-6">
                NasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±mÄ±zÄ± 90 saniyede Ã¶ÄŸrenin. Binlerce kullanÄ±cÄ±nÄ±n kayÄ±p Ã¼rÃ¼nlerini 
                nasÄ±l bulduÄŸunu gÃ¶rÃ¼n ve siz de hemen baÅŸlayÄ±n.
              </p>
              <div className="flex flex-wrap gap-4">
                <button className="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl flex items-center">
                  <span className="mr-2">â–¶ï¸</span>
                  TanÄ±tÄ±m Filmini Ä°zle
                </button>
                <button className="px-6 py-3 bg-white hover:bg-gray-50 text-gray-800 font-medium rounded-xl border border-gray-300">
                  BaÅŸarÄ± Hikayeleri
                </button>
              </div>
            </div>
            
            <div className="lg:w-1/3">
              <div className="bg-gradient-to-br from-blue-400 to-purple-500 rounded-2xl p-1">
                <div className="bg-white rounded-xl p-6 text-center">
                  <div className="text-5xl mb-4">ğŸ“±</div>
                  <h4 className="font-bold text-gray-900 mb-2">Mobil Uygulama</h4>
                  <p className="text-sm text-gray-600 mb-4">Yoldayken bile spot oluÅŸturun</p>
                  <div className="flex justify-center space-x-3">
                    <button className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm">
                      App Store
                    </button>
                    <button className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm">
                      Google Play
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ ImageLimitChecker.tsx
ğŸ“Š 66 satÄ±r | 1.66 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ImageLimitChecker.tsx
'use client'

import { useState, useEffect } from 'react'
import { checkImageLimit, ImageLimitStatus } from '@/lib/imageLimiter'

interface ImageLimitCheckerProps {
  userId: string
  children: (props: {
    canUpload: boolean
    limitInfo: string
    isPremium: boolean
    openUpgradeModal: () => void
    loading: boolean
  }) => React.ReactNode
}

export default function ImageLimitChecker({ userId, children }: ImageLimitCheckerProps) {
  const [limitStatus, setLimitStatus] = useState<ImageLimitStatus | null>(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    const loadLimit = async () => {
      setLoading(true)
      const status = await checkImageLimit(userId)
      setLimitStatus(status)
      setLoading(false)
    }
    
    loadLimit()
  }, [userId])

  if (loading) {
    return children({
      canUpload: true,
      limitInfo: 'YÃ¼kleniyor...',
      isPremium: false,
      openUpgradeModal: () => {},
      loading: true
    })
  }

  if (!limitStatus) {
    return children({
      canUpload: true,
      limitInfo: 'Limit kontrol edilemedi',
      isPremium: false,
      openUpgradeModal: () => {},
      loading: false
    })
  }

  const limitInfo = `${limitStatus.freeImagesUsed}/${limitStatus.freeImagesTotal} resim kullanÄ±ldÄ±`

  return children({
    canUpload: limitStatus.canUpload,
    limitInfo,
    isPremium: limitStatus.isPremium,
    openUpgradeModal: () => {
      // Premium upgrade modal'Ä±nÄ± aÃ§
      console.log('Premium upgrade modal aÃ§')
      // Burada modal aÃ§ma iÅŸlemi yapÄ±lacak
    },
    loading: false
  })
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ ImageUpload.tsx
ğŸ“Š 77 satÄ±r | 2.25 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ImageUpload.tsx
'use client'

import { useRef, useState } from 'react'

interface ImageUploadProps {
  onImagesSelected: (files: File[]) => void
  maxImages?: number
}

export default function ImageUpload({ 
  onImagesSelected, 
  maxImages = 10 
}: ImageUploadProps) {
  const fileInputRef = useRef<HTMLInputElement>(null)
  const [previews, setPreviews] = useState<string[]>([])

  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    const files = Array.from(e.target.files || [])
    const validFiles = files.slice(0, maxImages - previews.length)
    
    if (validFiles.length === 0) return
    
    // Preview oluÅŸtur
    const newPreviews = validFiles.map(file => URL.createObjectURL(file))
    setPreviews(prev => [...prev, ...newPreviews])
    
    onImagesSelected(validFiles)
  }

  const removeImage = (index: number) => {
    setPreviews(prev => prev.filter((_, i) => i !== index))
  }

  return (
    <div>
      <input
        type="file"
        ref={fileInputRef}
        multiple
        accept="image/*"
        onChange={handleFileSelect}
        className="hidden"
      />
      
      <div className="grid grid-cols-3 gap-4">
        {previews.map((preview, index) => (
          <div key={index} className="relative">
            <img
              src={preview}
              alt={`Preview ${index + 1}`}
              className="w-full h-32 object-cover rounded-lg"
            />
            <button
              type="button"
              onClick={() => removeImage(index)}
              className="absolute top-1 right-1 bg-red-500 text-white w-6 h-6 rounded-full text-sm"
            >
              Ã—
            </button>
          </div>
        ))}
        
        {previews.length < maxImages && (
          <button
            type="button"
            onClick={() => fileInputRef.current?.click()}
            className="w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-blue-400 transition"
          >
            <div className="text-2xl mb-2">+</div>
            <div className="text-sm text-gray-600">Resim Ekle</div>
          </button>
        )}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ Leaderboard.tsx
ğŸ“Š 169 satÄ±r | 6.26 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/Leaderboard.tsx
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import { GamificationEngine } from '@/lib/gamification/game-engine'

export default function Leaderboard() {
  const [leaderboard, setLeaderboard] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [timeRange, setTimeRange] = useState<'daily' | 'weekly' | 'all'>('weekly')

  useEffect(() => {
    fetchLeaderboard()
  }, [timeRange])

  const fetchLeaderboard = async () => {
    setLoading(true)
    try {
      let query = supabase
        .from('leaderboard_view')
        .select('*')
        .limit(20)

      if (timeRange === 'daily') {
        query = query.order('total_points', { ascending: false })
      } else if (timeRange === 'weekly') {
        // Bu haftanÄ±n puanlarÄ± iÃ§in farklÄ± bir view gerekebilir
        query = query.order('total_points', { ascending: false })
      }

      const { data, error } = await query

      if (error) throw error
      setLeaderboard(data || [])
    } catch (error) {
      console.error('Leaderboard yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getRankIcon = (rank: number) => {
    switch(rank) {
      case 1: return 'ğŸ¥‡'
      case 2: return 'ğŸ¥ˆ'
      case 3: return 'ğŸ¥‰'
      default: return `#${rank}`
    }
  }

  return (
    <div className="bg-white rounded-xl shadow-lg p-6">
      <div className="flex items-center justify-between mb-6">
        <div>
          <h2 className="text-xl font-bold text-gray-900">ğŸ† Lider Tablosu</h2>
          <p className="text-gray-600">En aktif bulucular</p>
        </div>
        
        <div className="flex space-x-2">
          {['daily', 'weekly', 'all'].map((range) => (
            <button
              key={range}
              onClick={() => setTimeRange(range as any)}
              className={`px-4 py-2 rounded-lg text-sm font-medium ${
                timeRange === range
                  ? 'bg-blue-600 text-white'
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              {range === 'daily' ? 'GÃ¼nlÃ¼k' : range === 'weekly' ? 'HaftalÄ±k' : 'TÃ¼m Zamanlar'}
            </button>
          ))}
        </div>
      </div>

      {loading ? (
        <div className="space-y-4">
          {[...Array(5)].map((_, i) => (
            <div key={i} className="animate-pulse flex items-center space-x-4">
              <div className="w-10 h-10 bg-gray-200 rounded-full"></div>
              <div className="flex-1">
                <div className="h-4 bg-gray-200 rounded w-1/4"></div>
                <div className="h-3 bg-gray-200 rounded w-1/2 mt-2"></div>
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div className="space-y-3">
          {leaderboard.map((user, index) => {
            const userLevel = GamificationEngine.LEVELS.find(l => l.level === user.current_level)
            
            return (
              <div 
                key={user.user_id}
                className={`flex items-center space-x-4 p-3 rounded-lg ${
                  index < 3 ? 'bg-gradient-to-r from-yellow-50 to-yellow-100 border border-yellow-200' : 'hover:bg-gray-50'
                }`}
              >
                {/* SÄ±ra */}
                <div className="flex-shrink-0">
                  <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold ${
                    index === 0 ? 'bg-yellow-500 text-white' :
                    index === 1 ? 'bg-gray-400 text-white' :
                    index === 2 ? 'bg-amber-700 text-white' :
                    'bg-gray-200 text-gray-700'
                  }`}>
                    {getRankIcon(index + 1)}
                  </div>
                </div>

                {/* Avatar ve Ä°sim */}
                <div className="flex-1 flex items-center space-x-3">
                  <div className="w-12 h-12 rounded-full overflow-hidden bg-gray-200">
                    {user.avatar_url ? (
                      <img src={user.avatar_url} alt={user.name} className="w-full h-full object-cover" />
                    ) : (
                      <div className="w-full h-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-bold">
                        {user.name?.[0] || 'K'}
                      </div>
                    )}
                  </div>
                  
                  <div className="flex-1">
                    <div className="flex items-center justify-between">
                      <div>
                        <h4 className="font-bold text-gray-900">{user.name}</h4>
                        <p className="text-sm" style={{ color: userLevel?.color }}>
                          {userLevel?.name}
                        </p>
                      </div>
                      <div className="text-right">
                        <div className="font-bold text-gray-900">{user.total_points} puan</div>
                        <div className="text-xs text-gray-500">
                          {user.total_sightings} yardÄ±m
                        </div>
                      </div>
                    </div>
                    
                    {/* Progress bar (mini) */}
                    <div className="mt-2">
                      <div className="w-full bg-gray-200 rounded-full h-1">
                        <div 
                          className="h-1 rounded-full bg-gradient-to-r from-blue-500 to-purple-600"
                          style={{ width: `${Math.min(100, (user.total_points / 5000) * 100)}%` }}
                        ></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            )
          })}
        </div>
      )}

      {/* Kendi Pozisyonun (alt kÄ±sÄ±m) */}
      <div className="mt-6 pt-6 border-t">
        <button 
          onClick={() => fetchLeaderboard()}
          className="w-full text-center text-blue-600 hover:text-blue-800 font-medium py-2"
        >
          Tam Listeyi GÃ¶r
        </button>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ LocationPickerWithPermission.tsx
ğŸ“Š 396 satÄ±r | 15.33 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/LocationPickerWithPermission.tsx
'use client'

import { useState, useEffect } from 'react'
import useGeolocationWithPermission from '@/hooks/useGeolocationWithPermission'

interface LocationPickerProps {
  onLocationSelect: (location: {
    latitude: number | null
    longitude: number | null
    city: string
  }) => void
}

export default function LocationPickerWithPermission({ onLocationSelect }: LocationPickerProps) {
  const { 
    latitude, 
    longitude, 
    city, 
    error, 
    loading, 
    permission,
    requestPermissionAndGetLocation,
    clearLocation 
  } = useGeolocationWithPermission()

  const [manualCity, setManualCity] = useState('')
  const [useGPS, setUseGPS] = useState(false)
  const [showPermissionInfo, setShowPermissionInfo] = useState(false)

  const cities = [
    'Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya', 'Adana', 'Konya',
    'Trabzon', 'Gaziantep', 'Kayseri', 'Mersin', 'EskiÅŸehir', 'DiyarbakÄ±r',
    'Samsun', 'Denizli', 'Ä°zmit', 'Manisa', 'BalÄ±kesir', 'Van', 'Malatya',
    'TÃ¼rkiye Geneli', 'Yurt DÄ±ÅŸÄ±'
  ]

  // Konum deÄŸiÅŸtiÄŸinde parent'a bildir
  useEffect(() => {
    if (useGPS && latitude && city && city !== 'Konum izni bekleniyor') {
      onLocationSelect({ latitude, longitude, city })
    }
  }, [latitude, city, useGPS])

  const handleGetLocation = async () => {
    setUseGPS(true)
    clearLocation() // Ã–nceki konumu temizle
    
    // KullanÄ±cÄ±ya izin isteÄŸi hakkÄ±nda bilgi gÃ¶ster
    setShowPermissionInfo(true)
    
    const location = await requestPermissionAndGetLocation()
    
    if (location.latitude) {
      onLocationSelect({
        latitude: location.latitude,
        longitude: location.longitude,
        city: location.city
      })
    }
  }

  const handleManualSelect = () => {
    setUseGPS(false)
    setManualCity('')
    setShowPermissionInfo(false)
  }

  const handleCityChange = (e: React.ChangeEvent<HTMLSelectElement>) => {
    const selectedCity = e.target.value
    setManualCity(selectedCity)
    if (selectedCity) {
      onLocationSelect({
        latitude: null,
        longitude: null,
        city: selectedCity
      })
    }
  }

  // Ä°zin durumuna gÃ¶re mesaj
  const getPermissionMessage = () => {
    switch(permission) {
      case 'granted':
        return 'âœ… Konum izniniz var'
      case 'denied':
        return 'âŒ Konum izni verilmedi'
      case 'prompt':
        return 'ğŸ“ Konum izni istenecek'
      default:
        return 'Konum durumu belirsiz'
    }
  }

  return (
    <div className="space-y-6">
      {/* Ä°zin Durumu GÃ¶stergesi */}
      <div className={`p-4 rounded-lg border ${
        permission === 'granted' ? 'bg-green-50 border-green-200' :
        permission === 'denied' ? 'bg-red-50 border-red-200' :
        'bg-blue-50 border-blue-200'
      }`}>
        <div className="flex items-center justify-between">
          <div className="flex items-center">
            {permission === 'granted' && <span className="text-green-600 text-xl mr-2">âœ…</span>}
            {permission === 'denied' && <span className="text-red-600 text-xl mr-2">âŒ</span>}
            {permission === 'prompt' && <span className="text-blue-600 text-xl mr-2">ğŸ“</span>}
            <div>
              <p className="font-medium">
                {getPermissionMessage()}
              </p>
              <p className="text-sm opacity-75">
                {permission === 'denied' 
                  ? 'TarayÄ±cÄ± ayarlarÄ±ndan izin verebilirsiniz' 
                  : 'Daha doÄŸru sonuÃ§lar iÃ§in konumunuzu kullanabiliriz'}
              </p>
            </div>
          </div>
          {permission === 'denied' && (
            <button
              onClick={() => window.open('https://support.google.com/chrome/answer/142065?hl=tr', '_blank')}
              className="text-sm text-blue-600 hover:text-blue-800"
            >
              NasÄ±l aÃ§Ä±lÄ±r?
            </button>
          )}
        </div>
      </div>

      {/* Konum Tipi SeÃ§imi */}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <button
          type="button"
          onClick={handleGetLocation}
          disabled={loading || permission === 'denied'}
          className={`p-6 rounded-xl border-2 text-center transition-all disabled:opacity-50 disabled:cursor-not-allowed ${
            useGPS
              ? 'border-blue-500 bg-blue-50'
              : 'border-gray-200 hover:border-gray-300'
          } ${permission === 'denied' ? 'opacity-50 cursor-not-allowed' : ''}`}
        >
          {loading ? (
            <div className="space-y-3">
              <div className="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-600 mx-auto"></div>
              <p className="text-sm text-blue-600">Konumunuz alÄ±nÄ±yor...</p>
              <p className="text-xs text-blue-500">TarayÄ±cÄ± izin isteyecek</p>
            </div>
          ) : (
            <>
              <div className="text-3xl mb-3">ğŸ“</div>
              <h4 className="font-bold text-gray-900 mb-2">
                {permission === 'granted' ? 'Konumumu Kullan' : 'Konum Ä°zni Ä°ste'}
              </h4>
              <p className="text-sm text-gray-600">
                {permission === 'denied' 
                  ? 'Ä°zin verilmedi. Manuel seÃ§in.' 
                  : 'TarayÄ±cÄ±dan konum izni istenir'}
              </p>
            </>
          )}
        </button>

        <button
          type="button"
          onClick={handleManualSelect}
          className={`p-6 rounded-xl border-2 text-center transition-all ${
            !useGPS
              ? 'border-blue-500 bg-blue-50'
              : 'border-gray-200 hover:border-gray-300'
          }`}
        >
          <div className="text-3xl mb-3">ğŸ™ï¸</div>
          <h4 className="font-bold text-gray-900 mb-2">Åehir SeÃ§</h4>
          <p className="text-sm text-gray-600">Listeden ÅŸehir seÃ§in</p>
        </button>
      </div>

      {/* Ä°zin Ä°steÄŸi Bilgilendirmesi */}
      {showPermissionInfo && permission === 'prompt' && !loading && (
        <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-pulse">
          <div className="flex items-start">
            <span className="text-yellow-600 text-xl mr-3">ğŸ“±</span>
            <div>
              <p className="font-medium text-yellow-800 mb-2">TarayÄ±cÄ± Ä°zin Ä°steÄŸi!</p>
              <p className="text-sm text-yellow-700">
                EkranÄ±n Ã¼stÃ¼nde tarayÄ±cÄ±nÄ±n konum izni isteÄŸi belirecek. 
                <strong> LÃ¼tfen "Ä°zin Ver" veya "Allow" seÃ§eneÄŸini tÄ±klayÄ±n.</strong>
              </p>
              <div className="mt-3 space-y-2">
                <div className="flex items-center text-sm">
                  <span className="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                  <span>DoÄŸru konum iÃ§in izin vermeniz gerekir</span>
                </div>
                <div className="flex items-center text-sm">
                  <span className="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                  <span>Ä°zin vermezseniz manuel ÅŸehir seÃ§ebilirsiniz</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* GPS Sonucu */}
      {useGPS && (
        <div className={`p-4 rounded-lg border ${
          error ? 'bg-red-50 border-red-200' : 
          latitude ? 'bg-green-50 border border-green-200' : 
          'bg-blue-50 border border-blue-200'
        }`}>
          {loading ? (
            <div className="space-y-2">
              <div className="flex items-center">
                <div className="animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-blue-600 mr-3"></div>
                <p className="text-blue-700">Konumunuz alÄ±nÄ±yor...</p>
              </div>
              <p className="text-sm text-blue-600">
                TarayÄ±cÄ±nÄ±n izin isteÄŸini bekleyin
              </p>
            </div>
          ) : error ? (
            <div className="space-y-3">
              <div className="flex items-center">
                <span className="text-red-500 text-xl mr-2">âŒ</span>
                <div>
                  <p className="font-medium text-red-800">Konum alÄ±namadÄ±</p>
                  <p className="text-sm text-red-600">{city}</p>
                </div>
              </div>
              
              {permission === 'denied' ? (
                <div className="bg-white p-3 rounded border border-red-100">
                  <p className="text-sm font-medium mb-2">Ä°zin nasÄ±l verilir?</p>
                  <ul className="text-xs text-gray-700 space-y-1">
                    <li>1. TarayÄ±cÄ± ayarlarÄ±nÄ± aÃ§Ä±n</li>
                    <li>2. "Site izinleri" veya "Gizlilik" bÃ¶lÃ¼mÃ¼ne gidin</li>
                    <li>3. "Konum" seÃ§eneÄŸini bulun</li>
                    <li>4. spotitforme.com iÃ§in izin verin</li>
                    <li>5. SayfayÄ± yenileyin ve tekrar deneyin</li>
                  </ul>
                </div>
              ) : (
                <div className="flex space-x-3">
                  <button
                    onClick={handleGetLocation}
                    className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm"
                  >
                    Tekrar Dene
                  </button>
                  <button
                    onClick={handleManualSelect}
                    className="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg text-sm"
                  >
                    Åehir SeÃ§
                  </button>
                </div>
              )}
            </div>
          ) : latitude ? (
            <div className="space-y-4">
              <div className="flex items-center justify-between">
                <div className="flex items-center">
                  <span className="text-green-500 text-2xl mr-3">âœ…</span>
                  <div>
                    <p className="font-bold text-green-800">Konumunuz alÄ±ndÄ±!</p>
                    <p className="text-green-700">{city}</p>
                  </div>
                </div>
                <span className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">
                  GPS Aktif
                </span>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div className="bg-white p-3 rounded border">
                  <p className="text-xs text-gray-600 mb-1">Enlem</p>
                  <p className="font-mono">{latitude?.toFixed(6)}</p>
                </div>
                <div className="bg-white p-3 rounded border">
                  <p className="text-xs text-gray-600 mb-1">Boylam</p>
                  <p className="font-mono">{longitude?.toFixed(6)}</p>
                </div>
              </div>

              <div className="flex space-x-3 pt-2">
                <button
                  onClick={handleGetLocation}
                  className="text-sm text-blue-600 hover:text-blue-800"
                >
                  Konumu Yenile
                </button>
                <button
                  onClick={() => {
                    if (latitude && longitude) {
                      window.open(`https://maps.google.com/?q=${latitude},${longitude}`, '_blank')
                    }
                  }}
                  className="text-sm text-green-600 hover:text-green-800"
                >
                  Haritada GÃ¶ster
                </button>
              </div>
            </div>
          ) : (
            <div className="text-center py-4">
              <div className="text-3xl mb-3">ğŸ“</div>
              <p className="font-medium text-gray-900 mb-2">Konumunuzu alalÄ±m</p>
              <p className="text-sm text-gray-600 mb-4">
                Daha doÄŸru sonuÃ§lar iÃ§in konumunuzu kullanabiliriz
              </p>
              <button
                onClick={handleGetLocation}
                disabled={permission === 'denied'}
                className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg disabled:opacity-50"
              >
                {permission === 'denied' ? 'Ä°zin Verilmedi' : 'Konumumu Al'}
              </button>
            </div>
          )}
        </div>
      )}

      {/* Manuel Åehir SeÃ§imi */}
      {!useGPS && (
        <div>
          <div className="flex items-center justify-between mb-3">
            <label className="block text-sm font-medium text-gray-700">
              Åehir SeÃ§in *
            </label>
            {manualCity && (
              <span className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">
                SeÃ§ildi: {manualCity}
              </span>
            )}
          </div>
          
          <select
            value={manualCity}
            onChange={handleCityChange}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            required={!useGPS}
          >
            <option value="">Åehir seÃ§in</option>
            <option value="TÃ¼rkiye Geneli">ğŸŒ TÃ¼rkiye Geneli</option>
            <optgroup label="BÃ¼yÃ¼k Åehirler">
              {cities.filter(c => !['TÃ¼rkiye Geneli', 'Yurt DÄ±ÅŸÄ±'].includes(c)).map((city) => (
                <option key={city} value={city}>{city}</option>
              ))}
            </optgroup>
            <option value="Yurt DÄ±ÅŸÄ±">âœˆï¸ Yurt DÄ±ÅŸÄ±</option>
          </select>
          
          <div className="mt-3 flex items-center text-sm text-gray-600">
            <span className="mr-2">ğŸ’¡</span>
            <p>
              Konum izni vermek istemiyorsanÄ±z, ÅŸehir listesinden seÃ§ebilirsiniz
            </p>
          </div>
        </div>
      )}

      {/* Ä°zin SeÃ§enekleri Bilgisi */}
      <div className="bg-gray-50 rounded-lg p-4">
        <details className="group">
          <summary className="flex items-center justify-between cursor-pointer list-none">
            <span className="font-medium text-gray-900">Konum Ä°zin SeÃ§enekleri</span>
            <span className="transition group-open:rotate-180">â–¼</span>
          </summary>
          <div className="mt-3 space-y-3 text-sm text-gray-600">
            <div className="flex items-start">
              <span className="text-green-600 mr-2">âœ…</span>
              <div>
                <p className="font-medium">Bir KereliÄŸine Ä°zin Ver</p>
                <p>Sadece bu seferlik konumunuzu kullanmamÄ±za izin verir</p>
              </div>
            </div>
            <div className="flex items-start">
              <span className="text-blue-600 mr-2">ğŸ”’</span>
              <div>
                <p className="font-medium">Her Zaman Ä°zin Ver</p>
                <p>Gelecekteki ziyaretlerinizde tekrar sormaz</p>
              </div>
            </div>
            <div className="flex items-start">
              <span className="text-red-600 mr-2">âŒ</span>
              <div>
                <p className="font-medium">Ä°zin Verme</p>
                <p>Manuel olarak ÅŸehir seÃ§meniz gerekir</p>
              </div>
            </div>
          </div>
        </details>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ LocationSelector.tsx
ğŸ“Š 291 satÄ±r | 8.94 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useState, useEffect, useRef } from 'react'
import { MapPin, Navigation } from 'lucide-react'
import { supabase } from '@/lib/supabase'

// Tip tanÄ±mlarÄ±
interface LocationSuggestion {
  type: 'database' | 'osm'
  name: string
  address: string
  latitude: number | null
  longitude: number | null
  city: string
  district: string
}

interface SelectedLocation {
  name: string
  address: string
  latitude: number | null
  longitude: number | null
  city: string
  district: string
}

interface LocationSelectorProps {
  onLocationSelect: (location: SelectedLocation) => void
  initialLocation?: string
  required?: boolean
}

interface DatabaseLocation {
  name: string
  full_address: string
  latitude: number | null
  longitude: number | null
  city: string
  district: string
}

interface OSMResult {
  display_name: string
  lat: string
  lon: string
  address?: {
    city?: string
    town?: string
    suburb?: string
    county?: string
    [key: string]: any
  }
}

export default function LocationSelector({ 
  onLocationSelect, 
  initialLocation = '',
  required = true
}: LocationSelectorProps) {
  const [location, setLocation] = useState(initialLocation)
  const [suggestions, setSuggestions] = useState<LocationSuggestion[]>([])
  const [isLoading, setIsLoading] = useState(false)
  
  const searchTimeout = useRef<NodeJS.Timeout>()

  useEffect(() => {
    // Ä°lk konum varsa trigger et
    if (initialLocation) {
      handleLocationSelect({ 
        name: initialLocation, 
        address: initialLocation,
        latitude: null,
        longitude: null,
        city: '',
        district: ''
      })
    }
  }, [initialLocation])

  const searchLocation = async (query: string) => {
    if (!query || query.length < 2) {
      setSuggestions([])
      return
    }

    setIsLoading(true)
    try {
      // 1. VeritabanÄ±ndan ara
      const { data: dbResults } = await supabase
        .from('locations')
        .select('*')
        .or(`name.ilike.%${query}%,city.ilike.%${query}%,district.ilike.%${query}%`)
        .limit(5)

      // 2. OpenStreetMap API
      const osmResponse = await fetch(
        `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(query + ' TÃ¼rkiye')}&format=json&addressdetails=1&limit=5`
      )
      const osmResults: OSMResult[] = await osmResponse.json()

      const dbSuggestions: LocationSuggestion[] = (dbResults as DatabaseLocation[] || []).map(loc => ({
        type: 'database' as const,
        name: loc.name,
        address: loc.full_address,
        latitude: loc.latitude,
        longitude: loc.longitude,
        city: loc.city,
        district: loc.district
      }))

      const osmSuggestions: LocationSuggestion[] = osmResults.map((place: OSMResult) => ({
        type: 'osm' as const,
        name: place.display_name.split(',')[0],
        address: place.display_name,
        latitude: place.lat ? parseFloat(place.lat) : null,
        longitude: place.lon ? parseFloat(place.lon) : null,
        city: place.address?.city || place.address?.town || '',
        district: place.address?.suburb || place.address?.county || ''
      }))

      const allSuggestions = [...dbSuggestions, ...osmSuggestions]
      setSuggestions(allSuggestions.slice(0, 8))
    } catch (error) {
      console.error('Konum arama hatasÄ±:', error)
    } finally {
      setIsLoading(false)
    }
  }

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const value = e.target.value
    setLocation(value)
    
    if (searchTimeout.current) {
      clearTimeout(searchTimeout.current)
    }
    
    searchTimeout.current = setTimeout(() => {
      searchLocation(value)
    }, 300)
  }

  const handleSuggestionClick = (suggestion: LocationSuggestion) => {
    setLocation(suggestion.address || suggestion.name)
    setSuggestions([])
    handleLocationSelect(suggestion)
  }

  const handleLocationSelect = (locationData: SelectedLocation) => {
    onLocationSelect({
      name: locationData.name,
      address: locationData.address || locationData.name,
      latitude: locationData.latitude,
      longitude: locationData.longitude,
      city: locationData.city || '',
      district: locationData.district || ''
    })
  }

  const useCurrentLocation = () => {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        async (position) => {
          const { latitude, longitude } = position.coords
          
          try {
            const response = await fetch(
              `https://nominatim.openstreetmap.org/reverse?lat=${latitude}&lon=${longitude}&format=json`
            )
            const data: OSMResult = await response.json()
            
            const locationObj: SelectedLocation = {
              name: 'Mevcut Konumum',
              address: data.display_name,
              latitude,
              longitude,
              city: data.address?.city || data.address?.town || '',
              district: data.address?.suburb || data.address?.county || ''
            }
            
            setLocation(data.display_name)
            handleLocationSelect(locationObj)
          } catch (error) {
            console.error('Reverse geocoding hatasÄ±:', error)
          }
        },
        (error) => {
          console.error('Konum alÄ±namadÄ±:', error)
          alert('Konum izni vermeniz gerekiyor')
        }
      )
    }
  }

  const quickLocations = [
    'Ä°stiklal Caddesi, BeyoÄŸlu',
    'KadÄ±kÃ¶y Ã‡arÅŸÄ±, KadÄ±kÃ¶y',
    'BaÄŸdat Caddesi, KadÄ±kÃ¶y',
    'NiÅŸantaÅŸÄ±, ÅiÅŸli',
    'Akmerkez, BeÅŸiktaÅŸ',
    'Kanyon, ÅiÅŸli',
    'Ä°zmir Alsancak',
    'Ankara KÄ±zÄ±lay'
  ]

  return (
    <div className="space-y-3">
      <label className="block text-sm font-medium text-gray-700">
        ğŸ“ Konum {required && '*'}
      </label>
      
      <div className="relative">
        <div className="flex items-center">
          <div className="flex-1 relative">
            <MapPin className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
            <input
              type="text"
              value={location}
              onChange={handleInputChange}
              placeholder="Ã–rn: Ä°stiklal Caddesi, KadÄ±kÃ¶y Ã‡arÅŸÄ±..."
              className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              required={required}
            />
          </div>
          
          <button
            type="button"
            onClick={useCurrentLocation}
            className="ml-2 p-3 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition"
            title="Mevcut konumumu kullan"
          >
            <Navigation className="w-5 h-5" />
          </button>
        </div>

        {/* Ã–neriler */}
        {suggestions.length > 0 && (
          <div className="absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto">
            {suggestions.map((suggestion, index) => (
              <button
                key={index}
                type="button"
                onClick={() => handleSuggestionClick(suggestion)}
                className="w-full text-left px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-0"
              >
                <div className="font-medium">{suggestion.name}</div>
                <div className="text-sm text-gray-600 truncate">
                  {suggestion.address}
                </div>
                {suggestion.city && (
                  <div className="text-xs text-gray-500 mt-1">
                    {suggestion.district ? `${suggestion.district}, ` : ''}
                    {suggestion.city}
                  </div>
                )}
              </button>
            ))}
          </div>
        )}

        {isLoading && (
          <div className="absolute right-3 top-1/2 transform -translate-y-1/2">
            <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"></div>
          </div>
        )}
      </div>

      {/* HÄ±zlÄ± konum butonlarÄ± */}
      <div className="flex flex-wrap gap-2">
        {quickLocations.map((quickLocation) => (
          <button
            key={quickLocation}
            type="button"
            onClick={() => {
              setLocation(quickLocation)
              searchLocation(quickLocation)
            }}
            className="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full text-sm transition"
          >
            {quickLocation}
          </button>
        ))}
      </div>

      <p className="text-xs text-gray-500">
        âœ“ Konum bilgisi Ã¼rÃ¼nÃ¼n daha hÄ±zlÄ± bulunmasÄ±nÄ± saÄŸlar<br />
        âœ“ DetaylÄ± adres (sokak, bina no) daha iyi sonuÃ§ verir
      </p>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ MapView.tsx
ğŸ“Š 81 satÄ±r | 3.01 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleMap.tsx
'use client'

import { useState } from 'react'

interface SimpleMapProps {
  location: string
  height?: string
}

export default function SimpleMap({ location, height = '300px' }: SimpleMapProps) {
  const [showMap, setShowMap] = useState(false)

  // Åehir gÃ¶rselleri (placeholder)
  const cityImages: Record<string, string> = {
    'Ä°stanbul': 'https://images.unsplash.com/photo-1527838832700-5059252407fa?w=800&auto=format&fit=crop',
    'Ankara': 'https://images.unsplash.com/photo-1593642632559-0c6d3fc62b89?w-800&auto=format&fit=crop',
    'Ä°zmir': 'https://images.unsplash.com/photo-1590490360182-c33d57733427?w=800&auto=format&fit=crop',
    'Bursa': 'https://images.unsplash.com/photo-1544984243-ec57ea16fe25?w=800&auto=format&fit=crop',
    'Antalya': 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&auto=format&fit=crop',
    'DiÄŸer': 'https://images.unsplash.com/photo-1589829545856-d10d557cf95f?w=800&auto=format&fit=crop'
  }

  const getCityImage = () => {
    for (const city in cityImages) {
      if (location.includes(city)) {
        return cityImages[city]
      }
    }
    return cityImages['DiÄŸer']
  }

  return (
    <div className="bg-white rounded-xl shadow-lg overflow-hidden">
      <div 
        className="relative bg-gray-100" 
        style={{ height }}
      >
        {showMap ? (
          // Google Maps iframe (basit)
          <iframe
            src={`https://maps.google.com/maps?q=${encodeURIComponent(location)}&output=embed`}
            className="w-full h-full border-0"
            loading="lazy"
            title={`${location} haritasÄ±`}
          />
        ) : (
          // GÃ¶rsel preview
          <div className="w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-50">
            <div className="text-center p-8">
              <div className="text-5xl mb-4">ğŸ—ºï¸</div>
              <h3 className="text-xl font-bold text-gray-900 mb-2">Konum: {location}</h3>
              <p className="text-gray-600 mb-6">Bu spot {location} konumunda aranÄ±yor</p>
              <button
                onClick={() => setShowMap(true)}
                className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg"
              >
                Haritada GÃ¶ster
              </button>
            </div>
          </div>
        )}
      </div>
      
      <div className="p-4 border-t border-gray-200">
        <div className="flex items-center justify-between">
          <div className="flex items-center space-x-2">
            <span className="text-sm text-gray-600">ğŸ“</span>
            <span className="font-medium">{location}</span>
          </div>
          <button
            onClick={() => setShowMap(!showMap)}
            className="text-blue-600 hover:text-blue-800 text-sm"
          >
            {showMap ? 'GÃ¶rsel GÃ¶ster' : 'Harita GÃ¶ster'}
          </button>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\MessageThread.tsx
ğŸ“Š 596 satÄ±r | 20.53 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/MessageThread.tsx
'use client'

import { useState, useRef, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { Send, Paperclip, Image as ImageIcon, X, ArrowLeft, MoreVertical, Phone, Video, Info, Trash2, MessageSquare } from 'lucide-react'

interface Message {
  id: string
  sender_id: string
  content: string
  attachments?: string[]
  created_at: string
  is_read: boolean
  type?: string
}

interface Participant {
  id: string
  name: string
  avatar: string
  is_online: boolean
  last_seen?: string
}

interface MessageThreadProps {
  threadId: string
  userId: string
  onBack: () => void
}

export default function MessageThread({ threadId, userId, onBack }: MessageThreadProps) {
  const [messages, setMessages] = useState<Message[]>([])
  const [newMessage, setNewMessage] = useState('')
  const [participant, setParticipant] = useState<Participant | null>(null)
  const [loading, setLoading] = useState(true)
  const [sending, setSending] = useState(false)
  const [attachment, setAttachment] = useState<File | null>(null)
  const [uploadProgress, setUploadProgress] = useState(0)
  const [showOptions, setShowOptions] = useState(false)
  
  const messagesEndRef = useRef<HTMLDivElement>(null)
  const fileInputRef = useRef<HTMLInputElement>(null)

  useEffect(() => {
    if (threadId) {
      fetchThreadData()
    }
  }, [threadId])

  useEffect(() => {
    scrollToBottom()
  }, [messages])

  const fetchThreadData = async () => {
    setLoading(true)
    try {
      // 1. Thread bilgilerini Ã§ek
      const { data: threadData, error: threadError } = await supabase
        .from('message_threads')
        .select(`
          *,
          participant1:user_profiles!participant1_id(*),
          participant2:user_profiles!participant2_id(*),
          spot:spots(title)
        `)
        .eq('id', threadId)
        .single()

      if (threadError) throw threadError

      // 2. Hangi katÄ±lÄ±mcÄ± biz deÄŸiliz?
      let otherParticipant = null
      let isParticipant1 = false
      
      if (threadData.participant1_id === userId) {
        otherParticipant = threadData.participant2
        isParticipant1 = true
      } else {
        otherParticipant = threadData.participant1
        isParticipant1 = false
      }

      setParticipant({
        id: otherParticipant?.id || 'unknown',
        name: otherParticipant?.name || 'KullanÄ±cÄ±',
        avatar: otherParticipant?.avatar_url || '',
        is_online: otherParticipant?.last_seen ? 
          new Date(otherParticipant.last_seen).getTime() > Date.now() - 5 * 60 * 1000 : false,
        last_seen: otherParticipant?.last_seen
      })

      // 3. MesajlarÄ± Ã§ek
      const { data: messagesData, error: messagesError } = await supabase
        .from('messages')
        .select('*')
        .eq('thread_id', threadId)
        .order('created_at', { ascending: true })

      if (messagesError) throw messagesError

      setMessages(messagesData || [])
      
      // 4. OkunmamÄ±ÅŸ mesajlarÄ± iÅŸaretle
      await markMessagesAsRead(isParticipant1)

    } catch (error) {
      console.error('Mesajlar yÃ¼klenemedi:', error)
      // Fallback veri
      setParticipant({
        id: '123',
        name: 'Ahmet YÄ±lmaz',
        avatar: '',
        is_online: true
      })
      
      setMessages([
        {
          id: '1',
          sender_id: '123',
          content: 'Merhaba, o vintage Sony Walkman\'i nerede bulabilirim?',
          created_at: '2024-01-15T10:00:00',
          is_read: true,
          type: 'text'
        },
        {
          id: '2',
          sender_id: userId,
          content: 'KadÄ±kÃ¶y Ã§arÅŸÄ±sÄ±nda bir antikacÄ±da gÃ¶rmÃ¼ÅŸtÃ¼m, tam adres: KadÄ±kÃ¶y RÄ±htÄ±m Cd. No:25',
          created_at: '2024-01-15T10:05:00',
          is_read: true,
          type: 'text'
        },
        {
          id: '3',
          sender_id: '123',
          content: 'Harika! Hafta sonu uÄŸrayacaÄŸÄ±m. Fiyat fikriniz var mÄ±?',
          created_at: '2024-01-15T10:10:00',
          is_read: false,
          type: 'text'
        }
      ])
    } finally {
      setLoading(false)
    }
  }

  const markMessagesAsRead = async (isParticipant1: boolean) => {
    try {
      // MesajlarÄ± okundu olarak iÅŸaretle
      await supabase
        .from('messages')
        .update({ is_read: true })
        .eq('thread_id', threadId)
        .neq('sender_id', userId)
        .eq('is_read', false)

      // Thread'deki okunmamÄ±ÅŸ sayÄ±sÄ±nÄ± sÄ±fÄ±rla
      const updateField = isParticipant1 ? 'unread_count_p1' : 'unread_count_p2'
      await supabase
        .from('message_threads')
        .update({ [updateField]: 0 })
        .eq('id', threadId)

    } catch (error) {
      console.error('Okundu iÅŸaretleme hatasÄ±:', error)
    }
  }

  const scrollToBottom = () => {
    setTimeout(() => {
      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })
    }, 100)
  }

  const handleSendMessage = async () => {
    if (!newMessage.trim() && !attachment) return

    setSending(true)
    const tempMessageId = Date.now().toString()

    try {
      // 1. KullanÄ±cÄ± bilgisi
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) throw new Error('KullanÄ±cÄ± bulunamadÄ±')

      let attachmentUrl = null
      
      // 2. Dosya yÃ¼kleme
      if (attachment) {
        const fileExt = attachment.name.split('.').pop()
        const fileName = `${user.id}/${threadId}/${Date.now()}.${fileExt}`
        
        const { data, error } = await supabase.storage
          .from('message-attachments')
          .upload(fileName, attachment)

        if (error) throw error
        attachmentUrl = data?.path
      }

      // 3. Yeni mesaj oluÅŸtur (optimistik)
      const newMsg: Message = {
        id: tempMessageId,
        sender_id: user.id,
        content: newMessage,
        attachments: attachmentUrl ? [attachmentUrl] : undefined,
        created_at: new Date().toISOString(),
        is_read: false,
        type: attachment ? 'image' : 'text'
      }

      setMessages(prev => [...prev, newMsg])
      
      // 4. Supabase'e kaydet
      const { error: saveError } = await supabase
        .from('messages')
        .insert([{
          thread_id: threadId,
          sender_id: user.id,
          content: newMessage,
          attachments: attachmentUrl ? [attachmentUrl] : null,
          type: attachment ? 'image' : 'text'
        }])

      if (saveError) throw saveError

      // 5. Thread'i gÃ¼ncelle
      const { error: updateError } = await supabase
        .from('message_threads')
        .update({
          last_message_at: new Date().toISOString(),
          last_message_preview: newMessage.substring(0, 100),
          updated_at: new Date().toISOString()
        })
        .eq('id', threadId)

      if (updateError) console.warn('Thread gÃ¼ncellenemedi:', updateError)

      // 6. Formu temizle
      setNewMessage('')
      setAttachment(null)
      setUploadProgress(0)

    } catch (error) {
      console.error('Mesaj gÃ¶nderilemedi:', error)
      alert('Mesaj gÃ¶nderilemedi. LÃ¼tfen tekrar deneyin.')
      
      // Optimistik mesajÄ± geri al
      setMessages(prev => prev.filter(msg => msg.id !== tempMessageId))
    } finally {
      setSending(false)
    }
  }

  const handleAttachment = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (file) {
      if (file.size > 10 * 1024 * 1024) {
        alert('Dosya boyutu 10MB\'dan kÃ¼Ã§Ã¼k olmalÄ±')
        return
      }
      
      const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'application/pdf']
      if (!allowedTypes.includes(file.type)) {
        alert('Sadece JPG, PNG, GIF veya PDF dosyalarÄ± yÃ¼kleyebilirsiniz')
        return
      }
      
      setAttachment(file)
      // Upload progress simÃ¼lasyonu
      let progress = 0
      const interval = setInterval(() => {
        progress += 10
        setUploadProgress(progress)
        if (progress >= 100) {
          clearInterval(interval)
        }
      }, 100)
    }
  }

  const formatMessageTime = (dateString: string) => {
    return new Date(dateString).toLocaleTimeString('tr-TR', {
      hour: '2-digit',
      minute: '2-digit'
    })
  }

  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault()
      handleSendMessage()
    }
  }

  if (loading) {
    return (
      <div className="flex flex-col h-full">
        <div className="p-4 border-b">
          <div className="animate-pulse flex items-center space-x-3">
            <div className="w-10 h-10 bg-gray-200 rounded-full"></div>
            <div className="flex-1">
              <div className="h-4 bg-gray-200 rounded w-32 mb-2"></div>
              <div className="h-3 bg-gray-200 rounded w-24"></div>
            </div>
          </div>
        </div>
        <div className="flex-1 flex items-center justify-center">
          <div className="text-center">
            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
            <p className="mt-2 text-gray-500">Mesajlar yÃ¼kleniyor...</p>
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="flex flex-col h-full">
      {/* Header */}
      <div className="p-4 border-b flex items-center justify-between bg-white sticky top-0 z-10">
        <div className="flex items-center space-x-3">
          <button
            onClick={onBack}
            className="p-1 hover:bg-gray-100 rounded-lg md:hidden"
          >
            <ArrowLeft className="w-5 h-5" />
          </button>
          
          <div className="relative">
            <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
              {participant?.avatar ? (
                <img
                  src={participant.avatar}
                  alt={participant.name}
                  className="w-10 h-10 rounded-full"
                />
              ) : (
                <span className="font-semibold text-blue-600 text-lg">
                  {participant?.name?.charAt(0) || 'K'}
                </span>
              )}
            </div>
            {participant?.is_online && (
              <div className="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
            )}
          </div>
          
          <div>
            <h3 className="font-semibold">{participant?.name || 'KullanÄ±cÄ±'}</h3>
            <p className="text-sm text-gray-500">
              {participant?.is_online 
                ? 'Ã‡evrimiÃ§i' 
                : participant?.last_seen 
                  ? `Son gÃ¶rÃ¼lme: ${new Date(participant.last_seen).toLocaleTimeString('tr-TR')}`
                  : 'Ã‡evrimdÄ±ÅŸÄ±'
              }
            </p>
          </div>
        </div>
        
        <div className="flex items-center space-x-2">
          <button className="p-2 hover:bg-gray-100 rounded-lg" title="Ara">
            <Phone className="w-5 h-5 text-gray-600" />
          </button>
          <button className="p-2 hover:bg-gray-100 rounded-lg" title="GÃ¶rÃ¼ntÃ¼lÃ¼ ara">
            <Video className="w-5 h-5 text-gray-600" />
          </button>
          <button 
            onClick={() => setShowOptions(!showOptions)}
            className="p-2 hover:bg-gray-100 rounded-lg relative"
          >
            <MoreVertical className="w-5 h-5 text-gray-600" />
            {showOptions && (
              <div className="absolute right-0 top-full mt-1 w-48 bg-white border rounded-lg shadow-lg py-2 z-20">
                <button className="w-full px-4 py-2 text-left hover:bg-gray-100 text-sm flex items-center">
                  <Info className="w-4 h-4 mr-2" />
                  Profili gÃ¶rÃ¼ntÃ¼le
                </button>
                <button className="w-full px-4 py-2 text-left hover:bg-gray-100 text-sm flex items-center">
                  <Trash2 className="w-4 h-4 mr-2" />
                  GÃ¶rÃ¼ÅŸmeyi sil
                </button>
                <button className="w-full px-4 py-2 text-left hover:bg-gray-100 text-sm flex items-center">
                  <X className="w-4 h-4 mr-2" />
                  Bildirimleri kapat
                </button>
              </div>
            )}
          </button>
        </div>
      </div>

      {/* Messages */}
      <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50">
        {messages.length === 0 ? (
          <div className="flex items-center justify-center h-full">
            <div className="text-center text-gray-500">
              <MessageSquare className="w-12 h-12 mx-auto mb-3 text-gray-300" />
              <p>HenÃ¼z mesaj yok</p>
              <p className="text-sm mt-1">Ä°lk mesajÄ± siz gÃ¶nderin</p>
            </div>
          </div>
        ) : (
          <>
            {messages.map((msg) => (
              <div
                key={msg.id}
                className={`flex ${msg.sender_id === userId ? 'justify-end' : 'justify-start'}`}
              >
                <div
                  className={`
                    max-w-[70%] rounded-2xl px-4 py-2 relative
                    ${msg.sender_id === userId
                      ? 'bg-blue-500 text-white rounded-br-none'
                      : 'bg-white text-gray-800 rounded-bl-none border'
                    }
                  `}
                >
                  {/* Mesaj iÃ§eriÄŸi */}
                  <p className="whitespace-pre-wrap break-words">{msg.content}</p>
                  
                  {/* Ekler */}
                  {msg.attachments && msg.attachments.length > 0 && (
                    <div className="mt-2 space-y-2">
                      {msg.attachments.map((url, idx) => (
                        <div key={idx} className="border rounded-lg overflow-hidden">
                          {url && url.match(/\.(jpg|jpeg|png|gif)$/i) ? (
                            <img 
                              src={`${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/message-attachments/${url}`}
                              alt="Ek"
                              className="max-w-full h-auto"
                              loading="lazy"
                            />
                          ) : (
                            <a 
                              href={`${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/message-attachments/${url}`}
                              target="_blank"
                              rel="noopener noreferrer"
                              className="flex items-center p-2 hover:bg-gray-50"
                            >
                              <Paperclip className="w-4 h-4 mr-2" />
                              <span className="text-sm truncate">Dosya eki</span>
                            </a>
                          )}
                        </div>
                      ))}
                    </div>
                  )}
                  
                  {/* Zaman ve okundu bilgisi */}
                  <div className={`flex items-center justify-between mt-1 ${msg.sender_id === userId ? 'text-blue-200' : 'text-gray-500'}`}>
                    <span className="text-xs">
                      {formatMessageTime(msg.created_at)}
                    </span>
                    {msg.sender_id === userId && (
                      <span className="text-xs ml-2">
                        {msg.is_read ? 'âœ“âœ“' : 'âœ“'}
                      </span>
                    )}
                  </div>
                </div>
              </div>
            ))}
            <div ref={messagesEndRef} />
          </>
        )}
      </div>

      {/* Upload Progress */}
      {uploadProgress > 0 && uploadProgress < 100 && (
        <div className="px-4 py-2 border-t bg-blue-50">
          <div className="flex items-center justify-between">
            <div className="flex items-center space-x-2">
              <ImageIcon className="w-4 h-4 text-blue-500" />
              <span className="text-sm text-blue-700">
                {attachment?.name} yÃ¼kleniyor...
              </span>
            </div>
            <span className="text-sm text-blue-700 font-medium">
              %{Math.round(uploadProgress)}
            </span>
          </div>
          <div className="mt-1 w-full bg-blue-200 rounded-full h-1">
            <div 
              className="bg-blue-500 h-1 rounded-full transition-all duration-300"
              style={{ width: `${uploadProgress}%` }}
            ></div>
          </div>
        </div>
      )}

      {/* Attachment Preview */}
      {attachment && uploadProgress === 0 && (
        <div className="px-4 py-2 border-t bg-gray-50 flex items-center justify-between">
          <div className="flex items-center space-x-2">
            <ImageIcon className="w-5 h-5 text-gray-500" />
            <div>
              <p className="text-sm font-medium truncate max-w-[200px]">
                {attachment.name}
              </p>
              <p className="text-xs text-gray-500">
                {(attachment.size / 1024).toFixed(1)} KB â€¢ {attachment.type.split('/')[1].toUpperCase()}
              </p>
            </div>
          </div>
          <button
            onClick={() => setAttachment(null)}
            className="p-1 hover:bg-gray-200 rounded"
          >
            <X className="w-4 h-4 text-gray-500" />
          </button>
        </div>
      )}

      {/* Input Area */}
      <div className="p-4 border-t bg-white">
        <div className="flex items-center space-x-2">
          <input
            ref={fileInputRef}
            type="file"
            className="hidden"
            onChange={handleAttachment}
            accept="image/*,.pdf"
          />
          
          <button
            onClick={() => fileInputRef.current?.click()}
            className="p-2 hover:bg-gray-100 rounded-lg"
            title="Dosya ekle"
          >
            <Paperclip className="w-5 h-5 text-gray-500" />
          </button>
          
          <div className="flex-1 relative">
            <textarea
              value={newMessage}
              onChange={(e) => setNewMessage(e.target.value)}
              onKeyDown={handleKeyPress}
              placeholder="MesajÄ±nÄ±zÄ± yazÄ±n... (Enter ile gÃ¶nder, Shift+Enter ile yeni satÄ±r)"
              className="w-full border rounded-lg px-4 py-2 pr-10 focus:outline-none focus:border-blue-500 resize-none min-h-[44px] max-h-[120px]"
              rows={1}
              style={{ height: 'auto' }}
              onInput={(e) => {
                const target = e.target as HTMLTextAreaElement
                target.style.height = 'auto'
                target.style.height = `${Math.min(target.scrollHeight, 120)}px`
              }}
            />
            <div className="absolute right-2 top-1/2 transform -translate-y-1/2">
              <span className="text-xs text-gray-400">
                {newMessage.length}/1000
              </span>
            </div>
          </div>
          
          <button
            onClick={handleSendMessage}
            disabled={sending || (!newMessage.trim() && !attachment)}
            className={`
              p-2 rounded-lg flex-shrink-0 transition-colors
              ${sending || (!newMessage.trim() && !attachment)
                ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
                : 'bg-blue-500 text-white hover:bg-blue-600'
              }
            `}
            title="GÃ¶nder"
          >
            {sending ? (
              <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
            ) : (
              <Send className="w-5 h-5" />
            )}
          </button>
        </div>
        
        {/* Security Notice */}
        <div className="mt-2 text-center">
          <p className="text-xs text-gray-500">
            â€¢ SpotItForme Ã¼zerinden kiÅŸisel bilgi (telefon, adres, kart bilgisi) paylaÅŸmayÄ±n â€¢
            Ã–demeler iÃ§in gÃ¼venli kanallar kullanÄ±n
          </p>
        </div>
      </div>

      {/* Options Overlay */}
      {showOptions && (
        <div 
          className="fixed inset-0 z-0"
          onClick={() => setShowOptions(false)}
        />
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\MessagingLayout.tsx
ğŸ“Š 257 satÄ±r | 7.71 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/MessagingLayout.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'
import ThreadList from './ThreadList'
import MessageThread from './MessageThread'
import NewMessageModal from './NewMessageModal'
import SecurityDisclaimer from './SecurityDisclaimer'

interface MessagingLayoutProps {
  initialThreadId?: string
  userId: string
}

// Thread tÃ¼rÃ¼nÃ¼ tanÄ±mla
interface Thread {
  id: string
  participant1_id: string
  participant2_id: string
  unread_count_p1: number
  unread_count_p2: number
  last_message_at: string
  thread_type: string
  status: string
  [key: string]: any // DiÄŸer Ã¶zellikler iÃ§in
}

export default function MessagingLayout({ initialThreadId, userId }: MessagingLayoutProps) {
  const router = useRouter()
  const [selectedThread, setSelectedThread] = useState<string | null>(initialThreadId || null)
  const [threads, setThreads] = useState<Thread[]>([])
  const [loading, setLoading] = useState(true)
  const [showNewMessageModal, setShowNewMessageModal] = useState(false)
  const [unreadCount, setUnreadCount] = useState(0)
  
  // Realtime subscription iÃ§in
  const [subscription, setSubscription] = useState<any>(null)

  useEffect(() => {
    fetchThreads()
    setupRealtimeSubscription()
    
    return () => {
      if (subscription) {
        supabase.removeChannel(subscription)
      }
    }
  }, [userId])

  const fetchThreads = async () => {
    try {
      const { data, error } = await supabase
        .from('active_conversations')
        .select('*')
        .or(`participant1_id.eq.${userId},participant2_id.eq.${userId}`)
        .order('last_message_at', { ascending: false })

      if (error) throw error

      setThreads(data || [])
      
      // OkunmamÄ±ÅŸ mesaj sayÄ±sÄ±nÄ± hesapla - DÃœZELTÄ°LDÄ°
      const totalUnread = (data || []).reduce((sum: number, thread: Thread) => {
        if (thread.participant1_id === userId) {
          return sum + (thread.unread_count_p1 || 0)
        } else {
          return sum + (thread.unread_count_p2 || 0)
        }
      }, 0)
      
      setUnreadCount(totalUnread)
    } catch (error) {
      console.error('Threads yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const setupRealtimeSubscription = () => {
    const channel = supabase
      .channel('message-changes')
      .on(
        'postgres_changes',
        {
          event: 'INSERT',
          schema: 'public',
          table: 'messages',
          filter: `receiver_id=eq.${userId}`
        },
        (payload) => {
          console.log('Yeni mesaj geldi:', payload)
          fetchThreads() // Thread listesini yenile
          
          // Bildirim gÃ¶ster (native browser notification)
          if (Notification.permission === 'granted') {
            new Notification('Yeni Mesaj', {
              body: payload.new.content?.substring(0, 50) || 'Yeni mesajÄ±nÄ±z var',
              icon: '/logo.png'
            })
          }
        }
      )
      .subscribe()

    setSubscription(channel)
  }

  const handleNewMessage = async (receiverId: string, content: string, threadType: string) => {
    try {
      // Ã–nce thread var mÄ± kontrol et
      let threadId = selectedThread
      
      if (!threadId) {
        // Yeni thread oluÅŸtur
        const { data: thread, error: threadError } = await supabase
          .from('message_threads')
          .insert({
            participant1_id: userId,
            participant2_id: receiverId,
            thread_type: threadType,
            status: 'active'
          })
          .select()
          .single()

        if (threadError) throw threadError
        threadId = thread.id
      }

      // MesajÄ± gÃ¶nder
      const { error: messageError } = await supabase
        .from('messages')
        .insert({
          thread_id: threadId,
          sender_id: userId,
          receiver_id: receiverId,
          content: content
        })

      if (messageError) throw messageError

      // Thread'i seÃ§ ve modal'Ä± kapat
      setSelectedThread(threadId)
      setShowNewMessageModal(false)
      
      // Thread listesini gÃ¼ncelle
      fetchThreads()

    } catch (error) {
      console.error('Mesaj gÃ¶nderme hatasÄ±:', error)
      alert('Mesaj gÃ¶nderilemedi. LÃ¼tfen tekrar deneyin.')
    }
  }

  const handleDeleteThread = async (threadId: string) => {
    if (!confirm('Bu konuÅŸmayÄ± silmek istediÄŸinize emin misiniz?')) return

    try {
      const { error } = await supabase
        .from('message_threads')
        .update({ status: 'archived' })
        .eq('id', threadId)

      if (error) throw error

      // EÄŸer silinen thread seÃ§iliyse, seÃ§imi temizle
      if (selectedThread === threadId) {
        setSelectedThread(null)
      }

      // Listeyi gÃ¼ncelle
      fetchThreads()

    } catch (error) {
      console.error('Thread silme hatasÄ±:', error)
      alert('KonuÅŸma silinemedi.')
    }
  }

  return (
    <div className="flex h-[calc(100vh-200px)] bg-white rounded-xl shadow-lg overflow-hidden">
      {/* Sol sidebar - Thread listesi */}
      <div className="w-full md:w-96 border-r border-gray-200 flex flex-col">
        <div className="p-4 border-b">
          <div className="flex items-center justify-between">
            <h2 className="text-xl font-bold text-gray-900">Mesajlar</h2>
            <div className="flex items-center space-x-2">
              {unreadCount > 0 && (
                <span className="bg-red-500 text-white text-xs px-2 py-1 rounded-full">
                  {unreadCount}
                </span>
              )}
              <button
                onClick={() => setShowNewMessageModal(true)}
                className="bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg"
                title="Yeni mesaj"
              >
                +
              </button>
            </div>
          </div>
          
          {/* GÃ¼venlik uyarÄ±sÄ± (kÃ¼Ã§Ã¼k) */}
          <div className="mt-3">
            <SecurityDisclaimer variant="mini" />
          </div>
        </div>

        <ThreadList
          threads={threads}
          selectedThread={selectedThread}
          onSelectThread={setSelectedThread}
          onDeleteThread={handleDeleteThread}
          loading={loading}
          userId={userId}
        />
      </div>

      {/* SaÄŸ taraf - MesajlaÅŸma ekranÄ± */}
      <div className="flex-1 flex flex-col">
        {selectedThread ? (
          <MessageThread
            threadId={selectedThread}
            userId={userId}
            onBack={() => setSelectedThread(null)}
          />
        ) : (
          <div className="flex-1 flex flex-col items-center justify-center p-8 text-center">
            <div className="text-4xl mb-4">ğŸ’¬</div>
            <h3 className="text-xl font-bold text-gray-900 mb-2">
              Bir konuÅŸma seÃ§in
            </h3>
            <p className="text-gray-600 mb-6 max-w-md">
              Mevcut konuÅŸmalarÄ±nÄ±zÄ± soldan seÃ§ebilir veya yeni bir mesaj baÅŸlatabilirsiniz.
            </p>
            <button
              onClick={() => setShowNewMessageModal(true)}
              className="btn-primary"
            >
              Yeni Mesaj BaÅŸlat
            </button>
          </div>
        )}
      </div>

      {/* Yeni Mesaj Modal'Ä± */}
      <NewMessageModal
        isOpen={showNewMessageModal}
        onClose={() => setShowNewMessageModal(false)}
        onSendMessage={handleNewMessage}
        currentUserId={userId}
      />
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\mobile\MessagingMobile.tsx
ğŸ“Š 185 satÄ±r | 5.83 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/mobile/MessagingMobile.tsx
'use client'

import { useState, useEffect } from 'react'
import { Menu, MessageSquare, Search, User } from 'lucide-react'
import MobileThreadList from './MobileThreadList'
import MobileMessageThread from './MobileMessageThread'
import MobileNewMessage from './MobileNewMessage'

interface Thread {
  id: string
  participant_name: string
  last_message_preview: string
  last_message_at: string
}

interface MobileMessagingProps {
  userId: string
}

type ViewType = 'list' | 'thread' | 'newMessage'

export default function MessagingMobile({ userId }: MobileMessagingProps) {
  const [currentView, setCurrentView] = useState<ViewType>('list')
  const [selectedThreadId, setSelectedThreadId] = useState<string | null>(null)
  const [threads, setThreads] = useState<Thread[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchThreads()
  }, [])

  const fetchThreads = async () => {
    try {
      // Ã–rnek veri - gerÃ§ek API'yi baÄŸlayacaksÄ±nÄ±z
      const mockThreads: Thread[] = [
        {
          id: '1',
          participant_name: 'Ahmet YÄ±lmaz',
          last_message_preview: 'O Ã¼rÃ¼nÃ¼ KadÄ±kÃ¶y\'de gÃ¶rdÃ¼m',
          last_message_at: '2024-01-15T10:30:00'
        },
        {
          id: '2',
          participant_name: 'Zeynep Demir',
          last_message_preview: 'FotoÄŸrafÄ± ekledim',
          last_message_at: '2024-01-14T15:45:00'
        },
        {
          id: '3',
          participant_name: 'Mehmet Ã–z',
          last_message_preview: 'YarÄ±n buluÅŸabilir miyiz?',
          last_message_at: '2024-01-13T09:15:00'
        }
      ]
      setThreads(mockThreads)
    } catch (error) {
      console.error('Threads yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const handleSelectThread = (threadId: string) => {
    setSelectedThreadId(threadId)
    setCurrentView('thread')
  }

  const handleNewMessage = () => {
    setCurrentView('newMessage')
  }

  const handleSendMessage = async (receiverId: string, content: string) => {
    try {
      console.log('Mobil mesaj gÃ¶nderiliyor:', { receiverId, content, userId })
      // GerÃ§ek API Ã§aÄŸrÄ±sÄ±nÄ± buraya ekleyin
      alert('Mesaj gÃ¶nderildi!')
      setCurrentView('list')
    } catch (error) {
      console.error('Mesaj gÃ¶nderilemedi:', error)
      alert('Mesaj gÃ¶nderilemedi')
    }
  }

  const renderView = () => {
    switch (currentView) {
      case 'list':
        return (
          <>
            <div className="p-4 border-b flex items-center justify-between bg-white">
              <h1 className="text-xl font-bold">Mesajlar</h1>
              <div className="flex items-center space-x-3">
                <button className="p-2 hover:bg-gray-100 rounded-lg">
                  <Search className="w-5 h-5" />
                </button>
                <button 
                  onClick={handleNewMessage}
                  className="bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600"
                >
                  <MessageSquare className="w-5 h-5" />
                </button>
              </div>
            </div>
            <MobileThreadList
              threads={threads}
              onSelectThread={handleSelectThread}
              loading={loading}
            />
          </>
        )
      
      case 'thread':
        return (
          <>
            <div className="p-4 border-b bg-white">
              <button
                onClick={() => setCurrentView('list')}
                className="text-blue-600 font-medium"
              >
                â† Mesajlara dÃ¶n
              </button>
            </div>
            {selectedThreadId && (
              <MobileMessageThread
                threadId={selectedThreadId}
                userId={userId}
                onBack={() => setCurrentView('list')}
              />
            )}
          </>
        )
      
      case 'newMessage':
        return (
          <MobileNewMessage
            onClose={() => setCurrentView('list')}
            onSendMessage={handleSendMessage}
          />
        )
    }
  }

  return (
    <div className="flex flex-col h-screen bg-white">
      {/* Main Content */}
      <div className="flex-1 overflow-hidden">
        {renderView()}
      </div>

      {/* Bottom Navigation (sadece list view'da gÃ¶ster) */}
      {currentView === 'list' && (
        <div className="border-t bg-white">
          <div className="flex justify-around items-center py-3">
            <button className="flex flex-col items-center">
              <MessageSquare className="w-6 h-6 text-blue-500" />
              <span className="text-xs mt-1 font-medium text-blue-500">Mesajlar</span>
            </button>
            <button 
              onClick={handleNewMessage}
              className="flex flex-col items-center"
            >
              <div className="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center -mt-4">
                <MessageSquare className="w-6 h-6 text-white" />
              </div>
              <span className="text-xs mt-1">Yeni Mesaj</span>
            </button>
            <button className="flex flex-col items-center">
              <User className="w-6 h-6 text-gray-500" />
              <span className="text-xs mt-1 text-gray-500">Profil</span>
            </button>
          </div>
        </div>
      )}

      {/* Stats (sadece list view'da) */}
      {currentView === 'list' && (
        <div className="px-4 py-2 border-t bg-gray-50">
          <div className="text-center text-xs text-gray-500">
            <p>Aktif kullanÄ±cÄ±: {userId?.substring(0, 8) || 'guest'} â€¢ {threads.length} gÃ¶rÃ¼ÅŸme</p>
          </div>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\mobile\MobileMessageThread.tsx
ğŸ“Š 89 satÄ±r | 2.89 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/mobile/MobileMessageThread.tsx
'use client'

import { useState } from 'react'
import { ArrowLeft, Send } from 'lucide-react'

interface MobileMessageThreadProps {
  threadId: string;
  userId: string;
  onBack: () => void;
}

export default function MobileMessageThread({ 
  threadId, 
  userId, 
  onBack 
}: MobileMessageThreadProps) {
  const [message, setMessage] = useState('')

  const handleSend = () => {
    if (!message.trim()) return
    console.log('Mobil mesaj gÃ¶nder:', { threadId, message, userId })
    setMessage('')
  }

  return (
    <div className="flex flex-col h-full">
      {/* Header */}
      <div className="p-4 border-b flex items-center">
        <button onClick={onBack} className="mr-3">
          <ArrowLeft className="w-5 h-5" />
        </button>
        <div className="flex items-center space-x-3">
          <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
            <span className="font-semibold text-blue-600 text-sm">A</span>
          </div>
          <div>
            <h3 className="font-semibold">Ahmet YÄ±lmaz</h3>
            <p className="text-xs text-green-600">Ã‡evrimiÃ§i</p>
          </div>
        </div>
      </div>

      {/* Messages Area */}
      <div className="flex-1 overflow-y-auto p-4 space-y-3">
        {/* AlÄ±nan mesaj */}
        <div className="flex justify-start">
          <div className="max-w-[80%] bg-gray-100 rounded-2xl rounded-tl-none px-4 py-2">
            <p>Merhaba, o vintage Walkman'i nerede bulabilirim?</p>
            <span className="text-xs text-gray-500 block mt-1">10:00</span>
          </div>
        </div>

        {/* GÃ¶nderilen mesaj */}
        <div className="flex justify-end">
          <div className="max-w-[80%] bg-blue-500 text-white rounded-2xl rounded-br-none px-4 py-2">
            <p>KadÄ±kÃ¶y Ã§arÅŸÄ±sÄ±nda bir antikacÄ±da gÃ¶rmÃ¼ÅŸtÃ¼m</p>
            <span className="text-xs text-white/80 block mt-1">10:05</span>
          </div>
        </div>
      </div>

      {/* Input */}
      <div className="p-3 border-t">
        <div className="flex items-center space-x-2">
          <input
            type="text"
            value={message}
            onChange={(e) => setMessage(e.target.value)}
            onKeyDown={(e) => {
              if (e.key === 'Enter') {
                handleSend()
              }
            }}
            placeholder="Mesaj yaz..."
            className="flex-1 border rounded-full px-4 py-2 focus:outline-none focus:border-blue-500"
          />
          <button
            onClick={handleSend}
            disabled={!message.trim()}
            className="bg-blue-500 text-white p-2 rounded-full hover:bg-blue-600 disabled:opacity-50"
          >
            <Send className="w-5 h-5" />
          </button>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\mobile\MobileNewMessage.tsx
ğŸ“Š 156 satÄ±r | 5.68 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/mobile/MobileNewMessage.tsx
'use client'

import { useState } from 'react'
import { ArrowLeft, Search, User, Send, AlertCircle } from 'lucide-react'

interface MobileNewMessageProps {
  onClose: () => void
  onSendMessage: (receiverId: string, content: string) => void
}

export default function MobileNewMessage({ 
  onClose, 
  onSendMessage 
}: MobileNewMessageProps) {
  const [search, setSearch] = useState('')
  const [selectedUser, setSelectedUser] = useState<string | null>(null)
  const [message, setMessage] = useState('')

  const users = [
    { id: '1', name: 'Ahmet YÄ±lmaz', lastActive: '2 saat Ã¶nce' },
    { id: '2', name: 'Zeynep Demir', lastActive: '1 gÃ¼n Ã¶nce' },
    { id: '3', name: 'Mehmet Ã–z', lastActive: 'Ã‡evrimiÃ§i' }
  ]

  const handleSelectUser = (userId: string) => {
    setSelectedUser(userId)
    const user = users.find(u => u.id === userId)
    if (user) {
      setMessage(`Merhaba ${user.name},\n\n`)
    }
  }

  const handleSend = () => {
    if (!selectedUser || !message.trim()) {
      alert('LÃ¼tfen bir kullanÄ±cÄ± seÃ§in ve mesajÄ±nÄ±zÄ± yazÄ±n')
      return
    }
    
    onSendMessage(selectedUser, message)
    onClose()
  }

  const filteredUsers = users.filter(user =>
    user.name.toLowerCase().includes(search.toLowerCase())
  )

  return (
    <div className="fixed inset-0 z-50 bg-white flex flex-col">
      {/* Header */}
      <div className="p-4 border-b flex items-center bg-white">
        <button onClick={onClose} className="mr-3">
          <ArrowLeft className="w-5 h-5" />
        </button>
        <h2 className="text-lg font-semibold">
          {selectedUser ? 'Yeni Mesaj' : 'Kime?'}
        </h2>
      </div>

      {!selectedUser ? (
        /* KullanÄ±cÄ± SeÃ§imi */
        <div className="flex-1 overflow-y-auto p-4">
          <div className="relative mb-4">
            <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
            <input
              type="text"
              value={search}
              onChange={(e) => setSearch(e.target.value)}
              placeholder="KiÅŸi ara..."
              className="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
            />
          </div>

          <div className="space-y-2">
            {filteredUsers.length === 0 ? (
              <div className="text-center py-8 text-gray-500">
                <User className="w-12 h-12 mx-auto mb-3 text-gray-300" />
                <p>KullanÄ±cÄ± bulunamadÄ±</p>
              </div>
            ) : (
              filteredUsers.map(user => (
                <div
                  key={user.id}
                  onClick={() => handleSelectUser(user.id)}
                  className="flex items-center justify-between p-3 hover:bg-gray-50 active:bg-gray-100 rounded-lg cursor-pointer transition-colors"
                >
                  <div className="flex items-center space-x-3">
                    <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                      <User className="w-5 h-5 text-blue-600" />
                    </div>
                    <div>
                      <p className="font-medium">{user.name}</p>
                      <p className="text-xs text-gray-500">{user.lastActive}</p>
                    </div>
                  </div>
                  <button className="text-blue-600 text-sm">SeÃ§</button>
                </div>
              ))
            )}
          </div>
        </div>
      ) : (
        /* Mesaj Yazma */
        <div className="flex-1 flex flex-col">
          <div className="p-4 border-b">
            <div className="flex items-center space-x-3">
              <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                <User className="w-5 h-5 text-blue-600" />
              </div>
              <div>
                <p className="font-medium">
                  {users.find(u => u.id === selectedUser)?.name}
                </p>
                <p className="text-xs text-gray-500">Mesaj gÃ¶nderiliyor</p>
              </div>
            </div>
          </div>

          <div className="flex-1 p-4">
            <textarea
              value={message}
              onChange={(e) => setMessage(e.target.value)}
              placeholder="MesajÄ±nÄ±zÄ± yazÄ±n..."
              className="w-full h-40 p-3 border rounded-lg focus:outline-none focus:border-blue-500 resize-none"
            />
            
            <div className="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
              <div className="flex items-start space-x-2">
                <AlertCircle className="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5" />
                <div>
                  <p className="text-sm font-medium text-yellow-800 mb-1">
                    GÃ¼venlik UyarÄ±sÄ±
                  </p>
                  <p className="text-xs text-yellow-700">
                    â€¢ KiÅŸisel bilgilerinizi paylaÅŸmayÄ±n
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div className="p-4 border-t">
            <button
              onClick={handleSend}
              disabled={!message.trim()}
              className="w-full py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
            >
              <Send className="w-5 h-5 mr-2" />
              GÃ¶nder
            </button>
          </div>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\mobile\MobileThreadList.tsx
ğŸ“Š 101 satÄ±r | 3.44 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/mobile/MobileThreadList.tsx
'use client'

interface Thread {
  id: string
  participant_name: string
  last_message_preview: string
  last_message_at: string
  unread_count?: number
}

interface MobileThreadListProps {
  threads: Thread[]
  onSelectThread: (threadId: string) => void
  loading: boolean
}

export default function MobileThreadList({ 
  threads, 
  onSelectThread, 
  loading 
}: MobileThreadListProps) {
  const formatTime = (dateString: string) => {
    const date = new Date(dateString)
    const now = new Date()
    const diffMs = now.getTime() - date.getTime()
    const diffHours = diffMs / (1000 * 60 * 60)
    
    if (diffHours < 24) {
      return date.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' })
    } else if (diffHours < 48) {
      return 'DÃ¼n'
    } else {
      return date.toLocaleDateString('tr-TR')
    }
  }

  if (loading) {
    return (
      <div className="space-y-3 p-4">
        {[1, 2, 3].map(i => (
          <div key={i} className="animate-pulse">
            <div className="h-16 bg-gray-200 rounded-lg"></div>
          </div>
        ))}
      </div>
    )
  }

  return (
    <div className="h-full overflow-y-auto">
      {threads.length === 0 ? (
        <div className="p-8 text-center text-gray-500">
          <p>HenÃ¼z mesajÄ±nÄ±z yok</p>
        </div>
      ) : (
        <div className="divide-y">
          {threads.map(thread => (
            <div
              key={thread.id}
              onClick={() => onSelectThread(thread.id)}
              className="p-4 border-b hover:bg-gray-50 active:bg-gray-100 cursor-pointer transition-colors"
            >
              <div className="flex items-center justify-between">
                <div className="flex items-center space-x-3">
                  <div className="relative">
                    <div className={`w-10 h-10 rounded-full flex items-center justify-center ${thread.unread_count ? 'bg-blue-100' : 'bg-gray-100'}`}>
                      <span className={`font-semibold ${thread.unread_count ? 'text-blue-600' : 'text-gray-600'}`}>
                        {thread.participant_name?.charAt(0) || 'U'}
                      </span>
                    </div>
                    {thread.unread_count && thread.unread_count > 0 && (
                      <div className="absolute -top-1 -right-1">
                        <div className="bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">
                          {thread.unread_count}
                        </div>
                      </div>
                    )}
                  </div>
                  <div className="min-w-0 flex-1">
                    <div className="flex items-center justify-between mb-1">
                      <p className="font-medium truncate">
                        {thread.participant_name || 'KullanÄ±cÄ±'}
                      </p>
                      <span className="text-xs text-gray-500 flex-shrink-0 ml-2">
                        {formatTime(thread.last_message_at)}
                      </span>
                    </div>
                    <p className="text-sm text-gray-600 truncate">
                      {thread.last_message_preview || '...'}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\NewMessageModal.tsx
ğŸ“Š 732 satÄ±r | 29.37 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/NewMessageModal.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect, useRef } from 'react'
import { supabase } from '@/lib/supabase'
import { X, Search, User, AlertCircle, Send, Image as ImageIcon, MapPin } from 'lucide-react'

interface UserProfile {
  id: string
  name: string
  avatar: string
  last_active: string
  reputation_score?: number
}

interface Spot {
  id: string
  title: string
  image_url?: string
}

interface NewMessageModalProps {
  isOpen: boolean
  onClose: () => void
  onSendMessage: (receiverId: string, content: string, threadType: string) => Promise<void>
  currentUserId: string
  spotId?: string
}

// Database'den gelen user tipi
interface DatabaseUser {
  id: string
  name: string | null
  avatar_url: string | null
  last_seen: string | null
  reputation_score: number | null
}

// Database'den gelen spot tipi  
interface DatabaseSpot {
  id: string
  title: string
  image_url: string | null
}

export default function NewMessageModal({ 
  isOpen, 
  onClose, 
  onSendMessage, 
  currentUserId,
  spotId 
}: NewMessageModalProps) {
  const [searchQuery, setSearchQuery] = useState('')
  const [selectedUser, setSelectedUser] = useState<UserProfile | null>(null)
  const [message, setMessage] = useState('')
  const [users, setUsers] = useState<UserProfile[]>([])
  const [spots, setSpots] = useState<Spot[]>([])
  const [filteredUsers, setFilteredUsers] = useState<UserProfile[]>([])
  const [loading, setLoading] = useState(false)
  const [sending, setSending] = useState(false)
  const [step, setStep] = useState<'select' | 'compose'>('select')
  const [showTips, setShowTips] = useState(true)
  const [selectedSpot, setSelectedSpot] = useState<Spot | null>(null)
  const [messageType, setMessageType] = useState<'general' | 'spot' | 'help'>('general')
  
  const modalRef = useRef<HTMLDivElement>(null)

  useEffect(() => {
    if (isOpen) {
      fetchInitialData()
      document.body.style.overflow = 'hidden'
    } else {
      document.body.style.overflow = 'unset'
    }

    return () => {
      document.body.style.overflow = 'unset'
    }
  }, [isOpen])

  useEffect(() => {
    if (searchQuery.length < 2) {
      setFilteredUsers(users)
      return
    }

    const filtered = users.filter(user =>
      user.name.toLowerCase().includes(searchQuery.toLowerCase())
    )
    setFilteredUsers(filtered)
  }, [searchQuery, users])

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (modalRef.current && !modalRef.current.contains(event.target as Node)) {
        onClose()
      }
    }

    if (isOpen) {
      document.addEventListener('mousedown', handleClickOutside)
    }

    return () => {
      document.removeEventListener('mousedown', handleClickOutside)
    }
  }, [isOpen, onClose])

  const fetchInitialData = async () => {
    setLoading(true)
    try {
      // 1. KullanÄ±cÄ±larÄ± getir
      const { data: usersData, error: usersError } = await supabase
        .from('user_profiles')
        .select('id, name, avatar_url, last_seen, reputation_score')
        .neq('id', currentUserId)
        .limit(20)
        .order('last_seen', { ascending: false })

      if (usersError) throw usersError

      // DÃœZELTME 1: user parametresi iÃ§in tip belirle
      const formattedUsers: UserProfile[] = (usersData || []).map((user: DatabaseUser) => ({
        id: user.id,
        name: user.name || 'KullanÄ±cÄ±',
        avatar: user.avatar_url || '',
        last_active: formatLastActive(user.last_seen || ''),
        reputation_score: user.reputation_score || 0
      }))

      setUsers(formattedUsers)
      setFilteredUsers(formattedUsers)

      // 2. Spot'larÄ± getir
      const { data: spotsData, error: spotsError } = await supabase
        .from('spots')
        .select('id, title, image_url')
        .eq('user_id', currentUserId)
        .eq('status', 'active')
        .limit(5)
        .order('created_at', { ascending: false })

      if (spotsError) throw spotsError
      
      const formattedSpots: Spot[] = (spotsData || []).map((spot: DatabaseSpot) => ({
        id: spot.id,
        title: spot.title,
        image_url: spot.image_url || undefined
      }))
      
      setSpots(formattedSpots)

      // 3. EÄŸer spotId varsa, o spot'u bul
      // DÃœZELTME 2: s parametresi iÃ§in tip belirle
      if (spotId) {
        const spot = spotsData?.find((s: DatabaseSpot) => s.id === spotId)
        if (spot) {
          setSelectedSpot({
            id: spot.id,
            title: spot.title,
            image_url: spot.image_url || undefined
          })
          setMessageType('spot')
          setMessage(`Merhaba, "${spot.title}" spot'u hakkÄ±nda bilgi almak istiyorum...`)
        }
      }

    } catch (error) {
      console.error('BaÅŸlangÄ±Ã§ verileri yÃ¼klenemedi:', error)
      // Fallback veri
      const fallbackUsers: UserProfile[] = [
        { id: '1', name: 'Ahmet YÄ±lmaz', avatar: '', last_active: '2 saat Ã¶nce', reputation_score: 150 },
        { id: '2', name: 'Zeynep Demir', avatar: '', last_active: '1 gÃ¼n Ã¶nce', reputation_score: 89 },
        { id: '3', name: 'Mehmet Ã–z', avatar: '', last_active: 'Ã‡evrimiÃ§i', reputation_score: 42 }
      ]
      
      const fallbackSpots: Spot[] = [
        { id: '1', title: 'Vintage Sony Walkman', image_url: '' },
        { id: '2', title: 'Ã‡elik DÃ¼dÃ¼k 1980 Model', image_url: '' }
      ]
      
      setUsers(fallbackUsers)
      setFilteredUsers(fallbackUsers)
      setSpots(fallbackSpots)
    } finally {
      setLoading(false)
    }
  }

  const formatLastActive = (lastSeen: string) => {
    if (!lastSeen) return 'Bilinmiyor'
    
    const lastSeenDate = new Date(lastSeen)
    const now = new Date()
    const diffMs = now.getTime() - lastSeenDate.getTime()
    const diffMins = Math.floor(diffMs / (1000 * 60))
    
    if (diffMins < 5) return 'Ã‡evrimiÃ§i'
    if (diffMins < 60) return `${diffMins} dakika Ã¶nce`
    if (diffMins < 24 * 60) return `${Math.floor(diffMins / 60)} saat Ã¶nce`
    return `${Math.floor(diffMins / (60 * 24))} gÃ¼n Ã¶nce`
  }

  const handleSelectUser = (user: UserProfile) => {
    setSelectedUser(user)
    setStep('compose')
    
    // MesajÄ± hazÄ±rla
    if (selectedSpot) {
      setMessage(`Merhaba ${user.name},\n\n"${selectedSpot.title}" spot'u hakkÄ±nda bilgi almak istiyorum. Bu konuda yardÄ±mcÄ± olabilir misiniz?\n\nTeÅŸekkÃ¼rler.`)
    } else {
      setMessage(`Merhaba ${user.name},\n\n`)
    }
  }

  const handleSend = async () => {
    if (!selectedUser || !message.trim()) {
      alert('LÃ¼tfen bir kullanÄ±cÄ± seÃ§in ve mesajÄ±nÄ±zÄ± yazÄ±n')
      return
    }

    setSending(true)
    try {
      // 1. KullanÄ±cÄ± kimliÄŸini al
      const { data: { user: currentUser } } = await supabase.auth.getUser()
      if (!currentUser) throw new Error('KullanÄ±cÄ± bulunamadÄ±')

      // 2. Yeni thread oluÅŸtur
      const { data: threadData, error: threadError } = await supabase
        .from('message_threads')
        .insert([{
          participant1_id: currentUser.id,
          participant2_id: selectedUser.id,
          subject: selectedSpot ? `Spot: ${selectedSpot.title}` : 'Yeni Mesaj',
          thread_type: selectedSpot ? 'spot' : 'general',
          spot_id: selectedSpot?.id,
          last_message_at: new Date().toISOString(),
          last_message_preview: message.substring(0, 100),
          unread_count_p2: 1,
          status: 'active'
        }])
        .select()
        .single()

      if (threadError) throw threadError

      // 3. Ä°lk mesajÄ± gÃ¶nder
      const { error: messageError } = await supabase
        .from('messages')
        .insert([{
          thread_id: threadData.id,
          sender_id: currentUser.id,
          content: message,
          topic: selectedSpot ? `Spot: ${selectedSpot.title}` : 'Yeni Mesaj',
          type: 'text',
          is_read: false
        }])

      if (messageError) throw messageError

      // 4. thread_participants tablosuna ekle
      const { error: participantsError } = await supabase
        .from('thread_participants')
        .insert([
          { thread_id: threadData.id, user_id: currentUser.id },
          { thread_id: threadData.id, user_id: selectedUser.id }
        ])

      if (participantsError) console.warn('KatÄ±lÄ±mcÄ± eklenemedi:', participantsError)

      // 5. Callback'i Ã§aÄŸÄ±r
      await onSendMessage(selectedUser.id, message, selectedSpot ? 'spot' : 'general')
      
      // 6. BaÅŸarÄ±lÄ± - modal'Ä± kapat
      alert('Mesaj gÃ¶nderildi!')
      setSending(false)
      setSelectedUser(null)
      setMessage('')
      setStep('select')
      onClose()
      
    } catch (error) {
      console.error('Mesaj gÃ¶nderilemedi:', error)
      alert('Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.')
      setSending(false)
    }
  }

  const handleMessageTemplate = (template: string) => {
    switch (template) {
      case 'spot_question':
        setMessage(`Merhaba ${selectedUser?.name || ''},\n\nBu Ã¼rÃ¼n hakkÄ±nda daha fazla bilgi alabilir miyim?\n- Durumu nedir?\n- Fiyat aralÄ±ÄŸÄ±?\n- Nerede gÃ¶rÃ¼lebilir?\n\nTeÅŸekkÃ¼rler.`)
        break
      case 'meeting_request':
        setMessage(`Merhaba ${selectedUser?.name || ''},\n\nÃœrÃ¼nÃ¼ gÃ¶rmek iÃ§in buluÅŸabilir miyiz? Hangi gÃ¼n ve saat uygun olursunuz?\n\nÄ°yi gÃ¼nler.`)
        break
      case 'price_offer':
        setMessage(`Merhaba ${selectedUser?.name || ''},\n\nÃœrÃ¼n iÃ§in fiyat teklifim var. Bu konuda konuÅŸabilir miyiz?\n\nSaygÄ±larÄ±mla.`)
        break
    }
  }

  if (!isOpen) return null

  return (
    <div className="fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50">
      <div className="flex items-center justify-center min-h-screen p-4">
        <div 
          ref={modalRef}
          className="relative bg-white rounded-xl shadow-xl w-full max-w-2xl mx-auto overflow-hidden"
        >
          {/* Header */}
          <div className="p-4 border-b flex items-center justify-between bg-white sticky top-0 z-10">
            <div>
              <h2 className="text-lg font-semibold">
                {step === 'select' ? 'Yeni Mesaj' : `${selectedUser?.name}'a Mesaj`}
              </h2>
              <p className="text-sm text-gray-500">
                {step === 'select' 
                  ? 'Bir kullanÄ±cÄ± seÃ§in veya spot iÃ§in mesaj gÃ¶nderin' 
                  : 'MesajÄ±nÄ±zÄ± yazÄ±n'}
              </p>
            </div>
            <button
              onClick={onClose}
              className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
              disabled={sending}
            >
              <X className="w-5 h-5" />
            </button>
          </div>

          {/* Content */}
          <div className="max-h-[70vh] overflow-y-auto">
            {step === 'select' ? (
              <>
                {/* Spot SeÃ§imi */}
                {spots.length > 0 && (
                  <div className="p-4 border-b">
                    <h3 className="text-sm font-medium text-gray-700 mb-3">
                      SpotlarÄ±nÄ±z Ä°Ã§in Mesaj GÃ¶nderin
                    </h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      {spots.map((spot: Spot) => (
                        <div
                          key={spot.id}
                          className={`
                            border rounded-lg p-3 cursor-pointer transition-all hover:shadow-md
                            ${selectedSpot?.id === spot.id 
                              ? 'border-blue-500 bg-blue-50' 
                              : 'hover:border-blue-300'
                            }
                          `}
                          onClick={() => {
                            setSelectedSpot(spot)
                            setMessageType('spot')
                          }}
                        >
                          <div className="flex items-center space-x-3">
                            {spot.image_url ? (
                              <img
                                src={spot.image_url}
                                alt={spot.title}
                                className="w-12 h-12 object-cover rounded"
                              />
                            ) : (
                              <div className="w-12 h-12 bg-gray-200 rounded flex items-center justify-center">
                                <ImageIcon className="w-6 h-6 text-gray-400" />
                              </div>
                            )}
                            <div className="flex-1 min-w-0">
                              <p className="font-medium text-sm truncate">
                                {spot.title}
                              </p>
                              <p className="text-xs text-gray-500">
                                Spot hakkÄ±nda mesaj gÃ¶nder
                              </p>
                            </div>
                            {selectedSpot?.id === spot.id && (
                              <div className="w-5 h-5 rounded-full bg-blue-500 flex items-center justify-center">
                                <div className="w-2 h-2 bg-white rounded-full"></div>
                              </div>
                            )}
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {/* Arama */}
                <div className="p-4 border-b">
                  <div className="relative">
                    <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                    <input
                      type="text"
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                      placeholder="Ä°sim veya kullanÄ±cÄ± adÄ± ile ara..."
                      className="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
                      disabled={loading}
                    />
                  </div>
                  
                  {searchQuery.length > 0 && searchQuery.length < 2 && (
                    <p className="text-xs text-gray-500 mt-2">
                      Aramak iÃ§in en az 2 karakter girin
                    </p>
                  )}
                </div>

                {/* KullanÄ±cÄ± Listesi */}
                <div className="p-4">
                  <h3 className="text-sm font-medium text-gray-700 mb-3">
                    {searchQuery ? 'Arama SonuÃ§larÄ±' : 'Ã–nerilen KullanÄ±cÄ±lar'}
                  </h3>
                  
                  {loading ? (
                    <div className="space-y-3">
                      {[1, 2, 3].map(i => (
                        <div key={i} className="animate-pulse flex items-center space-x-3 p-3">
                          <div className="w-10 h-10 bg-gray-200 rounded-full"></div>
                          <div className="flex-1">
                            <div className="h-4 bg-gray-200 rounded w-32 mb-2"></div>
                            <div className="h-3 bg-gray-200 rounded w-24"></div>
                          </div>
                        </div>
                      ))}
                    </div>
                  ) : filteredUsers.length === 0 ? (
                    <div className="text-center py-8 text-gray-500">
                      <User className="w-12 h-12 mx-auto mb-3 text-gray-300" />
                      <p>KullanÄ±cÄ± bulunamadÄ±</p>
                      <p className="text-sm mt-1">FarklÄ± bir arama terimi deneyin</p>
                    </div>
                  ) : (
                    <div className="space-y-2">
                      {filteredUsers.map((user: UserProfile) => (
                        <div
                          key={user.id}
                          onClick={() => handleSelectUser(user)}
                          className="flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors active:bg-gray-100"
                        >
                          <div className="flex items-center space-x-3">
                            <div className="relative">
                              <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                {user.avatar ? (
                                  <img
                                    src={user.avatar}
                                    alt={user.name}
                                    className="w-10 h-10 rounded-full"
                                  />
                                ) : (
                                  <User className="w-5 h-5 text-blue-600" />
                                )}
                              </div>
                              {user.last_active === 'Ã‡evrimiÃ§i' && (
                                <div className="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
                              )}
                            </div>
                            <div>
                              <div className="flex items-center space-x-2">
                                <p className="font-medium">{user.name}</p>
                                {user.reputation_score && user.reputation_score > 0 ? (
                                  <span className="text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded">
                                    {user.reputation_score} puan
                                  </span>
                                ) : null}
                              </div>
                              <div className="flex items-center space-x-2 mt-1">
                                <p className="text-xs text-gray-500">
                                  {user.last_active}
                                </p>
                              </div>
                            </div>
                          </div>
                          <button className="text-blue-600 hover:text-blue-800 text-sm font-medium px-3 py-1 hover:bg-blue-50 rounded">
                            Mesaj
                          </button>
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              </>
            ) : (
              /* Mesaj Yazma */
              <>
                {/* KullanÄ±cÄ± Bilgisi */}
                <div className="p-4 border-b">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center space-x-3">
                      <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                        {selectedUser?.avatar ? (
                          <img
                            src={selectedUser.avatar}
                            alt={selectedUser.name}
                            className="w-12 h-12 rounded-full"
                          />
                        ) : (
                          <User className="w-6 h-6 text-blue-600" />
                        )}
                      </div>
                      <div>
                        <div className="flex items-center space-x-2">
                          <p className="font-semibold">{selectedUser?.name}</p>
                          {selectedUser?.reputation_score && selectedUser.reputation_score > 0 ? (
                            <span className="text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded">
                              {selectedUser.reputation_score} puan
                            </span>
                          ) : null}
                        </div>
                        <p className="text-sm text-gray-500">
                          {selectedUser?.last_active}
                        </p>
                      </div>
                    </div>
                    
                    <button
                      onClick={() => setStep('select')}
                      className="text-sm text-gray-600 hover:text-gray-800"
                      disabled={sending}
                    >
                      KullanÄ±cÄ± deÄŸiÅŸtir
                    </button>
                  </div>
                  
                  {selectedSpot && (
                    <div className="mt-3 p-3 bg-blue-50 rounded-lg">
                      <div className="flex items-center space-x-2">
                        <MapPin className="w-4 h-4 text-blue-600" />
                        <span className="text-sm font-medium text-blue-800">
                          {selectedSpot.title}
                        </span>
                      </div>
                      <p className="text-xs text-blue-700 mt-1">
                        Bu spot iÃ§in mesaj gÃ¶nderiyorsunuz
                      </p>
                    </div>
                  )}
                </div>

                {/* Mesaj ÅablonlarÄ± */}
                <div className="p-4 border-b">
                  <h4 className="text-sm font-medium text-gray-700 mb-2">
                    HÄ±zlÄ± Åablonlar
                  </h4>
                  <div className="flex flex-wrap gap-2">
                    <button
                      onClick={() => handleMessageTemplate('spot_question')}
                      className="text-xs bg-gray-100 hover:bg-gray-200 text-gray-800 px-3 py-1 rounded"
                      disabled={sending}
                    >
                      ÃœrÃ¼n Sorusu
                    </button>
                    <button
                      onClick={() => handleMessageTemplate('meeting_request')}
                      className="text-xs bg-gray-100 hover:bg-gray-200 text-gray-800 px-3 py-1 rounded"
                      disabled={sending}
                    >
                      BuluÅŸma Talebi
                    </button>
                    <button
                      onClick={() => handleMessageTemplate('price_offer')}
                      className="text-xs bg-gray-100 hover:bg-gray-200 text-gray-800 px-3 py-1 rounded"
                      disabled={sending}
                    >
                      Fiyat Teklifi
                    </button>
                  </div>
                </div>

                {/* Mesaj AlanÄ± */}
                <div className="p-4">
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      MesajÄ±nÄ±z
                    </label>
                    <textarea
                      value={message}
                      onChange={(e) => setMessage(e.target.value)}
                      placeholder="MesajÄ±nÄ±zÄ± detaylÄ± bir ÅŸekilde yazÄ±n..."
                      className="w-full h-48 p-3 border rounded-lg focus:outline-none focus:border-blue-500 resize-none"
                      disabled={sending}
                    />
                    <div className="flex justify-between mt-1">
                      <span className="text-xs text-gray-500">
                        {message.length}/2000 karakter
                      </span>
                      <span className="text-xs text-gray-500">
                        Shift+Enter ile yeni satÄ±r
                      </span>
                    </div>
                  </div>

                  {/* Mesaj TÃ¼rÃ¼ SeÃ§imi */}
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Mesaj TÃ¼rÃ¼
                    </label>
                    <div className="flex space-x-2">
                      {['general', 'spot', 'help'].map((type) => (
                        <button
                          key={type}
                          onClick={() => setMessageType(type as 'general' | 'spot' | 'help')}
                          className={`
                            flex-1 py-2 text-sm rounded-lg border transition-colors
                            ${messageType === type
                              ? 'border-blue-500 bg-blue-50 text-blue-700'
                              : 'border-gray-300 hover:border-gray-400'
                            }
                          `}
                          disabled={sending}
                        >
                          {type === 'general' && 'Genel Mesaj'}
                          {type === 'spot' && 'Spot Ä°Ã§in'}
                          {type === 'help' && 'YardÄ±m Talebi'}
                        </button>
                      ))}
                    </div>
                  </div>

                  {/* GÃ¼venlik UyarÄ±sÄ± */}
                  {showTips && (
                    <div className="mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                      <div className="flex items-start justify-between">
                        <div className="flex items-start space-x-2">
                          <AlertCircle className="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5" />
                          <div>
                            <p className="text-sm font-medium text-yellow-800 mb-1">
                              GÃ¼venli MesajlaÅŸma Ä°puÃ§larÄ±
                            </p>
                            <ul className="text-xs text-yellow-700 space-y-1">
                              <li>â€¢ KiÅŸisel bilgilerinizi (telefon, adres, TC kimlik) paylaÅŸmayÄ±n</li>
                              <li>â€¢ Ã–n Ã¶deme talep etmeyin veya yapmayÄ±n</li>
                              <li>â€¢ SpotItForme gÃ¼venli Ã¶deme sistemini kullanÄ±n</li>
                              <li>â€¢ ÅÃ¼pheli talepleri bize bildirin: guvenlik@spotitforme.com</li>
                            </ul>
                          </div>
                        </div>
                        <button
                          onClick={() => setShowTips(false)}
                          className="text-yellow-600 hover:text-yellow-800"
                          disabled={sending}
                        >
                          <X className="w-4 h-4" />
                        </button>
                      </div>
                    </div>
                  )}
                </div>
              </>
            )}
          </div>

          {/* Footer Buttons */}
          <div className="p-4 border-t bg-gray-50">
            {step === 'select' ? (
              <div className="flex justify-between">
                <button
                  onClick={onClose}
                  className="px-4 py-2 border rounded-lg hover:bg-gray-100 transition-colors"
                  disabled={loading}
                >
                  Ä°ptal
                </button>
                <div className="text-sm text-gray-500 flex items-center">
                  {selectedSpot && (
                    <span className="mr-3">
                      SeÃ§ili spot: <span className="font-medium">{selectedSpot.title}</span>
                    </span>
                  )}
                  <span>
                    {filteredUsers.length} kullanÄ±cÄ±
                  </span>
                </div>
              </div>
            ) : (
              <div className="flex justify-between items-center">
                <button
                  onClick={() => setStep('select')}
                  className="px-4 py-2 border rounded-lg hover:bg-gray-100 transition-colors"
                  disabled={sending}
                >
                  Geri
                </button>
                
                <div className="flex items-center space-x-3">
                  <button
                    onClick={() => {
                      setMessage('')
                      setSelectedUser(null)
                      setStep('select')
                    }}
                    className="text-sm text-gray-600 hover:text-gray-800"
                    disabled={sending}
                  >
                    Temizle
                  </button>
                  
                  <button
                    onClick={handleSend}
                    disabled={sending || !selectedUser || !message.trim()}
                    className={`
                      px-6 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2
                      ${sending || !selectedUser || !message.trim()
                        ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                        : 'bg-blue-500 text-white hover:bg-blue-600'
                      }
                    `}
                  >
                    {sending ? (
                      <>
                        <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                        <span>GÃ¶nderiliyor...</span>
                      </>
                    ) : (
                      <>
                        <Send className="w-4 h-4" />
                        <span>GÃ¶nder</span>
                      </>
                    )}
                  </button>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\QuickReplies.tsx
ğŸ“Š 159 satÄ±r | 5.38 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/QuickReplies.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

interface QuickRepliesProps {
  shopId?: string
  userId?: string
  onSelectTemplate: (content: string) => void
}

export default function QuickReplies({ shopId, userId, onSelectTemplate }: QuickRepliesProps) {
  const [templates, setTemplates] = useState<any[]>([])
  const [showForm, setShowForm] = useState(false)
  const [newTemplate, setNewTemplate] = useState({ title: '', content: '', category: '' })

  useEffect(() => {
    fetchTemplates()
  }, [shopId, userId])

  const fetchTemplates = async () => {
    try {
      let query = supabase.from('quick_reply_templates').select('*')
      
      if (shopId) {
        query = query.eq('shop_id', shopId)
      } else if (userId) {
        query = query.eq('user_id', userId)
      }
      
      const { data } = await query.order('usage_count', { ascending: false })
      setTemplates(data || [])
    } catch (error) {
      console.error('Template yÃ¼klenemedi:', error)
    }
  }

  const handleCreateTemplate = async () => {
    if (!newTemplate.title || !newTemplate.content) return

    try {
      const { error } = await supabase
        .from('quick_reply_templates')
        .insert({
          ...(shopId ? { shop_id: shopId } : { user_id: userId }),
          title: newTemplate.title,
          content: newTemplate.content,
          category: newTemplate.category || 'general'
        })

      if (error) throw error

      setNewTemplate({ title: '', content: '', category: '' })
      setShowForm(false)
      fetchTemplates()
    } catch (error) {
      console.error('Template oluÅŸturma hatasÄ±:', error)
    }
  }

  const handleUseTemplate = async (templateId: string, content: string) => {
    try {
      // KullanÄ±m sayÄ±sÄ±nÄ± artÄ±r
      await supabase.rpc('increment_template_usage', { template_id: templateId })
      
      // Template'i seÃ§
      onSelectTemplate(content)
    } catch (error) {
      console.error('Template kullanÄ±m hatasÄ±:', error)
    }
  }

  const categories = [
    { value: 'greeting', label: 'Selamlama', icon: 'ğŸ‘‹' },
    { value: 'price', label: 'Fiyat', icon: 'ğŸ’°' },
    { value: 'delivery', label: 'Teslimat', icon: 'ğŸšš' },
    { value: 'thanks', label: 'TeÅŸekkÃ¼r', icon: 'ğŸ™' },
    { value: 'followup', label: 'Takip', icon: 'â°' }
  ]

  return (
    <div className="border-t border-gray-200 pt-4">
      <div className="flex items-center justify-between mb-3">
        <h4 className="text-sm font-medium text-gray-700">âš¡ HÄ±zlÄ± YanÄ±tlar</h4>
        <button
          onClick={() => setShowForm(!showForm)}
          className="text-xs text-blue-600 hover:text-blue-800"
        >
          {showForm ? 'Ä°ptal' : '+ Yeni'}
        </button>
      </div>

      {/* Yeni template formu */}
      {showForm && (
        <div className="mb-4 p-3 bg-gray-50 rounded-lg">
          <input
            type="text"
            placeholder="Template adÄ±"
            value={newTemplate.title}
            onChange={(e) => setNewTemplate({...newTemplate, title: e.target.value})}
            className="w-full mb-2 px-3 py-2 border border-gray-300 rounded text-sm"
          />
          <textarea
            placeholder="Template iÃ§eriÄŸi"
            value={newTemplate.content}
            onChange={(e) => setNewTemplate({...newTemplate, content: e.target.value})}
            className="w-full mb-2 px-3 py-2 border border-gray-300 rounded text-sm"
            rows={2}
          />
          <div className="flex justify-between">
            <select
              value={newTemplate.category}
              onChange={(e) => setNewTemplate({...newTemplate, category: e.target.value})}
              className="text-sm border border-gray-300 rounded px-2 py-1"
            >
              <option value="">Kategori seÃ§</option>
              {categories.map(cat => (
                <option key={cat.value} value={cat.value}>{cat.icon} {cat.label}</option>
              ))}
            </select>
            <button
              onClick={handleCreateTemplate}
              className="bg-blue-600 text-white text-sm px-3 py-1 rounded"
            >
              Kaydet
            </button>
          </div>
        </div>
      )}

      {/* Template listesi */}
      <div className="flex flex-wrap gap-2">
        {templates.slice(0, 5).map((template) => (
          <button
            key={template.id}
            onClick={() => handleUseTemplate(template.id, template.content)}
            className="inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-gray-100 hover:bg-gray-200 text-gray-800"
            title={template.content}
          >
            <span className="mr-1">
              {categories.find(c => c.value === template.category)?.icon || 'ğŸ’¬'}
            </span>
            {template.title}
            {template.usage_count > 0 && (
              <span className="ml-2 text-xs text-gray-500">{template.usage_count}</span>
            )}
          </button>
        ))}
        
        {templates.length === 0 && !showForm && (
          <p className="text-sm text-gray-500 italic">
            HenÃ¼z hÄ±zlÄ± yanÄ±t ÅŸablonunuz yok. "+ Yeni" butonundan ekleyin.
          </p>
        )}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\SecurityDisclaimer.tsx
ğŸ“Š 135 satÄ±r | 4.62 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/SecurityDisclaimer.tsx
'use client'

import { useState } from 'react'
import { MESSAGING_DISCLAIMERS } from '@/lib/messaging/disclaimer'

interface SecurityDisclaimerProps {
  variant?: 'full' | 'mini' | 'inline'
  onAccept?: () => void
  showAcceptButton?: boolean
}

export default function SecurityDisclaimer({ 
  variant = 'full', 
  onAccept,
  showAcceptButton = false 
}: SecurityDisclaimerProps) {
  const [accepted, setAccepted] = useState(false)
  const [showDetails, setShowDetails] = useState(false)

  const handleAccept = () => {
    setAccepted(true)
    if (onAccept) onAccept()
  }

  if (variant === 'mini') {
    return (
      <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
        <div className="flex items-start">
          <span className="text-yellow-600 mr-2">âš ï¸</span>
          <p className="text-sm text-yellow-800">
            <strong>GÃ¼venlik UyarÄ±sÄ±:</strong> Platform dÄ±ÅŸÄ± Ã¶demelerden sorumlu deÄŸiliz.
            <button 
              onClick={() => setShowDetails(!showDetails)}
              className="ml-2 text-yellow-700 underline text-xs"
            >
              Detaylar
            </button>
          </p>
        </div>
        
        {showDetails && (
          <div className="mt-2 pl-6 border-l-2 border-yellow-300">
            <ul className="text-xs text-yellow-700 space-y-1">
              {MESSAGING_DISCLAIMERS.SAFETY_TIPS.slice(0, 3).map((tip, i) => (
                <li key={i}>â€¢ {tip}</li>
              ))}
            </ul>
          </div>
        )}
      </div>
    )
  }

  if (variant === 'inline') {
    return (
      <div className="text-sm text-gray-600 italic">
        âš ï¸ Ã–demeler platform dÄ±ÅŸÄ±nda yapÄ±lÄ±r. GÃ¼venli alÄ±ÅŸveriÅŸ iÃ§in dikkatli olun.
      </div>
    )
  }

  // Full variant
  return (
    <div className="bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-300 rounded-xl p-6 mb-6">
      <div className="flex items-start mb-4">
        <div className="bg-yellow-100 p-3 rounded-lg mr-4">
          <span className="text-2xl">ğŸ›¡ï¸</span>
        </div>
        <div>
          <h3 className="text-lg font-bold text-gray-900 mb-2">
            {MESSAGING_DISCLAIMERS.GENERAL_DISCLAIMER.title}
          </h3>
          <div className="prose prose-sm max-w-none text-gray-700">
            {MESSAGING_DISCLAIMERS.GENERAL_DISCLAIMER.content.split('\n').map((line, i) => (
              <p key={i} className={i === 0 ? 'font-medium' : ''}>
                {line}
              </p>
            ))}
          </div>
        </div>
      </div>

      {/* GÃ¼venlik ipuÃ§larÄ± */}
      <div className="mt-6">
        <h4 className="font-bold text-gray-900 mb-3">ğŸ”’ GÃ¼venli AlÄ±ÅŸveriÅŸ Ä°puÃ§larÄ±:</h4>
        <div className="grid md:grid-cols-2 gap-3">
          {MESSAGING_DISCLAIMERS.SAFETY_TIPS.map((tip, i) => (
            <div key={i} className="flex items-start bg-white bg-opacity-50 p-3 rounded-lg">
              <span className="text-green-600 mr-2 mt-1">âœ“</span>
              <span className="text-sm">{tip}</span>
            </div>
          ))}
        </div>
      </div>

      {/* Kabul butonu (isteÄŸe baÄŸlÄ±) */}
      {showAcceptButton && !accepted && (
        <div className="mt-6 pt-6 border-t border-yellow-300">
          <div className="flex items-center justify-between">
            <div className="flex items-center">
              <input
                type="checkbox"
                id="acceptDisclaimer"
                checked={accepted}
                onChange={(e) => setAccepted(e.target.checked)}
                className="w-4 h-4 text-blue-600 mr-3"
              />
              <label htmlFor="acceptDisclaimer" className="text-sm font-medium text-gray-900">
                YukarÄ±daki gÃ¼venlik uyarÄ±larÄ±nÄ± okudum ve kabul ediyorum
              </label>
            </div>
            <button
              onClick={handleAccept}
              disabled={!accepted}
              className="bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium py-2 px-6 rounded-lg"
            >
              Devam Et
            </button>
          </div>
        </div>
      )}

      {/* ÅÃ¼pheli durum bildirimi */}
      <div className="mt-6 text-center">
        <p className="text-sm text-gray-600">
          ÅÃ¼pheli bir mesaj veya kullanÄ±cÄ± gÃ¶rdÃ¼nÃ¼z mÃ¼?
        </p>
        <button className="mt-2 text-sm text-red-600 hover:text-red-800 font-medium">
          ğŸš¨ Hemen Bildir
        </button>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\ThreadList.tsx
ğŸ“Š 178 satÄ±r | 5.94 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/ThreadList.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { MessageSquare, User, Clock, Trash2, CheckCircle } from 'lucide-react'

interface Thread {
  id: string
  participant1_id: string
  participant2_id: string
  last_message_at: string
  last_message_preview?: string
  unread_count_p1: number
  unread_count_p2: number
  status: string
  participant1_name?: string
  participant2_name?: string
  // MessagingLayout'dan gelen ek alanlar
  thread_type?: string
  subject?: string
  spot_id?: string
  product_id?: string
  shop_id?: string
  created_at?: string
  updated_at?: string
  // active_conversations view'Ä±ndan gelebilecek alanlar
  last_message_content?: string
  other_user_name?: string
  other_user_avatar?: string
  [key: string]: any // DiÄŸer olasÄ± alanlar iÃ§in
}

interface ThreadListProps {
  threads: Thread[]
  selectedThread: string | null
  onSelectThread: (threadId: string) => void
  onDeleteThread: (threadId: string) => void
  loading: boolean
  userId: string
}

export default function ThreadList({
  threads,
  selectedThread,
  onSelectThread,
  onDeleteThread,
  loading,
  userId
}: ThreadListProps) {
  
  const getOtherParticipantName = (thread: Thread) => {
    if (thread.participant1_id === userId) {
      return thread.participant2_name || thread.other_user_name || `KullanÄ±cÄ±-${thread.participant2_id?.substring(0, 8) || 'unknown'}`
    }
    return thread.participant1_name || thread.other_user_name || `KullanÄ±cÄ±-${thread.participant1_id?.substring(0, 8) || 'unknown'}`
  }

  const getUnreadCount = (thread: Thread) => {
    if (thread.participant1_id === userId) {
      return thread.unread_count_p1 || 0
    }
    return thread.unread_count_p2 || 0
  }

  const getMessagePreview = (thread: Thread) => {
    return thread.last_message_preview || 
           thread.last_message_content || 
           'Mesaj yok'
  }

  const formatTime = (dateString: string) => {
    if (!dateString) return 'Yeni'
    
    try {
      const date = new Date(dateString)
      const now = new Date()
      const diffMs = now.getTime() - date.getTime()
      const diffMins = Math.floor(diffMs / 60000)
      
      if (diffMins < 60) {
        return `${diffMins} dk Ã¶nce`
      } else if (diffMins < 1440) {
        return `${Math.floor(diffMins / 60)} saat Ã¶nce`
      } else {
        return date.toLocaleDateString('tr-TR')
      }
    } catch {
      return 'Yeni'
    }
  }

  if (loading) {
    return (
      <div className="flex-1 flex items-center justify-center">
        <div className="text-center">
          <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-2 text-gray-600">YÃ¼kleniyor...</p>
        </div>
      </div>
    )
  }

  if (threads.length === 0) {
    return (
      <div className="flex-1 flex flex-col items-center justify-center p-8 text-center">
        <MessageSquare className="w-12 h-12 text-gray-400 mb-4" />
        <h3 className="text-lg font-medium text-gray-900 mb-2">HenÃ¼z mesajÄ±nÄ±z yok</h3>
        <p className="text-gray-600">Ä°lk mesajÄ±nÄ±zÄ± gÃ¶ndererek baÅŸlayÄ±n</p>
      </div>
    )
  }

  return (
    <div className="flex-1 overflow-y-auto">
      <div className="divide-y divide-gray-100">
        {threads.map((thread) => {
          const unreadCount = getUnreadCount(thread)
          const isSelected = selectedThread === thread.id
          
          return (
            <div
              key={thread.id}
              className={`p-4 hover:bg-gray-50 cursor-pointer transition-colors ${
                isSelected ? 'bg-blue-50 border-r-4 border-r-blue-600' : ''
              }`}
              onClick={() => onSelectThread(thread.id)}
            >
              <div className="flex items-start justify-between">
                <div className="flex-1 min-w-0">
                  <div className="flex items-center mb-1">
                    <div className="flex-shrink-0 mr-3">
                      <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                        <User className="w-5 h-5 text-blue-600" />
                      </div>
                    </div>
                    <div className="flex-1 min-w-0">
                      <div className="flex items-center justify-between">
                        <h4 className="font-medium text-gray-900 truncate">
                          {getOtherParticipantName(thread)}
                        </h4>
                        <span className="text-xs text-gray-500">
                          {formatTime(thread.last_message_at)}
                        </span>
                      </div>
                      <p className="text-sm text-gray-600 truncate mt-1">
                        {getMessagePreview(thread)}
                      </p>
                    </div>
                  </div>
                </div>
                
                <div className="flex items-center space-x-2 ml-2">
                  {unreadCount > 0 && (
                    <span className="bg-red-500 text-white text-xs px-2 py-1 rounded-full min-w-[20px] text-center">
                      {unreadCount}
                    </span>
                  )}
                  {thread.status === 'active' && !unreadCount && (
                    <CheckCircle className="w-4 h-4 text-green-500" />
                  )}
                  <button
                    onClick={(e) => {
                      e.stopPropagation()
                      onDeleteThread(thread.id)
                    }}
                    className="text-gray-400 hover:text-red-500 p-1"
                    title="Sil"
                  >
                    <Trash2 className="w-4 h-4" />
                  </button>
                </div>
              </div>
            </div>
          )
        })}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ messaging\TradeAgreementForm.tsx
ğŸ“Š 491 satÄ±r | 19.33 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/messaging/TradeAgreementForm.tsx
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'
import { MESSAGING_DISCLAIMERS } from '@/lib/messaging/disclaimer'

interface TradeAgreementFormProps {
  threadId: string
  buyerId: string
  sellerId: string
  productTitle?: string
  onAgreementCreated?: (agreementId: string) => void
  onCancel?: () => void
}

export default function TradeAgreementForm({
  threadId,
  buyerId,
  sellerId,
  productTitle = '',
  onAgreementCreated,
  onCancel
}: TradeAgreementFormProps) {
  const [step, setStep] = useState(1)
  const [loading, setLoading] = useState(false)
  const [formData, setFormData] = useState({
    // ÃœrÃ¼n bilgileri
    productDescription: productTitle,
    agreedPrice: '',
    priceCurrency: 'TRY',
    
    // Teslimat
    deliveryMethod: 'local_pickup',
    deliveryAddress: '',
    meetingLocation: '',
    meetingTime: '',
    
    // Ã–deme
    paymentMethod: 'cash',
    paymentDetails: '',
    
    // Garanti
    warrantyDays: '0',
    returnPolicy: 'SatÄ±n alÄ±nan Ã¼rÃ¼n orijinal durumunda iade edilebilir.',
    
    // Kabul
    disclaimerAccepted: false
  })

  const handleSubmit = async () => {
    setLoading(true)
    try {
      // 1. Mutabakat formunu oluÅŸtur
      const { data: agreement, error } = await supabase
        .from('trade_agreements')
        .insert({
          thread_id: threadId,
          buyer_id: buyerId,
          seller_id: sellerId,
          product_description: formData.productDescription,
          agreed_price: parseFloat(formData.agreedPrice),
          price_currency: formData.priceCurrency,
          delivery_method: formData.deliveryMethod,
          delivery_address: formData.deliveryMethod === 'cargo' ? formData.deliveryAddress : null,
          meeting_location: formData.meetingLocation,
          meeting_time: formData.meetingTime ? new Date(formData.meetingTime).toISOString() : null,
          payment_method: formData.paymentMethod,
          payment_details: formData.paymentDetails,
          warranty_days: parseInt(formData.warrantyDays),
          return_policy: formData.returnPolicy,
          disclaimer_accepted: true,
          disclaimer_text: MESSAGING_DISCLAIMERS.TRADE_AGREEMENT_DISCLAIMER,
          status: 'pending'
        })
        .select()
        .single()

      if (error) throw error

      // 2. Thread'e sistem mesajÄ± ekle
      await supabase
        .from('messages')
        .insert({
          thread_id: threadId,
          sender_id: buyerId, // Formu baÅŸlatan kiÅŸi
          receiver_id: sellerId,
          content: `ğŸ“„ Mutabakat formu oluÅŸturuldu. LÃ¼tfen inceleyin ve kabul edin.`,
          content_type: 'agreement',
          is_system_message: true,
          system_message_type: 'agreement_created',
          metadata: { agreement_id: agreement.id }
        })

      // 3. BaÅŸarÄ±lÄ±
      alert('âœ… Mutabakat formu baÅŸarÄ±yla oluÅŸturuldu! KarÅŸÄ± taraf onayÄ± bekleniyor.')
      
      if (onAgreementCreated) {
        onAgreementCreated(agreement.id)
      }

    } catch (error) {
      console.error('Mutabakat formu oluÅŸturma hatasÄ±:', error)
      alert('Form oluÅŸturulurken bir hata oluÅŸtu.')
    } finally {
      setLoading(false)
    }
  }

  const deliveryMethods = [
    { value: 'cargo', label: 'ğŸšš Kargo', description: 'Kargo ile gÃ¶nderim' },
    { value: 'local_pickup', label: 'ğŸª MaÄŸazadan Teslim', description: 'MaÄŸazadan teslim alÄ±m' },
    { value: 'meetup', label: 'ğŸ¤ Yerinde BuluÅŸma', description: 'Halka aÃ§Ä±k yerde buluÅŸma' },
    { value: 'other', label: 'ğŸ“¦ DiÄŸer', description: 'DiÄŸer teslimat yÃ¶ntemi' }
  ]

  const paymentMethods = [
    { value: 'cash', label: 'ğŸ’µ Nakit', description: 'YÃ¼z yÃ¼ze nakit Ã¶deme' },
    { value: 'bank_transfer', label: 'ğŸ¦ Banka Havalesi', description: 'Banka havalesi/EFT' },
    { value: 'eft', label: 'ğŸ’³ EFT', description: 'Elektronik fon transferi' },
    { value: 'credit_card', label: 'ğŸ’³ Kredi KartÄ±', description: 'Kredi kartÄ± ile Ã¶deme' },
    { value: 'other', label: 'ğŸ“„ DiÄŸer', description: 'DiÄŸer Ã¶deme yÃ¶ntemi' }
  ]

  return (
    <div className="bg-white rounded-xl shadow-lg p-6 max-w-2xl mx-auto">
      {/* Header */}
      <div className="mb-8">
        <h2 className="text-2xl font-bold text-gray-900 mb-2">ğŸ¤ AlÄ±ÅŸveriÅŸ Mutabakat Formu</h2>
        <p className="text-gray-600">
          GÃ¼venli alÄ±ÅŸveriÅŸ iÃ§in tÃ¼m detaylarÄ± belgeleyin. Bu form yasal baÄŸlayÄ±cÄ±lÄ±ÄŸÄ± olmayan bir kayÄ±ttÄ±r.
        </p>
        
        {/* Step indicator */}
        <div className="flex mt-6">
          {[1, 2, 3, 4].map((stepNum) => (
            <div key={stepNum} className="flex-1">
              <div className={`h-2 rounded-full ${
                step >= stepNum ? 'bg-green-600' : 'bg-gray-200'
              }`}></div>
              <p className="text-xs text-center mt-2">
                {stepNum === 1 ? 'ÃœrÃ¼n' : stepNum === 2 ? 'Teslimat' : stepNum === 3 ? 'Ã–deme' : 'Ã–zet'}
              </p>
            </div>
          ))}
        </div>
      </div>

      {/* Form Content */}
      <div className="space-y-6">
        {step === 1 && (
          <div className="space-y-6">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                ÃœrÃ¼n AÃ§Ä±klamasÄ± *
              </label>
              <textarea
                value={formData.productDescription}
                onChange={(e) => setFormData({...formData, productDescription: e.target.value})}
                placeholder="SatÄ±n alÄ±nacak Ã¼rÃ¼nÃ¼n detaylÄ± aÃ§Ä±klamasÄ±..."
                className="w-full px-4 py-3 border border-gray-300 rounded-lg h-32"
                required
              />
              <p className="text-sm text-gray-500 mt-1">
                MÃ¼mkÃ¼n olduÄŸunca detaylÄ± yazÄ±n: marka, model, durum, varsa kusurlar...
              </p>
            </div>

            <div className="grid md:grid-cols-2 gap-6">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  AnlaÅŸÄ±lan Fiyat (TL) *
                </label>
                <input
                  type="number"
                  value={formData.agreedPrice}
                  onChange={(e) => setFormData({...formData, agreedPrice: e.target.value})}
                  placeholder="Ã–rn: 1500"
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                  required
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Garanti SÃ¼resi (gÃ¼n)
                </label>
                <select
                  value={formData.warrantyDays}
                  onChange={(e) => setFormData({...formData, warrantyDays: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                >
                  <option value="0">Garanti yok</option>
                  <option value="7">7 gÃ¼n</option>
                  <option value="14">14 gÃ¼n</option>
                  <option value="30">30 gÃ¼n</option>
                  <option value="90">90 gÃ¼n</option>
                </select>
              </div>
            </div>
          </div>
        )}

        {step === 2 && (
          <div className="space-y-6">
            <div>
              <h3 className="font-bold text-gray-900 mb-4">Teslimat YÃ¶ntemi</h3>
              <div className="grid grid-cols-2 gap-4">
                {deliveryMethods.map((method) => (
                  <label 
                    key={method.value}
                    className={`cursor-pointer border-2 rounded-lg p-4 ${
                      formData.deliveryMethod === method.value
                        ? 'border-green-500 bg-green-50'
                        : 'border-gray-200 hover:border-gray-300'
                    }`}
                  >
                    <input
                      type="radio"
                      name="deliveryMethod"
                      value={method.value}
                      checked={formData.deliveryMethod === method.value}
                      onChange={(e) => setFormData({...formData, deliveryMethod: e.target.value})}
                      className="sr-only"
                    />
                    <div className="text-lg mb-2">{method.label}</div>
                    <div className="text-sm text-gray-600">{method.description}</div>
                  </label>
                ))}
              </div>
            </div>

            {/* Teslimat detaylarÄ± */}
            {formData.deliveryMethod === 'cargo' && (
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Teslimat Adresi *
                </label>
                <textarea
                  value={formData.deliveryAddress}
                  onChange={(e) => setFormData({...formData, deliveryAddress: e.target.value})}
                  placeholder="Tam teslimat adresi..."
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                  rows={3}
                  required
                />
              </div>
            )}

            {formData.deliveryMethod === 'meetup' && (
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    BuluÅŸma Yeri *
                  </label>
                  <input
                    type="text"
                    value={formData.meetingLocation}
                    onChange={(e) => setFormData({...formData, meetingLocation: e.target.value})}
                    placeholder="Ã–rn: Ä°stiklal Caddesi Starbucks, KadÄ±kÃ¶y RÄ±htÄ±m"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                    required
                  />
                  <p className="text-sm text-gray-500 mt-1">
                    Halka aÃ§Ä±k, gÃ¼venli ve kameralÄ± bir yer seÃ§in.
                  </p>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    BuluÅŸma ZamanÄ±
                  </label>
                  <input
                    type="datetime-local"
                    value={formData.meetingTime}
                    onChange={(e) => setFormData({...formData, meetingTime: e.target.value})}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                  />
                </div>
              </div>
            )}
          </div>
        )}

        {step === 3 && (
          <div className="space-y-6">
            <div>
              <h3 className="font-bold text-gray-900 mb-4">Ã–deme YÃ¶ntemi</h3>
              <div className="grid grid-cols-2 gap-4">
                {paymentMethods.map((method) => (
                  <label 
                    key={method.value}
                    className={`cursor-pointer border-2 rounded-lg p-4 ${
                      formData.paymentMethod === method.value
                        ? 'border-blue-500 bg-blue-50'
                        : 'border-gray-200 hover:border-gray-300'
                    }`}
                  >
                    <input
                      type="radio"
                      name="paymentMethod"
                      value={method.value}
                      checked={formData.paymentMethod === method.value}
                      onChange={(e) => setFormData({...formData, paymentMethod: e.target.value})}
                      className="sr-only"
                    />
                    <div className="text-lg mb-2">{method.label}</div>
                    <div className="text-sm text-gray-600">{method.description}</div>
                  </label>
                ))}
              </div>
            </div>

            {/* Ã–deme detaylarÄ± */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Ã–deme DetaylarÄ±
              </label>
              <textarea
                value={formData.paymentDetails}
                onChange={(e) => setFormData({...formData, paymentDetails: e.target.value})}
                placeholder={
                  formData.paymentMethod === 'bank_transfer' 
                    ? 'Banka adÄ±, IBAN, alÄ±cÄ± adÄ±...' 
                    : formData.paymentMethod === 'cash'
                    ? 'Ã–deme yapÄ±lacak miktar ve para birimi...'
                    : 'DiÄŸer Ã¶deme detaylarÄ±...'
                }
                className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                rows={3}
              />
            </div>

            {/* Ä°ade politikasÄ± */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Ä°ade PolitikasÄ±
              </label>
              <textarea
                value={formData.returnPolicy}
                onChange={(e) => setFormData({...formData, returnPolicy: e.target.value})}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                rows={3}
              />
              <p className="text-sm text-gray-500 mt-1">
                Ä°ade koÅŸullarÄ±nÄ± aÃ§Ä±kÃ§a belirtin.
              </p>
            </div>
          </div>
        )}

        {step === 4 && (
          <div className="space-y-6">
            {/* Ã–zet */}
            <div className="bg-gray-50 rounded-xl p-6">
              <h4 className="font-bold text-gray-900 mb-4">ğŸ“‹ Mutabakat Ã–zeti</h4>
              
              <div className="space-y-4">
                <div>
                  <p className="text-sm text-gray-600">ÃœrÃ¼n:</p>
                  <p className="font-medium">{formData.productDescription}</p>
                </div>
                
                <div className="grid md:grid-cols-2 gap-4">
                  <div>
                    <p className="text-sm text-gray-600">Fiyat:</p>
                    <p className="font-medium">{formData.agreedPrice} {formData.priceCurrency}</p>
                  </div>
                  
                  <div>
                    <p className="text-sm text-gray-600">Teslimat:</p>
                    <p className="font-medium">
                      {deliveryMethods.find(m => m.value === formData.deliveryMethod)?.label}
                    </p>
                  </div>
                  
                  <div>
                    <p className="text-sm text-gray-600">Ã–deme:</p>
                    <p className="font-medium">
                      {paymentMethods.find(m => m.value === formData.paymentMethod)?.label}
                    </p>
                  </div>
                  
                  <div>
                    <p className="text-sm text-gray-600">Garanti:</p>
                    <p className="font-medium">
                      {formData.warrantyDays === '0' ? 'Yok' : `${formData.warrantyDays} gÃ¼n`}
                    </p>
                  </div>
                </div>
              </div>
            </div>

            {/* Sorumluluk reddi */}
            <div className="bg-red-50 border border-red-200 rounded-xl p-6">
              <h4 className="font-bold text-red-900 mb-3">âš ï¸ KRÄ°TÄ°K UYARI</h4>
              
              <div className="prose prose-sm max-w-none text-red-800">
                {MESSAGING_DISCLAIMERS.TRADE_AGREEMENT_DISCLAIMER.split('\n').map((line, i) => (
                  <p key={i} className={i === 0 ? 'font-bold' : ''}>
                    {line}
                  </p>
                ))}
              </div>
              
              <div className="mt-4">
                <label className="flex items-start">
                  <input
                    type="checkbox"
                    checked={formData.disclaimerAccepted}
                    onChange={(e) => setFormData({...formData, disclaimerAccepted: e.target.checked})}
                    className="mt-1 mr-3 text-red-600"
                    required
                  />
                  <span className="text-sm font-medium text-red-900">
                    YukarÄ±daki sorumluluk reddini okudum, anladÄ±m ve kabul ediyorum.
                    <br />
                    <span className="font-normal text-red-700">
                      Bu form sadece kayÄ±t amaÃ§lÄ±dÄ±r, yasal baÄŸlayÄ±cÄ±lÄ±ÄŸÄ± yoktur.
                    </span>
                  </span>
                </label>
              </div>
            </div>

            {/* Tavsiyeler */}
            <div className="bg-blue-50 rounded-xl p-6">
              <h4 className="font-bold text-gray-900 mb-3">ğŸ’¡ GÃ¼venli AlÄ±ÅŸveriÅŸ Tavsiyeleri</h4>
              <ul className="space-y-2 text-sm text-gray-700">
                <li className="flex items-start">
                  <span className="mr-2">âœ…</span>
                  <span>Yerel buluÅŸmalarda halka aÃ§Ä±k, kameralÄ± yerleri tercih edin</span>
                </li>
                <li className="flex items-start">
                  <span className="mr-2">âœ…</span>
                  <span>ÃœrÃ¼nÃ¼ gÃ¶rmeden, teslimat almadan Ã¶deme yapmayÄ±n</span>
                </li>
                <li className="flex items-start">
                  <span className="mr-2">âœ…</span>
                  <span>Resmi fatura veya garanti belgesi talep edin</span>
                </li>
                <li className="flex items-start">
                  <span className="mr-2">âœ…</span>
                  <span>ÅÃ¼pheli durumlarÄ± platform@spotitforme.com'a bildirin</span>
                </li>
              </ul>
            </div>
          </div>
        )}
      </div>

      {/* Footer */}
      <div className="mt-8 pt-6 border-t flex justify-between">
        <button
          onClick={step === 1 ? onCancel : () => setStep(step - 1)}
          className="px-6 py-3 text-gray-700 hover:text-gray-900 font-medium"
        >
          {step === 1 ? 'Ä°ptal' : 'Geri'}
        </button>

        <div className="flex space-x-4">
          {step < 4 && (
            <button
              onClick={() => setStep(step + 1)}
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg"
            >
              Devam Et
            </button>
          )}
          
          {step === 4 && (
            <button
              onClick={handleSubmit}
              disabled={loading || !formData.disclaimerAccepted || !formData.agreedPrice}
              className="bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-bold py-3 px-8 rounded-lg disabled:opacity-50"
            >
              {loading ? (
                <span className="flex items-center">
                  <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>
                  OluÅŸturuluyor...
                </span>
              ) : (
                'Mutabakat Formunu OluÅŸtur'
              )}
            </button>
          )}
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ NativeAd.tsx
ğŸ“Š 259 satÄ±r | 8.83 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/NativeAd.tsx - TAMAMI
'use client';

import { useState, useEffect } from 'react';
import { ExternalLink, TrendingUp, Star, Smartphone, Monitor } from 'lucide-react';

interface NativeAdProps {
  index?: number;
  className?: string;
  title?: string;
  description?: string;
  ctaText?: string;
  advertiserName?: string;
}

export default function NativeAd({ 
  index = 3, 
  className = '',
  title,
  description,
  ctaText,
  advertiserName
}: NativeAdProps) {
  const [isMobile, setIsMobile] = useState(false);
  const [mounted, setMounted] = useState(false);
  const [hover, setHover] = useState(false);

  useEffect(() => {
    setMounted(true);
    const checkMobile = () => {
      setIsMobile(window.innerWidth < 768);
    };
    
    checkMobile();
    window.addEventListener('resize', checkMobile);
    
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  // VarsayÄ±lan reklam iÃ§erikleri
  const defaultAds = {
    mobile: {
      title: 'Mobil AlÄ±ÅŸveriÅŸte Ã–zel FÄ±rsat!',
      description: 'Nadir bulunan Ã¼rÃ¼nler iÃ§in mobil uygulamamÄ±zÄ± deneyin. %20 indirim kodu: SPOT20',
      ctaText: 'Hemen KeÅŸfet',
      advertiserName: 'Mobil Partner',
      icon: 'ğŸ“±'
    },
    desktop: {
      title: 'Desktop Ã–zel Teklif',
      description: 'GeniÅŸ ekranda daha iyi deneyim iÃ§in premium Ã¼yelik avantajlarÄ±.',
      ctaText: 'DetaylarÄ± GÃ¶r',
      advertiserName: 'Desktop Sponsor',
      icon: 'ğŸ’»'
    },
    generic: {
      title: 'SpotItForMe Premium',
      description: 'Spot\'larÄ±nÄ±zÄ± Ã¶ne Ã§Ä±karÄ±n, daha hÄ±zlÄ± bulun. Premium Ã¼yelik avantajlarÄ±.',
      ctaText: 'Premium Ol',
      advertiserName: 'SpotItForMe',
      icon: 'â­'
    }
  };

  // Reklam verisini seÃ§
  const getAdData = () => {
    if (title || description || ctaText || advertiserName) {
      return {
        title: title || defaultAds.generic.title,
        description: description || defaultAds.generic.description,
        ctaText: ctaText || defaultAds.generic.ctaText,
        advertiserName: advertiserName || defaultAds.generic.advertiserName,
        icon: defaultAds.generic.icon
      };
    }
    
    return isMobile ? defaultAds.mobile : defaultAds.desktop;
  };

  const adData = getAdData();

  if (!mounted) {
    return (
      <div className={`bg-gray-100 animate-pulse rounded-xl ${className}`}>
        <div className={`p-${isMobile ? '4' : '6'}`}>
          <div className={`h-4 bg-gray-200 rounded ${isMobile ? 'w-1/2' : 'w-1/3'} mb-4`}></div>
          <div className={`h-${isMobile ? '16' : '20'} bg-gray-200 rounded mb-4`}></div>
          <div className={`h-8 bg-gray-200 rounded ${isMobile ? 'w-full' : 'w-1/2'}`}></div>
        </div>
      </div>
    );
  }

  return (
    <div 
      className={`relative z-0 ${className}`}
      onMouseEnter={() => setHover(true)}
      onMouseLeave={() => setHover(false)}
    >
      <div className={`
        ${isMobile ? 'p-4' : 'p-6'}
        ${hover 
          ? 'bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-300 shadow-md' 
          : 'bg-gradient-to-br from-white to-gray-50 border-gray-200'
        }
        border ${isMobile ? 'rounded-lg' : 'rounded-xl'}
        shadow-sm
        transition-all duration-300
        overflow-hidden
        relative
      `}>
        
        {/* Sponsor badge - sol Ã¼st */}
        <div className="absolute top-3 left-3">
          <div className={`
            ${isMobile ? 'text-[10px] px-2 py-1' : 'text-xs px-3 py-1.5'} 
            ${hover ? 'bg-blue-600 text-white' : 'bg-blue-100 text-blue-700'}
            font-semibold rounded-full
            flex items-center
            transition-colors duration-300
          `}>
            <Star size={isMobile ? 10 : 12} className="mr-1" />
            SPONSOR
          </div>
        </div>

        {/* Platform icon - saÄŸ Ã¼st */}
        <div className="absolute top-3 right-3">
          <div className={`
            ${isMobile ? 'w-8 h-8' : 'w-10 h-10'}
            ${hover ? 'bg-blue-100' : 'bg-gray-100'}
            rounded-full flex items-center justify-center
            transition-colors duration-300
          `}>
            {isMobile ? (
              <Smartphone size={isMobile ? 14 : 16} className={hover ? 'text-blue-600' : 'text-gray-600'} />
            ) : (
              <Monitor size={isMobile ? 14 : 16} className={hover ? 'text-blue-600' : 'text-gray-600'} />
            )}
          </div>
        </div>

        {/* Ana iÃ§erik */}
        <div className={isMobile ? 'pt-10' : 'pt-12'}>
          
          {/* BaÅŸlÄ±k */}
          <h3 className={`
            font-bold text-gray-900 
            ${isMobile ? 'text-base mb-2' : 'text-lg mb-3'}
            ${hover ? 'text-blue-800' : ''}
            transition-colors duration-300
          `}>
            {adData.title}
          </h3>

          {/* AÃ§Ä±klama */}
          <p className={`
            text-gray-600 
            ${isMobile ? 'text-sm mb-3' : 'text-base mb-4'}
            ${hover ? 'text-gray-700' : ''}
            transition-colors duration-300
          `}>
            {adData.description}
          </p>

          {/* Reklamveren bilgisi */}
          <div className="flex items-center mb-4">
            <div className={`
              ${isMobile ? 'w-8 h-8' : 'w-10 h-10'}
              ${hover ? 'bg-blue-100' : 'bg-gray-100'}
              rounded-full flex items-center justify-center mr-3
              transition-colors duration-300
            `}>
              <span className={`${isMobile ? 'text-lg' : 'text-xl'}`}>
                {adData.icon}
              </span>
            </div>
            <div>
              <p className={`
                font-medium 
                ${isMobile ? 'text-sm' : 'text-base'}
                ${hover ? 'text-blue-700' : 'text-gray-700'}
                transition-colors duration-300
              `}>
                {adData.advertiserName}
              </p>
              <p className={`${isMobile ? 'text-xs' : 'text-sm'} text-gray-500`}>
                {isMobile ? 'Mobil Sponsor' : 'Desktop Sponsor'}
              </p>
            </div>
          </div>

          {/* CTA Butonu */}
          <a
            href="#"
            onClick={(e) => {
              e.preventDefault();
              console.log('Native ad clicked:', adData.title);
              // Buraya tÄ±klama takibi eklenebilir
            }}
            className={`
              block w-full 
              ${hover 
                ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white' 
                : 'bg-gradient-to-r from-blue-500 to-blue-600 text-white'
              }
              text-center font-semibold 
              ${isMobile ? 'py-2.5 px-4 text-sm' : 'py-3 px-6 text-base'}
              rounded-lg
              transition-all duration-300
              transform ${hover ? 'scale-[1.02]' : 'scale-100'}
              shadow-sm ${hover ? 'shadow-md' : ''}
              flex items-center justify-center
            `}
          >
            <span>{adData.ctaText}</span>
            <ExternalLink size={isMobile ? 14 : 16} className="ml-2" />
          </a>

          {/* Ä°statistikler (sadece desktop) */}
          {!isMobile && (
            <div className="mt-4 pt-4 border-t border-gray-100">
              <div className="flex justify-between text-xs text-gray-500">
                <div className="text-center">
                  <div className="font-semibold text-gray-700">1.2K</div>
                  <div>GÃ¶sterim</div>
                </div>
                <div className="text-center">
                  <div className="font-semibold text-gray-700">48</div>
                  <div>TÄ±klama</div>
                </div>
                <div className="text-center">
                  <div className="font-semibold text-gray-700">4%</div>
                  <div>CTR</div>
                </div>
              </div>
            </div>
          )}

          {/* KÃ¼Ã§Ã¼k disclaimer */}
          <div className={`mt-${isMobile ? '3' : '4'} pt-${isMobile ? '3' : '4'} border-t border-gray-100`}>
            <p className={`
              text-gray-400 text-center 
              ${isMobile ? 'text-[10px]' : 'text-xs'}
              ${hover ? 'text-gray-500' : ''}
              transition-colors duration-300
            `}>
              Bu bir reklamdÄ±r. TÄ±klamalar dÄ±ÅŸ sitelere yÃ¶nlendirebilir.
            </p>
          </div>
        </div>

        {/* Dekoratif elementler */}
        <div className="absolute top-0 right-0 w-20 h-20 -mt-10 -mr-10 bg-blue-100 rounded-full opacity-20"></div>
        <div className="absolute bottom-0 left-0 w-16 h-16 -mb-8 -ml-8 bg-indigo-100 rounded-full opacity-20"></div>
      </div>
    </div>
  );
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ QuickSightingButton.tsx
ğŸ“Š 40 satÄ±r | 1.27 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useState } from 'react'
import QuickSightingModal from './QuickSightingModal'

export default function QuickSightingButton() {
  const [showModal, setShowModal] = useState(false)

  return (
    <>
      {/* Floating Button */}
      <button
        onClick={() => setShowModal(true)}
        className="fixed bottom-6 right-6 z-50 bg-gradient-to-r from-green-500 to-emerald-600 text-white p-4 rounded-full shadow-2xl hover:shadow-3xl transition-all duration-300 hover:scale-110 group"
      >
        <div className="flex items-center space-x-2">
          <span className="text-2xl">ğŸ‘ï¸</span>
          <span className="font-bold hidden md:inline-block group-hover:inline-block transition-all">
            Nadir GÃ¶rdÃ¼m!
          </span>
        </div>
        
        {/* Puan gÃ¶sterimi */}
        <div className="absolute -top-2 -right-2 bg-yellow-500 text-white text-xs font-bold px-2 py-1 rounded-full">
          +5-25
        </div>
      </button>

      {/* Modal */}
      <QuickSightingModal
        isOpen={showModal}
        onClose={() => setShowModal(false)}
        onSuccess={() => {
          // Bildirim baÅŸarÄ±lÄ± olduÄŸunda sayfayÄ± yenile
          window.location.reload()
        }}
      />
    </>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ QuickSightingModal.tsx
ğŸ“Š 391 satÄ±r | 13.20 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useState, useRef } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase'
import Image from 'next/image'
import LocationSelector from './LocationSelector'

interface QuickSightingModalProps {
  isOpen: boolean
  onClose: () => void
  onSuccess?: () => void
}

export default function QuickSightingModal({ 
  isOpen, 
  onClose, 
  onSuccess 
}: QuickSightingModalProps) {
  const router = useRouter()
  const fileInputRef = useRef<HTMLInputElement>(null)
  
  const [loading, setLoading] = useState(false)
  const [locationData, setLocationData] = useState<any>(null)
  const [photoFile, setPhotoFile] = useState<File | null>(null)
  const [photoPreview, setPhotoPreview] = useState<string | null>(null)
  
  const [formData, setFormData] = useState({
    description: '',
    category: '',
    hasPhoto: false
  })

  const handleLocationSelect = (location: any) => {
    setLocationData(location)
  }

  const handlePhotoToggle = (checked: boolean) => {
    setFormData({...formData, hasPhoto: checked})
    if (!checked) {
      setPhotoFile(null)
      setPhotoPreview(null)
    } else {
      fileInputRef.current?.click()
    }
  }

  const handlePhotoUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (file) {
      // Max 5MB kontrolÃ¼
      if (file.size > 5 * 1024 * 1024) {
        alert('Resim boyutu 5MB\'dan kÃ¼Ã§Ã¼k olmalÄ±dÄ±r')
        return
      }
      
      setPhotoFile(file)
      const reader = new FileReader()
      reader.onloadend = () => {
        setPhotoPreview(reader.result as string)
      }
      reader.readAsDataURL(file)
    }
  }

  const calculatePoints = () => {
    let points = 5 // Temel puan
    
    if (formData.hasPhoto) points += 10
    if (locationData) points += 5
    if (formData.category) points += 3
    
    return points
  }

  const handleSubmit = async () => {
    if (!locationData) {
      alert('LÃ¼tfen konum seÃ§in')
      return
    }

    if (!formData.description.trim()) {
      alert('LÃ¼tfen ne gÃ¶rdÃ¼ÄŸÃ¼nÃ¼zÃ¼ yazÄ±n')
      return
    }

    setLoading(true)

    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) {
        router.push('/login?redirect=/')
        return
      }

      let photoUrl = null
      
      // 1. FotoÄŸraf yÃ¼kle
      if (photoFile) {
        const fileExt = photoFile.name.split('.').pop()
        const fileName = `${user.id}/sightings/${Date.now()}.${fileExt}`
        
        const { error: uploadError } = await supabase.storage
          .from('spot-images')
          .upload(fileName, photoFile)
        
        if (uploadError) throw uploadError
        
        const { data: { publicUrl } } = supabase.storage
          .from('spot-images')
          .getPublicUrl(fileName)
        
        photoUrl = publicUrl
      }

      // 2. Quick sighting oluÅŸtur
      const { data: sighting, error: sightingError } = await supabase
        .from('quick_sightings')
        .insert({
          user_id: user.id,
          description: formData.description,
          category: formData.category,
          has_photo: formData.hasPhoto,
          photo_url: photoUrl,
          location_name: locationData.name,
          address: locationData.address,
          latitude: locationData.latitude,
          longitude: locationData.longitude,
          city: locationData.city,
          district: locationData.district,
          points_earned: calculatePoints(),
          status: 'active'
        })
        .select()
        .single()

      if (sightingError) throw sightingError

      // 3. Puan ekle (gamification)
      await supabase.rpc('add_user_points', {
        user_id: user.id,
        points_to_add: calculatePoints(),
        activity_type: 'quick_sighting'
      })

      // 4. Badge kontrolÃ¼ (ilk sighting)
      const { data: reputation } = await supabase
        .from('user_reputation')
        .select('total_sightings')
        .eq('user_id', user.id)
        .single()

      if (reputation?.total_sightings === 1) {
        await supabase.rpc('award_badge', {
          user_id: user.id,
          badge_id: 'first_sighting'
        })
      }

      // 5. Ana sayfada gÃ¶sterilmek Ã¼zere global state'e ekle
      // (Real-time iÃ§in Supabase Realtime kullanÄ±labilir)
      
      // 6. Social feed'e ekle (opsiyonel)
      if (process.env.NEXT_PUBLIC_ENABLE_SOCIAL === 'true') {
        await supabase.from('social_posts').insert({
          user_id: user.id,
          type: 'sighting',
          caption: `"${formData.description}" gÃ¶rdÃ¼m!`,
          location: locationData.name,
          image_urls: photoUrl ? [photoUrl] : [],
          hashtags: ['#nadirgÃ¶rdÃ¼m', '#spotitforme']
        })
      }

      // BaÅŸarÄ± mesajÄ±
      alert(`ğŸ‰ Bildiriminiz kaydedildi! ${calculatePoints()} puan kazandÄ±nÄ±z.`)
      
      // Formu sÄ±fÄ±rla
      setFormData({ description: '', category: '', hasPhoto: false })
      setLocationData(null)
      setPhotoFile(null)
      setPhotoPreview(null)
      
      onClose()
      if (onSuccess) onSuccess()
      
      // SayfayÄ± yenile
      router.refresh()

    } catch (error: any) {
      console.error('Bildirim hatasÄ±:', error)
      alert(`Hata: ${error.message}`)
    } finally {
      setLoading(false)
    }
  }

  if (!isOpen) return null

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto">
        {/* Header */}
        <div className="sticky top-0 bg-white border-b p-6 z-10">
          <div className="flex items-center justify-between">
            <div>
              <h2 className="text-2xl font-bold text-gray-900">ğŸ‘ï¸ Nadir GÃ¶rdÃ¼m!</h2>
              <p className="text-gray-600">HÄ±zlÄ±ca bildirim gÃ¶nder, puan kazan</p>
            </div>
            <button
              onClick={onClose}
              className="text-gray-500 hover:text-gray-700 text-2xl"
            >
              Ã—
            </button>
          </div>
        </div>

        {/* Form */}
        <div className="p-6 space-y-6">
          {/* AÃ§Ä±klama */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Ne gÃ¶rdÃ¼nÃ¼z? *
            </label>
            <textarea
              value={formData.description}
              onChange={(e) => setFormData({...formData, description: e.target.value})}
              placeholder="Ã–rn: Vintage Nikon F2 kamera, eski Rolex saat, antika Hereke halÄ±sÄ±..."
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
              rows={3}
              required
            />
          </div>

          {/* KONUM SEÃ‡Ä°CÄ° */}
          <LocationSelector 
            onLocationSelect={handleLocationSelect}
            initialLocation=""
          />

          {/* Kategori */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Kategori
            </label>
            <select
              value={formData.category}
              onChange={(e) => setFormData({...formData, category: e.target.value})}
              className="w-full px-4 py-3 border border-gray-300 rounded-lg"
            >
              <option value="">Kategori seÃ§in (opsiyonel)</option>
              <option value="electronics">Elektronik</option>
              <option value="fashion">Giyim & Aksesuar</option>
              <option value="home">Ev & BahÃ§e</option>
              <option value="collectible">Koleksiyon</option>
              <option value="vehicle">AraÃ§ & ParÃ§a</option>
              <option value="other">DiÄŸer</option>
            </select>
          </div>

          {/* FOTOÄRAF BÃ–LÃœMÃœ */}
          <div className="space-y-3">
            <div className="flex items-center space-x-3">
              <input
                type="checkbox"
                checked={formData.hasPhoto}
                onChange={(e) => handlePhotoToggle(e.target.checked)}
                className="w-4 h-4 text-green-600"
                id="hasPhoto"
              />
              <label htmlFor="hasPhoto" className="text-sm font-medium text-gray-700">
                ğŸ“¸ FotoÄŸrafÄ±m var (+10 ekstra puan!)
              </label>
            </div>

            {formData.hasPhoto && (
              <div className="mt-3">
                {photoPreview ? (
                  <div className="relative">
                    <img
                      src={photoPreview}
                      alt="Preview"
                      className="w-full h-48 object-cover rounded-lg border-2 border-green-200"
                    />
                    <button
                      type="button"
                      onClick={() => {
                        setPhotoFile(null)
                        setPhotoPreview(null)
                      }}
                      className="absolute top-2 right-2 bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center"
                    >
                      Ã—
                    </button>
                  </div>
                ) : (
                  <div
                    onClick={() => fileInputRef.current?.click()}
                    className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-green-400 transition"
                  >
                    <div className="text-4xl mb-2">ğŸ“¸</div>
                    <p className="font-medium">FotoÄŸraf yÃ¼klemek iÃ§in tÄ±kla</p>
                    <p className="text-sm text-gray-500 mt-1">
                      ÃœrÃ¼nÃ¼n net fotoÄŸrafÄ±nÄ± Ã§ek, daha hÄ±zlÄ± bulunsun
                    </p>
                  </div>
                )}
                
                <input
                  type="file"
                  ref={fileInputRef}
                  accept="image/*"
                  onChange={handlePhotoUpload}
                  className="hidden"
                  capture="environment"
                />

                <p className="text-xs text-gray-500 mt-2">
                  âœ“ FotoÄŸraflÄ± bildirimler 2x daha hÄ±zlÄ± bulunuyor<br />
                  âœ“ Max 5MB â€¢ PNG, JPG, JPEG, WebP
                </p>
              </div>
            )}
          </div>

          {/* PUAN HESAPLA */}
          <div className="bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg">
            <div className="flex items-center justify-between">
              <div>
                <p className="font-medium text-green-800">ğŸ¯ Toplam KazanacaÄŸÄ±nÄ±z Puan:</p>
                <div className="text-2xl font-bold text-green-600 mt-1">
                  {calculatePoints()} PUAN
                </div>
              </div>
              <div className="text-3xl">ğŸ†</div>
            </div>
            <div className="text-sm text-green-700 mt-2 space-y-1">
              <div className="flex justify-between">
                <span>Temel bildirim:</span>
                <span className="font-medium">5 puan</span>
              </div>
              {formData.hasPhoto && (
                <div className="flex justify-between">
                  <span>FotoÄŸraf:</span>
                  <span className="font-medium">+10 puan</span>
                </div>
              )}
              {locationData && (
                <div className="flex justify-between">
                  <span>DetaylÄ± konum:</span>
                  <span className="font-medium">+5 puan</span>
                </div>
              )}
              {formData.category && (
                <div className="flex justify-between">
                  <span>Kategori:</span>
                  <span className="font-medium">+3 puan</span>
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Footer */}
        <div className="sticky bottom-0 bg-white border-t p-6">
          <button
            onClick={handleSubmit}
            disabled={loading || !locationData || !formData.description.trim()}
            className="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition"
          >
            {loading ? (
              <span className="flex items-center justify-center">
                <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>
                GÃ¶nderiliyor...
              </span>
            ) : !locationData ? (
              'ğŸ“ Konum SeÃ§in'
            ) : (
              `Bildir ve ${calculatePoints()} Puan Kazan!`
            )}
          </button>
          
          <p className="text-center text-gray-500 text-sm mt-3">
            Bildiriminiz profil sayfanÄ±zda ve ana sayfada gÃ¶rÃ¼necek
          </p>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ RecentSightings.tsx
ğŸ“Š 189 satÄ±r | 6.94 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/RecentSightings.tsx - GÃœNCELLENMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import { supabase } from '@/lib/supabase' // ESKÄ° VERSÄ°YONU KULLAN
import { MapPin, Camera, Award } from 'lucide-react'

interface RecentSightingsProps {
  initialSightings?: any[] // Opsiyonel: Server'dan gelebilir
}

export default function RecentSightings({ initialSightings = [] }: RecentSightingsProps) {
  const router = useRouter()
  const [sightings, setSightings] = useState<any[]>(initialSightings)
  const [loading, setLoading] = useState(!initialSightings.length)
  const [showAll, setShowAll] = useState(false)

  useEffect(() => {
    if (!initialSightings.length) {
      fetchSightings()
    }
  }, [])

  const fetchSightings = async () => {
    try {
      const { data } = await supabase
        .from('quick_sightings')
        .select(`
          *,
          user:user_profiles(name, avatar_url)
        `)
        .eq('status', 'active')
        .order('created_at', { ascending: false })
        .limit(6)
      
      setSightings(data || [])
    } catch (error) {
      console.error('Sightings yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const displaySightings = showAll ? sightings : sightings.slice(0, 4)

  if (loading) {
    return (
      <section className="py-12 bg-white">
        <div className="container-custom">
          <h2 className="text-3xl font-bold text-gray-900 mb-8">ğŸ‘ï¸ Son GÃ¶rÃ¼lenler</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            {[...Array(4)].map((_, i) => (
              <div key={i} className="animate-pulse bg-gray-100 rounded-xl h-64"></div>
            ))}
          </div>
        </div>
      </section>
    )
  }

  if (sightings.length === 0) {
    return null // HiÃ§ sighting yoksa gÃ¶zÃ¼kmesin
  }

  return (
    <section className="py-12 bg-white">
      <div className="container-custom">
        <div className="flex items-center justify-between mb-8">
          <div>
            <h2 className="text-3xl font-bold text-gray-900 mb-2">
              ğŸ‘ï¸ Son GÃ¶rÃ¼lenler
            </h2>
            <p className="text-gray-600">
              TopluluÄŸumuzun en son gÃ¶rdÃ¼ÄŸÃ¼ nadir Ã¼rÃ¼nler
            </p>
          </div>
          
          {sightings.length > 4 && (
            <button
              onClick={() => setShowAll(!showAll)}
              className="text-blue-600 hover:text-blue-800 font-medium"
            >
              {showAll ? 'Daha Az GÃ¶ster' : `TÃ¼mÃ¼nÃ¼ GÃ¶r (${sightings.length})`}
            </button>
          )}
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {displaySightings.map((sighting) => (
            <div
              key={sighting.id}
              className="bg-gray-50 rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow duration-300 cursor-pointer"
              onClick={() => router.push(`/sightings/${sighting.id}`)}
            >
              {/* FotoÄŸraf */}
              <div className="h-48 relative bg-gray-100">
                {sighting.photo_url ? (
                  <img
                    src={sighting.photo_url}
                    alt={sighting.description}
                    className="w-full h-full object-cover"
                  />
                ) : (
                  <div className="w-full h-full flex items-center justify-center">
                    <div className="text-center">
                      <Camera className="w-12 h-12 text-gray-400 mx-auto mb-2" />
                      <p className="text-sm text-gray-500">FotoÄŸraf Yok</p>
                    </div>
                  </div>
                )}
                
                {/* Puan badge */}
                <div className="absolute top-3 right-3">
                  <div className="bg-green-600 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center">
                    <Award className="w-3 h-3 mr-1" />
                    +{sighting.points_earned}
                  </div>
                </div>
              </div>

              {/* Ä°Ã§erik */}
              <div className="p-4">
                <p className="font-medium text-gray-900 line-clamp-2 mb-3">
                  {sighting.description}
                </p>
                
                {/* Konum */}
                <div className="flex items-center text-sm text-gray-600 mb-3">
                  <MapPin className="w-4 h-4 mr-1 flex-shrink-0" />
                  <span className="truncate">{sighting.location_name}</span>
                </div>
                
                {/* KullanÄ±cÄ± */}
                <div className="flex items-center justify-between">
                  <div className="flex items-center">
                    <div className="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold mr-2">
                      {sighting.user?.name?.[0] || 'K'}
                    </div>
                    <span className="text-sm text-gray-700">
                      {sighting.user?.name || 'KullanÄ±cÄ±'}
                    </span>
                  </div>
                  
                  <span className="text-blue-600 text-sm font-medium">
                    Detay â†’
                  </span>
                </div>
                
                {/* Kategori */}
                {sighting.category && (
                  <div className="mt-3">
                    <span className="inline-block bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded">
                      {sighting.category}
                    </span>
                  </div>
                )}
              </div>
            </div>
          ))}
        </div>

        {/* Ben de arÄ±yorum CTA */}
        <div className="mt-10 bg-gradient-to-r from-blue-50 to-blue-100 rounded-2xl p-8 text-center">
          <h3 className="text-xl font-bold text-gray-900 mb-3">
            Bu Ã¼rÃ¼nlerden birini siz de mi arÄ±yorsunuz?
          </h3>
          <p className="text-gray-700 mb-6">
            "Ben de arÄ±yorum" deyin, spot oluÅŸturalÄ±m ve bulalÄ±m!
          </p>
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <button
              onClick={() => router.push('/create-spot')}
              className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg"
            >
              Spot OluÅŸtur
            </button>
            <button
              onClick={() => router.push('/recent-sightings')}
              className="bg-white hover:bg-gray-100 text-gray-800 font-bold py-3 px-8 rounded-lg border"
            >
              TÃ¼m GÃ¶rÃ¼lenleri Ä°ncele
            </button>
          </div>
        </div>
      </div>
    </section>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ RecentSpots.tsx
ğŸ“Š 119 satÄ±r | 2.85 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/RecentSpots.tsx - GÃœNCELLENMÄ°Å
'use client';

import { useEffect, useState } from 'react';
import { supabase } from '@/lib/supabase';
import SpotCard from './SpotCard';
import NativeAd from './NativeAd';

export default function RecentSpots() {
  const [spots, setSpots] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadSpots();
  }, []);

  const loadSpots = async () => {
    const { data, error } = await supabase
      .from('spots')
      .select('*')
      .eq('status', 'active')
      .order('created_at', { ascending: false })
      .limit(9); // 9 spot + reklamlar

    if (error) {
      console.error('Error loading recent spots:', error);
      return;
    }

    setSpots(data || []);
    setLoading(false);
  };

  // Spotlar ve reklamlarÄ± karÄ±ÅŸtÄ±r
  const getMixedItems = () => {
    const items: any[] = [];
    
    // Ä°lk 3 spot
    items.push(...spots.slice(0, 3).map(spot => ({
      type: 'spot',
      data: spot,
      key: `spot-${spot.id}`
    })));
    
    // Ä°lk reklam
    items.push({
      type: 'ad',
      key: 'ad-1',
      index: 3
    });
    
    // Sonraki 3 spot
    items.push(...spots.slice(3, 6).map(spot => ({
      type: 'spot',
      data: spot,
      key: `spot-${spot.id}`
    })));
    
    // Ä°kinci reklam
    items.push({
      type: 'ad',
      key: 'ad-2',
      index: 6
    });
    
    // Son 3 spot
    items.push(...spots.slice(6, 9).map(spot => ({
      type: 'spot',
      data: spot,
      key: `spot-${spot.id}`
    })));
    
    return items;
  };

  const mixedItems = getMixedItems();

  if (loading) {
    return (
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {[...Array(6)].map((_, i) => (
          <div key={i} className="bg-gray-100 animate-pulse rounded-xl h-64"></div>
        ))}
      </div>
    );
  }

  return (
    <section className="py-12">
      <div className="flex justify-between items-center mb-8">
        <h2 className="text-2xl md:text-3xl font-bold text-gray-900">
          Yeni Eklenen Spot'lar
        </h2>
        <a
          href="/spots"
          className="text-blue-600 hover:text-blue-800 font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </a>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {mixedItems.map((item) => {
          if (item.type === 'spot') {
            return (
              <SpotCard key={item.key} spot={item.data} />
            );
          } else {
            return (
              <div key={item.key} className="col-span-full md:col-span-2 lg:col-span-3">
                <NativeAd index={item.index} />
              </div>
            );
          }
        })}
      </div>
    </section>
  );
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ ResponsiveAd.tsx
ğŸ“Š 117 satÄ±r | 3.79 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ResponsiveAd.tsx - SABÄ°T Ã–LÃ‡ÃœLER
'use client';

import { useState, useEffect } from 'react';

interface ResponsiveAdProps {
  placement: 'inline' | 'banner' | 'native';
  className?: string;
}

export default function ResponsiveAd({ 
  placement, 
  className = ''
}: ResponsiveAdProps) {
  const [isMobile, setIsMobile] = useState(false);
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
    const checkMobile = () => {
      setIsMobile(window.innerWidth < 768);
    };
    
    checkMobile();
    window.addEventListener('resize', checkMobile);
    
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  if (!mounted) {
    return (
      <div className={`${className} bg-gray-100 animate-pulse rounded`}>
        <div className="h-full flex items-center justify-center">
          <span className="text-gray-400 text-sm">Reklam yÃ¼kleniyor...</span>
        </div>
      </div>
    );
  }

  // Sabit Ã¶lÃ§Ã¼ler belirle
  const getAdConfig = () => {
    if (isMobile) {
      return {
        height: placement === 'banner' ? 'h-16' : 'h-48',
        width: 'w-full',
        textSize: 'text-sm',
        label: placement === 'banner' ? 'MOBÄ°L BANNER' : 'MOBÄ°L REKLAM',
        dimensions: placement === 'banner' ? '320Ã—50' : '300Ã—250',
        bgColor: placement === 'banner' ? 'bg-gradient-to-r from-blue-50 to-cyan-50' : 'bg-gradient-to-br from-blue-50 to-purple-50'
      };
    } else {
      return {
        height: placement === 'banner' ? 'h-20' : 'h-40',
        width: 'w-full',
        textSize: 'text-base',
        label: placement === 'banner' ? 'DESKTOP BANNER' : 'DESKTOP REKLAM',
        dimensions: placement === 'banner' ? '728Ã—90' : '728Ã—90',
        bgColor: placement === 'banner' ? 'bg-gradient-to-r from-blue-100 to-indigo-100' : 'bg-gradient-to-br from-blue-100 to-purple-100'
      };
    }
  };

  const config = getAdConfig();

  return (
    <div className={`${className} ${config.width}`}>
      <div className={`
        text-center
        ${config.bgColor}
        border-2 border-dashed ${isMobile ? 'border-blue-200' : 'border-blue-300'}
        rounded-lg
        overflow-hidden
        relative
      `}>
        {/* Reklam etiketi - kÃ¶ÅŸede */}
        <div className={`absolute top-2 left-2 ${isMobile ? 'text-[10px]' : 'text-xs'} bg-blue-600 text-white px-2 py-1 rounded`}>
          REKLAM
        </div>
        
        {/* Platform etiketi - diÄŸer kÃ¶ÅŸede */}
        <div className={`absolute top-2 right-2 ${isMobile ? 'text-[10px]' : 'text-xs'} bg-gray-700 text-white px-2 py-1 rounded`}>
          {isMobile ? 'ğŸ“±' : 'ğŸ’»'}
        </div>
        
        {/* Ana reklam alanÄ± */}
        <div className={`
          ${config.height}
          flex flex-col items-center justify-center
          px-4
        `}>
          <div className={`font-bold ${isMobile ? 'text-lg' : 'text-xl'} text-blue-700 mb-1`}>
            {config.label}
          </div>
          <div className={`${isMobile ? 'text-xs' : 'text-sm'} text-blue-600 mb-2`}>
            {config.dimensions}
          </div>
          <div className={`${isMobile ? 'text-xs' : 'text-sm'} text-gray-600`}>
            {isMobile 
              ? 'Mobil uyumlu reklam alanÄ±' 
              : 'Desktop uyumlu reklam alanÄ±'}
          </div>
        </div>
        
        {/* Alt bilgi */}
        <div className={`
          ${isMobile ? 'py-1' : 'py-2'}
          bg-white/50
          border-t ${isMobile ? 'border-blue-100' : 'border-blue-200'}
        `}>
          <div className={`${isMobile ? 'text-[10px]' : 'text-xs'} text-gray-500`}>
            SpotItForMe - Reklam AlanÄ±
          </div>
        </div>
      </div>
    </div>
  );
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ SearchFilters.tsx
ğŸ“Š 264 satÄ±r | 9.28 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SearchFilters.tsx
'use client'

import { useState, useEffect } from 'react'
import { useRouter, useSearchParams } from 'next/navigation'

interface FilterState {
  category: string
  location: string
  status: string
  sortBy: string
  minPrice: string
  maxPrice: string
  dateRange: string
}

export default function SearchFilters() {
  const router = useRouter()
  const searchParams = useSearchParams()
  
  const [filters, setFilters] = useState<FilterState>({
    category: searchParams.get('category') || 'all',
    location: searchParams.get('location') || 'all',
    status: searchParams.get('status') || 'all',
    sortBy: searchParams.get('sort') || 'newest',
    minPrice: searchParams.get('minPrice') || '',
    maxPrice: searchParams.get('maxPrice') || '',
    dateRange: searchParams.get('dateRange') || 'all'
  })

  const [showAdvanced, setShowAdvanced] = useState(false)

  // URL deÄŸiÅŸtiÄŸinde state'i gÃ¼ncelle
  useEffect(() => {
    setFilters({
      category: searchParams.get('category') || 'all',
      location: searchParams.get('location') || 'all',
      status: searchParams.get('status') || 'all',
      sortBy: searchParams.get('sort') || 'newest',
      minPrice: searchParams.get('minPrice') || '',
      maxPrice: searchParams.get('maxPrice') || '',
      dateRange: searchParams.get('dateRange') || 'all'
    })
  }, [searchParams])

  const categories = [
    'Elektronik', 'Giyim & Aksesuar', 'Ev & BahÃ§e',
    'Koleksiyon', 'Kitap & MÃ¼zik', 'Oyuncak & Oyun',
    'Spor & Outdoor', 'AraÃ§ & ParÃ§a', 'DiÄŸer'
  ]

  const locations = [
    'Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya',
    'Adana', 'Konya', 'Trabzon', 'TÃ¼rkiye Geneli', 'Yurt DÄ±ÅŸÄ±'
  ]

  const applyFilters = () => {
    const params = new URLSearchParams()
    
    if (filters.category !== 'all') params.set('category', filters.category)
    if (filters.location !== 'all') params.set('location', filters.location)
    if (filters.status !== 'all') params.set('status', filters.status)
    if (filters.sortBy !== 'newest') params.set('sort', filters.sortBy)
    if (filters.minPrice) params.set('minPrice', filters.minPrice)
    if (filters.maxPrice) params.set('maxPrice', filters.maxPrice)
    if (filters.dateRange !== 'all') params.set('dateRange', filters.dateRange)

    // URL'i gÃ¼ncelle (sayfa yenileme olmadan)
    router.push(`/spots?${params.toString()}`)
  }

  const handleInputChange = (key: keyof FilterState, value: string) => {
    setFilters(prev => ({
      ...prev,
      [key]: value
    }))
    
    // AnÄ±nda filtreleme (debounce eklenebilir)
    const params = new URLSearchParams(searchParams.toString())
    if (value && value !== 'all' && value !== '') {
      params.set(key, value)
    } else {
      params.delete(key)
    }
    
    // BazÄ± filtreler iÃ§in anÄ±nda uygula
    if (['category', 'location', 'status'].includes(key)) {
      router.push(`/spots?${params.toString()}`)
    }
  }

  const resetFilters = () => {
    setFilters({
      category: 'all',
      location: 'all',
      status: 'all',
      sortBy: 'newest',
      minPrice: '',
      maxPrice: '',
      dateRange: 'all'
    })
    router.push('/spots')
  }

  return (
    <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
      <div className="flex items-center justify-between mb-6">
        <h3 className="text-lg font-bold text-gray-900">Filtrele</h3>
        <button
          onClick={() => setShowAdvanced(!showAdvanced)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          {showAdvanced ? 'Basit GÃ¶rÃ¼nÃ¼m' : 'GeliÅŸmiÅŸ Filtreler'}
        </button>
      </div>

      {/* Temel Filtreler */}
      <div className="grid md:grid-cols-3 gap-6 mb-6">
        {/* Kategori */}
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-2">
            Kategori
          </label>
          <select
            value={filters.category}
            onChange={(e) => handleInputChange('category', e.target.value)}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          >
            <option value="all">TÃ¼m Kategoriler</option>
            {categories.map((cat) => (
              <option key={cat} value={cat}>
                {cat}
              </option>
            ))}
          </select>
        </div>

        {/* Konum */}
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-2">
            Konum
          </label>
          <select
            value={filters.location}
            onChange={(e) => handleInputChange('location', e.target.value)}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          >
            <option value="all">TÃ¼m Konumlar</option>
            {locations.map((loc) => (
              <option key={loc} value={loc}>
                {loc}
              </option>
            ))}
          </select>
        </div>

        {/* Durum */}
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-2">
            Durum
          </label>
          <select
            value={filters.status}
            onChange={(e) => handleInputChange('status', e.target.value)}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          >
            <option value="all">TÃ¼m Durumlar</option>
            <option value="active">Aktif</option>
            <option value="found">Bulundu</option>
            <option value="urgent">Acil</option>
          </select>
        </div>
      </div>

      {/* GeliÅŸmiÅŸ Filtreler */}
      {showAdvanced && (
        <div className="border-t pt-6 mb-6">
          <div className="grid md:grid-cols-4 gap-6">
            {/* SÄ±ralama */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                SÄ±rala
              </label>
              <select
                value={filters.sortBy}
                onChange={(e) => setFilters({...filters, sortBy: e.target.value})}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg"
              >
                <option value="newest">En Yeni</option>
                <option value="oldest">En Eski</option>
                <option value="most_viewed">En Ã‡ok GÃ¶rÃ¼ntÃ¼lenen</option>
                <option value="most_helped">En Ã‡ok YardÄ±m Alan</option>
              </select>
            </div>

            {/* Fiyat AralÄ±ÄŸÄ± */}
            <div className="md:col-span-2">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Fiyat AralÄ±ÄŸÄ± (TL)
              </label>
              <div className="flex space-x-4">
                <input
                  type="number"
                  placeholder="Min"
                  value={filters.minPrice}
                  onChange={(e) => setFilters({...filters, minPrice: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                />
                <input
                  type="number"
                  placeholder="Max"
                  value={filters.maxPrice}
                  onChange={(e) => setFilters({...filters, maxPrice: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                />
              </div>
            </div>

            {/* Tarih AralÄ±ÄŸÄ± */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Zaman AralÄ±ÄŸÄ±
              </label>
              <select
                value={filters.dateRange}
                onChange={(e) => setFilters({...filters, dateRange: e.target.value})}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg"
              >
                <option value="all">TÃ¼m Zamanlar</option>
                <option value="today">BugÃ¼n</option>
                <option value="week">Bu Hafta</option>
                <option value="month">Bu Ay</option>
                <option value="3months">Son 3 Ay</option>
              </select>
            </div>
          </div>
        </div>
      )}

      {/* Butonlar */}
      <div className="flex justify-between items-center pt-6 border-t">
        <button
          onClick={resetFilters}
          className="text-gray-600 hover:text-gray-800 font-medium flex items-center"
        >
          <span className="mr-2">ğŸ—‘ï¸</span>
          TÃ¼m Filtreleri Temizle
        </button>
        
        <div className="flex space-x-4">
          {(showAdvanced || filters.minPrice || filters.maxPrice || filters.dateRange !== 'all' || filters.sortBy !== 'newest') && (
            <button
              onClick={applyFilters}
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-lg flex items-center"
            >
              <span className="mr-2">ğŸ”</span>
              Filtrele
            </button>
          )}
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ ShareButtons.tsx
ğŸ“Š 61 satÄ±r | 2.16 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleShareButtons.tsx
'use client'

import { useState } from 'react'

export default function SimpleShareButtons({ url, title }: { url: string, title: string }) {
  const [copied, setCopied] = useState(false)

  const currentUrl = typeof window !== 'undefined' ? window.location.origin + url : url
  
  const shareOnFacebook = () => {
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentUrl)}`, '_blank')
  }
  
  const shareOnWhatsApp = () => {
    window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(title + ' ' + currentUrl)}`, '_blank')
  }
  
  const copyToClipboard = async () => {
    try {
      await navigator.clipboard.writeText(currentUrl)
      setCopied(true)
      setTimeout(() => setCopied(false), 2000)
    } catch (err) {
      console.error('Kopyalama hatasÄ±:', err)
    }
  }

  return (
    <div className="bg-white rounded-xl shadow-md p-6">
      <h3 className="font-bold text-gray-900 mb-4">PaylaÅŸ</h3>
      <div className="flex flex-col sm:flex-row gap-3">
        <button
          onClick={shareOnFacebook}
          className="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">ğŸ“˜</span> Facebook
        </button>
        <button
          onClick={shareOnWhatsApp}
          className="flex-1 bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">ğŸ’š</span> WhatsApp
        </button>
        <button
          onClick={copyToClipboard}
          className="flex-1 bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">{copied ? 'âœ…' : 'ğŸ“‹'}</span> {copied ? 'KopyalandÄ±!' : 'Kopyala'}
        </button>
      </div>
      
      <div className="mt-4">
        <p className="text-sm text-gray-600 mb-2">Link:</p>
        <div className="bg-gray-100 p-3 rounded-lg text-sm break-all">
          {currentUrl}
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\ActiveSearches.tsx
ğŸ“Š 210 satÄ±r | 7.42 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ActiveSearches.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import Link from 'next/link'

interface ActiveSearchesProps {
  shopId: string
  showCreateButton?: boolean
  limit?: number
}

export default function ActiveSearches({ 
  shopId, 
  showCreateButton = true,
  limit = 6 
}: ActiveSearchesProps) {
  const [searches, setSearches] = useState<any[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchActiveSearches()
  }, [shopId])

  const fetchActiveSearches = async () => {
    try {
      const { data, error } = await supabase
        .from('shop_searches')
        .select('*')
        .eq('shop_id', shopId)
        .eq('status', 'active')
        .order('priority_level', { ascending: false })
        .order('created_at', { ascending: false })
        .limit(limit)

      if (error) throw error
      setSearches(data || [])
    } catch (error) {
      console.error('Aramalar yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getPriorityColor = (level: number) => {
    switch(level) {
      case 1: return 'bg-gray-100 text-gray-800'
      case 2: return 'bg-blue-100 text-blue-800'
      case 3: return 'bg-green-100 text-green-800'
      case 4: return 'bg-orange-100 text-orange-800'
      case 5: return 'bg-red-100 text-red-800'
      default: return 'bg-gray-100 text-gray-800'
    }
  }

  const getPriorityText = (level: number) => {
    switch(level) {
      case 1: return 'Ã‡ok DÃ¼ÅŸÃ¼k'
      case 2: return 'DÃ¼ÅŸÃ¼k'
      case 3: return 'Normal'
      case 4: return 'YÃ¼ksek'
      case 5: return 'Ã‡ok YÃ¼ksek'
      default: return 'BelirtilmemiÅŸ'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse space-y-4">
          <div className="h-6 bg-gray-200 rounded w-1/4"></div>
          {[...Array(3)].map((_, i) => (
            <div key={i} className="h-20 bg-gray-200 rounded-lg"></div>
          ))}
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow-lg">
      <div className="p-6 border-b">
        <div className="flex items-center justify-between">
          <div>
            <h3 className="text-lg font-bold text-gray-900">ğŸ” Aktif Aramalar</h3>
            <p className="text-sm text-gray-600">{searches.length} aktif arama</p>
          </div>
          {showCreateButton && (
            <Link
              href={`/shop/${shopId}/searches/new`}
              className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg text-sm"
            >
              + Yeni Arama
            </Link>
          )}
        </div>
      </div>

      {searches.length === 0 ? (
        <div className="p-8 text-center">
          <div className="text-4xl mb-4">ğŸ”</div>
          <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z aktif aramanÄ±z yok</h4>
          <p className="text-gray-600 mb-6">AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nleri listeleyin, otomatik eÅŸleÅŸmeleri bulalÄ±m</p>
          {showCreateButton && (
            <Link
              href={`/shop/${shopId}/searches/new`}
              className="btn-primary inline-block"
            >
              Ä°lk AramayÄ± OluÅŸturun
            </Link>
          )}
        </div>
      ) : (
        <div className="divide-y divide-gray-100">
          {searches.map((search) => (
            <div key={search.id} className="p-6 hover:bg-gray-50">
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <div className="flex items-center space-x-3 mb-2">
                    <span className={`px-3 py-1 rounded-full text-xs font-medium ${getPriorityColor(search.priority_level)}`}>
                      {getPriorityText(search.priority_level)}
                    </span>
                    <span className="text-sm text-gray-500">
                      {search.match_count || 0} eÅŸleÅŸme
                    </span>
                  </div>
                  
                  <h4 className="font-bold text-gray-900 mb-1">{search.title}</h4>
                  
                  {search.description && (
                    <p className="text-gray-600 text-sm line-clamp-2 mb-3">
                      {search.description}
                    </p>
                  )}

                  <div className="flex flex-wrap items-center gap-3 text-sm text-gray-500">
                    {search.category && (
                      <span className="bg-gray-100 px-2 py-1 rounded">
                        {search.category}
                      </span>
                    )}
                    {search.brand && (
                      <span className="flex items-center">
                        <span className="mr-1">ğŸ·ï¸</span>
                        {search.brand}
                      </span>
                    )}
                    {(search.min_price || search.max_price) && (
                      <span className="flex items-center">
                        <span className="mr-1">ğŸ’°</span>
                        {search.min_price || 0} - {search.max_price || 'âˆ'} TL
                      </span>
                    )}
                    {search.location && (
                      <span className="flex items-center">
                        <span className="mr-1">ğŸ“</span>
                        {search.location}
                      </span>
                    )}
                  </div>
                </div>

                <Link
                  href={`/shop/${shopId}/searches/${search.id}`}
                  className="ml-4 text-blue-600 hover:text-blue-800 text-sm font-medium whitespace-nowrap"
                >
                  Detay â†’
                </Link>
              </div>

              {/* Progress bar for days left */}
              {search.expire_date && (
                <div className="mt-4">
                  <div className="flex justify-between text-xs mb-1">
                    <span className="text-gray-600">
                      {Math.ceil((new Date(search.expire_date).getTime() - Date.now()) / (1000 * 60 * 60 * 24))} gÃ¼n kaldÄ±
                    </span>
                    <span className="font-medium">Sona eriyor: {new Date(search.expire_date).toLocaleDateString('tr-TR')}</span>
                  </div>
                  <div className="w-full bg-gray-200 rounded-full h-2">
                    <div 
                      className="h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-600"
                      style={{ 
                        width: `${Math.min(100, 
                          (1 - (new Date(search.expire_date).getTime() - Date.now()) / (30 * 24 * 60 * 60 * 1000)) * 100
                        )}%` 
                      }}
                    ></div>
                  </div>
                </div>
              )}
            </div>
          ))}
        </div>
      )}

      {searches.length > 0 && showCreateButton && (
        <div className="p-6 border-t text-center">
          <Link
            href={`/shop/${shopId}/searches`}
            className="text-blue-600 hover:text-blue-800 font-medium"
          >
            TÃ¼m AramalarÄ± GÃ¶r â†’
          </Link>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\CreateSearchForm.tsx
ğŸ“Š 1 satÄ±r | 0.00 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€



â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\InventoryGrid.tsx
ğŸ“Š 120 satÄ±r | 3.25 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/InventoryGrid.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import ProductCard from './ProductCard'

interface InventoryGridProps {
  shopId: string
  limit?: number
  showFilters?: boolean
}

export default function InventoryGrid({ 
  shopId, 
  limit = 12, 
  showFilters = false 
}: InventoryGridProps) {
  const [products, setProducts] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [filters, setFilters] = useState({
    category: '',
    minPrice: '',
    maxPrice: '',
    condition: '',
    sortBy: 'newest'
  })

  useEffect(() => {
    fetchProducts()
  }, [shopId, filters])

  const fetchProducts = async () => {
    setLoading(true)
    try {
      let query = supabase
        .from('shop_inventory')
        .select('*')
        .eq('shop_id', shopId)
        .eq('status', 'active')

      // Filtreler
      if (filters.category) {
        query = query.eq('category', filters.category)
      }
      if (filters.condition) {
        query = query.eq('condition', filters.condition)
      }
      if (filters.minPrice) {
        query = query.gte('price', parseFloat(filters.minPrice))
      }
      if (filters.maxPrice) {
        query = query.lte('price', parseFloat(filters.maxPrice))
      }

      // SÄ±ralama
      switch (filters.sortBy) {
        case 'price_low':
          query = query.order('price', { ascending: true })
          break
        case 'price_high':
          query = query.order('price', { ascending: false })
          break
        case 'popular':
          query = query.order('view_count', { ascending: false })
          break
        default:
          query = query.order('created_at', { ascending: false })
      }

      query = query.limit(limit)

      const { data, error } = await query

      if (error) throw error
      setProducts(data || [])
    } catch (error) {
      console.error('Products yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  // Geri kalan kod aynÄ±...
  return (
    <div>
      {/* Filtreler */}
      {showFilters && (
        <div className="mb-6 bg-white rounded-xl shadow p-4">
          {/* Filtre UI */}
        </div>
      )}

      {/* Grid */}
      {loading ? (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          {[...Array(limit)].map((_, i) => (
            <div key={i} className="animate-pulse bg-gray-200 rounded-xl h-64"></div>
          ))}
        </div>
      ) : products.length === 0 ? (
        <div className="text-center py-12">
          <div className="text-4xl mb-4">ğŸ“­</div>
          <h3 className="text-xl font-bold text-gray-900 mb-2">HenÃ¼z Ã¼rÃ¼n yok</h3>
          <p className="text-gray-600">Bu maÄŸaza henÃ¼z Ã¼rÃ¼n eklememiÅŸ</p>
        </div>
      ) : (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          {products.map((product) => (
            <ProductCard 
              key={product.id} 
              product={product} 
              shopId={shopId}
            />
          ))}
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\InventoryOverview.tsx
ğŸ“Š 188 satÄ±r | 6.55 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/InventoryOverview.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

interface InventoryOverviewProps {
  shopId: string
}

export default function InventoryOverview({ shopId }: InventoryOverviewProps) {
  const router = useRouter()
  const [inventory, setInventory] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [stats, setStats] = useState({
    active: 0,
    draft: 0,
    outOfStock: 0,
    total: 0
  })

  useEffect(() => {
    fetchInventory()
  }, [shopId])

  const fetchInventory = async () => {
    try {
      const { data } = await supabase
        .from('shop_inventory')
        .select('*')
        .eq('shop_id', shopId)
        .order('created_at', { ascending: false })
        .limit(5)

      const { count: activeCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'active')

      const { count: draftCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'draft')

      const { count: outOfStockCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'out_of_stock')

      const { count: totalCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)

      setInventory(data || [])
      setStats({
        active: activeCount || 0,
        draft: draftCount || 0,
        outOfStock: outOfStockCount || 0,
        total: totalCount || 0
      })
    } catch (error) {
      console.error('Inventory yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getStatusColor = (status: string) => {
    switch(status) {
      case 'active': return 'bg-green-100 text-green-800'
      case 'draft': return 'bg-gray-100 text-gray-800'
      case 'out_of_stock': return 'bg-red-100 text-red-800'
      default: return 'bg-gray-100 text-gray-800'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="space-y-3">
            {[...Array(3)].map((_, i) => (
              <div key={i} className="h-16 bg-gray-200 rounded"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex items-center justify-between mb-6">
        <h3 className="font-bold text-gray-900">ğŸ“¦ Envanter Ã–zeti</h3>
        <button
          onClick={() => router.push(`/shop/${shopId}/inventory`)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </button>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        <div className="text-center p-3 bg-blue-50 rounded-lg">
          <div className="text-xl font-bold text-blue-600">{stats.active}</div>
          <div className="text-sm text-gray-600">Aktif</div>
        </div>
        <div className="text-center p-3 bg-gray-50 rounded-lg">
          <div className="text-xl font-bold text-gray-600">{stats.draft}</div>
          <div className="text-sm text-gray-600">Taslak</div>
        </div>
        <div className="text-center p-3 bg-red-50 rounded-lg">
          <div className="text-xl font-bold text-red-600">{stats.outOfStock}</div>
          <div className="text-sm text-gray-600">Stok Yok</div>
        </div>
        <div className="text-center p-3 bg-green-50 rounded-lg">
          <div className="text-xl font-bold text-green-600">{stats.total}</div>
          <div className="text-sm text-gray-600">Toplam</div>
        </div>
      </div>

      {/* Recent Items */}
      <div className="space-y-3">
        {inventory.length === 0 ? (
          <div className="text-center py-8">
            <div className="text-4xl mb-4">ğŸ“­</div>
            <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z Ã¼rÃ¼n eklenmemiÅŸ</h4>
            <p className="text-gray-600 mb-4">Ä°lk Ã¼rÃ¼nÃ¼nÃ¼zÃ¼ ekleyerek baÅŸlayÄ±n</p>
            <button
              onClick={() => router.push(`/shop/${shopId}/inventory/new`)}
              className="btn-primary"
            >
              Ä°lk ÃœrÃ¼nÃ¼ Ekle
            </button>
          </div>
        ) : (
          <>
            {inventory.map((item) => (
              <div 
                key={item.id}
                className="flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg cursor-pointer"
                onClick={() => router.push(`/shop/${shopId}/inventory/${item.id}`)}
              >
                <div className="flex items-center space-x-3">
                  {item.images && item.images.length > 0 ? (
                    <div className="w-12 h-12 bg-gray-100 rounded-lg overflow-hidden">
                      <img
                        src={item.images[0]}
                        alt={item.title}
                        className="w-full h-full object-cover"
                      />
                    </div>
                  ) : (
                    <div className="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center">
                      <span className="text-gray-400">ğŸ“¦</span>
                    </div>
                  )}
                  
                  <div>
                    <h4 className="font-medium text-gray-900 line-clamp-1">
                      {item.title}
                    </h4>
                    <p className="text-sm text-gray-600">
                      {item.price.toLocaleString('tr-TR')} {item.currency}
                    </p>
                  </div>
                </div>
                
                <span className={`px-2 py-1 rounded text-xs font-medium ${getStatusColor(item.status)}`}>
                  {item.status === 'active' ? 'Aktif' : 
                   item.status === 'draft' ? 'Taslak' : 
                   item.status === 'out_of_stock' ? 'Stok Yok' : item.status}
                </span>
              </div>
            ))}
          </>
        )}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\mobile\InventoryOverview.tsx
ğŸ“Š 188 satÄ±r | 6.55 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/InventoryOverview.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

interface InventoryOverviewProps {
  shopId: string
}

export default function InventoryOverview({ shopId }: InventoryOverviewProps) {
  const router = useRouter()
  const [inventory, setInventory] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [stats, setStats] = useState({
    active: 0,
    draft: 0,
    outOfStock: 0,
    total: 0
  })

  useEffect(() => {
    fetchInventory()
  }, [shopId])

  const fetchInventory = async () => {
    try {
      const { data } = await supabase
        .from('shop_inventory')
        .select('*')
        .eq('shop_id', shopId)
        .order('created_at', { ascending: false })
        .limit(5)

      const { count: activeCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'active')

      const { count: draftCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'draft')

      const { count: outOfStockCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)
        .eq('status', 'out_of_stock')

      const { count: totalCount } = await supabase
        .from('shop_inventory')
        .select('id', { count: 'exact', head: true })
        .eq('shop_id', shopId)

      setInventory(data || [])
      setStats({
        active: activeCount || 0,
        draft: draftCount || 0,
        outOfStock: outOfStockCount || 0,
        total: totalCount || 0
      })
    } catch (error) {
      console.error('Inventory yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getStatusColor = (status: string) => {
    switch(status) {
      case 'active': return 'bg-green-100 text-green-800'
      case 'draft': return 'bg-gray-100 text-gray-800'
      case 'out_of_stock': return 'bg-red-100 text-red-800'
      default: return 'bg-gray-100 text-gray-800'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="space-y-3">
            {[...Array(3)].map((_, i) => (
              <div key={i} className="h-16 bg-gray-200 rounded"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex items-center justify-between mb-6">
        <h3 className="font-bold text-gray-900">ğŸ“¦ Envanter Ã–zeti</h3>
        <button
          onClick={() => router.push(`/shop/${shopId}/inventory`)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </button>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        <div className="text-center p-3 bg-blue-50 rounded-lg">
          <div className="text-xl font-bold text-blue-600">{stats.active}</div>
          <div className="text-sm text-gray-600">Aktif</div>
        </div>
        <div className="text-center p-3 bg-gray-50 rounded-lg">
          <div className="text-xl font-bold text-gray-600">{stats.draft}</div>
          <div className="text-sm text-gray-600">Taslak</div>
        </div>
        <div className="text-center p-3 bg-red-50 rounded-lg">
          <div className="text-xl font-bold text-red-600">{stats.outOfStock}</div>
          <div className="text-sm text-gray-600">Stok Yok</div>
        </div>
        <div className="text-center p-3 bg-green-50 rounded-lg">
          <div className="text-xl font-bold text-green-600">{stats.total}</div>
          <div className="text-sm text-gray-600">Toplam</div>
        </div>
      </div>

      {/* Recent Items */}
      <div className="space-y-3">
        {inventory.length === 0 ? (
          <div className="text-center py-8">
            <div className="text-4xl mb-4">ğŸ“­</div>
            <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z Ã¼rÃ¼n eklenmemiÅŸ</h4>
            <p className="text-gray-600 mb-4">Ä°lk Ã¼rÃ¼nÃ¼nÃ¼zÃ¼ ekleyerek baÅŸlayÄ±n</p>
            <button
              onClick={() => router.push(`/shop/${shopId}/inventory/new`)}
              className="btn-primary"
            >
              Ä°lk ÃœrÃ¼nÃ¼ Ekle
            </button>
          </div>
        ) : (
          <>
            {inventory.map((item) => (
              <div 
                key={item.id}
                className="flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg cursor-pointer"
                onClick={() => router.push(`/shop/${shopId}/inventory/${item.id}`)}
              >
                <div className="flex items-center space-x-3">
                  {item.images && item.images.length > 0 ? (
                    <div className="w-12 h-12 bg-gray-100 rounded-lg overflow-hidden">
                      <img
                        src={item.images[0]}
                        alt={item.title}
                        className="w-full h-full object-cover"
                      />
                    </div>
                  ) : (
                    <div className="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center">
                      <span className="text-gray-400">ğŸ“¦</span>
                    </div>
                  )}
                  
                  <div>
                    <h4 className="font-medium text-gray-900 line-clamp-1">
                      {item.title}
                    </h4>
                    <p className="text-sm text-gray-600">
                      {item.price.toLocaleString('tr-TR')} {item.currency}
                    </p>
                  </div>
                </div>
                
                <span className={`px-2 py-1 rounded text-xs font-medium ${getStatusColor(item.status)}`}>
                  {item.status === 'active' ? 'Aktif' : 
                   item.status === 'draft' ? 'Taslak' : 
                   item.status === 'out_of_stock' ? 'Stok Yok' : item.status}
                </span>
              </div>
            ))}
          </>
        )}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\mobile\QuickActions.tsx
ğŸ“Š 101 satÄ±r | 3.15 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/QuickActions.tsx
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'

interface QuickActionsProps {
  shopId: string
  onActionComplete?: () => void
}

export default function QuickActions({ shopId, onActionComplete }: QuickActionsProps) {
  const router = useRouter()
  const [loadingAction, setLoadingAction] = useState<string | null>(null)

  const actions = [
    {
      id: 'add-product',
      label: 'ÃœrÃ¼n Ekle',
      description: 'Yeni Ã¼rÃ¼nÃ¼ envantere ekle',
      icon: 'ğŸ“¦',
      color: 'blue',
      action: () => router.push(`/shop/${shopId}/inventory/new`)
    },
    {
      id: 'create-search',
      label: 'Arama OluÅŸtur',
      description: 'AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼ tanÄ±mlayÄ±n',
      icon: 'ğŸ”',
      color: 'green',
      action: () => router.push(`/shop/${shopId}/searches/new`)
    },
    {
      id: 'social-post',
      label: 'PaylaÅŸÄ±m Yap',
      description: 'MÃ¼ÅŸterilerle etkileÅŸim kurun',
      icon: 'ğŸ“¢',
      color: 'purple',
      action: () => router.push(`/shop/${shopId}/social/new`)
    },
    {
      id: 'view-analytics',
      label: 'Analizleri GÃ¶r',
      description: 'Performans istatistikleri',
      icon: 'ğŸ“Š',
      color: 'orange',
      action: () => router.push(`/shop/${shopId}/analytics`)
    }
  ]

  const handleAction = async (actionId: string, action: () => void) => {
    setLoadingAction(actionId)
    try {
      action()
      if (onActionComplete) {
        setTimeout(() => onActionComplete(), 500)
      }
    } catch (error) {
      console.error('Action failed:', error)
    } finally {
      setLoadingAction(null)
    }
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <h3 className="font-bold text-gray-900 mb-6">ğŸš€ HÄ±zlÄ± Ä°ÅŸlemler</h3>
      
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {actions.map((action) => (
          <button
            key={action.id}
            onClick={() => handleAction(action.id, action.action)}
            disabled={loadingAction === action.id}
            className={`p-4 rounded-xl border-2 text-left transition-all duration-200 hover:shadow-md ${
              loadingAction === action.id
                ? 'opacity-50 cursor-not-allowed'
                : 'hover:border-blue-300'
            }`}
          >
            <div className="flex items-start space-x-3">
              <div className={`text-2xl bg-${action.color}-100 text-${action.color}-600 p-3 rounded-lg`}>
                {action.icon}
              </div>
              <div>
                <h4 className="font-bold text-gray-900">{action.label}</h4>
                <p className="text-sm text-gray-600 mt-1">{action.description}</p>
              </div>
            </div>
            
            {loadingAction === action.id && (
              <div className="mt-3 text-center">
                <div className="inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"></div>
              </div>
            )}
          </button>
        ))}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\mobile\ShopMobileActions.tsx
ğŸ“Š 20 satÄ±r | 0.54 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/mobile/ShopMobileActions.tsx
export default function ShopMobileActions({ 
  shopId,
  onContact,
  onFollow,
  onShare 
}: { 
  shopId: string,
  onContact: () => void,
  onFollow: () => void,
  onShare: () => void 
}) {
  return (
    <div className="fixed bottom-0 left-0 right-0 bg-white border-t p-4 flex justify-around">
      <button onClick={onContact}>ğŸ’¬ Ä°letiÅŸim</button>
      <button onClick={onFollow}>â¤ï¸ Takip</button>
      <button onClick={onShare}>ğŸ“¤ PaylaÅŸ</button>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\mobile\ShopMobileHeader.tsx
ğŸ“Š 37 satÄ±r | 1.11 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/mobile/ShopMobileHeader.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

interface ShopMobileHeaderProps {
  shopId: string
  activeView: 'products' | 'searches' | 'info'
  onViewChange: (view: 'products' | 'searches' | 'info') => void
}

export default function ShopMobileHeader({ 
  shopId, 
  activeView, 
  onViewChange 
}: ShopMobileHeaderProps) {
  // Geri kalan kod aynÄ±...
  return (
    <div className="fixed top-0 left-0 right-0 bg-white border-b z-40">
      {/* Header iÃ§eriÄŸi */}
      <div className="flex justify-around py-3">
        {(['products', 'searches', 'info'] as const).map((view) => (
          <button
            key={view}
            onClick={() => onViewChange(view)}
            className={`px-4 py-2 font-medium ${
              activeView === view 
                ? 'text-blue-600 border-b-2 border-blue-600' 
                : 'text-gray-600'
            }`}
          >
            {view === 'products' ? 'ğŸ“¦ ÃœrÃ¼nler' :
             view === 'searches' ? 'ğŸ” Aramalar' : 'â„¹ï¸ Bilgi'}
          </button>
        ))}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\mobile\ShopMobileProducts.tsx
ğŸ“Š 4 satÄ±r | 0.19 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/mobile/ShopMobileProducts.tsx
export default function ShopMobileProducts({ shopId }: { shopId: string }) {
  return <div className="p-4">ÃœrÃ¼nler yÃ¼kleniyor...</div>
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\mobile\ShopMobileSearches.tsx
ğŸ“Š 4 satÄ±r | 0.19 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/mobile/ShopMobileSearches.tsx
export default function ShopMobileSearches({ shopId }: { shopId: string }) {
  return <div className="p-4">Aramalar yÃ¼kleniyor...</div>
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\mobile\ShopMobileView.tsx
ğŸ“Š 42 satÄ±r | 1.33 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/mobile/ShopMobileView.tsx
'use client'

import { useState } from 'react'
import ShopMobileHeader from './ShopMobileHeader'
import ShopMobileProducts from './ShopMobileProducts'
import ShopMobileSearches from './ShopMobileSearches'
import ShopMobileActions from './ShopMobileActions'

export default function ShopMobileView({ shopId }: { shopId: string }) {
  const [activeView, setActiveView] = useState<'products' | 'searches' | 'info'>('products')

  return (
    <div className="md:hidden">
      {/* Fixed Header */}
      <ShopMobileHeader 
        shopId={shopId}
        activeView={activeView}
        onViewChange={setActiveView}
      />

      {/* Content */}
      <div className="pt-16 pb-20"> {/* Header ve bottom nav iÃ§in padding */}
        {activeView === 'products' && <ShopMobileProducts shopId={shopId} />}
        {activeView === 'searches' && <ShopMobileSearches shopId={shopId} />}
        {activeView === 'info' && (
          <div className="p-4">
            {/* Shop info */}
          </div>
        )}
      </div>

      {/* Fixed Bottom Actions */}
      <ShopMobileActions 
        shopId={shopId}
        onContact={() => console.log('contact')}
        onFollow={() => console.log('follow')}
        onShare={() => console.log('share')}
      />
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\ProductCard.tsx
ğŸ“Š 128 satÄ±r | 4.39 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ProductCard.tsx
'use client'

import { useState } from 'react'
import Link from 'next/link'

interface ProductCardProps {
  product: {
    id: string
    title: string
    description?: string
    price: number
    currency: string
    images: string[]
    condition: string
    location?: string
    view_count: number
    created_at: string
  }
  shopId: string
}

export default function ProductCard({ product, shopId }: ProductCardProps) {
  const [imageLoaded, setImageLoaded] = useState(false)

  const getConditionText = (condition: string) => {
    const conditions: Record<string, string> = {
      'new': 'Yeni',
      'like_new': 'Yeni Gibi',
      'used_good': 'Ä°yi Durumda',
      'used_fair': 'Orta Durumda',
      'for_parts': 'ParÃ§a Ä°Ã§in'
    }
    return conditions[condition] || condition
  }

  const getConditionColor = (condition: string) => {
    const colors: Record<string, string> = {
      'new': 'bg-green-100 text-green-800',
      'like_new': 'bg-blue-100 text-blue-800',
      'used_good': 'bg-yellow-100 text-yellow-800',
      'used_fair': 'bg-orange-100 text-orange-800',
      'for_parts': 'bg-red-100 text-red-800'
    }
    return colors[condition] || 'bg-gray-100 text-gray-800'
  }

  return (
    <Link href={`/shop/${shopId}/products/${product.id}`}>
      <div className="bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden group cursor-pointer">
        {/* Image */}
        <div className="relative h-48 bg-gray-100 overflow-hidden">
          {product.images && product.images.length > 0 ? (
            <>
              <img
                src={product.images[0]}
                alt={product.title}
                className={`w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 ${
                  imageLoaded ? 'opacity-100' : 'opacity-0'
                }`}
                onLoad={() => setImageLoaded(true)}
              />
              {!imageLoaded && (
                <div className="absolute inset-0 flex items-center justify-center">
                  <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                </div>
              )}
            </>
          ) : (
            <div className="w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200">
              <div className="text-center">
                <span className="text-3xl text-gray-400">ğŸ“¦</span>
                <p className="text-sm text-gray-500 mt-2">Resim Yok</p>
              </div>
            </div>
          )}
          
          {/* Condition badge */}
          <div className="absolute top-3 left-3">
            <span className={`px-2 py-1 rounded-full text-xs font-medium ${getConditionColor(product.condition)}`}>
              {getConditionText(product.condition)}
            </span>
          </div>
          
          {/* View count */}
          {product.view_count > 0 && (
            <div className="absolute top-3 right-3 bg-black bg-opacity-60 text-white px-2 py-1 rounded-full text-xs">
              ğŸ‘ï¸ {product.view_count}
            </div>
          )}
        </div>

        {/* Content */}
        <div className="p-4">
          <h3 className="font-bold text-gray-900 mb-2 line-clamp-1 group-hover:text-blue-600">
            {product.title}
          </h3>
          
          {product.description && (
            <p className="text-gray-600 text-sm mb-3 line-clamp-2">
              {product.description}
            </p>
          )}

          <div className="flex items-center justify-between">
            <div className="font-bold text-lg text-gray-900">
              {product.price.toLocaleString('tr-TR')} {product.currency}
            </div>
            
            {product.location && (
              <div className="text-sm text-gray-500 flex items-center">
                <span className="mr-1">ğŸ“</span>
                {product.location.split(',')[0]}
              </div>
            )}
          </div>

          {/* Timestamp */}
          <div className="mt-3 pt-3 border-t border-gray-100">
            <p className="text-xs text-gray-500">
              {new Date(product.created_at).toLocaleDateString('tr-TR')}
            </p>
          </div>
        </div>
      </div>
    </Link>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\QuickActions.tsx
ğŸ“Š 109 satÄ±r | 3.48 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/QuickActions.tsx
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { supabase } from '@/lib/supabase';
import { Plus, Search, Share2, BarChart, Loader2 } from 'lucide-react';

interface QuickActionsProps {
  shopId: string;
  onActionComplete?: () => void;
}

export default function QuickActions({ shopId, onActionComplete }: QuickActionsProps) {
  const router = useRouter();
  const [loading, setLoading] = useState<string | null>(null);

  const actions = [
    {
      id: 'add-product',
      title: 'ÃœrÃ¼n Ekle',
      description: 'SatÄ±ÅŸa sunacaÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼ envantere ekleyin',
      icon: <Plus size={24} />,
      color: 'bg-green-100 text-green-700 hover:bg-green-200',
      path: `/shop/${shopId}/inventory/add`
    },
    {
      id: 'create-search',
      title: 'Arama OluÅŸtur',
      description: 'AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nleri belirleyin',
      icon: <Search size={24} />,
      color: 'bg-blue-100 text-blue-700 hover:bg-blue-200',
      path: `/shop/${shopId}/searches/add`
    },
    {
      id: 'create-post',
      title: 'PaylaÅŸÄ±m Yap',
      description: 'MaÄŸazanÄ±zÄ± tanÄ±tan iÃ§erik paylaÅŸÄ±n',
      icon: <Share2 size={24} />,
      color: 'bg-purple-100 text-purple-700 hover:bg-purple-200',
      path: `/shop/${shopId}/social/create`
    },
    {
      id: 'get-report',
      title: 'Rapor Al',
      description: 'Performans raporlarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin',
      icon: <BarChart size={24} />,
      color: 'bg-orange-100 text-orange-700 hover:bg-orange-200',
      path: `/shop/${shopId}/analytics`
    }
  ];

  const handleAction = async (action: typeof actions[0]) => {
    setLoading(action.id);
    
    try {
      // EÄŸer yol varsa yÃ¶nlendir
      if (action.path) {
        router.push(action.path);
      }
      
      // Callback Ã§aÄŸÄ±r
      if (onActionComplete) {
        setTimeout(() => {
          onActionComplete();
        }, 500);
      }
    } catch (error) {
      console.error(`${action.title} iÅŸlemi baÅŸarÄ±sÄ±z:`, error);
      alert(`${action.title} iÅŸlemi sÄ±rasÄ±nda bir hata oluÅŸtu.`);
    } finally {
      setLoading(null);
    }
  };

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex justify-between items-center mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">âš¡ HÄ±zlÄ± Eylemler</h3>
          <p className="text-gray-600 text-sm">MaÄŸazanÄ±zÄ± hÄ±zlÄ±ca yÃ¶netin</p>
        </div>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {actions.map((action) => (
          <button
            key={action.id}
            onClick={() => handleAction(action)}
            disabled={loading === action.id}
            className={`p-4 rounded-xl border ${action.color} transition-all duration-200 flex flex-col items-center justify-center h-full min-h-[140px] disabled:opacity-50`}
          >
            <div className="mb-3">
              {loading === action.id ? (
                <Loader2 size={24} className="animate-spin" />
              ) : (
                action.icon
              )}
            </div>
            <div className="text-center">
              <h4 className="font-bold mb-1">{action.title}</h4>
              <p className="text-xs opacity-90">{action.description}</p>
            </div>
          </button>
        ))}
      </div>
    </div>
  );
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\RecentMatches.tsx
ğŸ“Š 167 satÄ±r | 5.84 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/RecentMatches.tsx - DÃœZELTÄ°LMÄ°Å VERSÄ°YON
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

interface RecentMatchesProps {
  shopId: string
  limit?: number
}

export default function RecentMatches({ shopId, limit = 5 }: RecentMatchesProps) {
  const router = useRouter()
  const [matches, setMatches] = useState<any[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchRecentMatches()
  }, [shopId])

  const fetchRecentMatches = async () => {
    try {
      const { data } = await supabase
        .from('shop_search_matches')
        .select(`
          *,
          search:shop_searches(*),
          inventory:shop_inventory(*),
          spot:spots(*)
        `)
        .eq('search_id', shopId)
        .order('created_at', { ascending: false })
        .limit(limit)

      setMatches(data || [])
    } catch (error) {
      console.error('Recent matches yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getMatchType = (match: any) => {
    if (match.inventory_id) return 'inventory'
    if (match.spot_id) return 'spot'
    return 'unknown'
  }

  const getMatchSource = (match: any) => {
    if (match.inventory) return 'BaÅŸka MaÄŸaza'
    if (match.spot) return 'KullanÄ±cÄ± Spot\'u'
    return 'Bilinmeyen'
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="space-y-3">
            {[...Array(limit)].map((_, i) => (
              <div key={i} className="h-16 bg-gray-200 rounded"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  if (matches.length === 0) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <h3 className="font-bold text-gray-900 mb-6">âœ… Son EÅŸleÅŸmeler</h3>
        <div className="text-center py-8">
          <div className="text-4xl mb-4">ğŸ¤</div>
          <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z eÅŸleÅŸme yok</h4>
          <p className="text-gray-600">
            Arama oluÅŸturduÄŸunuzda eÅŸleÅŸmeler burada gÃ¶rÃ¼necek
          </p>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <div className="flex items-center justify-between mb-6">
        <h3 className="font-bold text-gray-900">âœ… Son EÅŸleÅŸmeler</h3>
        <button
          onClick={() => router.push(`/shop/${shopId}/matches`)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </button>
      </div>

      <div className="space-y-4">
        {matches.map((match) => (
          <div 
            key={match.id}
            className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"
            onClick={() => {
              if (match.inventory_id) {
                router.push(`/shop/${shopId}/matches/inventory/${match.inventory_id}`)
              } else if (match.spot_id) {
                router.push(`/spots/${match.spot_id}`)
              }
            }}
          >
            <div className="flex-1">
              <div className="flex items-center space-x-3 mb-2">
                <div className={`w-10 h-10 rounded-full flex items-center justify-center ${
                  match.match_score >= 80 ? 'bg-green-100 text-green-600' :
                  match.match_score >= 60 ? 'bg-yellow-100 text-yellow-600' :
                  'bg-blue-100 text-blue-600'
                }`}>
                  {match.match_score >= 80 ? 'ğŸ”¥' :
                   match.match_score >= 60 ? 'âœ…' : 'ğŸ”'}
                </div>
                <div>
                  <h4 className="font-medium text-gray-900">
                    {match.search?.title || 'Arama'}
                  </h4>
                  <p className="text-sm text-gray-600">
                    {getMatchSource(match)} â€¢ %{match.match_score} eÅŸleÅŸme
                  </p>
                </div>
              </div>

              {match.match_reasons && match.match_reasons.length > 0 && (
                <div className="flex flex-wrap gap-2 mt-2">
                  {match.match_reasons.slice(0, 3).map((reason: string, idx: number) => (
                    <span key={idx} className="px-2 py-1 bg-white text-gray-700 text-xs rounded-full border">
                      {reason}
                    </span>
                  ))}
                  {match.match_reasons.length > 3 && (
                    <span className="px-2 py-1 bg-white text-gray-500 text-xs rounded-full border">
                      +{match.match_reasons.length - 3}
                    </span>
                  )}
                </div>
              )}
            </div>

            <div className="text-right">
              <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                match.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :
                match.status === 'notified' ? 'bg-blue-100 text-blue-800' :
                match.status === 'contacted' ? 'bg-green-100 text-green-800' :
                'bg-gray-100 text-gray-800'
              }`}>
                {match.status === 'pending' ? 'Bekliyor' :
                 match.status === 'notified' ? 'Bildirildi' :
                 match.status === 'contacted' ? 'Ä°letiÅŸimde' : match.status}
              </span>
              <div className="text-xs text-gray-500 mt-1">
                {new Date(match.created_at).toLocaleDateString('tr-TR')}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\SearchOverview.tsx
ğŸ“Š 242 satÄ±r | 8.82 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/SearchOverview.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

interface SearchOverviewProps {
  shopId: string
}

// Arama verisi tipini tanÄ±mla
interface SearchItem {
  id: string
  title: string
  category?: string
  brand?: string
  min_price?: number
  max_price?: number
  priority_level: number
  status: string
  created_at: string
  matches?: Array<{ count: number }>
}

export default function SearchOverview({ shopId }: SearchOverviewProps) {
  const router = useRouter()
  const [searches, setSearches] = useState<SearchItem[]>([])
  const [stats, setStats] = useState({
    active: 0,
    totalMatches: 0,
    highPriority: 0,
    recentMatches: 0
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchSearchesData()
  }, [shopId])

  const fetchSearchesData = async () => {
    try {
      // Aktif aramalarÄ± getir
      const { data: searchesData, error } = await supabase
        .from('shop_searches')
        .select('*, matches:shop_search_matches(count)')
        .eq('shop_id', shopId)
        .eq('status', 'active')
        .order('priority_level', { ascending: false })
        .order('created_at', { ascending: false })
        .limit(5)

      if (error) throw error

      // Ä°statistikleri hesapla - DÃœZELTÄ°LDÄ°: 's' parametresine tip eklendi
      const activeSearches = searchesData?.length || 0
      const highPriority = searchesData?.filter((s: SearchItem) => s.priority_level >= 4).length || 0
      
      // Toplam eÅŸleÅŸme sayÄ±sÄ±nÄ± hesapla - DÃœZELTÄ°LDÄ°: search_id yerine shop_id kontrol et
      const { count: totalMatchesCount } = await supabase
        .from('shop_search_matches')
        .select('*', { count: 'exact', head: true })
        .eq('search.shop_id', shopId) // DÃ¼zeltildi: search.shop_id kontrolÃ¼

      // Son 7 gÃ¼ndeki eÅŸleÅŸmeler
      const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()
      const { count: recentMatchesCount } = await supabase
        .from('shop_search_matches')
        .select('*', { count: 'exact', head: true })
        .eq('search.shop_id', shopId) // DÃ¼zeltildi: search.shop_id kontrolÃ¼
        .gte('created_at', weekAgo)

      setSearches(searchesData || [])
      setStats({
        active: activeSearches,
        totalMatches: totalMatchesCount || 0,
        highPriority,
        recentMatches: recentMatchesCount || 0
      })
    } catch (error) {
      console.error('Arama verileri yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getPriorityColor = (level: number) => {
    switch(level) {
      case 5: return 'bg-red-100 text-red-800'
      case 4: return 'bg-orange-100 text-orange-800'
      case 3: return 'bg-green-100 text-green-800'
      case 2: return 'bg-blue-100 text-blue-800'
      case 1: return 'bg-gray-100 text-gray-800'
      default: return 'bg-gray-100 text-gray-800'
    }
  }

  const getPriorityText = (level: number) => {
    switch(level) {
      case 5: return 'Ã‡OK ACÄ°L'
      case 4: return 'ACÄ°L'
      case 3: return 'NORMAL'
      case 2: return 'DÃœÅÃœK'
      case 1: return 'Ã‡OK DÃœÅÃœK'
      default: return 'BELÄ°RSÄ°Z'
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="h-4 bg-gray-200 rounded w-1/2 mb-6"></div>
          <div className="space-y-4">
            {[...Array(3)].map((_, i) => (
              <div key={i} className="h-16 bg-gray-200 rounded-lg"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      {/* Header */}
      <div className="flex items-center justify-between mb-6">
        <div>
          <h3 className="text-lg font-bold text-gray-900">ğŸ” Aktif Aramalar</h3>
          <p className="text-sm text-gray-600">{stats.active} aktif arama</p>
        </div>
        <button
          onClick={() => router.push(`/shop/${shopId}/searches`)}
          className="text-blue-600 hover:text-blue-800 text-sm font-medium"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r â†’
        </button>
      </div>

      {/* Ä°statistikler */}
      <div className="grid grid-cols-2 gap-4 mb-6">
        <div className="bg-blue-50 rounded-lg p-4 text-center">
          <div className="text-2xl font-bold text-blue-700">{stats.active}</div>
          <div className="text-sm text-blue-600">Aktif Arama</div>
        </div>
        <div className="bg-green-50 rounded-lg p-4 text-center">
          <div className="text-2xl font-bold text-green-700">{stats.totalMatches}</div>
          <div className="text-sm text-green-600">Toplam EÅŸleÅŸme</div>
        </div>
        <div className="bg-orange-50 rounded-lg p-4 text-center">
          <div className="text-2xl font-bold text-orange-700">{stats.highPriority}</div>
          <div className="text-sm text-orange-600">Acil Arama</div>
        </div>
        <div className="bg-purple-50 rounded-lg p-4 text-center">
          <div className="text-2xl font-bold text-purple-700">{stats.recentMatches}</div>
          <div className="text-sm text-purple-600">Son 7 GÃ¼n</div>
        </div>
      </div>

      {/* Aramalar Listesi */}
      <div className="space-y-4">
        {searches.length === 0 ? (
          <div className="text-center py-8">
            <div className="text-4xl mb-4">ğŸ”</div>
            <p className="text-gray-600 mb-4">HenÃ¼z aktif aramanÄ±z yok</p>
            <button
              onClick={() => router.push(`/shop/${shopId}/searches/new`)}
              className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
            >
              Ä°lk Arama OluÅŸtur
            </button>
          </div>
        ) : (
          searches.map((search) => (
            <div 
              key={search.id}
              className="border border-gray-200 rounded-lg p-4 hover:border-blue-300 cursor-pointer"
              onClick={() => router.push(`/shop/${shopId}/searches/${search.id}`)}
            >
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <h4 className="font-medium text-gray-900 mb-1 line-clamp-1">
                    {search.title}
                  </h4>
                  <div className="flex items-center space-x-3 text-sm text-gray-600">
                    <span>{search.category}</span>
                    {search.brand && <span>â€¢ {search.brand}</span>}
                    {search.min_price && search.max_price && (
                      <span>â€¢ {search.min_price} - {search.max_price} â‚º</span>
                    )}
                  </div>
                </div>
                
                <div className="flex items-center space-x-3">
                  <div className="text-right">
                    <div className="font-bold text-gray-900">
                      {search.matches?.[0]?.count || 0}
                    </div>
                    <div className="text-xs text-gray-500">eÅŸleÅŸme</div>
                  </div>
                  
                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${getPriorityColor(search.priority_level)}`}>
                    {getPriorityText(search.priority_level)}
                  </span>
                </div>
              </div>
              
              {/* Match progress bar */}
              <div className="mt-3">
                <div className="flex justify-between text-xs mb-1">
                  <span className="text-gray-600">EÅŸleÅŸme oranÄ±</span>
                  <span className="font-medium">
                    {Math.round(((search.matches?.[0]?.count || 0) / 10) * 100)}%
                  </span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div 
                    className="bg-green-500 h-2 rounded-full"
                    style={{ 
                      width: `${Math.min(100, ((search.matches?.[0]?.count || 0) / 10) * 100)}%` 
                    }}
                  ></div>
                </div>
              </div>
            </div>
          ))
        )}
      </div>

      {/* Yeni arama butonu */}
      <div className="mt-6 pt-6 border-t">
        <button
          onClick={() => router.push(`/shop/${shopId}/searches/new`)}
          className="w-full py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-400 hover:text-blue-600"
        >
          + Yeni Arama OluÅŸtur
        </button>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\ShopDashboard.tsx
ğŸ“Š 251 satÄ±r | 8.08 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopDashboard.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'
import ShopStats from './ShopStats'
import RecentMatches from './RecentMatches'
import QuickActions from './QuickActions'
import InventoryOverview from './InventoryOverview'
import SearchOverview from './SearchOverview'

interface ShopDashboardProps {
  shopId: string
}

// Revenue data iÃ§in interface
interface RevenueData {
  revenue: number
  [key: string]: any // DiÄŸer field'lar iÃ§in
}

// Stats interface
interface ShopStatsData {
  totalProducts: number
  activeSearches: number
  totalMatches: number
  pendingMatches: number
  totalFollowers: number
  revenue: number
}

// Shop interface
interface Shop {
  id: string
  shop_name: string
  city: string
  subscription_type: 'free' | 'premium'
  is_verified: boolean
  [key: string]: any // DiÄŸer field'lar iÃ§in
}

export default function ShopDashboard({ shopId }: ShopDashboardProps) {
  const router = useRouter()
  const [shop, setShop] = useState<Shop | null>(null)
  const [loading, setLoading] = useState(true)
  const [stats, setStats] = useState<ShopStatsData>({
    totalProducts: 0,
    activeSearches: 0,
    totalMatches: 0,
    pendingMatches: 0,
    totalFollowers: 0,
    revenue: 0
  })

  useEffect(() => {
    fetchShopData()
  }, [shopId])

  const fetchShopData = async () => {
    try {
      // MaÄŸaza bilgileri
      const { data: shopData } = await supabase
        .from('shops')
        .select('*')
        .eq('id', shopId)
        .single()

      // Ä°statistikler (paralel olarak)
      const [
        { count: productCount },
        { count: searchCount },
        { count: matchCount },
        { count: pendingMatchCount },
        { count: followerCount },
        { data: revenueData }
      ] = await Promise.all([
        supabase
          .from('shop_inventory')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('status', 'active'),
        supabase
          .from('shop_searches')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('status', 'active'),
        supabase
          .from('shop_search_matches')
          .select('count', { count: 'exact', head: true })
          .eq('search_id', shopId),
        supabase
          .from('shop_search_matches')
          .select('count', { count: 'exact', head: true })
          .eq('search_id', shopId)
          .eq('status', 'pending'),
        supabase
          .from('shop_customer_relationships')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('relationship_type', 'follower'),
        supabase
          .from('shop_analytics_daily')
          .select('revenue')
          .eq('shop_id', shopId)
          .gte('date', new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString())
      ])

      // DÃœZELTÄ°LMÄ°Å KISIM - Type ekledik
      const totalRevenue = revenueData?.reduce((sum: number, day: RevenueData) => 
        sum + (day.revenue || 0), 0) || 0

      if (shopData) {
        setShop(shopData as Shop)
      }

      setStats({
        totalProducts: productCount || 0,
        activeSearches: searchCount || 0,
        totalMatches: matchCount || 0,
        pendingMatches: pendingMatchCount || 0,
        totalFollowers: followerCount || 0,
        revenue: totalRevenue
      })
    } catch (error) {
      console.error('MaÄŸaza verileri yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  if (loading) {
    return (
      <div className="animate-pulse space-y-6">
        <div className="h-8 bg-gray-200 rounded w-1/4"></div>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {[...Array(6)].map((_, i) => (
            <div key={i} className="h-32 bg-gray-200 rounded-xl"></div>
          ))}
        </div>
      </div>
    )
  }

  if (!shop) {
    return (
      <div className="text-center py-12">
        <div className="text-4xl mb-4">ğŸª</div>
        <h3 className="text-xl font-bold text-gray-900 mb-2">MaÄŸaza bulunamadÄ±</h3>
        <p className="text-gray-600 mb-6">Bu maÄŸaza mevcut deÄŸil veya silinmiÅŸ</p>
        <button
          onClick={() => router.push('/for-business')}
          className="btn-primary"
        >
          Yeni MaÄŸaza AÃ§
        </button>
      </div>
    )
  }

  return (
    <div className="space-y-8">
      {/* Header */}
      <div className="flex items-start justify-between">
        <div>
          <h1 className="text-3xl font-bold text-gray-900">{shop.shop_name}</h1>
          <p className="text-gray-600">
            {shop.city} â€¢ {shop.subscription_type === 'free' ? 'Ãœcretsiz' : 'Premium'} MaÄŸaza
          </p>
        </div>
        <div className="flex items-center space-x-4">
          <span className={`px-4 py-2 rounded-full text-sm font-medium ${
            shop.is_verified 
              ? 'bg-green-100 text-green-800' 
              : 'bg-yellow-100 text-yellow-800'
          }`}>
            {shop.is_verified ? 'âœ… DoÄŸrulanmÄ±ÅŸ' : 'ğŸ” DoÄŸrulanmadÄ±'}
          </span>
          <button
            onClick={() => router.push(`/shop/${shop.id}/edit`)}
            className="btn-secondary"
          >
            MaÄŸazayÄ± DÃ¼zenle
          </button>
        </div>
      </div>

      {/* HÄ±zlÄ± Ä°statistikler */}
      <ShopStats stats={stats} shopId={shopId} />

      {/* HÄ±zlÄ± Aksiyonlar */}
      <QuickActions 
        shopId={shopId}
        onActionComplete={fetchShopData}
      />

      {/* Grid Layout */}
      <div className="grid lg:grid-cols-2 gap-8">
        {/* Sol Kolon */}
        <div className="space-y-8">
          {/* Son EÅŸleÅŸmeler */}
          <RecentMatches shopId={shopId} />
          
          {/* Stok Ã–zeti */}
          <InventoryOverview shopId={shopId} />
        </div>

        {/* SaÄŸ Kolon */}
        <div className="space-y-8">
          {/* Arama Ã–zeti */}
          <SearchOverview shopId={shopId} />
          
          {/* HÄ±zlÄ± BaÄŸlantÄ±lar */}
          <div className="bg-white rounded-xl shadow p-6">
            <h3 className="font-bold text-gray-900 mb-4">ğŸš€ HÄ±zlÄ± BaÄŸlantÄ±lar</h3>
            <div className="grid grid-cols-2 gap-4">
              <button
                onClick={() => router.push(`/shop/${shopId}/inventory/new`)}
                className="p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-400 text-center"
              >
                <div className="text-2xl mb-2">ğŸ“¦</div>
                <div className="font-medium">Yeni ÃœrÃ¼n Ekle</div>
              </button>
              <button
                onClick={() => router.push(`/shop/${shopId}/searches/new`)}
                className="p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-green-400 text-center"
              >
                <div className="text-2xl mb-2">ğŸ”</div>
                <div className="font-medium">Arama OluÅŸtur</div>
              </button>
              <button
                onClick={() => router.push(`/shop/${shopId}/social/new`)}
                className="p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-purple-400 text-center"
              >
                <div className="text-2xl mb-2">ğŸ“¢</div>
                <div className="font-medium">PaylaÅŸÄ±m Yap</div>
              </button>
              <button
                onClick={() => router.push(`/shop/${shopId}/analytics`)}
                className="p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-orange-400 text-center"
              >
                <div className="text-2xl mb-2">ğŸ“Š</div>
                <div className="font-medium">Analizleri GÃ¶r</div>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\ShopHeader.tsx
ğŸ“Š 113 satÄ±r | 3.85 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopHeader.tsx
'use client'

interface ShopHeaderProps {
  shop: any
  followersCount: number
  isFollowing: boolean
  onFollowToggle: () => void
  onContact: () => void
  onShare: () => void
}

export default function ShopHeader({
  shop,
  followersCount,
  isFollowing,
  onFollowToggle,
  onContact,
  onShare
}: ShopHeaderProps) {
  return (
    <div className="bg-white rounded-xl shadow-lg overflow-hidden mb-8">
      {/* Cover Image */}
      <div className="h-48 bg-gradient-to-r from-blue-500 to-purple-600 relative">
        {shop.cover_image ? (
          <img 
            src={shop.cover_image} 
            alt="Cover" 
            className="w-full h-full object-cover"
          />
        ) : (
          <div className="w-full h-full flex items-center justify-center">
            <span className="text-white text-4xl opacity-50">ğŸª</span>
          </div>
        )}
        
        {/* Verified Badge */}
        {shop.is_verified && (
          <div className="absolute top-4 right-4 bg-white text-green-600 px-3 py-1 rounded-full text-sm font-medium flex items-center">
            <span className="mr-1">âœ…</span>
            DoÄŸrulanmÄ±ÅŸ MaÄŸaza
          </div>
        )}
      </div>

      {/* Shop Info */}
      <div className="p-6">
        <div className="flex items-start justify-between">
          <div className="flex items-start space-x-6">
            {/* Avatar */}
            <div className="relative -mt-16">
              <div className="w-32 h-32 rounded-2xl border-4 border-white bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-4xl font-bold shadow-lg">
                {shop.shop_name?.[0] || 'M'}
              </div>
            </div>

            {/* Details */}
            <div className="pt-4">
              <h1 className="text-3xl font-bold text-gray-900">{shop.shop_name}</h1>
              <p className="text-gray-600 mt-2">{shop.description || 'AÃ§Ä±klama yok'}</p>
              
              <div className="flex items-center space-x-6 mt-4">
                <div className="flex items-center space-x-2">
                  <span className="text-gray-500">ğŸ“</span>
                  <span>{shop.city || 'Konum belirtilmemiÅŸ'}</span>
                </div>
                <div className="flex items-center space-x-2">
                  <span className="text-gray-500">ğŸ‘¥</span>
                  <span>{followersCount} takipÃ§i</span>
                </div>
                {shop.owner && (
                  <div className="flex items-center space-x-2">
                    <span className="text-gray-500">ğŸ‘¤</span>
                    <span>{shop.owner.name || 'MaÄŸaza sahibi'}</span>
                  </div>
                )}
              </div>
            </div>
          </div>

          {/* Actions */}
          <div className="flex items-center space-x-3">
            <button
              onClick={onFollowToggle}
              className={`px-6 py-3 rounded-lg font-medium ${
                isFollowing
                  ? 'bg-gray-100 text-gray-800 hover:bg-gray-200'
                  : 'bg-blue-600 text-white hover:bg-blue-700'
              }`}
            >
              {isFollowing ? 'âœ“ Takip Ediliyor' : 'ğŸ‘¥ Takip Et'}
            </button>
            
            <button
              onClick={onContact}
              className="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium"
            >
              ğŸ“ Ä°letiÅŸim
            </button>
            
            <button
              onClick={onShare}
              className="p-3 bg-gray-100 hover:bg-gray-200 rounded-lg"
              title="PaylaÅŸ"
            >
              ğŸ“¤
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\ShopSocialFeed.tsx
ğŸ“Š 265 satÄ±r | 9.36 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopSocialFeed.tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import Link from 'next/link'

interface ShopSocialFeedProps {
  shopId: string
  limit?: number
  compact?: boolean
}

export default function ShopSocialFeed({ 
  shopId, 
  limit = 9,
  compact = false 
}: ShopSocialFeedProps) {
  const [posts, setPosts] = useState<any[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchSocialPosts()
  }, [shopId])

  const fetchSocialPosts = async () => {
    try {
      const { data, error } = await supabase
        .from('shop_social_posts')
        .select('*')
        .eq('shop_id', shopId)
        .eq('status', 'published')
        .order('publish_at', { ascending: false })
        .limit(limit)

      if (error) throw error
      setPosts(data || [])
    } catch (error) {
      console.error('Sosyal paylaÅŸÄ±mlar yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const getPostIcon = (type: string) => {
    switch(type) {
      case 'product_showcase': return 'ğŸ“¦'
      case 'new_arrival': return 'ğŸ†•'
      case 'sale': return 'ğŸ·ï¸'
      case 'behind_scenes': return 'ğŸ¬'
      case 'customer_review': return 'â­'
      case 'looking_for': return 'ğŸ”'
      default: return 'ğŸ“¢'
    }
  }

  const formatDate = (dateString: string) => {
    const date = new Date(dateString)
    const now = new Date()
    const diffDays = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24))
    
    if (diffDays === 0) return 'BugÃ¼n'
    if (diffDays === 1) return 'DÃ¼n'
    if (diffDays < 7) return `${diffDays} gÃ¼n Ã¶nce`
    
    return date.toLocaleDateString('tr-TR', { 
      day: 'numeric', 
      month: 'short' 
    })
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="grid grid-cols-3 gap-3">
            {[...Array(limit)].map((_, i) => (
              <div key={i} className="aspect-square bg-gray-200 rounded-lg"></div>
            ))}
          </div>
        </div>
      </div>
    )
  }

  if (compact) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <div className="flex items-center justify-between mb-4">
          <h3 className="font-bold text-gray-900">ğŸ“± Son PaylaÅŸÄ±mlar</h3>
          <Link
            href={`/shop/${shopId}/social`}
            className="text-blue-600 hover:text-blue-800 text-sm font-medium"
          >
            TÃ¼mÃ¼ â†’
          </Link>
        </div>

        {posts.length === 0 ? (
          <div className="text-center py-4">
            <p className="text-gray-600">HenÃ¼z paylaÅŸÄ±m yapÄ±lmamÄ±ÅŸ</p>
          </div>
        ) : (
          <div className="grid grid-cols-3 gap-3">
            {posts.slice(0, 6).map((post) => (
              <Link
                key={post.id}
                href={`/shop/${shopId}/social/${post.id}`}
                className="group relative aspect-square rounded-lg overflow-hidden bg-gray-100"
              >
                {post.images && post.images.length > 0 ? (
                  <img
                    src={post.images[0]}
                    alt={post.title || 'Post image'}
                    className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                  />
                ) : (
                  <div className="w-full h-full flex items-center justify-center text-3xl">
                    {getPostIcon(post.type)}
                  </div>
                )}
                
                {/* Overlay */}
                <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-2">
                  <span className="text-white text-xs truncate">
                    {post.title || 'PaylaÅŸÄ±m'}
                  </span>
                </div>
              </Link>
            ))}
          </div>
        )}
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow-lg">
      <div className="p-6 border-b">
        <div className="flex items-center justify-between">
          <div>
            <h3 className="text-lg font-bold text-gray-900">ğŸ“± Sosyal PaylaÅŸÄ±mlar</h3>
            <p className="text-sm text-gray-600">MaÄŸazanÄ±n son aktiviteleri</p>
          </div>
          <Link
            href={`/shop/${shopId}/social/new`}
            className="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-medium py-2 px-4 rounded-lg text-sm"
          >
            + PaylaÅŸÄ±m Yap
          </Link>
        </div>
      </div>

      {posts.length === 0 ? (
        <div className="p-8 text-center">
          <div className="text-4xl mb-4">ğŸ“±</div>
          <h4 className="font-bold text-gray-900 mb-2">HenÃ¼z paylaÅŸÄ±m yok</h4>
          <p className="text-gray-600 mb-6">MaÄŸazanÄ±zÄ±n hikayesini paylaÅŸÄ±n, takipÃ§ilerinizle baÄŸlantÄ± kurun</p>
          <Link
            href={`/shop/${shopId}/social/new`}
            className="btn-primary inline-block"
          >
            Ä°lk PaylaÅŸÄ±mÄ± YapÄ±n
          </Link>
        </div>
      ) : (
        <div className="divide-y divide-gray-100">
          {posts.map((post) => (
            <div key={post.id} className="p-6 hover:bg-gray-50">
              <div className="flex items-start space-x-4">
                {/* Post icon */}
                <div className="w-12 h-12 rounded-xl bg-gradient-to-br from-purple-100 to-pink-100 flex items-center justify-center text-xl">
                  {getPostIcon(post.type)}
                </div>

                {/* Content */}
                <div className="flex-1">
                  <div className="flex items-center justify-between mb-2">
                    <div>
                      <h4 className="font-bold text-gray-900">{post.title}</h4>
                      <div className="flex items-center space-x-3 text-sm text-gray-500">
                        <span>{formatDate(post.publish_at || post.created_at)}</span>
                        {post.like_count > 0 && (
                          <span className="flex items-center">
                            â¤ï¸ {post.like_count}
                          </span>
                        )}
                        {post.comment_count > 0 && (
                          <span className="flex items-center">
                            ğŸ’¬ {post.comment_count}
                          </span>
                        )}
                      </div>
                    </div>
                    <Link
                      href={`/shop/${shopId}/social/${post.id}`}
                      className="text-blue-600 hover:text-blue-800 text-sm font-medium"
                    >
                      GÃ¶rÃ¼ntÃ¼le â†’
                    </Link>
                  </div>

                  {post.content && (
                    <p className="text-gray-700 mb-4 line-clamp-3">
                      {post.content}
                    </p>
                  )}

                  {/* Images */}
                  {post.images && post.images.length > 0 && (
                    <div className="grid grid-cols-3 gap-3 mb-4">
                      {post.images.slice(0, 3).map((image: string, index: number) => (
                        <div
                          key={index}
                          className="aspect-square rounded-lg overflow-hidden bg-gray-100"
                        >
                          <img
                            src={image}
                            alt={`Post image ${index + 1}`}
                            className="w-full h-full object-cover"
                          />
                        </div>
                      ))}
                      {post.images.length > 3 && (
                        <div className="aspect-square rounded-lg bg-gray-800 text-white flex items-center justify-center text-lg font-bold">
                          +{post.images.length - 3}
                        </div>
                      )}
                    </div>
                  )}

                  {/* Hashtags */}
                  {post.hashtags && post.hashtags.length > 0 && (
                    <div className="flex flex-wrap gap-2">
                      {post.hashtags.map((tag: string, index: number) => (
                        <span
                          key={index}
                          className="text-blue-600 hover:text-blue-800 text-sm"
                        >
                          {tag}
                        </span>
                      ))}
                    </div>
                  )}
                </div>
              </div>
            </div>
          ))}
        </div>
      )}

      {posts.length > 0 && (
        <div className="p-6 border-t text-center">
          <Link
            href={`/shop/${shopId}/social`}
            className="text-blue-600 hover:text-blue-800 font-medium"
          >
            TÃ¼m PaylaÅŸÄ±mlarÄ± GÃ¶r â†’
          </Link>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\ShopStats.tsx
ğŸ“Š 167 satÄ±r | 6.53 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopStats.tsx
'use client'

interface ShopStatsProps {
  stats: {
    totalProducts: number
    activeSearches: number
    totalMatches: number
    pendingMatches: number
    totalFollowers: number
    revenue: number
  }
  shopId: string
}

export default function ShopStats({ stats, shopId }: ShopStatsProps) {
  const formatCurrency = (amount: number) => {
    return new Intl.NumberFormat('tr-TR', {
      style: 'currency',
      currency: 'TRY',
      minimumFractionDigits: 0
    }).format(amount)
  }

  const getGrowthColor = (current: number, previous: number) => {
    if (previous === 0) return 'text-green-600'
    const growth = ((current - previous) / previous) * 100
    if (growth > 20) return 'text-green-600'
    if (growth > 0) return 'text-yellow-600'
    return 'text-red-600'
  }

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {/* ÃœrÃ¼nler */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ“¦</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.totalProducts, stats.totalProducts * 0.9)}`}>
            +12%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.totalProducts}
        </div>
        <div className="text-sm text-gray-600">Aktif ÃœrÃ¼n</div>
        <div className="mt-4 h-2 bg-gray-200 rounded-full">
          <div 
            className="h-2 rounded-full bg-gradient-to-r from-blue-500 to-blue-600"
            style={{ width: `${Math.min(100, (stats.totalProducts / 100) * 100)}%` }}
          ></div>
        </div>
      </div>

      {/* Aramalar */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ”</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.activeSearches, stats.activeSearches * 0.8)}`}>
            +8%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.activeSearches}
        </div>
        <div className="text-sm text-gray-600">Aktif Arama</div>
        <div className="mt-4 h-2 bg-gray-200 rounded-full">
          <div 
            className="h-2 rounded-full bg-gradient-to-r from-green-500 to-green-600"
            style={{ width: `${Math.min(100, (stats.activeSearches / 20) * 100)}%` }}
          ></div>
        </div>
      </div>

      {/* EÅŸleÅŸmeler */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ¤</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.totalMatches, stats.totalMatches * 0.7)}`}>
            +24%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.totalMatches}
        </div>
        <div className="text-sm text-gray-600">Toplam EÅŸleÅŸme</div>
        <div className="mt-4 flex items-center text-sm">
          <span className="text-green-600 font-medium">
            {stats.pendingMatches} yeni
          </span>
          <span className="mx-2 text-gray-400">â€¢</span>
          <span className="text-gray-600">
            {(stats.totalMatches > 0 ? (stats.pendingMatches / stats.totalMatches * 100).toFixed(0) : 0)}% bekliyor
          </span>
        </div>
      </div>

      {/* TakipÃ§iler */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ‘¥</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.totalFollowers, stats.totalFollowers * 0.85)}`}>
            +15%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.totalFollowers}
        </div>
        <div className="text-sm text-gray-600">TakipÃ§i</div>
        <div className="mt-4">
          <div className="flex -space-x-2">
            {[...Array(Math.min(5, stats.totalFollowers))].map((_, i) => (
              <div 
                key={i}
                className="w-8 h-8 rounded-full border-2 border-white bg-gradient-to-br from-purple-400 to-pink-500"
              ></div>
            ))}
            {stats.totalFollowers > 5 && (
              <div className="w-8 h-8 rounded-full border-2 border-white bg-gray-300 flex items-center justify-center text-xs font-medium">
                +{stats.totalFollowers - 5}
              </div>
            )}
          </div>
        </div>
      </div>

      {/* Gelir */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ’°</div>
          <div className={`text-sm font-medium ${getGrowthColor(stats.revenue, stats.revenue * 0.6)}`}>
            +42%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {formatCurrency(stats.revenue)}
        </div>
        <div className="text-sm text-gray-600">Toplam Gelir</div>
        <div className="mt-4">
          <div className="text-xs text-gray-500">
            Bu ay: {formatCurrency(stats.revenue * 0.3)}
          </div>
        </div>
      </div>

      {/* DÃ¶nÃ¼ÅŸÃ¼m OranÄ± */}
      <div className="bg-white rounded-xl shadow p-6 hover:shadow-lg transition-shadow">
        <div className="flex items-center justify-between mb-4">
          <div className="text-gray-500">ğŸ“Š</div>
          <div className="text-sm font-medium text-green-600">
            +5%
          </div>
        </div>
        <div className="text-3xl font-bold text-gray-900 mb-2">
          {stats.totalProducts > 0 ? ((stats.totalMatches / stats.totalProducts) * 100).toFixed(1) : '0'}%
        </div>
        <div className="text-sm text-gray-600">DÃ¶nÃ¼ÅŸÃ¼m OranÄ±</div>
        <div className="mt-4">
          <div className="flex items-center text-sm">
            <span className="text-gray-600 mr-2">Hedef:</span>
            <span className="font-medium text-green-600">%25</span>
          </div>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\ShopStatsPublic.tsx
ğŸ“Š 178 satÄ±r | 5.84 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopStatsPublic.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

interface ShopStatsPublicProps {
  shopId: string
}

// Review interface'ini tanÄ±mlayalÄ±m
interface ShopReview {
  rating: number | null
  response_time: number | null
  [key: string]: any // DiÄŸer alanlar iÃ§in
}

interface ShopStats {
  productCount: number
  searchCount: number
  followerCount: number
  matchCount: number
  rating: number
  responseTime: number
}

export default function ShopStatsPublic({ shopId }: ShopStatsPublicProps) {
  const [stats, setStats] = useState<ShopStats>({
    productCount: 0,
    searchCount: 0,
    followerCount: 0,
    matchCount: 0,
    rating: 0,
    responseTime: 0
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchStats()
  }, [shopId])

  const fetchStats = async () => {
    try {
      const [
        { count: productCount },
        { count: searchCount },
        { count: followerCount },
        { count: matchCount },
        { data: reviewsData }
      ] = await Promise.all([
        supabase
          .from('shop_inventory')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('status', 'active'),
        supabase
          .from('shop_searches')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('status', 'active'),
        supabase
          .from('shop_customer_relationships')
          .select('count', { count: 'exact', head: true })
          .eq('shop_id', shopId)
          .eq('relationship_type', 'follower'),
        supabase
          .from('shop_search_matches')
          .select('count', { count: 'exact', head: true })
          .eq('search_id', shopId)
          .eq('status', 'pending'),
        supabase
          .from('shop_reviews')
          .select('rating, response_time')
          .eq('shop_id', shopId)
          .limit(50)
      ])

      // Calculate average rating and response time with proper typing
      const reviews: ShopReview[] = reviewsData || []
      
      // DÃœZELTÄ°LMÄ°Å KISIM - TypeScript hatalarÄ± giderildi
      const avgRating = reviews.length > 0 
        ? reviews.reduce((sum: number, r: ShopReview) => {
            const rating = r.rating || 0
            return sum + rating
          }, 0) / reviews.length 
        : 0
      
      const avgResponseTime = reviews.length > 0
        ? reviews.reduce((sum: number, r: ShopReview) => {
            const responseTime = r.response_time || 0
            return sum + responseTime
          }, 0) / reviews.length
        : 0

      setStats({
        productCount: productCount || 0,
        searchCount: searchCount || 0,
        followerCount: followerCount || 0,
        matchCount: matchCount || 0,
        rating: avgRating,
        responseTime: avgResponseTime
      })
    } catch (error) {
      console.error('MaÄŸaza istatistikleri yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const formatResponseTime = (minutes: number) => {
    if (minutes < 60) return `${Math.round(minutes)} dk`
    if (minutes < 1440) return `${Math.round(minutes / 60)} saat`
    return `${Math.round(minutes / 1440)} gÃ¼n`
  }

  if (loading) {
    return (
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        {[...Array(4)].map((_, i) => (
          <div key={i} className="animate-pulse bg-gray-200 rounded-xl h-24"></div>
        ))}
      </div>
    )
  }

  return (
    <div className="grid grid-cols-2 md:grid-cols-6 gap-4 mb-8">
      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-blue-600 mb-1">
          {stats.productCount}
        </div>
        <div className="text-sm text-gray-600">ÃœrÃ¼n</div>
        <div className="text-xs text-gray-400 mt-1">Stokta</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-green-600 mb-1">
          {stats.searchCount}
        </div>
        <div className="text-sm text-gray-600">Arama</div>
        <div className="text-xs text-gray-400 mt-1">Aktif</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-purple-600 mb-1">
          {stats.followerCount}
        </div>
        <div className="text-sm text-gray-600">TakipÃ§i</div>
        <div className="text-xs text-gray-400 mt-1">Toplam</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-orange-600 mb-1">
          {stats.matchCount}
        </div>
        <div className="text-sm text-gray-600">EÅŸleÅŸme</div>
        <div className="text-xs text-gray-400 mt-1">Bekleyen</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-yellow-600 mb-1">
          {stats.rating.toFixed(1)}
        </div>
        <div className="text-sm text-gray-600">Puan</div>
        <div className="text-xs text-gray-400 mt-1">Ortalama</div>
      </div>

      <div className="bg-white rounded-xl shadow p-4 text-center hover:shadow-md transition-shadow">
        <div className="text-2xl font-bold text-teal-600 mb-1">
          {formatResponseTime(stats.responseTime)}
        </div>
        <div className="text-sm text-gray-600">YanÄ±t</div>
        <div className="text-xs text-gray-400 mt-1">Ortalama</div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ shop\ShopTabs.tsx
ğŸ“Š 37 satÄ±r | 1.23 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/shop/ShopTabs.tsx
'use client'

interface ShopTabsProps {
  activeTab: 'products' | 'searches' | 'social' | 'about'
  onTabChange: (tab: 'products' | 'searches' | 'social' | 'about') => void
  shopId: string
}

export default function ShopTabs({ activeTab, onTabChange, shopId }: ShopTabsProps) {
  const tabs = [
    { id: 'products', label: 'ğŸ“¦ ÃœrÃ¼nler', countKey: 'products' },
    { id: 'searches', label: 'ğŸ” AradÄ±klarÄ±m', countKey: 'searches' },
    { id: 'social', label: 'ğŸ“± PaylaÅŸÄ±mlar', countKey: 'social' },
    { id: 'about', label: 'â„¹ï¸ HakkÄ±nda', countKey: 'about' }
  ]

  return (
    <div className="bg-white rounded-xl shadow p-2">
      <div className="flex overflow-x-auto">
        {tabs.map((tab) => (
          <button
            key={tab.id}
            onClick={() => onTabChange(tab.id as any)}
            className={`flex-1 whitespace-nowrap px-6 py-3 text-center font-medium rounded-lg transition ${
              activeTab === tab.id
                ? 'bg-blue-600 text-white'
                : 'text-gray-700 hover:text-gray-900 hover:bg-gray-100'
            }`}
          >
            {tab.label}
          </button>
        ))}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ ShopProductCard.tsx
ğŸ“Š 63 satÄ±r | 2.05 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/ShopProductCard.tsx - ÃœRÃœN KARTI
'use client';

import Link from 'next/link';
import { Heart, Eye } from 'lucide-react';

interface ShopProductCardProps {
  product: any;
}

export default function ShopProductCard({ product }: ShopProductCardProps) {
  return (
    <Link 
      href={`/product/${product.id}`} // BURASI DEÄÄ°ÅTÄ°
      className="bg-white rounded-xl shadow hover:shadow-md transition-shadow overflow-hidden block"
    >
      {/* Resim */}
      {product.images && product.images.length > 0 ? (
        <div className="h-48 overflow-hidden">
          <img
            src={product.images[0]}
            alt={product.title}
            className="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
          />
        </div>
      ) : (
        <div className="h-48 bg-gray-100 flex items-center justify-center">
          <div className="text-gray-400">Resim Yok</div>
        </div>
      )}
      
      {/* Ä°Ã§erik */}
      <div className="p-4">
        <h3 className="font-medium text-gray-900 line-clamp-2 mb-2">
          {product.title}
        </h3>
        
        <div className="flex items-center justify-between mb-3">
          <span className="font-bold text-blue-600">
            {product.price.toLocaleString('tr-TR')} {product.price_currency}
          </span>
          {product.discount_percent && (
            <span className="text-sm bg-red-100 text-red-700 px-2 py-1 rounded">
              %{product.discount_percent} indirim
            </span>
          )}
        </div>
        
        {/* Alt Bilgi */}
        <div className="flex items-center justify-between text-sm text-gray-500">
          <div className="flex items-center">
            <Eye size={14} className="mr-1" />
            {product.view_count || 0}
          </div>
          <div className="flex items-center">
            <Heart size={14} className="mr-1" />
            {product.wishlist_count || 0}
          </div>
        </div>
      </div>
    </Link>
  );
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ SimpleLocationPicker.tsx
ğŸ“Š 172 satÄ±r | 5.80 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleLocationPicker.tsx
'use client'

import { useState } from 'react'

interface SimpleLocationPickerProps {
  onLocationSelect: (location: {
    lat: number | null
    lon: number | null
    city: string
  }) => void
}

export default function SimpleLocationPicker({ onLocationSelect }: SimpleLocationPickerProps) {
  const [mode, setMode] = useState<'gps' | 'manual'>('gps')
  const [selectedCity, setSelectedCity] = useState('')
  const [isGettingLocation, setIsGettingLocation] = useState(false)
  const [gpsError, setGpsError] = useState<string | null>(null)

  const cities = [
    'Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya', 'Adana', 'Konya',
    'Trabzon', 'Gaziantep', 'Kayseri', 'Mersin', 'EskiÅŸehir', 'DiyarbakÄ±r',
    'Samsun', 'Denizli', 'Ä°zmit', 'Manisa', 'BalÄ±kesir', 'Van', 'Malatya',
    'TÃ¼rkiye Geneli', 'Yurt DÄ±ÅŸÄ±'
  ]

  const handleGetLocation = () => {
    if (!navigator.geolocation) {
      setGpsError('TarayÄ±cÄ±nÄ±z konum servisini desteklemiyor')
      return
    }

    setIsGettingLocation(true)
    setGpsError(null)

    // BURASI KRÄ°TÄ°K: Direkt Ã§aÄŸÄ±rÄ±yoruz, tarayÄ±cÄ± otomatik izin isteyecek
    navigator.geolocation.getCurrentPosition(
      // BaÅŸarÄ±lÄ±
      async (position) => {
        const lat = position.coords.latitude
        const lon = position.coords.longitude
        
        let city = 'Konum alÄ±ndÄ±'
        try {
          const response = await fetch(
            `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=tr`
          )
          const data = await response.json()
          if (data.address) {
            city = data.address.city || data.address.town || data.address.county || 'Konum alÄ±ndÄ±'
          }
        } catch {
          city = `${lat.toFixed(2)}, ${lon.toFixed(2)}`
        }

        onLocationSelect({ lat, lon, city })
        setIsGettingLocation(false)
      },
      // Hata
      (error) => {
        setIsGettingLocation(false)
        if (error.code === 1) {
          setGpsError('ğŸ“ Konum izni verilmedi. LÃ¼tfen tarayÄ±cÄ±nÄ±zÄ±n izin isteÄŸini kabul edin veya ÅŸehir seÃ§in.')
        } else {
          setGpsError('Konum alÄ±namadÄ±: ' + error.message)
        }
      },
      {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      }
    )
  }

  const handleCitySelect = (e: React.ChangeEvent<HTMLSelectElement>) => {
    const city = e.target.value
    setSelectedCity(city)
    if (city) {
      onLocationSelect({ lat: null, lon: null, city })
    }
  }

  return (
    <div className="space-y-6">
      {/* Mod SeÃ§imi */}
      <div className="grid grid-cols-2 gap-4">
        <button
          type="button"
          onClick={() => setMode('gps')}
          className={`p-4 rounded-lg border-2 ${mode === 'gps' ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}`}
        >
          <div className="text-2xl mb-2">ğŸ“</div>
          <p className="font-medium">Konumumu Kullan</p>
          <p className="text-sm text-gray-600 mt-1">TarayÄ±cÄ± izin isteyecek</p>
        </button>

        <button
          type="button"
          onClick={() => setMode('manual')}
          className={`p-4 rounded-lg border-2 ${mode === 'manual' ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}`}
        >
          <div className="text-2xl mb-2">ğŸ™ï¸</div>
          <p className="font-medium">Åehir SeÃ§</p>
          <p className="text-sm text-gray-600 mt-1">Listeden ÅŸehir seÃ§in</p>
        </button>
      </div>

      {/* GPS Modu */}
      {mode === 'gps' && (
        <div className="space-y-4">
          <button
            onClick={handleGetLocation}
            disabled={isGettingLocation}
            className="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg disabled:opacity-50 flex items-center justify-center"
          >
            {isGettingLocation ? (
              <>
                <div className="animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white mr-3"></div>
                Konum alÄ±nÄ±yor...
              </>
            ) : (
              <>
                <span className="mr-2">ğŸ“</span>
                Konum Ä°zni Ä°ste
              </>
            )}
          </button>

          {gpsError && (
            <div className="p-4 bg-red-50 border border-red-200 rounded-lg">
              <p className="text-red-700">{gpsError}</p>
              <button
                onClick={() => setMode('manual')}
                className="mt-2 text-red-600 hover:text-red-800 text-sm"
              >
                Åehir seÃ§mek iÃ§in tÄ±klayÄ±n
              </button>
            </div>
          )}

          {/* Bilgi */}
          <div className="p-4 bg-blue-50 rounded-lg">
            <p className="text-sm text-blue-700">
              <strong>ğŸ“± Telefon kullanÄ±cÄ±larÄ±:</strong> EkranÄ±n Ã¼st kÄ±smÄ±nda "spotitforme.com konumunuza eriÅŸmek istiyor" ÅŸeklinde bir izin isteÄŸi belirecek. LÃ¼tfen <strong>"Ä°zin Ver"</strong> seÃ§eneÄŸini tÄ±klayÄ±n.
            </p>
          </div>
        </div>
      )}

      {/* Manuel Mod */}
      {mode === 'manual' && (
        <div>
          <select
            value={selectedCity}
            onChange={handleCitySelect}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg"
            required
          >
            <option value="">Åehir seÃ§in *</option>
            {cities.map(city => (
              <option key={city} value={city}>{city}</option>
            ))}
          </select>
          <p className="text-sm text-gray-500 mt-2">
            Konum izni vermek istemiyorsanÄ±z ÅŸehir seÃ§ebilirsiniz
          </p>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ SimpleMap.tsx
ğŸ“Š 106 satÄ±r | 3.83 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleMap.tsx
'use client'

import { useState } from 'react'

interface SimpleMapProps {
  location: string
  height?: string
}

export default function SimpleMap({ location, height = '400px' }: SimpleMapProps) {
  const [showMap, setShowMap] = useState(false)

  // TÃ¼rkiye ÅŸehir koordinatlarÄ±
  const cityCoordinates: Record<string, { lat: number; lng: number }> = {
    'Ä°stanbul': { lat: 41.0082, lng: 28.9784 },
    'Ankara': { lat: 39.9334, lng: 32.8597 },
    'Ä°zmir': { lat: 38.4237, lng: 27.1428 },
    'Bursa': { lat: 40.1885, lng: 29.0610 },
    'Antalya': { lat: 36.8969, lng: 30.7133 },
    'Adana': { lat: 37.0000, lng: 35.3213 },
    'Konya': { lat: 37.8667, lng: 32.4833 },
    'Trabzon': { lat: 41.0015, lng: 39.7178 },
    'Gaziantep': { lat: 37.0662, lng: 37.3833 },
    'Kayseri': { lat: 38.7312, lng: 35.4787 },
    'TÃ¼rkiye Geneli': { lat: 39.9334, lng: 32.8597 }, // Ankara
    'Yurt DÄ±ÅŸÄ±': { lat: 48.8566, lng: 2.3522 } // Paris
  }

  const getCoordinates = () => {
    for (const city in cityCoordinates) {
      if (location.includes(city)) {
        return cityCoordinates[city]
      }
    }
    return cityCoordinates['Ä°stanbul'] // VarsayÄ±lan
  }

  const coordinates = getCoordinates()

  return (
    <div className="bg-white rounded-xl shadow-lg overflow-hidden">
      <div className="p-4 border-b">
        <div className="flex items-center justify-between">
          <div className="flex items-center">
            <span className="text-2xl mr-3">ğŸ“</span>
            <div>
              <h3 className="font-bold text-gray-900">{location}</h3>
              <p className="text-sm text-gray-600">Spot konumu</p>
            </div>
          </div>
          <button
            onClick={() => setShowMap(!showMap)}
            className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm"
          >
            {showMap ? 'HaritayÄ± Kapat' : 'HaritayÄ± AÃ§'}
          </button>
        </div>
      </div>

      {showMap && (
        <div className="p-4">
          <div className="rounded-lg overflow-hidden border border-gray-300" style={{ height }}>
            <iframe
              src={`https://maps.google.com/maps?q=${coordinates.lat},${coordinates.lng}&z=12&output=embed`}
              className="w-full h-full border-0"
              loading="lazy"
              title={`${location} haritasÄ±`}
              allowFullScreen
            />
          </div>
          <div className="mt-4 flex items-center justify-between text-sm text-gray-600">
            <div className="flex items-center">
              <span className="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>
              <span>Spot konumu: {location}</span>
            </div>
            <a
              href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`}
              target="_blank"
              rel="noopener noreferrer"
              className="text-blue-600 hover:text-blue-800"
            >
              Google Maps'te aÃ§ â†’
            </a>
          </div>
        </div>
      )}

      {!showMap && (
        <div className="p-6 text-center bg-gradient-to-br from-blue-50 to-purple-50">
          <div className="text-4xl mb-4">ğŸ—ºï¸</div>
          <h4 className="text-lg font-bold text-gray-900 mb-2">Bu spot {location} konumunda aranÄ±yor</h4>
          <p className="text-gray-600 mb-4">
            {location.includes('TÃ¼rkiye Geneli') 
              ? 'TÃ¼m TÃ¼rkiye\'de bu Ã¼rÃ¼nÃ¼ arayanlar size yardÄ±m edebilir'
              : `${location} bÃ¶lgesindeki kullanÄ±cÄ±lar size yardÄ±m edecek`
            }
          </p>
          <p className="text-sm text-gray-500">
            HaritayÄ± aÃ§arak konumu tam olarak gÃ¶rebilirsiniz
          </p>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ SimpleShareButtons.tsx
ğŸ“Š 85 satÄ±r | 2.89 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleShareButtons.tsx
'use client'

import { useState } from 'react'

export default function SimpleShareButtons({ 
  url, 
  title 
}: { 
  url: string 
  title: string 
}) {
  const [copied, setCopied] = useState(false)
  const currentUrl = typeof window !== 'undefined' ? window.location.origin + url : url

  const shareLinks = {
    facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentUrl)}`,
    whatsapp: `https://api.whatsapp.com/send?text=${encodeURIComponent(title + ' ' + currentUrl)}`,
    twitter: `https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(currentUrl)}`
  }

  const copyToClipboard = async () => {
    try {
      await navigator.clipboard.writeText(currentUrl)
      setCopied(true)
      setTimeout(() => setCopied(false), 2000)
    } catch (err) {
      console.error('Kopyalama hatasÄ±:', err)
    }
  }

  return (
    <div className="bg-white rounded-xl shadow-lg p-6">
      <h3 className="text-lg font-bold text-gray-900 mb-4">PaylaÅŸ</h3>
      
      <div className="grid grid-cols-3 gap-3 mb-6">
        <a
          href={shareLinks.facebook}
          target="_blank"
          rel="noopener noreferrer"
          className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">ğŸ“˜</span>
          <span className="hidden sm:inline">Facebook</span>
        </a>
        
        <a
          href={shareLinks.whatsapp}
          target="_blank"
          rel="noopener noreferrer"
          className="bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">ğŸ’š</span>
          <span className="hidden sm:inline">WhatsApp</span>
        </a>
        
        <button
          onClick={copyToClipboard}
          className="bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 rounded-lg flex items-center justify-center"
        >
          <span className="mr-2">{copied ? 'âœ…' : 'ğŸ“‹'}</span>
          <span className="hidden sm:inline">{copied ? 'Kopya' : 'Kopya'}</span>
        </button>
      </div>
      
      <div>
        <p className="text-sm text-gray-600 mb-2">Link:</p>
        <div className="relative">
          <input
            type="text"
            value={currentUrl}
            readOnly
            className="w-full px-4 py-3 pr-24 bg-gray-50 border border-gray-300 rounded-lg text-sm"
          />
          <button
            onClick={copyToClipboard}
            className="absolute right-2 top-1/2 transform -translate-y-1/2 px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded"
          >
            {copied ? 'KopyalandÄ±!' : 'Kopyala'}
          </button>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ SimpleTabs.tsx
ğŸ“Š 33 satÄ±r | 0.80 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SimpleTabs.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

interface Tab {
  id: string
  label: string
}

interface SimpleTabsProps {
  tabs: Tab[]
  activeTab: string
  onTabChange: (tabId: string) => void
}

export default function SimpleTabs({ tabs, activeTab, onTabChange }: SimpleTabsProps) {
  return (
    <div className="flex border-b">
      {tabs.map((tab) => (
        <button
          key={tab.id}
          onClick={() => onTabChange(tab.id)}
          className={`flex-1 py-4 text-center font-medium transition-colors ${
            activeTab === tab.id
              ? 'text-blue-600 border-b-2 border-blue-600'
              : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
          }`}
        >
          {tab.label}
        </button>
      ))}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\CommentsSection.tsx
ğŸ“Š 378 satÄ±r | 12.00 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/CommentsSection.tsx
'use client'

import { useState, useEffect, useRef } from 'react'
import { supabase } from '@/lib/supabase'
import { Send, Heart, MoreVertical, Smile } from 'lucide-react'

interface CommentsSectionProps {
  postId: string
  initialComments?: any[]
  onClose?: () => void
  autoFocus?: boolean
}

export default function CommentsSection({ 
  postId, 
  initialComments = [], 
  onClose,
  autoFocus = false 
}: CommentsSectionProps) {
  const [comments, setComments] = useState<any[]>(initialComments)
  const [newComment, setNewComment] = useState('')
  const [loading, setLoading] = useState(false)
  const [replyingTo, setReplyingTo] = useState<string | null>(null)
  const [showEmojiPicker, setShowEmojiPicker] = useState(false)
  
  const commentsEndRef = useRef<HTMLDivElement>(null)
  const inputRef = useRef<HTMLTextAreaElement>(null)

  useEffect(() => {
    if (initialComments.length === 0) {
      fetchComments()
    }
  }, [postId])

  useEffect(() => {
    scrollToBottom()
  }, [comments])

  const fetchComments = async () => {
    try {
      const { data } = await supabase
        .from('social_comments')
        .select(`
          *,
          user:user_profiles(*)
        `)
        .eq('post_id', postId)
        .order('created_at', { ascending: true })

      setComments(data || [])
    } catch (error) {
      console.error('Yorumlar yÃ¼klenemedi:', error)
    }
  }

  const scrollToBottom = () => {
    commentsEndRef.current?.scrollIntoView({ behavior: 'smooth' })
  }

  const handleSubmitComment = async () => {
    if (!newComment.trim()) return

    setLoading(true)
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) {
        alert('Yorum yapmak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z')
        return
      }

      const { data: comment, error } = await supabase
        .from('social_comments')
        .insert({
          post_id: postId,
          user_id: user.id,
          content: newComment,
          parent_id: replyingTo || null
        })
        .select(`
          *,
          user:user_profiles(*)
        `)
        .single()

      if (error) throw error

      // Yeni yorumu listeye ekle
      setComments(prev => [...prev, comment])
      setNewComment('')
      setReplyingTo(null)

      // Bildirim gÃ¶nder (post sahibine)
      const postOwnerId = comments[0]?.post?.user_id || postId
      if (postOwnerId !== user.id) {
        await supabase.from('social_notifications').insert({
          user_id: postOwnerId,
          type: 'comment',
          actor_id: user.id,
          post_id: postId,
          message: 'paylaÅŸÄ±mÄ±na yorum yaptÄ±'
        })
      }

      // Emoji picker'Ä± kapat
      setShowEmojiPicker(false)

    } catch (error) {
      console.error('Yorum gÃ¶nderme hatasÄ±:', error)
      alert('Yorum gÃ¶nderilemedi')
    } finally {
      setLoading(false)
    }
  }

  const handleLikeComment = async (commentId: string) => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      // BeÄŸeni iÅŸlemi (like/unlike)
      const existingLike = comments.find(c => c.id === commentId)?.liked_by_user
      
      if (existingLike) {
        // BeÄŸeniyi kaldÄ±r
        await supabase
          .from('comment_likes')
          .delete()
          .eq('comment_id', commentId)
          .eq('user_id', user.id)
      } else {
        // BeÄŸen
        await supabase
          .from('comment_likes')
          .insert({
            comment_id: commentId,
            user_id: user.id
          })
      }

      // UI gÃ¼ncelle
      setComments(prev => prev.map(comment => {
        if (comment.id === commentId) {
          return {
            ...comment,
            like_count: existingLike ? comment.like_count - 1 : comment.like_count + 1,
            liked_by_user: !existingLike
          }
        }
        return comment
      }))

    } catch (error) {
      console.error('Yorum beÄŸenme hatasÄ±:', error)
    }
  }

  const handleReply = (commentId: string, username: string) => {
    setReplyingTo(commentId)
    setNewComment(`@${username} `)
    inputRef.current?.focus()
  }

  const addEmoji = (emoji: string) => {
    setNewComment(prev => prev + emoji)
    setShowEmojiPicker(false)
  }

  const emojis = ['ğŸ˜Š', 'ğŸ˜', 'ğŸ˜‚', 'ğŸ˜®', 'ğŸ˜¢', 'ğŸ‘', 'â¤ï¸', 'ğŸ”¥', 'ğŸ‰', 'ğŸ‘']

  const renderComment = (comment: any, isChild = false) => {
    const childComments = comments.filter(c => c.parent_id === comment.id)
    
    return (
      <div key={comment.id} className={`${isChild ? 'ml-8' : ''}`}>
        <div className={`flex space-x-3 ${isChild ? 'mt-3' : 'mt-4'}`}>
          {/* Avatar */}
          <div className="flex-shrink-0">
            <div className="w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 overflow-hidden">
              {comment.user?.avatar_url ? (
                <img
                  src={comment.user.avatar_url}
                  alt={comment.user?.name}
                  className="w-full h-full object-cover"
                />
              ) : (
                <div className="w-full h-full flex items-center justify-center text-white text-sm font-bold">
                  {comment.user?.name?.[0] || 'K'}
                </div>
              )}
            </div>
          </div>

          {/* Ä°Ã§erik */}
          <div className="flex-1">
            <div className="bg-gray-100 rounded-2xl rounded-tl-none p-3">
              <div className="flex items-center justify-between mb-1">
                <div className="flex items-center space-x-2">
                  <span className="font-bold text-sm">{comment.user?.name || 'KullanÄ±cÄ±'}</span>
                  <span className="text-xs text-gray-500">
                    {new Date(comment.created_at).toLocaleTimeString('tr-TR', {
                      hour: '2-digit',
                      minute: '2-digit'
                    })}
                  </span>
                </div>
                
                <div className="relative">
                  <button
                    onClick={() => console.log('comment menu')}
                    className="p-1 hover:bg-gray-200 rounded-full"
                  >
                    <MoreVertical className="w-3 h-3 text-gray-500" />
                  </button>
                </div>
              </div>

              <p className="text-gray-800 text-sm whitespace-pre-line">
                {comment.content}
              </p>
            </div>

            {/* Aksiyonlar */}
            <div className="flex items-center space-x-4 mt-2 ml-3">
              <button
                onClick={() => handleLikeComment(comment.id)}
                className={`text-xs flex items-center space-x-1 ${
                  comment.liked_by_user ? 'text-red-600' : 'text-gray-500'
                }`}
              >
                <Heart className="w-3 h-3" />
                <span>{comment.like_count || 0}</span>
              </button>
              
              <button
                onClick={() => handleReply(comment.id, comment.user?.name)}
                className="text-xs text-gray-500 hover:text-gray-700"
              >
                YanÄ±tla
              </button>
              
              {!isChild && childComments.length > 0 && (
                <button className="text-xs text-blue-600">
                  {childComments.length} yanÄ±t
                </button>
              )}
            </div>

            {/* Alt yorumlar */}
            {childComments.length > 0 && (
              <div className="mt-3">
                {childComments.map(child => renderComment(child, true))}
              </div>
            )}
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="border-t border-gray-100">
      {/* Yorumlar listesi */}
      <div className="max-h-80 overflow-y-auto px-6 py-4">
        {comments.length === 0 ? (
          <div className="text-center py-8">
            <div className="text-3xl mb-3">ğŸ’¬</div>
            <p className="text-gray-600">HenÃ¼z yorum yok</p>
            <p className="text-sm text-gray-500 mt-1">Ä°lk yorumu sen yap!</p>
          </div>
        ) : (
          <div>
            {comments
              .filter(comment => !comment.parent_id) // Sadece parent yorumlar
              .map(comment => renderComment(comment, false))}
          </div>
        )}
        
        <div ref={commentsEndRef} />
      </div>

      {/* YanÄ±tlama durumu */}
      {replyingTo && (
        <div className="px-6 py-2 bg-blue-50 flex items-center justify-between">
          <div className="text-sm text-blue-700">
            YanÄ±tlanÄ±yor: @{comments.find(c => c.id === replyingTo)?.user?.name}
          </div>
          <button
            onClick={() => setReplyingTo(null)}
            className="text-sm text-gray-500 hover:text-gray-700"
          >
            Ã— Ä°ptal
          </button>
        </div>
      )}

      {/* Yorum input */}
      <div className="px-6 py-4 border-t border-gray-100">
        <div className="flex space-x-3">
          {/* Emoji picker */}
          <div className="relative">
            <button
              onClick={() => setShowEmojiPicker(!showEmojiPicker)}
              className="p-2 hover:bg-gray-100 rounded-full"
            >
              <Smile className="w-5 h-5 text-gray-500" />
            </button>

            {showEmojiPicker && (
              <div className="absolute bottom-full left-0 mb-2 bg-white rounded-xl shadow-lg border p-2 grid grid-cols-5 gap-1 z-50">
                {emojis.map(emoji => (
                  <button
                    key={emoji}
                    onClick={() => addEmoji(emoji)}
                    className="w-8 h-8 hover:bg-gray-100 rounded flex items-center justify-center text-lg"
                  >
                    {emoji}
                  </button>
                ))}
              </div>
            )}
          </div>

          {/* Textarea */}
          <div className="flex-1">
            <textarea
              ref={inputRef}
              value={newComment}
              onChange={(e) => setNewComment(e.target.value)}
              placeholder="Yorum ekle..."
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"
              rows={2}
              autoFocus={autoFocus}
              onKeyDown={(e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                  e.preventDefault()
                  handleSubmitComment()
                }
              }}
            />
          </div>

          {/* GÃ¶nder butonu */}
          <button
            onClick={handleSubmitComment}
            disabled={loading || !newComment.trim()}
            className="self-end bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full disabled:opacity-50 disabled:cursor-not-allowed"
          >
            {loading ? (
              <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
            ) : (
              <Send className="w-5 h-5" />
            )}
          </button>
        </div>

        {/* Yorum ipuÃ§larÄ± */}
        <div className="mt-3 text-xs text-gray-500">
          â€¢ Enter ile gÃ¶nder, Shift+Enter ile yeni satÄ±r<br />
          â€¢ @kullanÄ±cÄ± ile etiketleyebilirsin<br />
          â€¢ Nazik ve yardÄ±msever olalÄ±m
        </div>
      </div>

      {/* Kapatma butonu (mobile iÃ§in) */}
      {onClose && (
        <div className="px-6 py-3 border-t border-gray-100 text-center">
          <button
            onClick={onClose}
            className="text-blue-600 hover:text-blue-800 text-sm font-medium"
          >
            YorumlarÄ± Kapat
          </button>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\CreatePostButton.tsx
ğŸ“Š 48 satÄ±r | 1.63 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/CreatePostButton.tsx
'use client'

import { useState } from 'react'
import CreatePostModal from './CreatePostModal'

export default function CreatePostButton({ variant = 'default' }: { variant?: 'default' | 'primary' }) {
  const [showModal, setShowModal] = useState(false)

  if (variant === 'primary') {
    return (
      <>
        <button
          onClick={() => setShowModal(true)}
          className="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:from-blue-600 hover:to-purple-700 transition"
        >
          ğŸ“ Yeni PaylaÅŸÄ±m
        </button>
        
        <CreatePostModal
                isOpen={showModal}
                onClose={() => setShowModal(false)} onPostCreated={function (): void {
                    throw new Error('Function not implemented.')
                } }        />
      </>
    )
  }

  return (
    <>
      <button
        onClick={() => setShowModal(true)}
        className="fixed bottom-6 right-6 z-40 bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-full shadow-2xl hover:shadow-3xl transition-all hover:scale-110"
      >
        <div className="flex items-center space-x-2">
          <span className="text-2xl">âœï¸</span>
          <span className="font-bold hidden md:inline">PaylaÅŸ</span>
        </div>
      </button>
      
      <CreatePostModal
              isOpen={showModal}
              onClose={() => setShowModal(false)} onPostCreated={function (): void {
                  throw new Error('Function not implemented.')
              } }      />
    </>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\CreatePostModal.tsx
ğŸ“Š 453 satÄ±r | 16.98 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/CreatePostModal.tsx
'use client'

import { useState, useRef } from 'react'
import { supabase } from '@/lib/supabase'
import ImageUpload from '../ImageUpload'
import HashtagInput from './HashtagInput'
import LocationPicker from './LocationPicker'

interface CreatePostModalProps {
  isOpen: boolean
  onClose: () => void
  onPostCreated: () => void
}

export default function CreatePostModal({ 
  isOpen, 
  onClose, 
  onPostCreated 
}: CreatePostModalProps) {
  const [step, setStep] = useState(1)
  const [loading, setLoading] = useState(false)
  const [postData, setPostData] = useState({
    type: 'sighting',
    caption: '',
    location: '',
    category: '',
    hashtags: [] as string[],
    isPublic: true,
    images: [] as File[]
  })

  const fileInputRef = useRef<HTMLInputElement>(null)

  const handleImageUpload = (files: File[]) => {
    setPostData({ ...postData, images: [...postData.images, ...files] })
  }

  const removeImage = (index: number) => {
    setPostData({
      ...postData,
      images: postData.images.filter((_, i) => i !== index)
    })
  }

  const handleHashtagAdd = (hashtag: string) => {
    if (!postData.hashtags.includes(hashtag)) {
      setPostData({
        ...postData,
        hashtags: [...postData.hashtags, hashtag]
      })
    }
  }

  const handleHashtagRemove = (hashtag: string) => {
    setPostData({
      ...postData,
      hashtags: postData.hashtags.filter(h => h !== hashtag)
    })
  }

  const handleSubmit = async () => {
    setLoading(true)
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) throw new Error('KullanÄ±cÄ± giriÅŸi gerekli')

      // 1. Resimleri yÃ¼kle
      const imageUrls: string[] = []
      for (const file of postData.images) {
        const fileExt = file.name.split('.').pop()
        const fileName = `${user.id}/social/${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`
        
        const { error: uploadError } = await supabase.storage
          .from('spot-images')
          .upload(fileName, file)

        if (uploadError) throw uploadError

        const { data: { publicUrl } } = supabase.storage
          .from('spot-images')
          .getPublicUrl(fileName)

        imageUrls.push(publicUrl)
      }

      // 2. Post'u oluÅŸtur
      const { error: postError } = await supabase
        .from('social_posts')
        .insert({
          user_id: user.id,
          type: postData.type,
          caption: postData.caption,
          location: postData.location,
          category: postData.category,
          image_urls: imageUrls,
          hashtags: postData.hashtags.map(tag => `#${tag.replace('#', '')}`),
          is_public: postData.isPublic
        })

      if (postError) throw postError

      // 3. Puan ver (gamification)
      await supabase.rpc('add_user_points', {
        user_id: user.id,
        points_to_add: 10 + (postData.images.length * 5), // 10 puan + resim baÅŸÄ±na 5 puan
        activity_type: 'social_post'
      })

      // 4. BaÅŸarÄ±lÄ±
      alert('ğŸ‰ PaylaÅŸÄ±mÄ±nÄ±z yayÄ±nlandÄ±! Puan kazandÄ±nÄ±z.')
      onPostCreated()
      onClose()
      
      // Formu temizle
      setPostData({
        type: 'sighting',
        caption: '',
        location: '',
        category: '',
        hashtags: [],
        isPublic: true,
        images: []
      })
      setStep(1)

    } catch (error) {
      console.error('Post oluÅŸturma hatasÄ±:', error)
      alert('Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.')
    } finally {
      setLoading(false)
    }
  }

  if (!isOpen) return null

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden">
        {/* Header */}
        <div className="border-b p-6">
          <div className="flex items-center justify-between">
            <h2 className="text-2xl font-bold text-gray-900">Yeni PaylaÅŸÄ±m</h2>
            <button
              onClick={onClose}
              className="text-gray-500 hover:text-gray-700 text-2xl"
            >
              Ã—
            </button>
          </div>
          
          {/* Step indicator */}
          <div className="flex mt-4">
            {[1, 2, 3].map((stepNum) => (
              <div key={stepNum} className="flex-1">
                <div className={`h-1 rounded-full ${
                  step >= stepNum ? 'bg-blue-600' : 'bg-gray-200'
                }`}></div>
                <p className="text-xs text-center mt-2">
                  {stepNum === 1 ? 'Medya' : stepNum === 2 ? 'Detaylar' : 'PaylaÅŸ'}
                </p>
              </div>
            ))}
          </div>
        </div>

        {/* Content */}
        <div className="p-6 overflow-y-auto max-h-[60vh]">
          {step === 1 && (
            <div>
              <h3 className="text-lg font-bold mb-4">Medya Ekle</h3>
              
              {/* Image upload area */}
              <div 
                className="border-2 border-dashed border-gray-300 rounded-2xl p-8 text-center cursor-pointer hover:border-blue-400 transition"
                onClick={() => fileInputRef.current?.click()}
              >
                {postData.images.length === 0 ? (
                  <>
                    <div className="text-4xl mb-4">ğŸ“¸</div>
                    <p className="font-medium text-gray-700">FotoÄŸraf veya video yÃ¼kleyin</p>
                    <p className="text-sm text-gray-500 mt-2">
                      SÃ¼rÃ¼kle bÄ±rak veya tÄ±kla
                    </p>
                  </>
                ) : (
                  <div className="grid grid-cols-3 gap-4">
                    {postData.images.map((image, index) => (
                      <div key={index} className="relative">
                        <img
                          src={URL.createObjectURL(image)}
                          alt={`Preview ${index}`}
                          className="w-full h-32 object-cover rounded-lg"
                        />
                        <button
                          onClick={(e) => {
                            e.stopPropagation()
                            removeImage(index)
                          }}
                          className="absolute -top-2 -right-2 bg-red-500 text-white w-6 h-6 rounded-full"
                        >
                          Ã—
                        </button>
                      </div>
                    ))}
                    <div 
                      className="border-2 border-dashed border-gray-300 rounded-lg h-32 flex items-center justify-center"
                      onClick={() => fileInputRef.current?.click()}
                    >
                      <span className="text-2xl">+</span>
                    </div>
                  </div>
                )}
              </div>

              <input
                type="file"
                ref={fileInputRef}
                multiple
                accept="image/*,video/*"
                onChange={(e) => {
                  if (e.target.files) {
                    handleImageUpload(Array.from(e.target.files))
                  }
                }}
                className="hidden"
              />

              <div className="mt-6">
                <h4 className="font-medium mb-3">PaylaÅŸÄ±m TÃ¼rÃ¼</h4>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                  {[
                    { value: 'sighting', label: 'ğŸ‘ï¸ GÃ¶rdÃ¼m', desc: 'Nadir Ã¼rÃ¼n gÃ¶rdÃ¼m' },
                    { value: 'collection', label: 'ğŸ† Koleksiyon', desc: 'Koleksiyonumu paylaÅŸÄ±yorum' },
                    { value: 'question', label: 'â“ Soru', desc: 'Bu nedir?' },
                    { value: 'showcase', label: 'âœ¨ Vitrin', desc: 'ÃœrÃ¼nÃ¼mÃ¼ sergiliyorum' }
                  ].map((type) => (
                    <button
                      key={type.value}
                      onClick={() => setPostData({...postData, type: type.value})}
                      className={`p-4 rounded-xl border-2 text-center ${
                        postData.type === type.value
                          ? 'border-blue-500 bg-blue-50'
                          : 'border-gray-200 hover:border-gray-300'
                      }`}
                    >
                      <div className="text-2xl mb-2">{type.label.split(' ')[0]}</div>
                      <div className="font-medium">{type.label.split(' ')[1]}</div>
                      <div className="text-xs text-gray-500 mt-1">{type.desc}</div>
                    </button>
                  ))}
                </div>
              </div>
            </div>
          )}

          {step === 2 && (
            <div>
              <h3 className="text-lg font-bold mb-4">DetaylarÄ± Ekle</h3>
              
              {/* Caption */}
              <div className="mb-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  AÃ§Ä±klama
                </label>
                <textarea
                  value={postData.caption}
                  onChange={(e) => setPostData({...postData, caption: e.target.value})}
                  placeholder="PaylaÅŸÄ±mÄ±nÄ±zÄ± anlatÄ±n..."
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-32"
                  maxLength={2000}
                />
                <div className="text-right text-sm text-gray-500 mt-1">
                  {postData.caption.length}/2000
                </div>
              </div>

              {/* Hashtags */}
              <div className="mb-6">
                <HashtagInput
                  hashtags={postData.hashtags}
                  onAdd={handleHashtagAdd}
                  onRemove={handleHashtagRemove}
                />
              </div>

              {/* Location */}
              <div className="mb-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Konum (opsiyonel)
                </label>
                <LocationPicker
                  value={postData.location}
                  onChange={(location) => setPostData({...postData, location})}
                />
              </div>

              {/* Category */}
              <div className="mb-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Kategori
                </label>
                <select
                  value={postData.category}
                  onChange={(e) => setPostData({...postData, category: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg"
                >
                  <option value="">Kategori seÃ§in</option>
                  <option value="electronics">Elektronik</option>
                  <option value="fashion">Giyim & Aksesuar</option>
                  <option value="home">Ev & BahÃ§e</option>
                  <option value="collectible">Koleksiyon</option>
                  <option value="vehicle">AraÃ§ & ParÃ§a</option>
                  <option value="other">DiÄŸer</option>
                </select>
              </div>

              {/* Privacy */}
              <div className="flex items-center space-x-3">
                <input
                  type="checkbox"
                  checked={postData.isPublic}
                  onChange={(e) => setPostData({...postData, isPublic: e.target.checked})}
                  className="w-4 h-4 text-blue-600"
                  id="isPublic"
                />
                <label htmlFor="isPublic" className="text-sm font-medium text-gray-700">
                  Herkese aÃ§Ä±k paylaÅŸ
                </label>
                <span className="text-xs text-gray-500">
                  (KapalÄ±ysa sadece takipÃ§ilerin gÃ¶rebilir)
                </span>
              </div>
            </div>
          )}

          {step === 3 && (
            <div>
              <h3 className="text-lg font-bold mb-4">Ã–nizleme</h3>
              
              {/* Post preview */}
              <div className="bg-gray-50 rounded-xl p-4">
                {/* Header preview */}
                <div className="flex items-center space-x-3 mb-4">
                  <div className="w-12 h-12 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full"></div>
                  <div>
                    <div className="font-bold">Sen</div>
                    <div className="text-sm text-gray-500">
                      {postData.location || 'Konum belirtilmemiÅŸ'}
                    </div>
                  </div>
                </div>

                {/* Caption preview */}
                {postData.caption && (
                  <p className="text-gray-800 mb-4 whitespace-pre-line">
                    {postData.caption}
                    {postData.hashtags.length > 0 && (
                      <div className="mt-2">
                        {postData.hashtags.map(tag => (
                          <span key={tag} className="text-blue-600 mr-2">
                            #{tag}
                          </span>
                        ))}
                      </div>
                    )}
                  </p>
                )}

                {/* Images preview */}
                {postData.images.length > 0 && (
                  <div className="grid grid-cols-2 gap-2 mb-4">
                    {postData.images.slice(0, 4).map((image, index) => (
                      <div key={index} className="relative h-32 bg-gray-200 rounded-lg overflow-hidden">
                        <img
                          src={URL.createObjectURL(image)}
                          alt={`Preview ${index}`}
                          className="w-full h-full object-cover"
                        />
                        {postData.images.length > 4 && index === 3 && (
                          <div className="absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center text-white font-bold text-lg">
                            +{postData.images.length - 4}
                          </div>
                        )}
                      </div>
                    ))}
                  </div>
                )}

                {/* Stats preview */}
                <div className="text-sm text-gray-500">
                  {postData.type === 'sighting' && 'ğŸ‘ï¸ GÃ¶rdÃ¼m paylaÅŸÄ±mÄ± â€¢ '}
                  {postData.type === 'collection' && 'ğŸ† Koleksiyon paylaÅŸÄ±mÄ± â€¢ '}
                  {postData.images.length} fotoÄŸraf â€¢ Herkese aÃ§Ä±k
                </div>
              </div>

              {/* Bonus points info */}
              <div className="mt-6 bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="font-medium text-green-800">ğŸ‰ Puan KazanacaksÄ±nÄ±z!</p>
                    <p className="text-sm text-green-600">
                      â€¢ PaylaÅŸÄ±m: <strong>10 puan</strong><br />
                      â€¢ FotoÄŸraf baÅŸÄ±na: <strong>+5 puan</strong><br />
                      â€¢ Hashtag baÅŸÄ±na: <strong>+2 puan</strong>
                    </p>
                  </div>
                  <div className="text-2xl">ğŸ†</div>
                </div>
              </div>
            </div>
          )}
        </div>

        {/* Footer */}
        <div className="border-t p-6">
          <div className="flex justify-between">
            <button
              onClick={() => step > 1 ? setStep(step - 1) : onClose()}
              className="px-6 py-3 text-gray-700 hover:text-gray-900 font-medium"
            >
              {step === 1 ? 'Ä°ptal' : 'Geri'}
            </button>
            
            <button
              onClick={() => {
                if (step < 3) {
                  setStep(step + 1)
                } else {
                  handleSubmit()
                }
              }}
              disabled={loading || (step === 1 && postData.images.length === 0)}
              className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-lg disabled:opacity-50"
            >
              {loading ? (
                <span className="flex items-center">
                  <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>
                  PaylaÅŸÄ±lÄ±yor...
                </span>
              ) : step === 3 ? (
                `PaylaÅŸ (${10 + (postData.images.length * 5)} puan kazan)`
              ) : (
                'Devam Et'
              )}
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\Feed.tsx
ğŸ“Š 285 satÄ±r | 7.99 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/Feed.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect, useCallback } from 'react'
import { supabase } from '@/lib/supabase'
import FeedPost from './FeedPost'
import FeedFilters, { FilterType } from './FeedFilters'
import CreatePostButton from './CreatePostButton'
import StoriesBar from './StoriesBar'
import { useInView } from 'react-intersection-observer'

interface FeedProps {
  initialUserId?: string
  type?: FilterType
}

// FOLLOWING Ä°Ã‡Ä°N TÄ°P TANIMI
interface FollowingData {
  following_id: string
}

export default function Feed({ initialUserId, type = 'for-you' }: FeedProps) {
  const [posts, setPosts] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
  const [hasMore, setHasMore] = useState(true)
  const [page, setPage] = useState(0)
  const [activeFilter, setActiveFilter] = useState<FilterType>(type)
  
  const { ref, inView } = useInView()
  const PAGE_SIZE = 10

  const fetchPosts = useCallback(async (pageNum: number, refresh = false) => {
    try {
      setLoading(true)
      
      let query = supabase
        .from('social_posts')
        .select(`
          *,
          user:user_profiles(*),
          shop:shops(*),
          likes:social_likes(count),
          comments:social_comments(count),
          saves:social_saves(count)
        `)
        .eq('status', 'active')
        .eq('is_public', true)
        .order('created_at', { ascending: false })

      // Filtreler
      switch (activeFilter) {
        case 'following':
          if (initialUserId) {
            const { data: following } = await supabase
              .from('social_follows')
              .select('following_id')
              .eq('follower_id', initialUserId)

            if (following && following.length > 0) {
              // DÃœZELTME: 'f' parametresine tip ekle
              const followingIds = following.map((f: FollowingData) => f.following_id)
              query = query.in('user_id', followingIds)
            } else {
              setPosts([])
              setHasMore(false)
              return
            }
          }
          break
        
        case 'popular':
          query = query.order('like_count', { ascending: false })
          break
        
        case 'category':
          // Kategori filtresi
          break
      }

      // Sayfalama
      const from = pageNum * PAGE_SIZE
      const to = from + PAGE_SIZE - 1
      
      query = query.range(from, to)

      const { data, error } = await query

      if (error) throw error

      if (data) {
        if (refresh) {
          setPosts(data)
        } else {
          setPosts(prev => [...prev, ...data])
        }
        
        setHasMore(data.length === PAGE_SIZE)
      }
    } catch (error) {
      console.error('Feed yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }, [activeFilter, initialUserId])

  // Infinite scroll
  useEffect(() => {
    if (inView && hasMore && !loading) {
      const nextPage = page + 1
      setPage(nextPage)
      fetchPosts(nextPage)
    }
  }, [inView, hasMore, loading, fetchPosts, page])

  // Filtre deÄŸiÅŸince yenile
  useEffect(() => {
    setPage(0)
    setPosts([])
    fetchPosts(0, true)
  }, [activeFilter, fetchPosts])

  // Ä°lk yÃ¼kleme
  useEffect(() => {
    fetchPosts(0, true)
  }, [])

  const handleLike = async (postId: string, liked: boolean): Promise<void> => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      if (liked) {
        await supabase
          .from('social_likes')
          .delete()
          .eq('post_id', postId)
          .eq('user_id', user.id)
      } else {
        await supabase
          .from('social_likes')
          .insert({
            post_id: postId,
            user_id: user.id
          })

        // Bildirim gÃ¶nder
        const post = posts.find(p => p.id === postId)
        if (post && post.user_id !== user.id) {
          await supabase.from('social_notifications').insert({
            user_id: post.user_id,
            type: 'like',
            actor_id: user.id,
            post_id: postId,
            message: 'paylaÅŸÄ±mÄ±nÄ± beÄŸendi'
          })
        }
      }

      // UI gÃ¼ncelle
      setPosts(prev => prev.map(post => {
        if (post.id === postId) {
          return {
            ...post,
            like_count: liked ? post.like_count - 1 : post.like_count + 1,
            is_liked: !liked
          }
        }
        return post
      }))

    } catch (error) {
      console.error('Like hatasÄ±:', error)
    }
  }

  const handleSave = async (postId: string, saved: boolean): Promise<void> => {
    try {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      if (saved) {
        await supabase
          .from('social_saves')
          .delete()
          .eq('post_id', postId)
          .eq('user_id', user.id)
      } else {
        await supabase
          .from('social_saves')
          .insert({
            post_id: postId,
            user_id: user.id
          })
      }

      // UI gÃ¼ncelle
      setPosts(prev => prev.map(post => {
        if (post.id === postId) {
          return {
            ...post,
            save_count: saved ? post.save_count - 1 : post.save_count + 1,
            is_saved: !saved
          }
        }
        return post
      }))

    } catch (error) {
      console.error('Save hatasÄ±:', error)
    }
  }

  return (
    <div className="max-w-2xl mx-auto">
      {/* Stories Bar */}
      <StoriesBar />

      {/* Create Post Button */}
      <CreatePostButton />

      {/* Filters */}
      <FeedFilters 
        activeFilter={activeFilter}
        onFilterChange={setActiveFilter}
      />

      {/* Feed Posts */}
      <div className="space-y-6 mt-6">
        {posts.map((post) => (
          <FeedPost
            key={post.id}
            post={post}
            onLike={handleLike}
            onSave={handleSave}
            onComment={() => console.log('comment')}
            onShare={() => console.log('share')}
          />
        ))}
      </div>

      {/* Loading & Infinite Scroll */}
      {loading && (
        <div className="mt-8 space-y-6">
          {[...Array(3)].map((_, i) => (
            <div key={i} className="animate-pulse bg-white rounded-xl shadow p-6">
              <div className="flex items-center space-x-3">
                <div className="w-12 h-12 bg-gray-200 rounded-full"></div>
                <div className="flex-1">
                  <div className="h-4 bg-gray-200 rounded w-1/4"></div>
                  <div className="h-3 bg-gray-200 rounded w-1/2 mt-2"></div>
                </div>
              </div>
              <div className="mt-4">
                <div className="h-4 bg-gray-200 rounded w-full"></div>
                <div className="h-4 bg-gray-200 rounded w-3/4 mt-2"></div>
              </div>
              <div className="mt-4 h-64 bg-gray-200 rounded-lg"></div>
            </div>
          ))}
        </div>
      )}

      {/* Infinite Scroll Trigger */}
      {hasMore && !loading && (
        <div ref={ref} className="py-8 text-center">
          <div className="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
        </div>
      )}

      {/* No Posts */}
      {!loading && posts.length === 0 && (
        <div className="text-center py-12">
          <div className="text-4xl mb-4">ğŸ“­</div>
          <h3 className="text-xl font-bold text-gray-900 mb-2">HenÃ¼z paylaÅŸÄ±m yok</h3>
          <p className="text-gray-600 mb-6">
            {activeFilter === 'following' 
              ? 'Takip ettiÄŸin kiÅŸiler henÃ¼z paylaÅŸÄ±m yapmamÄ±ÅŸ'
              : 'Ä°lk paylaÅŸÄ±mÄ± sen yap!'}
          </p>
          <CreatePostButton variant="primary" />
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\FeedFilters.tsx
ğŸ“Š 40 satÄ±r | 1.28 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/FeedFilters.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

export type FilterType = 'for-you' | 'following' | 'popular' | 'category'

interface FeedFiltersProps {
  activeFilter: FilterType
  onFilterChange: (filter: FilterType) => void // TÄ°P DÃœZELTMESÄ°
}

export default function FeedFilters({ 
  activeFilter, 
  onFilterChange 
}: FeedFiltersProps) {
  const filters: Array<{ id: FilterType; label: string; icon: string }> = [
    { id: 'for-you', label: 'Sana Ã–zel', icon: 'ğŸ¯' },
    { id: 'following', label: 'Takip Edilenler', icon: 'ğŸ‘¥' },
    { id: 'popular', label: 'PopÃ¼ler', icon: 'ğŸ”¥' },
    { id: 'category', label: 'Kategoriler', icon: 'ğŸ·ï¸' }
  ]

  return (
    <div className="flex overflow-x-auto space-x-2 pb-4">
      {filters.map((filter) => (
        <button
          key={filter.id}
          onClick={() => onFilterChange(filter.id)}
          className={`flex items-center space-x-2 px-4 py-2 rounded-full whitespace-nowrap transition ${
            activeFilter === filter.id
              ? 'bg-blue-600 text-white'
              : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
          }`}
        >
          <span>{filter.icon}</span>
          <span>{filter.label}</span>
        </button>
      ))}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\FeedPost.tsx
ğŸ“Š 249 satÄ±r | 7.96 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/FeedPost.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import Image from 'next/image'
import Link from 'next/link'
import PostActions from './PostActions'
import CommentsSection from './CommentsSection' // âœ… DÃœZELTÄ°LDÄ°
import PostHeader from './PostHeader' // âœ… DÃœZELTÄ°LDÄ°

interface FeedPostProps {
  post: any
  onLike: (postId: string, liked: boolean) => void
  onSave: (postId: string, saved: boolean) => void
  onComment: () => void
  onShare: () => void
  showFull?: boolean
}

export default function FeedPost({ 
  post, 
  onLike, 
  onSave, 
  onComment, 
  onShare,
  showFull = false 
}: FeedPostProps) {
  const [isLiked, setIsLiked] = useState(false)
  const [isSaved, setIsSaved] = useState(false)
  const [showComments, setShowComments] = useState(false)
  const [imageIndex, setImageIndex] = useState(0)
  const [user, setUser] = useState<any>(null)

  useEffect(() => {
    checkUserInteractions()
    fetchUser()
  }, [post.id])

  const checkUserInteractions = async () => {
    try {
      const { data: { user: authUser } } = await supabase.auth.getUser()
      if (!authUser) return

      // BeÄŸeni kontrolÃ¼
      const { data: like } = await supabase
        .from('social_likes')
        .select('id')
        .eq('post_id', post.id)
        .eq('user_id', authUser.id)
        .single()

      // Kaydetme kontrolÃ¼
      const { data: save } = await supabase
        .from('social_saves')
        .select('id')
        .eq('post_id', post.id)
        .eq('user_id', authUser.id)
        .single()

      setIsLiked(!!like)
      setIsSaved(!!save)
    } catch (error) {
      // Hata durumunda silent fail
    }
  }

  const fetchUser = async () => {
    if (!post.user_id) return
    const { data } = await supabase
      .from('user_profiles')
      .select('*')
      .eq('id', post.user_id)
      .single()
    setUser(data)
  }

  // TÄ°P DÃœZELTMESÄ° - async/await eklendi
  const handleLikeClick = async () => {
    const newLikedState = !isLiked
    setIsLiked(newLikedState)
    await onLike(post.id, isLiked)
  }

  // TÄ°P DÃœZELTMESÄ° - async/await eklendi
  const handleSaveClick = async () => {
    const newSavedState = !isSaved
    setIsSaved(newSavedState)
    await onSave(post.id, isSaved)
  }

  const hasMultipleImages = post.image_urls && post.image_urls.length > 1

  return (
    <div className="bg-white rounded-xl shadow-lg overflow-hidden">
      {/* Header - KullanÄ±cÄ± bilgileri */}
      <PostHeader 
        user={user || post.user}
        post={post}
        onFollow={() => console.log('follow')}
      />

      {/* Caption */}
      {post.caption && (
        <div className="px-6 pt-4">
          <p className="text-gray-800 whitespace-pre-line">
            {post.caption}
            
            {/* Hashtag'ler */}
            {post.hashtags && post.hashtags.length > 0 && (
              <div className="mt-2">
                {post.hashtags.map((tag: string) => (
                  <Link
                    key={tag}
                    href={`/discover/tags/${tag.replace('#', '')}`}
                    className="inline-block text-blue-600 hover:text-blue-800 mr-2 text-sm"
                  >
                    {tag}
                  </Link>
                ))}
              </div>
            )}
          </p>
          
          {/* Konum */}
          {post.location && (
            <div className="mt-2 flex items-center text-gray-600 text-sm">
              <span className="mr-1">ğŸ“</span>
              {post.location}
            </div>
          )}
        </div>
      )}

      {/* Medya - Image/Video */}
      {post.image_urls && post.image_urls.length > 0 && (
        <div className="relative mt-4">
          {/* Ana resim */}
          <div className="relative h-[500px] bg-gray-100">
            <img
              src={post.image_urls[imageIndex]}
              alt={post.caption || 'Post image'}
              className="w-full h-full object-contain"
            />

            {/* Ã‡oklu resim navigasyonu */}
            {hasMultipleImages && (
              <>
                {/* Dots indicator */}
                <div className="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
                  {post.image_urls.map((_: any, index: number) => (
                    <button
                      key={index}
                      onClick={() => setImageIndex(index)}
                      className={`w-2 h-2 rounded-full ${
                        index === imageIndex ? 'bg-white' : 'bg-white bg-opacity-50'
                      }`}
                    />
                  ))}
                </div>

                {/* Navigation buttons */}
                {imageIndex > 0 && (
                  <button
                    onClick={() => setImageIndex(prev => prev - 1)}
                    className="absolute left-4 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-white bg-opacity-80 rounded-full flex items-center justify-center hover:bg-opacity-100"
                  >
                    â†
                  </button>
                )}
                {imageIndex < post.image_urls.length - 1 && (
                  <button
                    onClick={() => setImageIndex(prev => prev + 1)}
                    className="absolute right-4 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-white bg-opacity-80 rounded-full flex items-center justify-center hover:bg-opacity-100"
                  >
                    â†’
                  </button>
                )}
              </>
            )}
          </div>

          {/* Image counter */}
          {hasMultipleImages && (
            <div className="absolute top-4 right-4 bg-black bg-opacity-60 text-white px-3 py-1 rounded-full text-sm">
              {imageIndex + 1} / {post.image_urls.length}
            </div>
          )}
        </div>
      )}

      {/* Ä°statistikler */}
      <div className="px-6 py-3 border-t border-gray-100">
        <div className="flex items-center justify-between text-sm text-gray-600">
          <div className="flex items-center space-x-4">
            <div className="flex items-center">
              <span className="mr-1">â¤ï¸</span>
              <span className="font-medium">{post.like_count || 0}</span>
            </div>
            <div className="flex items-center">
              <span className="mr-1">ğŸ’¬</span>
              <span className="font-medium">{post.comment_count || 0}</span>
            </div>
            <div className="flex items-center">
              <span className="mr-1">ğŸ“¤</span>
              <span className="font-medium">{post.share_count || 0}</span>
            </div>
          </div>
          <div className="flex items-center">
            <span className="mr-1">ğŸ‘ï¸</span>
            <span className="font-medium">{post.view_count || 0}</span>
          </div>
        </div>
      </div>

      {/* Aksiyon ButonlarÄ± */}
      <PostActions
        isLiked={isLiked}
        isSaved={isSaved}
        onLike={handleLikeClick} // async fonksiyon
        onSave={handleSaveClick} // async fonksiyon
        onComment={() => {
          setShowComments(!showComments)
          onComment()
        }}
        onShare={onShare}
      />

      {/* Yorumlar BÃ¶lÃ¼mÃ¼ */}
      {showComments && (
        <CommentsSection 
          postId={post.id}
          initialComments={post.comments || []}
          onClose={() => setShowComments(false)}
        />
      )}

      {/* Zamansal bilgi */}
      <div className="px-6 py-3 border-t border-gray-100">
        <p className="text-xs text-gray-500">
          {new Date(post.created_at).toLocaleDateString('tr-TR', {
            hour: '2-digit',
            minute: '2-digit'
          })}
        </p>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\HashtagInput.tsx
ğŸ“Š 78 satÄ±r | 2.07 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/HashtagInput.tsx
'use client'

import { useState } from 'react'

interface HashtagInputProps {
  hashtags: string[]
  onAdd: (hashtag: string) => void
  onRemove: (hashtag: string) => void
}

export default function HashtagInput({ hashtags, onAdd, onRemove }: HashtagInputProps) {
  const [input, setInput] = useState('')

  const handleAdd = () => {
    const cleanTag = input.trim().replace(/#/g, '')
    if (cleanTag && !hashtags.includes(cleanTag)) {
      onAdd(cleanTag)
      setInput('')
    }
  }

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' || e.key === ',') {
      e.preventDefault()
      handleAdd()
    }
  }

  return (
    <div className="space-y-3">
      <label className="block text-sm font-medium text-gray-700">
        Hashtag'ler (opsiyonel)
      </label>
      
      <div className="flex">
        <input
          type="text"
          value={input}
          onChange={(e) => setInput(e.target.value)}
          onKeyDown={handleKeyDown}
          placeholder="#vintage #kamera #antika"
          className="flex-1 px-4 py-2 border border-gray-300 rounded-l-lg"
        />
        <button
          type="button"
          onClick={handleAdd}
          className="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-r-lg"
        >
          Ekle
        </button>
      </div>

      {/* Hashtag listesi */}
      <div className="flex flex-wrap gap-2">
        {hashtags.map((tag) => (
          <div
            key={tag}
            className="flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm"
          >
            #{tag}
            <button
              type="button"
              onClick={() => onRemove(tag)}
              className="ml-2 text-blue-600 hover:text-blue-900"
            >
              Ã—
            </button>
          </div>
        ))}
      </div>

      <p className="text-xs text-gray-500">
        Hashtag baÅŸÄ±na +2 puan kazanÄ±rsÄ±nÄ±z. Max 5 hashtag.
      </p>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\LocationPicker.tsx
ğŸ“Š 45 satÄ±r | 1.31 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/LocationPicker.tsx
'use client'

import { useState } from 'react'
import { MapPin } from 'lucide-react'

interface LocationPickerProps {
  value: string
  onChange: (value: string) => void
}

export default function LocationPicker({ value, onChange }: LocationPickerProps) {
  const popularLocations = [
    'Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya',
    'Evim', 'Ä°ÅŸyeri', 'Sahil', 'AlÄ±ÅŸveriÅŸ Merkezi'
  ]

  return (
    <div className="space-y-3">
      <div className="relative">
        <MapPin className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
        <input
          type="text"
          value={value}
          onChange={(e) => onChange(e.target.value)}
          placeholder="Nerede Ã§ektiniz? (opsiyonel)"
          className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"
        />
      </div>

      <div className="flex flex-wrap gap-2">
        {popularLocations.map((location) => (
          <button
            key={location}
            type="button"
            onClick={() => onChange(location)}
            className="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full text-sm"
          >
            {location}
          </button>
        ))}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\MobileNavigation.tsx
ğŸ“Š 50 satÄ±r | 1.67 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/MobileNavigation.tsx
'use client'

import { useState } from 'react'
import { usePathname } from 'next/navigation'
import Link from 'next/link'

export default function MobileNavigation() {
  const pathname = usePathname()
  const [showMenu, setShowMenu] = useState(false)

  const navItems = [
    { path: '/discovery', label: 'KeÅŸfet', icon: 'ğŸ”' },
    { path: '/discovery?tab=following', label: 'Takip', icon: 'ğŸ‘¥' },
    { path: '/discovery/create', label: 'OluÅŸtur', icon: 'â•', highlight: true },
    { path: '/discovery/notifications', label: 'Bildirim', icon: 'ğŸ””' },
    { path: '/discovery/profile', label: 'Profil', icon: 'ğŸ‘¤' },
  ]

  return (
    <>
      {/* Mobile Bottom Nav */}
      <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-40 md:hidden">
        <div className="flex justify-around items-center h-16">
          {navItems.map((item) => {
            const isActive = pathname === item.path
            
            return (
              <Link
                key={item.path}
                href={item.path}
                className={`flex flex-col items-center justify-center ${
                  isActive ? 'text-blue-600' : 'text-gray-600'
                }`}
              >
                <div className={`text-2xl ${item.highlight ? 'text-blue-600' : ''}`}>
                  {item.icon}
                </div>
                <span className="text-xs mt-1">{item.label}</span>
              </Link>
            )
          })}
        </div>
      </div>

      {/* Mobile iÃ§in ekstra padding */}
      <div className="pb-16 md:pb-0"></div>
    </>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\PostActions.tsx
ğŸ“Š 154 satÄ±r | 5.33 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/PostActions.tsx - DÃœZELTÄ°LMÄ°Å
'use client'

import { useState } from 'react'

interface PostActionsProps {
  isLiked: boolean
  isSaved: boolean
  onLike: () => void | Promise<void> // TÄ°P DÃœZELTMESÄ°
  onSave: () => void | Promise<void> // TÄ°P DÃœZELTMESÄ°
  onComment: () => void
  onShare: () => void
}

export default function PostActions({
  isLiked,
  isSaved,
  onLike,
  onSave,
  onComment,
  onShare
}: PostActionsProps) {
  const [showReactions, setShowReactions] = useState(false)
  const [showShareMenu, setShowShareMenu] = useState(false)

  const reactions = [
    { emoji: 'â¤ï¸', label: 'Like', value: 'like' },
    { emoji: 'ğŸ˜', label: 'Love', value: 'love' },
    { emoji: 'ğŸ˜®', label: 'Wow', value: 'wow' },
    { emoji: 'ğŸ˜‚', label: 'Haha', value: 'laugh' },
    { emoji: 'ğŸ˜¢', label: 'Sad', value: 'sad' },
    { emoji: 'ğŸ˜ ', label: 'Angry', value: 'angry' }
  ]

  const shareOptions = [
    { icon: 'ğŸ“±', label: 'Mesaj', action: 'message' },
    { icon: 'ğŸ“§', label: 'Email', action: 'email' },
    { icon: 'ğŸ”—', label: 'Kopyala', action: 'copy' },
    { icon: 'ğŸ“˜', label: 'Facebook', action: 'facebook' },
    { icon: 'ğŸ¦', label: 'Twitter', action: 'twitter' }
  ]

  const handleReaction = (reaction: string) => {
    console.log('Reaction:', reaction)
    setShowReactions(false)
  }

  const handleShare = (action: string) => {
    console.log('Share action:', action)
    setShowShareMenu(false)
  }

  return (
    <div className="px-6 py-3 border-t border-gray-100">
      <div className="flex items-center justify-between">
        {/* Sol taraf - BeÄŸeni ve yorum */}
        <div className="flex items-center space-x-4">
          {/* BeÄŸeni butonu ve reactions */}
          <div className="relative">
            <button
              onClick={onLike}
              onMouseEnter={() => setShowReactions(true)}
              onMouseLeave={() => setTimeout(() => setShowReactions(false), 500)}
              className={`flex items-center space-x-2 px-3 py-2 rounded-lg transition ${
                isLiked 
                  ? 'bg-red-50 text-red-600' 
                  : 'hover:bg-gray-100 text-gray-700'
              }`}
            >
              <span className="text-xl">{isLiked ? 'â¤ï¸' : 'ğŸ¤'}</span>
              <span className="font-medium">BeÄŸen</span>
            </button>

            {/* Reactions popup */}
            {showReactions && (
              <div 
                className="absolute bottom-full left-0 mb-2 bg-white rounded-xl shadow-2xl border p-2 flex space-x-1 z-50"
                onMouseEnter={() => setShowReactions(true)}
                onMouseLeave={() => setShowReactions(false)}
              >
                {reactions.map((reaction) => (
                  <button
                    key={reaction.value}
                    onClick={() => handleReaction(reaction.value)}
                    className="w-10 h-10 hover:scale-125 transform transition duration-200 text-2xl"
                    title={reaction.label}
                  >
                    {reaction.emoji}
                  </button>
                ))}
              </div>
            )}
          </div>

          {/* Yorum butonu */}
          <button
            onClick={onComment}
            className="flex items-center space-x-2 px-3 py-2 rounded-lg hover:bg-gray-100 text-gray-700"
          >
            <span className="text-xl">ğŸ’¬</span>
            <span className="font-medium">Yorum</span>
          </button>
        </div>

        {/* SaÄŸ taraf - PaylaÅŸ ve kaydet */}
        <div className="flex items-center space-x-2">
          {/* Kaydet butonu */}
          <button
            onClick={onSave}
            className={`p-2 rounded-full ${
              isSaved 
                ? 'bg-yellow-50 text-yellow-600' 
                : 'hover:bg-gray-100 text-gray-700'
            }`}
            title={isSaved ? 'Kaydedildi' : 'Kaydet'}
          >
            <span className="text-xl">
              {isSaved ? 'â­' : 'âœ°'}
            </span>
          </button>

          {/* PaylaÅŸ butonu ve menu */}
          <div className="relative">
            <button
              onClick={() => setShowShareMenu(!showShareMenu)}
              className="p-2 rounded-full hover:bg-gray-100 text-gray-700"
              title="PaylaÅŸ"
            >
              <span className="text-xl">ğŸ“¤</span>
            </button>

            {/* Share menu */}
            {showShareMenu && (
              <div className="absolute right-0 bottom-full mb-2 bg-white rounded-xl shadow-2xl border p-3 w-48 z-50">
                <div className="space-y-2">
                  {shareOptions.map((option) => (
                    <button
                      key={option.action}
                      onClick={() => handleShare(option.action)}
                      className="w-full flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-gray-100 text-gray-700"
                    >
                      <span className="text-xl">{option.icon}</span>
                      <span>{option.label}</span>
                    </button>
                  ))}
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\PostHeader.tsx
ğŸ“Š 180 satÄ±r | 6.22 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/PostHeader.tsx
'use client'

import { useState } from 'react'
import { MoreVertical, MapPin, Calendar } from 'lucide-react'

interface PostHeaderProps {
  user: any
  post: any
  onFollow?: () => void
  onReport?: () => void
}

export default function PostHeader({ user, post, onFollow, onReport }: PostHeaderProps) {
  const [showMenu, setShowMenu] = useState(false)
  const [isFollowing, setIsFollowing] = useState(false)

  const handleFollow = () => {
    setIsFollowing(!isFollowing)
    if (onFollow) onFollow()
  }

  const handleReport = () => {
    setShowMenu(false)
    if (onReport) onReport()
  }

  const formatDate = (dateString: string) => {
    const date = new Date(dateString)
    const now = new Date()
    const diffMs = now.getTime() - date.getTime()
    const diffHours = Math.floor(diffMs / (1000 * 60 * 60))
    
    if (diffHours < 1) {
      return 'Az Ã¶nce'
    } else if (diffHours < 24) {
      return `${diffHours} saat Ã¶nce`
    } else {
      return date.toLocaleDateString('tr-TR')
    }
  }

  return (
    <div className="px-6 py-4">
      <div className="flex items-start justify-between">
        {/* Sol taraf - KullanÄ±cÄ± bilgileri */}
        <div className="flex items-center space-x-3">
          {/* Avatar */}
          <div className="relative">
            <div className="w-12 h-12 rounded-full overflow-hidden bg-gradient-to-br from-blue-400 to-purple-500">
              {user?.avatar_url ? (
                <img
                  src={user.avatar_url}
                  alt={user?.name || 'KullanÄ±cÄ±'}
                  className="w-full h-full object-cover"
                />
              ) : (
                <div className="w-full h-full flex items-center justify-center text-white font-bold text-lg">
                  {user?.name?.[0]?.toUpperCase() || 'K'}
                </div>
              )}
            </div>
            
            {/* Online status indicator */}
            <div className="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full"></div>
          </div>

          {/* KullanÄ±cÄ± bilgileri */}
          <div className="flex-1">
            <div className="flex items-center space-x-2">
              <h4 className="font-bold text-gray-900">
                {user?.name || 'KullanÄ±cÄ±'}
              </h4>
              
              {/* Verified badge (maÄŸaza veya premium kullanÄ±cÄ±) */}
              {post?.shop_id && (
                <span className="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">
                  ğŸª MaÄŸaza
                </span>
              )}
              
              {/* Seviye badge */}
              {user?.reputation?.level && user.reputation.level > 2 && (
                <span className="bg-yellow-100 text-yellow-800 text-xs px-2 py-0.5 rounded-full">
                  â­ Lv.{user.reputation.level}
                </span>
              )}
            </div>
            
            <div className="flex items-center text-sm text-gray-500 space-x-3 mt-1">
              {post?.location && (
                <div className="flex items-center">
                  <MapPin className="w-3 h-3 mr-1" />
                  <span>{post.location}</span>
                </div>
              )}
              
              <div className="flex items-center">
                <Calendar className="w-3 h-3 mr-1" />
                <span>{formatDate(post.created_at)}</span>
              </div>
            </div>
          </div>
        </div>

        {/* SaÄŸ taraf - MenÃ¼ ve takip butonu */}
        <div className="flex items-center space-x-2">
          {/* Takip butonu */}
          <button
            onClick={handleFollow}
            className={`px-4 py-2 rounded-full text-sm font-medium ${
              isFollowing
                ? 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                : 'bg-blue-600 text-white hover:bg-blue-700'
            }`}
          >
            {isFollowing ? 'Takip Ediliyor' : 'Takip Et'}
          </button>

          {/* Daha fazla menÃ¼sÃ¼ */}
          <div className="relative">
            <button
              onClick={() => setShowMenu(!showMenu)}
              className="p-2 hover:bg-gray-100 rounded-full"
            >
              <MoreVertical className="w-5 h-5 text-gray-500" />
            </button>

            {showMenu && (
              <div className="absolute right-0 top-full mt-1 bg-white rounded-lg shadow-lg border w-48 z-50">
                <button
                  onClick={() => {
                    setShowMenu(false)
                    // PaylaÅŸÄ±mÄ± kaydet
                  }}
                  className="w-full text-left px-4 py-3 hover:bg-gray-50 text-gray-700"
                >
                  ğŸ“Œ Kaydet
                </button>
                <button
                  onClick={() => {
                    setShowMenu(false)
                    // BaÄŸlantÄ±yÄ± kopyala
                  }}
                  className="w-full text-left px-4 py-3 hover:bg-gray-50 text-gray-700"
                >
                  ğŸ”— BaÄŸlantÄ±yÄ± Kopyala
                </button>
                <button
                  onClick={handleReport}
                  className="w-full text-left px-4 py-3 hover:bg-gray-50 text-red-600 border-t"
                >
                  âš ï¸ Bildir
                </button>
              </div>
            )}
          </div>
        </div>
      </div>

      {/* Post tipi indicator */}
      {post?.type && (
        <div className="mt-3">
          <span className={`inline-block px-3 py-1 rounded-full text-xs font-medium ${
            post.type === 'sighting' 
              ? 'bg-green-100 text-green-800' 
              : post.type === 'collection'
              ? 'bg-purple-100 text-purple-800'
              : 'bg-blue-100 text-blue-800'
          }`}>
            {post.type === 'sighting' && 'ğŸ‘ï¸ GÃ¶rÃ¼ldÃ¼'}
            {post.type === 'collection' && 'ğŸ† Koleksiyon'}
            {post.type === 'question' && 'â“ Soru'}
            {post.type === 'showcase' && 'âœ¨ Vitrin'}
          </span>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\StoriesBar.tsx
ğŸ“Š 36 satÄ±r | 1.37 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/StoriesBar.tsx - BASÄ°T
'use client'

export default function StoriesBar() {
  const stories = [
    { id: 1, user: 'Ahmet', hasNew: true },
    { id: 2, user: 'Zeynep', hasNew: false },
    { id: 3, user: 'Mehmet', hasNew: true },
    { id: 4, user: 'AyÅŸe', hasNew: false },
    { id: 5, user: 'Can', hasNew: true },
  ]

  return (
    <div className="bg-white rounded-xl shadow p-4 mb-6">
      <div className="flex space-x-4 overflow-x-auto pb-2">
        {/* Kendi story */}
        <button className="flex-shrink-0 text-center">
          <div className="w-20 h-20 rounded-full border-4 border-blue-500 flex items-center justify-center text-2xl bg-gradient-to-br from-blue-400 to-purple-500 text-white">
            +
          </div>
          <div className="text-xs mt-2">Sen</div>
        </button>

        {/* DiÄŸer story'ler */}
        {stories.map((story) => (
          <button key={story.id} className="flex-shrink-0 text-center">
            <div className={`w-20 h-20 rounded-full ${story.hasNew ? 'border-4 border-green-500' : 'border-2 border-gray-300'}`}>
              <div className="w-full h-full rounded-full bg-gradient-to-br from-pink-400 to-orange-500"></div>
            </div>
            <div className="text-xs mt-2 truncate w-20">{story.user}</div>
          </button>
        ))}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\SuggestedUsers.tsx
ğŸ“Š 95 satÄ±r | 2.97 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/SuggestedUsers.tsx
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

export default function SuggestedUsers() {
  const router = useRouter()
  const [users, setUsers] = useState<any[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchSuggestedUsers()
  }, [])

  const fetchSuggestedUsers = async () => {
    try {
      // En aktif 5 kullanÄ±cÄ±
      const { data } = await supabase
        .from('user_profiles')
        .select('*')
        .limit(5)
        .order('created_at', { ascending: false })

      setUsers(data || [])
    } catch (error) {
      console.error('KullanÄ±cÄ±lar yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  const handleFollow = async (userId: string) => {
    // Takip etme iÅŸlemi
    console.log('Takip ediliyor:', userId)
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <h3 className="font-bold text-gray-900 mb-4">ğŸ‘¥ Ã–nerilen KullanÄ±cÄ±lar</h3>
        <div className="space-y-4">
          {[...Array(3)].map((_, i) => (
            <div key={i} className="animate-pulse flex items-center space-x-3">
              <div className="w-10 h-10 bg-gray-200 rounded-full"></div>
              <div className="flex-1">
                <div className="h-4 bg-gray-200 rounded w-1/2"></div>
                <div className="h-3 bg-gray-200 rounded w-1/4 mt-2"></div>
              </div>
            </div>
          ))}
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <h3 className="font-bold text-gray-900 mb-4">ğŸ‘¥ Ã–nerilen KullanÄ±cÄ±lar</h3>
      <div className="space-y-4">
        {users.map((user) => (
          <div key={user.id} className="flex items-center justify-between">
            <div className="flex items-center space-x-3">
              <div className="w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-bold">
                {user.name?.[0] || 'K'}
              </div>
              <div>
                <div className="font-medium">{user.name}</div>
                {user.bio && (
                  <div className="text-xs text-gray-500 truncate max-w-[120px]">
                    {user.bio}
                  </div>
                )}
              </div>
            </div>
            
            <button
              onClick={() => handleFollow(user.id)}
              className="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg"
            >
              Takip Et
            </button>
          </div>
        ))}
      </div>
      
      {users.length === 0 && (
        <p className="text-gray-500 text-center py-4">
          HenÃ¼z Ã¶nerilecek kullanÄ±cÄ± yok
        </p>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ social\TrendingHashtags.tsx
ğŸ“Š 78 satÄ±r | 2.39 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/social/TrendingHashtags.tsx
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

export default function TrendingHashtags() {
  const router = useRouter()
  const [hashtags, setHashtags] = useState<any[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchTrendingHashtags()
  }, [])

  const fetchTrendingHashtags = async () => {
    try {
      // Bu haftanÄ±n popÃ¼ler hashtag'leri
      const { data } = await supabase
        .from('social_hashtags')
        .select('*')
        .order('post_count', { ascending: false })
        .limit(8)

      setHashtags(data || [])
    } catch (error) {
      console.error('Hashtag yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  if (loading) {
    return (
      <div className="bg-white rounded-xl shadow p-6">
        <h3 className="font-bold text-gray-900 mb-4">ğŸ”¥ PopÃ¼ler Hashtag'ler</h3>
        <div className="space-y-2">
          {[...Array(5)].map((_, i) => (
            <div key={i} className="animate-pulse h-8 bg-gray-200 rounded"></div>
          ))}
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-xl shadow p-6">
      <h3 className="font-bold text-gray-900 mb-4">ğŸ”¥ PopÃ¼ler Hashtag'ler</h3>
      <div className="space-y-3">
        {hashtags.map((hashtag, index) => (
          <button
            key={hashtag.name}
            onClick={() => router.push(`/discovery/tags/${hashtag.name.replace('#', '')}`)}
            className="w-full flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg"
          >
            <div className="flex items-center">
              <span className="text-lg mr-3">{index < 3 ? 'ğŸ”¥' : '#'}</span>
              <div>
                <div className="font-medium text-left">{hashtag.name}</div>
                <div className="text-xs text-gray-500 text-left">
                  {hashtag.post_count} paylaÅŸÄ±m
                </div>
              </div>
            </div>
            <div className="text-blue-600 text-sm">â†’</div>
          </button>
        ))}
      </div>
      
      {hashtags.length === 0 && (
        <p className="text-gray-500 text-center py-4">
          HenÃ¼z popÃ¼ler hashtag yok
        </p>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ SpotCard.tsx
ğŸ“Š 250 satÄ±r | 8.26 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import Link from 'next/link'

interface SpotCardProps {
  spot: {
    id: string
    title: string
    description: string
    category: string | null
    location: string | null
    image_url: string | null
    status: string
    created_at: string
    views: number
    helps: number
    user?: {
      name: string | null
    }
  }
}

export default function SpotCard({ spot }: SpotCardProps) {
  // ZAMAN FORMATI
  const getTimeAgo = (dateString: string) => {
    try {
      const date = new Date(dateString)
      const now = new Date()
      const diffMs = now.getTime() - date.getTime()
      const diffMins = Math.floor(diffMs / 60000)
      const diffHours = Math.floor(diffMs / 3600000)
      const diffDays = Math.floor(diffMs / 86400000)

      if (diffMins < 1) return 'ÅŸimdi'
      if (diffMins < 60) return `${diffMins} dakika Ã¶nce`
      if (diffHours < 24) return `${diffHours} saat Ã¶nce`
      if (diffDays < 7) return `${diffDays} gÃ¼n Ã¶nce`
      return date.toLocaleDateString('tr-TR')
    } catch {
      return 'tarih belirsiz'
    }
  }

  // RESÄ°M URL'SÄ°NÄ° HAZIRLA
  const getImageUrl = (): string | null => {
    if (!spot.image_url) return null
    
    let url = spot.image_url
    
    // 1. NULL veya boÅŸ mu?
    if (!url || url.trim() === '') return null
    
    // 2. String mi?
    if (typeof url !== 'string') {
      console.error('image_url string deÄŸil:', typeof url, url)
      return null
    }
    
    // 3. Trim yap
    url = url.trim()
    
    // 4. TÄ±rnak iÅŸaretlerini temizle
    url = url.replace(/["']/g, '')
    
    // 5. BaÅŸÄ±na https:// ekle (gerekirse)
    if (url.startsWith('//')) {
      url = 'https:' + url
    }
    
    // 6. http:// ile baÅŸlÄ±yorsa https:// yap
    if (url.startsWith('http://')) {
      url = url.replace('http://', 'https://')
    }
    
    // 7. Supabase URL kontrolÃ¼
    if (url.includes('supabase.co')) {
      // /object/public/ kontrolÃ¼
      if (url.includes('/storage/v1/object/') && !url.includes('/public/')) {
        url = url.replace('/object/', '/object/public/')
      }
    }
    
    // 8. GeÃ§erli URL mi?
    try {
      new URL(url)
      return url
    } catch {
      console.error('GeÃ§ersiz URL:', url)
      return null
    }
  }

  const imageUrl = getImageUrl()
  const hasImage = !!imageUrl

  // KATEGORÄ° RENGÄ°
  const getCategoryColor = (category: string | null) => {
    if (!category) return 'bg-gray-100 text-gray-800'
    
    const colors: Record<string, string> = {
      'Elektronik': 'bg-blue-100 text-blue-800',
      'FotoÄŸraf Makineleri': 'bg-blue-100 text-blue-800',
      'Giyim & Aksesuar': 'bg-green-100 text-green-800',
      'Ev & BahÃ§e': 'bg-yellow-100 text-yellow-800',
      'Ev EÅŸyalarÄ±': 'bg-yellow-100 text-yellow-800',
      'Koleksiyon': 'bg-purple-100 text-purple-800',
      'Kitap & MÃ¼zik': 'bg-red-100 text-red-800',
      'Oyunlar': 'bg-indigo-100 text-indigo-800',
      'Spor & Outdoor': 'bg-pink-100 text-pink-800',
      'AraÃ§ & ParÃ§a': 'bg-gray-100 text-gray-800',
      'DiÄŸer': 'bg-gray-100 text-gray-800'
    }
    
    return colors[category] || 'bg-gray-100 text-gray-800'
  }

  return (
    <div className="bg-white rounded-xl shadow-md hover:shadow-lg transition duration-300 overflow-hidden border border-gray-100">
      {/* RESÄ°M BÃ–LÃœMÃœ - KESÄ°N Ã‡ALIÅACAK */}
      <div className="h-48 bg-gray-100 relative">
        {hasImage ? (
          <>
            {/* RESÄ°M */}
            <img
              src={imageUrl}
              alt={spot.title}
              className="w-full h-full object-cover"
              onLoad={() => console.log(`âœ… Resim yÃ¼klendi: ${spot.id}`)}
              onError={(e) => {
                console.error(`âŒ Resim yÃ¼klenemedi: ${imageUrl}`)
                const img = e.target as HTMLImageElement
                img.style.display = 'none'
                
                // FALLBACK gÃ¶ster
                const fallback = document.createElement('div')
                fallback.className = 'absolute inset-0 flex items-center justify-center bg-gray-200'
                fallback.innerHTML = `
                  <div class="text-center">
                    <span class="text-3xl block mb-2">ğŸ“·</span>
                    <p class="text-sm text-gray-600">Resim yÃ¼klenemedi</p>
                  </div>
                `
                img.parentNode?.appendChild(fallback)
              }}
            />
            
            {/* Yedek gÃ¶rÃ¼nÃ¼m (resim yÃ¼klenene kadar) */}
            <div className="absolute inset-0 flex items-center justify-center bg-gray-100" style={{ display: 'none' }}>
              <div className="text-center">
                <span className="text-3xl block mb-2">ğŸ“·</span>
                <p className="text-sm text-gray-600">Resim yÃ¼kleniyor...</p>
              </div>
            </div>
          </>
        ) : (
          // RESÄ°M YOKSA
          <div className="w-full h-full flex items-center justify-center bg-gray-50">
            <div className="text-center">
              <span className="text-4xl block mb-3 text-gray-400">ğŸ“·</span>
              <p className="text-sm text-gray-500">Resim Yok</p>
            </div>
          </div>
        )}
        
        {/* DURUM BADGE */}
        <div className="absolute top-3 right-3">
          <span className={`px-3 py-1 rounded-full text-xs font-medium ${
            spot.status === 'active' 
              ? 'bg-green-100 text-green-800 border border-green-200' 
              : 'bg-blue-100 text-blue-800 border border-blue-200'
          }`}>
            {spot.status === 'active' ? 'Aktif' : 'Bulundu'}
          </span>
        </div>
      </div>

      {/* Ä°Ã‡ERÄ°K BÃ–LÃœMÃœ */}
      <div className="p-5">
        {/* KULLANICI */}
        <div className="flex items-center mb-4">
          <div className="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
            {spot.user?.name?.[0]?.toUpperCase() || 'K'}
          </div>
          <div className="ml-3">
            <p className="font-medium text-sm">
              {spot.user?.name || 'KullanÄ±cÄ±'}
            </p>
            <p className="text-xs text-gray-500">
              {getTimeAgo(spot.created_at)}
            </p>
          </div>
        </div>

        {/* BAÅLIK */}
        <Link href={`/spots/${spot.id}`}>
          <h3 className="font-bold text-lg mb-2 hover:text-blue-600 line-clamp-1">
            {spot.title}
          </h3>
        </Link>
        
        {/* AÃ‡IKLAMA */}
        <p className="text-gray-600 text-sm mb-4 line-clamp-2">
          {spot.description}
        </p>

        {/* KATEGORÄ° & KONUM */}
        <div className="flex flex-wrap gap-2 mb-4">
          {spot.category && (
            <span className={`text-xs font-medium px-3 py-1 rounded-full ${getCategoryColor(spot.category)}`}>
              {spot.category}
            </span>
          )}
          
          {spot.location && (
            <span className="text-sm text-gray-500 flex items-center">
              <span className="mr-1">ğŸ“</span>
              {spot.location}
            </span>
          )}
        </div>

        {/* Ä°STATÄ°STÄ°KLER */}
        <div className="flex items-center justify-between text-sm text-gray-500 border-t border-gray-100 pt-4">
          <div className="flex items-center space-x-4">
            <span className="flex items-center">
              ğŸ‘ï¸ {spot.views || 0}
            </span>
            <span className="flex items-center">
              ğŸ¤ {spot.helps || 0}
            </span>
          </div>
          
          <Link 
            href={`/spots/${spot.id}`}
            className="text-blue-600 hover:text-blue-800 font-medium"
          >
            Detay â†’
          </Link>
        </div>

        {/* DEBUG: RESÄ°M BÄ°LGÄ°SÄ° */}
        {hasImage && process.env.NODE_ENV === 'development' && (
          <div className="mt-3 pt-3 border-t border-dashed border-gray-200">
            <p className="text-xs text-gray-400 truncate" title={imageUrl}>
              ğŸ”— {imageUrl.substring(0, 40)}...
            </p>
          </div>
        )}
      </div>
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ SpotList.tsx
ğŸ“Š 162 satÄ±r | 4.28 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/SpotList.tsx - GÃœNCELLENMÄ°Å
'use client';

import { useEffect, useState } from 'react';
import { supabase } from '@/lib/supabase';
import SpotCard from './SpotCard';
import NativeAd from './NativeAd';

interface SpotListProps {
  searchQuery?: string;
  category?: string;
  location?: string;
  status?: string;
}

export default function SpotList({ 
  searchQuery, 
  category, 
  location, 
  status 
}: SpotListProps) {
  const [spots, setSpots] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [page, setPage] = useState(1);
  const [hasMore, setHasMore] = useState(true);

  const loadSpots = async (pageNum = 1) => {
    setLoading(true);
    
    let query = supabase
      .from('spots')
      .select('*')
      .eq('status', 'active')
      .order('created_at', { ascending: false });

    // Filtreler
    if (searchQuery) {
      query = query.or(`title.ilike.%${searchQuery}%,description.ilike.%${searchQuery}%`);
    }
    if (category && category !== 'all') {
      query = query.eq('category', category);
    }
    if (location && location !== 'all') {
      query = query.eq('location', location);
    }

    const { data, error } = await query
      .range((pageNum - 1) * 12, pageNum * 12 - 1);

    if (error) {
      console.error('Error loading spots:', error);
      return;
    }

    if (pageNum === 1) {
      setSpots(data || []);
    } else {
      setSpots(prev => [...prev, ...(data || [])]);
    }

    setHasMore((data?.length || 0) === 12);
    setLoading(false);
  };

  useEffect(() => {
    loadSpots(1);
    setPage(1);
  }, [searchQuery, category, location, status]);

  const loadMore = () => {
    const nextPage = page + 1;
    setPage(nextPage);
    loadSpots(nextPage);
  };

  // ReklamlarÄ± spotlar arasÄ±na serpiÅŸtir
  const getItemsWithAds = () => {
    const items: any[] = [];
    const adFrequency = 4; // Her 4 spot'ta bir reklam
    
    spots.forEach((spot, index) => {
      items.push({
        type: 'spot',
        data: spot,
        key: `spot-${spot.id}`
      });
      
      // Belirli aralÄ±klarla reklam ekle
      if ((index + 1) % adFrequency === 0) {
        items.push({
          type: 'ad',
          key: `ad-${index}`,
          index: index
        });
      }
    });
    
    return items;
  };

  const items = getItemsWithAds();

  return (
    <div>
      {/* Spot Grid */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {items.map((item) => {
          if (item.type === 'spot') {
            return (
              <SpotCard key={item.key} spot={item.data} />
            );
          } else {
            return (
              <div key={item.key} className="col-span-full md:col-span-2 lg:col-span-3">
                <NativeAd index={item.index} />
              </div>
            );
          }
        })}
      </div>

      {/* Loading */}
      {loading && (
        <div className="text-center py-8">
          <div className="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
          <p className="mt-2 text-gray-600">Spot'lar yÃ¼kleniyor...</p>
        </div>
      )}

      {/* Load More */}
      {!loading && hasMore && spots.length > 0 && (
        <div className="text-center mt-8">
          <button
            onClick={loadMore}
            className="bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-3 px-8 rounded-lg transition-colors"
          >
            Daha Fazla Spot GÃ¶ster
          </button>
        </div>
      )}

      {/* No Results */}
      {!loading && spots.length === 0 && (
        <div className="text-center py-12">
          <div className="text-4xl mb-4">ğŸ”</div>
          <h3 className="text-xl font-semibold text-gray-800 mb-2">
            Spot bulunamadÄ±
          </h3>
          <p className="text-gray-600 mb-6">
            Arama kriterlerinize uygun spot bulunamadÄ±.
          </p>
          <a
            href="/create-spot"
            className="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg"
          >
            Ä°lk Spot'u Siz OluÅŸturun
          </a>
        </div>
      )}
    </div>
  );
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ Stats.tsx
ğŸ“Š 72 satÄ±r | 3.29 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

export default function Stats() {
  const stats = [
    { value: '10,000+', label: 'Aktif Spot', icon: 'ğŸ“', color: 'from-blue-500 to-blue-600' },
    { value: '50,000+', label: 'Topluluk Ãœyesi', icon: 'ğŸ‘¥', color: 'from-purple-500 to-purple-600' },
    { value: '5,000+', label: 'BaÅŸarÄ± Hikayesi', icon: 'ğŸ‰', color: 'from-green-500 to-green-600' },
    { value: '100+', label: 'Åehir', icon: 'ğŸ“', color: 'from-orange-500 to-orange-600' },
    { value: '24s', label: 'Ort. YanÄ±t SÃ¼resi', icon: 'âš¡', color: 'from-pink-500 to-pink-600' },
    { value: '94%', label: 'Memnuniyet OranÄ±', icon: 'â­', color: 'from-indigo-500 to-indigo-600' },
  ]

  return (
    <section className="py-16 bg-gradient-to-b from-white to-gray-50">
      <div className="container-custom">
        <div className="text-center mb-12">
          <h2 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            SpotItForMe Ä°statistikleri
          </h2>
          <p className="text-gray-600 max-w-2xl mx-auto">
            TÃ¼rkiye'nin en bÃ¼yÃ¼k kayÄ±p Ã¼rÃ¼n bulma topluluÄŸu olarak her gÃ¼n binlerce kiÅŸiye yardÄ±m ediyoruz
          </p>
        </div>

        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6">
          {stats.map((stat, index) => (
            <div 
              key={index}
              className="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 border border-gray-100"
            >
              <div className={`w-16 h-16 rounded-xl bg-gradient-to-br ${stat.color} flex items-center justify-center text-2xl text-white mx-auto mb-4`}>
                {stat.icon}
              </div>
              
              <div className="text-center">
                <div className="text-2xl md:text-3xl font-bold text-gray-900 mb-1">
                  {stat.value}
                </div>
                <div className="text-sm text-gray-600 font-medium">
                  {stat.label}
                </div>
              </div>
            </div>
          ))}
        </div>

        {/* CanlÄ± aktivite */}
        <div className="mt-12 bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-8 border border-blue-100">
          <div className="flex flex-col md:flex-row items-center justify-between">
            <div>
              <h3 className="text-xl font-bold text-gray-900 mb-2">ğŸ¯ Åu Anda Aktif Aramalar</h3>
              <p className="text-gray-600">
                <span className="font-bold text-blue-600">127 kiÅŸi</span> ÅŸu anda topluluÄŸumuzdan yardÄ±m bekliyor
              </p>
            </div>
            <div className="mt-4 md:mt-0">
              <div className="flex items-center space-x-4">
                <div className="flex -space-x-2">
                  {[1, 2, 3, 4, 5].map((i) => (
                    <div 
                      key={i}
                      className="w-10 h-10 rounded-full border-2 border-white bg-gradient-to-br from-blue-400 to-purple-400"
                    />
                  ))}
                </div>
                <span className="text-sm text-gray-600">+ daha fazlasÄ± yardÄ±m ediyor</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ StorageTest.tsx
ğŸ“Š 98 satÄ±r | 3.03 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/StorageTest.tsx
'use client';

import { useState } from 'react';
import { supabase } from '@/lib/supabase';

export default function StorageTest() {
  const [testing, setTesting] = useState(false);
  const [result, setResult] = useState<string>('');

  const testStorage = async () => {
    setTesting(true);
    setResult('Test baÅŸlÄ±yor...');
    
    try {
      // 1. Bucket listesini kontrol et
      setResult('Bucket listesi alÄ±nÄ±yor...');
      const { data: buckets, error: bucketsError } = await supabase.storage.listBuckets();
      
      if (bucketsError) {
        setResult(`Bucket listeleme hatasÄ±: ${bucketsError.message}`);
        return;
      }
      
      setResult(`Bucket'lar: ${buckets.map(b => b.name).join(', ')}`);
      
      // 2. product-images bucket'Ä±nÄ± kontrol et
      const hasProductImagesBucket = buckets.some(b => b.name === 'product-images');
      
      if (!hasProductImagesBucket) {
        setResult('ERROR: "product-images" bucket bulunamadÄ±!');
        return;
      }
      
      setResult('âœ… "product-images" bucket mevcut');
      
      // 3. Test dosyasÄ± yÃ¼kle
      setResult('Test dosyasÄ± yÃ¼kleniyor...');
      const testContent = 'test';
      const testBlob = new Blob([testContent], { type: 'text/plain' });
      const testFile = new File([testBlob], 'test.txt', { type: 'text/plain' });
      
      const { error: uploadError } = await supabase.storage
        .from('product-images')
        .upload('test/test.txt', testFile);
      
      if (uploadError) {
        setResult(`Test yÃ¼kleme hatasÄ±: ${uploadError.message}`);
        return;
      }
      
      setResult('âœ… Test dosyasÄ± baÅŸarÄ±yla yÃ¼klendi');
      
      // 4. Test dosyasÄ±nÄ± oku
      setResult('Test dosyasÄ± okunuyor...');
      const { data: readData, error: readError } = await supabase.storage
        .from('product-images')
        .download('test/test.txt');
      
      if (readError) {
        setResult(`Test okuma hatasÄ±: ${readError.message}`);
        return;
      }
      
      const text = await readData.text();
      setResult(`âœ… Test dosyasÄ± okundu: "${text}"`);
      
      // 5. Temizle
      await supabase.storage
        .from('product-images')
        .remove(['test/test.txt']);
        
      setResult('âœ… TÃ¼m testler baÅŸarÄ±lÄ±! Storage Ã§alÄ±ÅŸÄ±yor.');
      
    } catch (error: any) {
      setResult(`HATA: ${error.message}`);
    } finally {
      setTesting(false);
    }
  };

  return (
    <div className="fixed bottom-4 right-4 z-50">
      <button
        onClick={testStorage}
        disabled={testing}
        className="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg"
      >
        {testing ? 'Testing...' : 'ğŸ§ª Test Storage'}
      </button>
      {result && (
        <div className="mt-2 p-3 bg-white rounded-lg shadow-lg max-w-xs">
          <pre className="text-xs whitespace-pre-wrap">{result}</pre>
        </div>
      )}
    </div>
  );
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ TrueLocationPicker.tsx
ğŸ“Š 300 satÄ±r | 10.48 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/TrueLocationPicker.tsx - KESÄ°N Ã‡ALIÅAN
'use client'

import { useState } from 'react'

interface TrueLocationPickerProps {
  onLocationSelect: (location: {
    city: string
    lat?: number
    lng?: number
  }) => void
}

export default function TrueLocationPicker({ onLocationSelect }: TrueLocationPickerProps) {
  const [status, setStatus] = useState<'idle' | 'requesting' | 'success' | 'error'>('idle')
  const [city, setCity] = useState('')
  const [manualCity, setManualCity] = useState('')

  const cities = [
    'Ä°stanbul', 'Ankara', 'Ä°zmir', 'Bursa', 'Antalya', 'Adana', 'Konya',
    'Trabzon', 'Gaziantep', 'Kayseri', 'Mersin', 'EskiÅŸehir', 'DiyarbakÄ±r',
    'Samsun', 'Denizli', 'Ä°zmit', 'Manisa', 'BalÄ±kesir', 'Van', 'Malatya',
    'TÃ¼rkiye Geneli', 'Yurt DÄ±ÅŸÄ±'
  ]

  // KESÄ°N Ã‡ALIÅAN KONUM ALMA FONKSÄ°YONU
  const requestLocationPermission = async () => {
    setStatus('requesting')
    
    // 1. TarayÄ±cÄ± destekliyor mu?
    if (!navigator.geolocation) {
      setStatus('error')
      alert('TarayÄ±cÄ±nÄ±z konum servisini desteklemiyor.')
      return
    }

    // 2. Permissions API ile izin durumunu kontrol et (modern tarayÄ±cÄ±lar)
    if ('permissions' in navigator) {
      try {
        const permissionStatus = await navigator.permissions.query({ name: 'geolocation' as PermissionName })
        
        if (permissionStatus.state === 'denied') {
          setStatus('error')
          alert('Konum izni tarayÄ±cÄ± ayarlarÄ±nÄ±zdan engellenmiÅŸ. LÃ¼tfen ayarlardan izin verin.')
          return
        }
        
        if (permissionStatus.state === 'granted') {
          // Zaten izin verilmiÅŸ
          getLocation()
          return
        }
      } catch {
        // Permissions API desteklenmiyor, devam et
      }
    }

    // 3. KullanÄ±cÄ±ya aÃ§Ä±kÃ§a sor (en gÃ¼venli yol)
    const userConfirmed = window.confirm(
      'Konumunuzu kullanmamÄ±za izin veriyor musunuz?\n\n' +
      'â€¢ Daha hÄ±zlÄ± yardÄ±m almanÄ±zÄ± saÄŸlar\n' +
      'â€¢ Sadece ÅŸehir bilgisi kullanÄ±lÄ±r\n' +
      'â€¢ Tam adresiniz asla paylaÅŸÄ±lmaz\n\n' +
      'Telefonunuz konum izni isteyecek, lÃ¼tfen "Ä°zin Ver" seÃ§eneÄŸini seÃ§in.'
    )

    if (!userConfirmed) {
      setStatus('idle')
      return
    }

    // 4. Konumu al
    getLocation()
  }

  const getLocation = () => {
    navigator.geolocation.getCurrentPosition(
      async (position) => {
        try {
          const { latitude, longitude } = position.coords
          
          // Åehir bilgisini al
          const response = await fetch(
            `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=10`
          )
          const data = await response.json()
          
          let detectedCity = 'Konumunuz'
          if (data.address) {
            detectedCity = data.address.city || 
                          data.address.town || 
                          data.address.county ||
                          `${latitude.toFixed(2)}, ${longitude.toFixed(2)}`
          }
          
          setCity(detectedCity)
          setStatus('success')
          onLocationSelect({
            city: detectedCity,
            lat: latitude,
            lng: longitude
          })
        } catch {
          // Åehir bulunamazsa
          setCity('Konum alÄ±ndÄ±')
          setStatus('success')
          onLocationSelect({
            city: 'Konum alÄ±ndÄ±',
            lat: position.coords.latitude,
            lng: position.coords.longitude
          })
        }
      },
      (error) => {
        console.error('Konum hatasÄ±:', error)
        setStatus('error')
        
        let message = 'Konum alÄ±namadÄ±. '
        
        switch(error.code) {
          case 1: // PERMISSION_DENIED
            message += 'LÃ¼tfen:\n1. Telefon ayarlarÄ±ndan konumu aÃ§Ä±n\n2. TarayÄ±cÄ± ayarlarÄ±ndan siteye izin verin\n3. Manuel ÅŸehir seÃ§in'
            break
          case 2: // POSITION_UNAVAILABLE
            message += 'GPS veya internet baÄŸlantÄ±sÄ± yok.'
            break
          case 3: // TIMEOUT
            message += 'Zaman aÅŸÄ±mÄ±. Tekrar deneyin.'
            break
        }
        
        alert(message)
      },
      {
        enableHighAccuracy: true,
        timeout: 15000,
        maximumAge: 0
      }
    )
  }

  const handleManualSelect = (e: React.ChangeEvent<HTMLSelectElement>) => {
    const selectedCity = e.target.value
    setManualCity(selectedCity)
    if (selectedCity) {
      onLocationSelect({ city: selectedCity })
    }
  }

  return (
    <div className="space-y-6">
      {/* SeÃ§enekler */}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        {/* GPS Butonu - KULLANICI ONAYI Ä°LE */}
        <div className="text-center">
          <button
            type="button"
            onClick={requestLocationPermission}
            disabled={status === 'requesting'}
            className={`w-full p-6 rounded-xl border-2 transition-all ${
              status === 'success' 
                ? 'border-green-500 bg-green-50' 
                : status === 'requesting'
                ? 'border-blue-500 bg-blue-50'
                : 'border-gray-200 hover:border-gray-300'
            }`}
          >
            <div className="text-3xl mb-3">ğŸ“</div>
            <h4 className="font-bold text-gray-900 mb-2">
              {status === 'requesting' ? 'Konum Ä°steniyor...' : 'Telefon Konumu Kullan'}
            </h4>
            <p className="text-sm text-gray-600">
              {status === 'success' ? `âœ“ ${city}` : 'Telefonunuzdan konum izni istenir'}
            </p>
          </button>
          
          {status === 'error' && (
            <p className="text-red-600 text-sm mt-2">
              Konum alÄ±namadÄ±. LÃ¼tfen manuel ÅŸehir seÃ§in.
            </p>
          )}
        </div>

        {/* Manuel SeÃ§im */}
        <div className="text-center">
          <div className={`w-full p-6 rounded-xl border-2 ${
            manualCity ? 'border-blue-500 bg-blue-50' : 'border-gray-200'
          }`}>
            <div className="text-3xl mb-3">ğŸ™ï¸</div>
            <h4 className="font-bold text-gray-900 mb-2">Åehir SeÃ§</h4>
            <p className="text-sm text-gray-600">Listeden ÅŸehir seÃ§in</p>
          </div>
        </div>
      </div>

      {/* Manuel Åehir SeÃ§imi */}
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-2">
          Åehir SeÃ§in
        </label>
        <select
          value={manualCity}
          onChange={handleManualSelect}
          className="w-full px-4 py-3 border border-gray-300 rounded-lg"
        >
          <option value="">Åehir seÃ§in</option>
          {cities.map((city) => (
            <option key={city} value={city}>{city}</option>
          ))}
        </select>
        <p className="text-sm text-gray-500 mt-2">
          Telefon konumu Ã§alÄ±ÅŸmazsa buradan seÃ§in
        </p>
      </div>

      {/* Telefon KullanÄ±cÄ±larÄ± Ä°Ã§in DetaylÄ± Talimatlar */}
      <div className="bg-blue-50 border border-blue-200 rounded-xl p-6">
        <h4 className="font-bold text-blue-900 mb-4 flex items-center">
          <span className="text-2xl mr-3">ğŸ“±</span>
          Telefon KullanÄ±cÄ±larÄ± Ä°Ã§in AdÄ±mlar:
        </h4>
        
        <div className="space-y-4">
          <div className="flex items-start">
            <div className="bg-blue-100 text-blue-800 rounded-lg p-2 mr-3">1</div>
            <div>
              <p className="font-medium text-blue-900">"Telefon Konumu Kullan" butonuna tÄ±klayÄ±n</p>
              <p className="text-sm text-blue-700">TarayÄ±cÄ± konum izni isteyecek</p>
            </div>
          </div>
          
          <div className="flex items-start">
            <div className="bg-blue-100 text-blue-800 rounded-lg p-2 mr-3">2</div>
            <div>
              <p className="font-medium text-blue-900">"Ä°zin Ver" butonuna tÄ±klayÄ±n</p>
              <p className="text-sm text-blue-700">
                iOS: "Ä°zin Ver" veya "Uygulama KullanÄ±rken Ä°zin Ver"<br />
                Android: "Ä°zin Ver" veya "Sadece bu seferlik"
              </p>
            </div>
          </div>
          
          <div className="flex items-start">
            <div className="bg-blue-100 text-blue-800 rounded-lg p-2 mr-3">3</div>
            <div>
              <p className="font-medium text-blue-900">Konumunuz otomatik alÄ±nacak</p>
              <p className="text-sm text-blue-700">
                Ã‡alÄ±ÅŸmazsa yukarÄ±daki listeden ÅŸehir seÃ§in
              </p>
            </div>
          </div>
        </div>

        {/* Sorun Giderme */}
        <details className="mt-6">
          <summary className="cursor-pointer text-blue-700 font-medium">
            ğŸ› ï¸ Konum Ã§alÄ±ÅŸmÄ±yorsa tÄ±klayÄ±n
          </summary>
          <div className="mt-3 p-4 bg-white rounded-lg space-y-3">
            <div>
              <p className="font-medium text-gray-900">iPhone (Safari):</p>
              <p className="text-sm text-gray-700">
                1. Ayarlar â†’ Gizlilik â†’ Konum Hizmetleri â†’ AÃ‡IK<br />
                2. Safari â†’ "Konuma EriÅŸim" â†’ "Ä°zin Ver"<br />
                3. Siteyi yeniden yÃ¼kleyin
              </p>
            </div>
            
            <div>
              <p className="font-medium text-gray-900">Android (Chrome):</p>
              <p className="text-sm text-gray-700">
                1. Ayarlar â†’ Konum â†’ AÃ‡IK<br />
                2. Chrome â†’ Site ayarlarÄ± â†’ Konum â†’ "Siteden izin istenir"<br />
                3. Siteyi yeniden yÃ¼kleyin
              </p>
            </div>
          </div>
        </details>
      </div>

      {/* Konum Durumu */}
      {(status === 'success' || manualCity) && (
        <div className="bg-green-50 border border-green-200 rounded-xl p-6">
          <div className="flex items-center">
            <span className="text-green-600 text-2xl mr-3">âœ…</span>
            <div>
              <p className="font-bold text-green-900">Konum SeÃ§ildi!</p>
              <p className="text-green-800">
                {status === 'success' ? city : manualCity}
              </p>
              <p className="text-sm text-green-700 mt-1">
                YardÄ±m edecek kiÅŸiler bu konumu gÃ¶recek
              </p>
            </div>
          </div>
        </div>
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ UserMenu.tsx
ğŸ“Š 147 satÄ±r | 4.37 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import AuthModal from './AuthModal'

interface User {
  id: string
  email: string
  name?: string
}

export default function UserMenu() {
  const [user, setUser] = useState<User | null>(null)
  const [showAuthModal, setShowAuthModal] = useState(false)
  const [showDropdown, setShowDropdown] = useState(false)

  useEffect(() => {
    // Mevcut kullanÄ±cÄ±yÄ± kontrol et
    checkUser()
    
    // Auth state deÄŸiÅŸikliklerini dinle
    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {
      if (session?.user) {
        setUser({
          id: session.user.id,
          email: session.user.email!,
          name: session.user.user_metadata?.name,
        })
      } else {
        setUser(null)
      }
    })

    return () => subscription.unsubscribe()
  }, [])

  const checkUser = async () => {
    const { data: { user } } = await supabase.auth.getUser()
    if (user) {
      setUser({
        id: user.id,
        email: user.email!,
        name: user.user_metadata?.name,
      })
    }
  }

  const handleLogout = async () => {
    await supabase.auth.signOut()
    setUser(null)
    setShowDropdown(false)
  }

  if (!user) {
    return (
      <>
        <button
          onClick={() => setShowAuthModal(true)}
          className="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition duration-200"
        >
          GiriÅŸ Yap / KayÄ±t Ol
        </button>
        
        <AuthModal
          isOpen={showAuthModal}
          onClose={() => setShowAuthModal(false)}
        />
      </>
    )
  }

  return (
    <div className="relative">
      <button
        onClick={() => setShowDropdown(!showDropdown)}
        className="flex items-center space-x-3 bg-gray-100 hover:bg-gray-200 rounded-full pl-3 pr-4 py-2 transition duration-200"
      >
        <div className="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
          {user.name?.[0]?.toUpperCase() || user.email[0].toUpperCase()}
        </div>
        <div className="text-left hidden md:block">
          <p className="font-medium text-sm">{user.name || 'KullanÄ±cÄ±'}</p>
          <p className="text-xs text-gray-500 truncate max-w-[120px]">{user.email}</p>
        </div>
      </button>

      {showDropdown && (
        <div className="absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-lg border z-50">
          <div className="p-4 border-b">
            <p className="font-medium">{user.name || 'KullanÄ±cÄ±'}</p>
            <p className="text-sm text-gray-500 truncate">{user.email}</p>
          </div>
          
          <div className="p-2">
            <a
              href="/profile"
              className="flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 rounded-lg"
            >
              <span>ğŸ‘¤</span>
              <span>Profilim</span>
            </a>
            <a
              href="/my-spots"
              className="flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 rounded-lg"
            >
              <span>ğŸ“</span>
              <span>Spot'larÄ±m</span>
            </a>
            <a
              href="/help-given"
              className="flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 rounded-lg"
            >
              <span>ğŸ¤</span>
              <span>YardÄ±mlarÄ±m</span>
            </a>
            <a
              href="/settings"
              className="flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 rounded-lg"
            >
              <span>âš™ï¸</span>
              <span>Ayarlar</span>
            </a>
          </div>
          
          <div className="border-t p-2">
            <button
              onClick={handleLogout}
              className="flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 w-full rounded-lg"
            >
              <span>ğŸšª</span>
              <span>Ã‡Ä±kÄ±ÅŸ Yap</span>
            </button>
          </div>
        </div>
      )}

      {/* Dropdown dÄ±ÅŸÄ±na tÄ±klayÄ±nca kapat */}
      {showDropdown && (
        <div
          className="fixed inset-0 z-40"
          onClick={() => setShowDropdown(false)}
        />
      )}
    </div>
  )
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ UserProfileCard.tsx
ğŸ“Š 164 satÄ±r | 6.77 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// components/UserProfileCard.tsx
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import { GamificationEngine } from '@/lib/gamification/game-engine'

interface UserProfileCardProps {
  userId: string
  compact?: boolean
}

export default function UserProfileCard({ userId, compact = false }: UserProfileCardProps) {
  const [profile, setProfile] = useState<any>(null)
  const [reputation, setReputation] = useState<any>(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchUserData()
  }, [userId])

  const fetchUserData = async () => {
    try {
      const [{ data: profileData }, { data: repData }] = await Promise.all([
        supabase.from('user_profiles').select('*').eq('id', userId).single(),
        supabase.from('user_reputation').select('*').eq('user_id', userId).single()
      ])

      setProfile(profileData)
      setReputation(repData)
    } catch (error) {
      console.error('Profil yÃ¼klenemedi:', error)
    } finally {
      setLoading(false)
    }
  }

  if (loading) {
    return <div className="animate-pulse bg-gray-200 rounded-lg h-32"></div>
  }

  const userLevel = GamificationEngine.LEVELS.find(l => l.level === reputation?.current_level) || GamificationEngine.LEVELS[0]
  const nextLevel = GamificationEngine.LEVELS.find(l => l.level === (reputation?.current_level || 0) + 1)

  return (
    <div className={`bg-white rounded-xl shadow-lg ${compact ? 'p-4' : 'p-6'}`}>
      {/* Ãœst KÄ±sÄ±m - Avatar ve Temel Bilgiler */}
      <div className="flex items-start space-x-4">
        <div className="relative">
          <div className={`w-${compact ? '12' : '16'} h-${compact ? '12' : '16'} rounded-full border-4`} 
               style={{ borderColor: userLevel.color }}>
            {profile?.avatar_url ? (
              <img src={profile.avatar_url} alt={profile.name} className="w-full h-full rounded-full" />
            ) : (
              <div className={`w-full h-full rounded-full bg-gradient-to-br from-${userLevel.color}-400 to-${userLevel.color}-600 flex items-center justify-center text-white font-bold text-${compact ? 'lg' : 'xl'}`}>
                {profile?.name?.[0] || 'K'}
              </div>
            )}
          </div>
          
          {/* Seviye GÃ¶stergesi */}
          {!compact && (
            <div className="absolute -bottom-2 -right-2 bg-white rounded-full p-1 shadow-lg">
              <div className={`w-8 h-8 rounded-full bg-gradient-to-br from-${userLevel.color}-400 to-${userLevel.color}-600 flex items-center justify-center text-white text-xs font-bold`}>
                {userLevel.level}
              </div>
            </div>
          )}
        </div>

        <div className="flex-1">
          <div className="flex items-center justify-between">
            <div>
              <h3 className={`font-bold ${compact ? 'text-lg' : 'text-xl'}`}>
                {profile?.name || 'KullanÄ±cÄ±'}
              </h3>
              <p className={`text-${userLevel.color}-600 font-medium ${compact ? 'text-sm' : ''}`}>
                {userLevel.name}
              </p>
            </div>
            
            {!compact && (
              <div className="text-right">
                <div className="text-2xl font-bold text-gray-900">
                  {reputation?.total_points || 0}
                </div>
                <div className="text-sm text-gray-500">Toplam Puan</div>
              </div>
            )}
          </div>

          {/* Progress Bar */}
          {!compact && nextLevel && (
            <div className="mt-4">
              <div className="flex justify-between text-sm mb-1">
                <span className="text-gray-600">Seviye {userLevel.level}</span>
                <span className="font-medium">
                  {reputation?.total_points || 0} / {nextLevel.minPoints} puan
                </span>
              </div>
              <div className="w-full bg-gray-200 rounded-full h-2">
                <div 
                  className="h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-600"
                  style={{ 
                    width: `${Math.min(100, ((reputation?.total_points || 0) / nextLevel.minPoints) * 100)}%` 
                  }}
                ></div>
              </div>
              <p className="text-xs text-gray-500 mt-1">
                {nextLevel.minPoints - (reputation?.total_points || 0)} puan kaldÄ±: <strong>{nextLevel.name}</strong>
              </p>
            </div>
          )}
        </div>
      </div>

      {/* Rozetler */}
      {!compact && reputation?.badges && reputation.badges.length > 0 && (
        <div className="mt-6">
          <h4 className="font-medium text-gray-700 mb-3">KazanÄ±lan Rozetler</h4>
          <div className="flex flex-wrap gap-2">
            {reputation.badges.slice(0, 6).map((badgeId: string) => {
              const badge = Object.values(GamificationEngine.BADGES).find(b => b.id === badgeId)
              return badge ? (
                <div key={badge.id} className="tooltip" data-tip={badge.name}>
                  <div className="w-10 h-10 rounded-full bg-gradient-to-br from-yellow-100 to-yellow-300 flex items-center justify-center text-lg">
                    {badge.icon}
                  </div>
                </div>
              ) : null
            })}
            {reputation.badges.length > 6 && (
              <div className="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 font-medium">
                +{reputation.badges.length - 6}
              </div>
            )}
          </div>
        </div>
      )}

      {/* Ä°statistikler (Compact modda gizle) */}
      {!compact && (
        <div className="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4">
          <div className="text-center">
            <div className="text-2xl font-bold text-blue-600">{reputation?.total_sightings || 0}</div>
            <div className="text-sm text-gray-600">YardÄ±m</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-green-600">{reputation?.total_photos || 0}</div>
            <div className="text-sm text-gray-600">FotoÄŸraf</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-purple-600">{reputation?.total_rare_finds || 0}</div>
            <div className="text-sm text-gray-600">Nadir BuluÅŸ</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-orange-600">{reputation?.daily_streak || 0}</div>
            <div className="text-sm text-gray-600">GÃ¼n Streak</div>
          </div>
        </div>
      )}
    </div>
  )
}

================================================================================
ğŸ“Š Ã–ZET BÄ°LGÄ°LER
================================================================================
ğŸ“ Dizin: components
ğŸ“„ Toplam Dosya: 95
ğŸ“Š Toplam SatÄ±r: 15.395
ğŸ’¾ Toplam Boyut: 0.53 MB
ğŸ“… OluÅŸturulma: 15.02.2026 03:39:36
================================================================================
